
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Course Notes and Code (Erwin Frey, LMU Munich, 2025)">
      
      
        <meta name="author" content="Zhihang Liu">
      
      
        <link rel="canonical" href="https://liu-zhihang.github.io/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/notes/33.%20Nonequilibrium%20Work%20and%20Fluctuation%20Theorems/">
      
      
        <link rel="prev" href="../32.%20Janssen%E2%80%93De%20Dominicis%20Response%20Functional%20and%20the%20Fluctuation%E2%80%93Dissipation%20Relation/">
      
      
        <link rel="next" href="../34.%20Directed%20Percolation%2C%20Absorbing%20States%2C%20and%20Spectral%20Methods/">
      
      
        
          <link rel="alternate" href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/" hreflang="en">
        
          <link rel="alternate" href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/zh/" hreflang="zh">
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>33. Nonequilibrium Work and Fluctuation Theorems - Nonequilibrium Field Theories and Stochastic Dynamics</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/video.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction-from-passive-response-to-active-driving-opening-the-door-to-the-nonequilibrium-world" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Nonequilibrium Field Theories and Stochastic Dynamics" class="md-header__button md-logo" aria-label="Nonequilibrium Field Theories and Stochastic Dynamics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nonequilibrium Field Theories and Stochastic Dynamics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              33. Nonequilibrium Work and Fluctuation Theorems
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/zh/" hreflang="zh" class="md-select__link">
              简体中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Liu-Zhihang/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Nonequilibrium Field Theories and Stochastic Dynamics" class="md-nav__button md-logo" aria-label="Nonequilibrium Field Theories and Stochastic Dynamics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Nonequilibrium Field Theories and Stochastic Dynamics
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Liu-Zhihang/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Course Notes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Course Notes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20Course%20Introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Course Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.%20Simple%20Random%20Walk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Simple Random Walk
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.%20Gaussian%20Random%20Walk%20and%20Poisson%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Gaussian Random Walk and Poisson Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.%20Gillespie%20Algorithm%2C%20Master%20Equation%2C%20Generating%20Functions%20and%20Population%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Gillespie Algorithm, Master Equation, Generating Functions and Population Dynamics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.%20Population%20Dynamics%20-%20Linear%20Death%20Process%20and%20Lotka-Volterra%20System/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Population Dynamics - Linear Death Process and Lotka-Volterra System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.%20Fundamental%20Equations%20of%20Markov%20Processes%20%E2%80%94%20Chapman%E2%80%93Kolmogorov%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Fundamental Equations of Markov Processes — Chapman–Kolmogorov Equation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.%20Forward%20Master%20Equation%20and%20the%20Q%20Matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. Forward Master Equation and the Q Matrix
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8.%20Perron%E2%80%93Frobenius%20Theorem%2C%20Steady%20States%2C%20and%20Detailed%20Balance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. Perron–Frobenius Theorem, Steady States, and Detailed Balance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9.%20Nonequilibrium%20States%20%E2%80%94%20Irreversibility%20and%20Entropy%20Production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. Nonequilibrium States — Irreversibility and Entropy Production
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10.%20Ehrenfest%20Model%2C%20Entropy%2C%20and%20KL%20Divergence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. Ehrenfest Model, Entropy, and KL Divergence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11.%20Continuous%20Markov%20Processes%20and%20the%20Fokker%E2%80%93Planck%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. Continuous Markov Processes and the Fokker–Planck Equation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12.%20Brownian%20Motion%20and%20the%20Ornstein%E2%80%93Uhlenbeck%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. Brownian Motion and the Ornstein–Uhlenbeck Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13.%20Monte%20Carlo%20Sampling%20as%20a%20Stochastic%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. Monte Carlo Sampling as a Stochastic Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14.%20Hamiltonian%20Monte%20Carlo%20Sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. Hamiltonian Monte Carlo Sampling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15.%20Chemotaxis%2C%20Run-and-Tumble%20Motion%2C%20and%20the%20Keller%E2%80%93Segel%20Model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. Chemotaxis, Run-and-Tumble Motion, and the Keller–Segel Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../16.%20The%20Schnitzer%20Model%2C%20Anomalous%20Diffusion%2C%20and%20Motility%E2%80%91Induced%20Phase%20Separation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. The Schnitzer Model, Anomalous Diffusion, and Motility‑Induced Phase Separation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../17.%20Langevin%20Equation%2C%20Brownian%20Particle%2C%20and%20the%20Fluctuation%E2%80%93Dissipation%20Theorem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. Langevin Equation, Brownian Particle, and the Fluctuation–Dissipation Theorem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18.%20Fokker%E2%80%93Planck%20Equation%20and%20the%20Smoluchowski%20Equation%20%E2%80%94%20From%20Random%20Trajectories%20to%20Probability%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    18. Fokker–Planck Equation and the Smoluchowski Equation — From Random Trajectories to Probability Dynamics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19.%20Path%20Integral%20Formulation%20of%20Stochastic%20Processes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    19. Path Integral Formulation of Stochastic Processes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.%20Stochastic%20Differential%20Equations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    20. Stochastic Differential Equations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.%20Ito%20Integral%20and%20Unified%20Stochastic%20Process%20Framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    21. Ito Integral and Unified Stochastic Process Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.%20Path%20Integrals%20for%20Systems%20with%20Multiplicative%20Noise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    22. Path Integrals for Systems with Multiplicative Noise
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.%20From%20Coarse-Graining%20to%20Fluctuation%20Dynamics%20of%20Continuous%20Field%20Theories/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    23. From Coarse-Graining to Fluctuation Dynamics of Continuous Field Theories
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.%20Onsager%20Coefficients%2C%20Reciprocity%2C%20and%20the%20Dynamic%20Fluctuation%E2%80%93Dissipation%20Theorem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    24. Onsager Coefficients, Reciprocity, and the Dynamic Fluctuation–Dissipation Theorem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../25.%20Gradient%20Dynamics%2C%20Phase%20Transitions%2C%20and%20Relaxation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    25. Gradient Dynamics, Phase Transitions, and Relaxation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../26.%20Critical%20Slowing%20Down%2C%20Dynamic%20Response%2C%20and%20Conservation%20Laws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    26. Critical Slowing Down, Dynamic Response, and Conservation Laws
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../27.%20Hydrodynamics%20of%20Simple%20Fluids%2C%20Inviscid%20Flow%2C%20and%20the%20Euler%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    27. Hydrodynamics of Simple Fluids, Inviscid Flow, and the Euler Equation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../28.%20Viscous%20Fluids%2C%20the%20Navier%E2%80%93Stokes%20Equation%2C%20Entropy%20Balance%2C%20and%20Heat%20Conduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    28. Viscous Fluids, the Navier–Stokes Equation, Entropy Balance, and Heat Conduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../29.%20Irreversible%20Linear%20Thermodynamics%20and%20Dry%20Diffusive%20Particle%20Systems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    29. Irreversible Linear Thermodynamics and Dry Diffusive Particle Systems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../30.%20Brownian%20Particles%20Suspended%20in%20a%20Fluid%20%E2%80%94%20Model%20H/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    30. Brownian Particles Suspended in a Fluid — Model H
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../31.%20Dynamical%20Functionals%2C%20Additive%E2%80%91Noise%20Field%20Theory%2C%20and%20the%20Onsager%E2%80%93Machlup%20Functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    31. Dynamical Functionals, Additive‑Noise Field Theory, and the Onsager–Machlup Functional
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../32.%20Janssen%E2%80%93De%20Dominicis%20Response%20Functional%20and%20the%20Fluctuation%E2%80%93Dissipation%20Relation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    32. Janssen–De Dominicis Response Functional and the Fluctuation–Dissipation Relation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    33. Nonequilibrium Work and Fluctuation Theorems
  

    
  </span>
  
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../34.%20Directed%20Percolation%2C%20Absorbing%20States%2C%20and%20Spectral%20Methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    34. Directed Percolation, Absorbing States, and Spectral Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../35.%20Path-Integral%20Representation%20of%20the%20Master%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    35. Path-Integral Representation of the Master Equation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../36.%20Coherent-State%20Path%20Integrals%2C%20Operator%20Algebra%2C%20and%20Imaginary%20Noise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    36. Coherent-State Path Integrals, Operator Algebra, and Imaginary Noise
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../37.%20Kramers-Moyal%20Expansion%20and%20the%20Low-Noise%20Limit%20of%20Path%20Integrals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    37. Kramers-Moyal Expansion and the Low-Noise Limit of Path Integrals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../38.%20Multi-Species%20Path%20Integrals%20and%20Cyclic%20Competition%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    38. Multi-Species Path Integrals and Cyclic Competition Dynamics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../39.%20From%20Particle%20Jumps%20to%20Continuous%20Field%20Theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    39. From Particle Jumps to Continuous Field Theory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../40.%20Unified%20Field%20Theory%20Framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    40. Unified Field Theory Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    中文笔记
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    中文笔记
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    首页
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/1.%20%E8%AF%BE%E7%A8%8B%E5%AF%BC%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. 课程导论
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/2.%20%E7%AE%80%E5%8D%95%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. 简单随机游走
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/3.%20%E9%AB%98%E6%96%AF%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E4%B8%8E%E6%B3%8A%E6%9D%BE%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. 高斯随机游走与泊松过程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/4.%20Gillespie%20%E7%AE%97%E6%B3%95%E3%80%81%E4%B8%BB%E6%96%B9%E7%A8%8B%E3%80%81%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E4%B8%8E%E7%A7%8D%E7%BE%A4%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Gillespie 算法、主方程、生成函数与种群动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/5.%20%E7%A7%8D%E7%BE%A4%E5%8A%A8%E6%80%81%E5%AD%A6%EF%BC%9A%E7%BA%BF%E6%80%A7%E6%AD%BB%E4%BA%A1%E8%BF%87%E7%A8%8B%E4%B8%8ELotka-Volterra%20%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. 种群动态学：线性死亡过程与Lotka-Volterra 系统
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/6.%20%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%96%B9%E7%A8%8B%EF%BC%9A%E6%9F%A5%E6%99%AE%E6%9B%BC-%E7%A7%91%E5%B0%94%E8%8E%AB%E6%88%88%E7%BD%97%E5%A4%AB%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. 马尔可夫过程的基本方程：查普曼-科尔莫戈罗夫方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/7.%20%E5%89%8D%E5%90%91%E4%B8%BB%E6%96%B9%E7%A8%8B%E4%B8%8EQ%E7%9F%A9%E9%98%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. 前向主方程与Q矩阵
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/8.%20%E4%BD%A9%E9%BE%99-%E5%BC%97%E7%BD%97%E8%B4%9D%E5%B0%BC%E4%B9%8C%E6%96%AF%E5%AE%9A%E7%90%86%E3%80%81%E7%A8%B3%E6%80%81%E4%B8%8E%E7%BB%86%E8%87%B4%E5%B9%B3%E8%A1%A1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. 佩龙-弗罗贝尼乌斯定理、稳态与细致平衡
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/9.%20%E9%9D%9E%E5%B9%B3%E8%A1%A1%E6%80%81%EF%BC%9A%E4%B8%8D%E5%8F%AF%E9%80%86%E6%80%A7%E4%B8%8E%E7%86%B5%E4%BA%A7%E7%94%9F%E7%9A%84%E6%8E%A8%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. 非平衡态：不可逆性与熵产生的推论
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/10.%20%E5%9F%83%E4%BC%A6%E8%B4%B9%E6%96%AF%E7%89%B9%E6%A8%A1%E5%9E%8B%E3%80%81%E7%86%B5%E4%B8%8EKL%E6%95%A3%E5%BA%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. 埃伦费斯特模型、熵与KL散度
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/11.%20%E8%BF%9E%E7%BB%AD%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E4%B8%8E%E7%A6%8F%E5%85%8B-%E6%99%AE%E6%9C%97%E5%85%8B%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. 连续马尔可夫过程与福克-普朗克方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/12.%20%E5%B8%83%E6%9C%97%E8%BF%90%E5%8A%A8%E4%B8%8E%E5%A5%A5%E6%81%A9%E6%96%AF%E5%9D%A6-%E4%B9%8C%E4%BC%A6%E8%B4%9D%E5%85%8B%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. 布朗运动与奥恩斯坦-乌伦贝克过程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/13.%20%E4%BD%9C%E4%B8%BA%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E9%87%87%E6%A0%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. 作为随机过程的蒙特卡洛采样
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/14.%20%E5%93%88%E5%AF%86%E5%B0%94%E9%A1%BF%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E9%87%87%E6%A0%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. 哈密尔顿蒙特卡洛采样
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/15.%20%E8%B6%8B%E5%8C%96%E6%80%A7%E3%80%81%E8%B7%91%E5%8A%A8-%E7%BF%BB%E6%BB%9A%E8%BF%90%E5%8A%A8%E4%B8%8EKeller-Segel%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. 趋化性、跑动-翻滚运动与Keller-Segel模型
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/16.%20Schnitzer%E6%A8%A1%E5%9E%8B%E3%80%81%E5%8F%8D%E5%B8%B8%E6%89%A9%E6%95%A3%E4%B8%8E%E8%BF%90%E5%8A%A8%E8%AF%B1%E5%AF%BC%E7%9B%B8%E5%88%86%E7%A6%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. Schnitzer模型、反常扩散与运动诱导相分离
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/17.%20%E6%9C%97%E4%B9%8B%E4%B8%87%E6%96%B9%E7%A8%8B%E3%80%81%E5%B8%83%E6%9C%97%E7%B2%92%E5%AD%90%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. 朗之万方程、布朗粒子与涨落-耗散定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/18.%20%E7%A6%8F%E5%85%8B-%E6%99%AE%E6%9C%97%E5%85%8B%E6%96%B9%E7%A8%8B%E4%B8%8E%E6%96%AF%E6%91%A9%E6%A3%B1%E9%9C%8D%E5%A4%AB%E6%96%AF%E5%9F%BA%E6%96%B9%E7%A8%8B%EF%BC%9A%E4%BB%8E%E9%9A%8F%E6%9C%BA%E8%BD%A8%E8%BF%B9%E5%88%B0%E6%A6%82%E7%8E%87%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    18. 福克-普朗克方程与斯摩棱霍夫斯基方程：从随机轨迹到概率动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/19.%20%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E8%A1%A8%E8%BF%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    19. 随机过程的路径积分表述
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/20.%20%E9%9A%8F%E6%9C%BA%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    20. 随机微分方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/21.%20%E4%BC%8A%E8%97%A4%E7%A7%AF%E5%88%86%E4%B8%8E%E7%BB%9F%E4%B8%80%E7%9A%84%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    21. 伊藤积分与统一的随机过程框架
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/22.%20%E5%90%AB%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    22. 含乘性噪声系统的路径积分
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/23.%20%E4%BB%8E%E7%B2%97%E7%B2%92%E5%8C%96%E5%88%B0%E8%BF%9E%E7%BB%AD%E5%9C%BA%E8%AE%BA%E6%B6%A8%E8%90%BD%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    23. 从粗粒化到连续场论涨落动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/24.%20%E6%98%82%E8%90%A8%E6%A0%BC%E7%B3%BB%E6%95%B0%E3%80%81%E5%80%92%E6%98%93%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%8A%A8%E6%80%81%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    24. 昂萨格系数、倒易关系与动态涨落-耗散定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/25.%20%E6%A2%AF%E5%BA%A6%E5%8A%A8%E5%8A%9B%E5%AD%A6%E3%80%81%E7%9B%B8%E5%8F%98%E4%B8%8E%E5%BC%9B%E8%B1%AB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    25. 梯度动力学、相变与弛豫
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/26.%20%E4%B8%B4%E7%95%8C%E6%85%A2%E5%8C%96%E3%80%81%E5%8A%A8%E6%80%81%E5%93%8D%E5%BA%94%E4%B8%8E%E5%AE%88%E6%81%92%E5%BE%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    26. 临界慢化、动态响应与守恒律
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/27.%20%E7%AE%80%E5%8D%95%E6%B5%81%E4%BD%93%E3%80%81%E6%97%A0%E6%91%A9%E6%93%A6%E6%B5%81%E4%BD%93%E4%B8%8E%E6%AC%A7%E6%8B%89%E6%96%B9%E7%A8%8B%E7%9A%84%E6%B5%81%E4%BD%93%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    27. 简单流体、无摩擦流体与欧拉方程的流体动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/28.%20%E7%B2%98%E6%80%A7%E6%B5%81%E4%BD%93%E3%80%81%E7%BA%B3%E7%BB%B4-%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E6%96%B9%E7%A8%8B%E3%80%81%E7%86%B5%E5%B9%B3%E8%A1%A1%E4%B8%8E%E7%83%AD%E4%BC%A0%E5%AF%BC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    28. 粘性流体、纳维-斯托克斯方程、熵平衡与热传导
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/29.%20%E4%B8%8D%E5%8F%AF%E9%80%86%E7%BA%BF%E6%80%A7%E7%83%AD%E5%8A%9B%E5%AD%A6%E4%B8%8E%E5%B9%B2%E6%80%A7%E6%89%A9%E6%95%A3%E7%B2%92%E5%AD%90%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    29. 不可逆线性热力学与干性扩散粒子系统
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/30.%20%E6%82%AC%E6%B5%AE%E5%9C%A8%E6%B5%81%E4%BD%93%E4%B8%AD%E7%9A%84%E5%B8%83%E6%9C%97%E7%B2%92%E5%AD%90%20%E2%80%94%20H%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    30. 悬浮在流体中的布朗粒子 — H模型
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/31.%20%E5%8A%A8%E6%80%81%E6%B3%9B%E5%87%BD%E3%80%81%E5%8A%A0%E6%80%A7%E5%99%AA%E5%A3%B0%E5%9C%BA%E8%AE%BA%E4%B8%8EOnsager-Machlup%E6%B3%9B%E5%87%BD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    31. 动态泛函、加性噪声场论与Onsager-Machlup泛函
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/32.%20Janssen-De%20Dominicis%20%E5%93%8D%E5%BA%94%E6%B3%9B%E5%87%BD%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%85%B3%E7%B3%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    32. Janssen-De Dominicis 响应泛函与涨落-耗散关系
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/33.%20%E9%9D%9E%E5%B9%B3%E8%A1%A1%E5%8A%9F%E4%B8%8E%E6%B6%A8%E8%90%BD%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    33. 非平衡功与涨落定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/34.%20%E6%9C%89%E5%90%91%E6%B8%97%E6%B5%81%E3%80%81%E5%90%B8%E6%94%B6%E6%80%81%E4%B8%8E%E8%B0%B1%E6%96%B9%E6%B3%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    34. 有向渗流、吸收态与谱方法
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/35.%20%E4%B8%BB%E6%96%B9%E7%A8%8B%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E8%A1%A8%E7%A4%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    35. 主方程的路径积分表示
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/36.%20%E7%9B%B8%E5%B9%B2%E6%80%81%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E3%80%81%E7%AE%97%E7%AC%A6%E4%BB%A3%E6%95%B0%E4%B8%8E%E8%99%9A%E5%99%AA%E5%A3%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    36. 相干态路径积分、算符代数与虚噪声
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/37.%20Kramers-Moyal%20%E5%B1%95%E5%BC%80%E4%B8%8E%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E7%9A%84%E4%BD%8E%E5%99%AA%E5%A3%B0%E6%9E%81%E9%99%90/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    37. Kramers-Moyal 展开与路径积分的低噪声极限
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/38.%20%E5%A4%9A%E7%89%A9%E7%A7%8D%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E4%B8%8E%E5%BE%AA%E7%8E%AF%E7%AB%9E%E4%BA%89%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    38. 多物种路径积分与循环竞争动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/39.%20%E4%BB%8E%E7%B2%92%E5%AD%90%E8%B7%B3%E8%B7%83%E5%88%B0%E8%BF%9E%E7%BB%AD%E5%9C%BA%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    39. 从粒子跳跃到连续场论
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/40.%20%E7%BB%9F%E4%B8%80%E7%9A%84%E5%9C%BA%E8%AE%BA%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    40. 统一的场论框架
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="introduction-from-passive-response-to-active-driving-opening-the-door-to-the-nonequilibrium-world">Introduction: From Passive Response to Active Driving - Opening the Door to the Nonequilibrium World<a class="headerlink" href="#introduction-from-passive-response-to-active-driving-opening-the-door-to-the-nonequilibrium-world" title="Permanent link">&para;</a></h1>
<p>In the previous lectures we focused on <strong>near-equilibrium systems</strong>. In particular, <strong>Lecture 32</strong> built the powerful <strong>Janssen-De Dominicis (JDD) path-integral formalism</strong> and derived from it the cornerstone of near-equilibrium statistical physics—the <strong>fluctuation-dissipation theorem (FDT)</strong>. FDT reveals a deep insight: the <strong>passive linear response</strong> to a small external perturbation is fully determined by <strong>spontaneous equilibrium fluctuations</strong>. This relation relies crucially on <strong>time-reversal symmetry</strong> at equilibrium.</p>
<p>However, the brilliance of the JDD formalism and FDT also limits their domain. When we turn our gaze from the ideal conditions of the laboratory to the broader real world—from the continuous operation of molecular motors in cells, to colloids rapidly dragged by optical tweezers in experiments, to any system whose control parameters undergo significant changes in <strong>finite time</strong>—what we face are processes that are far from equilibrium and inherently <strong>irreversible</strong>. For these processes, classical thermodynamics can only provide incomplete descriptions, typically in the form of inequalities, such as the average nonequilibrium work always being greater than or equal to the system's equilibrium free energy change (<span class="arithmatex">\(\langle W \rangle \geq \Delta F\)</span>).</p>
<p>This lecture marks another crucial <strong>perspective shift</strong> in the course: from <strong>passive response</strong> to small perturbations, to analyzing nonequilibrium dynamics under <strong>active and arbitrary</strong> external <strong>protocols</strong>. The core question is: for these far-from-equilibrium, inherently stochastic processes, do there exist universal, <strong>exact equality relationships</strong> that can transcend classical inequalities and provide fundamental constraints for these processes?</p>
<p>The answer is yes, and the key breakthrough comes from <strong>changing the level of observation</strong>. Instead of focusing only on the <strong>averages</strong> of thermodynamic quantities (like work or entropy production), we turn to studying the <strong>complete probability distributions</strong> of these quantities generated by countless <strong>stochastic trajectories</strong> of the system. By analyzing the full statistics of fluctuations, we can precisely "distill" hidden equilibrium information from seemingly chaotic nonequilibrium processes.</p>
<p>This lecture will focus on deriving and understanding two central <strong>fluctuation theorems (FTs)</strong>: the <strong>Jarzynski equality (Jarzynski's Work Relation)</strong> and the <strong>Crooks fluctuation theorem (Crooks' Fluctuation Theorem)</strong>. These theorems are not only among the most important advances in nonequilibrium statistical physics in recent decades, but also form the theoretical foundation of <strong>stochastic thermodynamics</strong>, a burgeoning field of study.</p>
<h1 id="1-review-fluctuation-dissipation-theorem-fdt">1. Review: Fluctuation-Dissipation Theorem (FDT)<a class="headerlink" href="#1-review-fluctuation-dissipation-theorem-fdt" title="Permanent link">&para;</a></h1>
<p>To better understand the upcoming nonequilibrium fluctuation theorems, it is necessary to first review the core field-theory tool for describing <strong>near-equilibrium system</strong> dynamics—the <strong>Janssen-De Dominicis (J-D) action</strong>—and how it systematically derives the fluctuation-dissipation theorem.</p>
<p>Within the framework of statistical field theory, the statistical weight of all possible trajectories of a stochastic process can be described by an action functional. The J-D action is precisely such an action constructed for stochastic dynamical systems with additive Gaussian noise:</p>
<div class="arithmatex">\[
S[\phi, \tilde{\phi}] = \int_{x,t} \Big[ \tilde{\phi}_\alpha (\dot{\phi}_\alpha - A_\alpha[\phi]) - \tfrac{1}{2} \tilde{\phi}_\alpha N_{\alpha\beta} \tilde{\phi}_\beta \Big].
\]</div>
<p>Here <span class="arithmatex">\(\phi(\vec{x},t)\)</span> is the physical field describing the system state (e.g., particle concentration field), while <span class="arithmatex">\(\tilde{\phi}(\vec{x},t)\)</span> is an auxiliary <strong>response field</strong>. This action elegantly encodes all the dynamical information of the system:</p>
<ul>
<li>
<p><strong>Dynamical constraint term</strong> <span class="arithmatex">\(\tilde{\phi}_\alpha (\dot{\phi}_\alpha - A_\alpha[\phi])\)</span>: This term arises from the strict enforcement of the Langevin equation. In the path integral, the response field <span class="arithmatex">\(\tilde{\phi}\)</span> acts as a Lagrange multiplier, which through summation over all paths, enforces that only trajectories satisfying the deterministic equation of motion (<span class="arithmatex">\(\dot{\phi}_\alpha = A_\alpha[\phi]\)</span>) contribute significantly.</p>
</li>
<li>
<p><strong>Noise contribution term</strong> <span class="arithmatex">\(-\frac{1}{2} \tilde{\phi}_\alpha N_{\alpha\beta} \tilde{\phi}_\beta\)</span>: This term arises from averaging over Gaussian white noise. <span class="arithmatex">\(N_{\alpha\beta}\)</span> is the core of the noise correlation matrix <span class="arithmatex">\(\langle \xi_\alpha(x,t)\xi_\beta(x',t') \rangle = N_{\alpha\beta}\delta(x-x')\delta(t-t')\)</span>, and this quadratic form permanently "imprints" the noise statistics into the effective action.</p>
</li>
</ul>
<p>By performing path integration over this action functional, any observable can be calculated. Among them, two core physical quantities are the response function and correlation function.</p>
<ol>
<li><strong>Response function</strong> <span class="arithmatex">\(\chi_{\alpha\beta}(x,t;x',t')\)</span>: It describes how the field component <span class="arithmatex">\(\langle \phi_\alpha \rangle\)</span> at <span class="arithmatex">\((x,t)\)</span> responds to a small external perturbation field <span class="arithmatex">\(h_\beta\)</span> applied at another spacetime point <span class="arithmatex">\((x',t')\)</span>. In the J-D formalism, it is precisely expressed as the correlation function between the physical field and response field:</li>
</ol>
<div class="arithmatex">\[
\chi_{\alpha\beta}(x,t;x',t') = \left.\frac{\delta \langle \phi_\alpha(x,t) \rangle}{\delta h_\beta(x',t')} \right|_{h \to 0} = L \langle \phi_\alpha(x,t) \tilde{\phi}_\beta(x',t') \rangle
\]</div>
<ol>
<li><strong>Correlation function</strong> <span class="arithmatex">\(C_{\alpha\beta}(x,t;x',t')\)</span>: It describes the statistical correlation between <strong>spontaneous fluctuations</strong> at different spacetime points in the absence of any external perturbation:
$$
C_{\alpha\beta}(x,t;x',t') = \langle \phi_\alpha(x,t) \phi_\beta(x',t') \rangle
$$</li>
</ol>
<p>The key to deriving FDT lies in utilizing the <strong>time-reversal symmetry</strong> satisfied by the system in <strong>thermal equilibrium</strong>. As demonstrated in Lectures 31 and 32, this fundamental symmetry imposes strong constraints on the J-D action, ultimately requiring that the noise intensity <span class="arithmatex">\(N\)</span> and dissipation coefficient <span class="arithmatex">\(L\)</span> must satisfy the <strong>Einstein-Onsager relation</strong> (<span class="arithmatex">\(N=2LT\)</span>). This built-in symmetry ultimately leads to an exact relationship between the response function and correlation function:</p>
<div class="arithmatex">\[\chi(\tau) = -\frac{1}{k_B T} \Theta(\tau) \frac{dC}{d\tau}(\tau)\]</div>
<p>where <span class="arithmatex">\(\tau = t-t'\)</span>, <span class="arithmatex">\(\Theta(\tau)\)</span> is the Heaviside step function, embodying <strong>causality</strong> (response cannot occur before perturbation). This relationship is the <strong>fluctuation-dissipation theorem</strong>. It profoundly reveals that: a system's ability to <strong>dissipate</strong> energy in response to external perturbations (embodied by <span class="arithmatex">\(\chi\)</span>) and its internal spontaneous, thermally driven <strong>fluctuations</strong> (embodied by <span class="arithmatex">\(C\)</span>) are two aspects of the same microscopic physical essence.</p>
<p>This derivation process not only provides a rigorous field-theoretic proof of FDT, but more importantly, it demonstrates the central role of <strong>time-reversal symmetry</strong> in connecting system "response" and "fluctuations". It is precisely this idea that will be extended to far-from-equilibrium systems, becoming the cornerstone for deriving nonequilibrium fluctuation theorems.</p>
<h1 id="2-nonequilibrium-driving-and-external-protocols">2. Nonequilibrium Driving and External Protocols<a class="headerlink" href="#2-nonequilibrium-driving-and-external-protocols" title="Permanent link">&para;</a></h1>
<p>The fluctuation-dissipation relationship (FDT) reviewed in the previous section describes the <strong>passive response</strong> of a system to small perturbations. Now, we turn our attention from this near-equilibrium linear behavior to a system that is <strong>actively and arbitrarily driven away from equilibrium</strong>. The core transformation here is that the external parameters are no longer small probes, but rather a time-dependent, significantly changing, predetermined control program.</p>
<h2 id="21-system-description-free-energy-functional">2.1 System Description: Free-Energy Functional<a class="headerlink" href="#21-system-description-free-energy-functional" title="Permanent link">&para;</a></h2>
<p>Consider a system described by field variables <span class="arithmatex">\(\vec{\phi}\)</span>, whose equilibrium properties under a given external field <span class="arithmatex">\(\vec{h}\)</span> are given by a <strong>free energy functional <span class="arithmatex">\(F[\vec{\phi}]\)</span></strong>. Its form is consistent with the Ginzburg-Landau theory discussed in Lecture 25:</p>
<div class="arithmatex">\[F[\vec{\phi}] = \int d^dx \left( f(\vec{\phi}) + \frac{c}{2} (\vec{\nabla} \vec{\phi})^2 - \vec{h} \cdot \vec{\phi} \right)\]</div>
<p>Each term in this functional has a clear physical meaning:</p>
<p><strong>Local free energy density</strong> <span class="arithmatex">\(f(\vec{\phi})\)</span>: Contains local entropy contributions and mean-field interactions between particles, determining the system's basic phase behavior.</p>
<p><strong>Gradient energy term</strong> <span class="arithmatex">\(\frac{c}{2} (\vec{\nabla} \vec{\phi})^2\)</span>: Imposes an energy penalty on spatial inhomogeneity, serving as the microscopic source of interface tension.</p>
<p><strong>Coupling term</strong> <span class="arithmatex">\(-\vec{h} \cdot \vec{\phi}\)</span>: This is the "handle" for interaction between the external world and the system. It is precisely through changing the external field <span class="arithmatex">\(\vec{h}\)</span> that one can influence the system and do work.</p>
<h2 id="22-protocol-setup">2.2 Protocol Setup<a class="headerlink" href="#22-protocol-setup" title="Permanent link">&para;</a></h2>
<p>A typical nonequilibrium driving experiment or simulation is set up as follows:</p>
<ol>
<li><strong>Initial state</strong>: At time <span class="arithmatex">\(t=0\)</span>, the system is in complete thermal equilibrium with an initial external field <span class="arithmatex">\(\vec{h}(0)\)</span>. This means that the probability distribution of the initial system configuration <span class="arithmatex">\(\vec{\phi}_0\)</span> is given by the Boltzmann factor:</li>
</ol>
<p><span class="arithmatex">\(<span class="arithmatex">\(P_0[\vec{\phi}_0] = \frac{1}{Z_0(T)} \exp \left[ -\beta F_0[\vec{\phi}_0] \right]\)</span>\)</span>
   where <span class="arithmatex">\(\beta = 1/T\)</span> (setting Boltzmann constant <span class="arithmatex">\(k_B=1\)</span>), <span class="arithmatex">\(F_0\)</span> is the free energy functional corresponding to the initial external field <span class="arithmatex">\(\vec{h}(0)\)</span>, and <span class="arithmatex">\(Z_0(T)\)</span> is the corresponding partition function. Starting from a precisely defined equilibrium state is the logical starting point for all fluctuation theorems.</p>
<ol>
<li><strong>Driving process</strong>: During the time interval from <span class="arithmatex">\(t=0\)</span> to <span class="arithmatex">\(t=t_f\)</span>, the external field <span class="arithmatex">\(\vec{h}(t)\)</span> evolves according to a predetermined, deterministic time function. This function <span class="arithmatex">\(\vec{h}(t)\)</span> is called the <strong>external protocol</strong>. As shown in the figure below, the protocol drives the system from an initial equilibrium state, through a series of nonequilibrium states, to a final state that is typically also nonequilibrium.</li>
</ol>
<p><img alt="Protocol Schematic (Blackboard Screenshot)" src="../../../assets/images/remote/d7894a2b-a42e-478b-8c51-2a1a648efeb5-9d8504a6cd.png" /></p>
<h2 id="23-origin-of-irreversibility-finite-time-and-relaxation">2.3 Origin of Irreversibility: Finite Time and Relaxation<a class="headerlink" href="#23-origin-of-irreversibility-finite-time-and-relaxation" title="Permanent link">&para;</a></h2>
<p>The irreversibility of this process has its root in the fact that the protocol is completed in <strong>finite time</strong> <span class="arithmatex">\(t_f\)</span>. There are two fundamentally different limits:</p>
<ul>
<li>
<p><strong>Quasistatic limit (<span class="arithmatex">\(t_f \to \infty\)</span>)</strong>: If the protocol changes infinitely slowly, the system has sufficient time at each instant to adapt to small changes in the external field through internal relaxation. Therefore, the system always remains in the equilibrium state corresponding to the instantaneous external field <span class="arithmatex">\(\vec{h}(t)\)</span>. Such a process is <strong>reversible</strong>, and the work done by the external world exactly equals the free energy difference <span class="arithmatex">\(\Delta F\)</span> between the initial and final equilibrium states. This is the ideal realm of classical thermodynamics.</p>
</li>
<li>
<p><strong>Finite-time process (<span class="arithmatex">\(t_f &lt; \infty\)</span>)</strong>: For any finite driving time, the system's internal relaxation (determined by dynamical coefficients <span class="arithmatex">\(L\)</span>, etc.) requires time. Therefore, the evolution of the system state will always <strong>lag</strong> behind changes in the external field. The system's probability distribution <span class="arithmatex">\(P(\vec{\phi},t)\)</span> will no longer be the equilibrium distribution corresponding to the instantaneous external field <span class="arithmatex">\(\vec{h}(t)\)</span>. It is precisely this lag that leads to energy <strong>dissipation</strong>, usually dissipated as heat to the environment.</p>
</li>
</ul>
<p>Therefore, the average work done by external forces will be strictly greater than the free energy change, i.e., <span class="arithmatex">\(\langle W \rangle &gt; \Delta F\)</span>. This difference, <span class="arithmatex">\(\langle W_{diss} \rangle = \langle W \rangle - \Delta F\)</span>, is the average <strong>dissipated work</strong>, which quantifies the degree of irreversibility of the process.</p>
<p>The essence of fluctuation theorems lies in the fact that they not only focus on this average behavior, but precisely characterize the <strong>complete probability distribution of work <span class="arithmatex">\(P(W)\)</span></strong> generated by countless random trajectories. The next task is to give a precise definition for the random nonequilibrium work done on a single trajectory.</p>
<h1 id="3-nonequilibrium-work-definition-and-path-integral-computation">3. Nonequilibrium Work: Definition and Path-Integral Computation<a class="headerlink" href="#3-nonequilibrium-work-definition-and-path-integral-computation" title="Permanent link">&para;</a></h1>
<h2 id="31-definition-of-jarzynski-work">3.1 Definition of Jarzynski Work<a class="headerlink" href="#31-definition-of-jarzynski-work" title="Permanent link">&para;</a></h2>
<p>To establish fluctuation theorems, we must first give a precise physical definition for "work" in stochastic, nonequilibrium processes. Unlike macroscopic thermodynamics where work is a deterministic value, in stochastic thermodynamics, work is defined on a <strong>single random trajectory</strong> as a <strong>random variable</strong> that depends on the path.</p>
<p>This definition originates from the fundamental ideas of classical mechanics and thermodynamics: the work done on a system equals the change in the system's energy due to changes in external control parameters. For a system driven by an external field <span class="arithmatex">\(\vec{h}(t)\)</span>, its free energy functional <span class="arithmatex">\(F[\vec{\phi}]\)</span> will change explicitly with time. In a small time interval <span class="arithmatex">\(dt\)</span>, the infinitesimal work <span class="arithmatex">\(dW_J\)</span> done by the external agent on the system is the change in <span class="arithmatex">\(F[\vec{\phi}]\)</span> due to the change in the external parameter <span class="arithmatex">\(\vec{h}\)</span>. This is analogous to <span class="arithmatex">\(dW = (\partial E / \partial \lambda) d\lambda\)</span> in classical thermodynamics. In the language of field theory, this manifests as:</p>
<div class="arithmatex">\[dW_J = \left( \frac{\partial F[\vec{\phi}(t)]}{\partial t} \right)_{\vec{\phi} \text{ fixed}} dt\]</div>
<p>Here the partial derivative <span class="arithmatex">\(\partial/\partial t\)</span> acts only on the external field <span class="arithmatex">\(\vec{h}(t)\)</span> that explicitly depends on time in the free energy functional, while keeping the instantaneous field configuration <span class="arithmatex">\(\vec{\phi}(t)\)</span> fixed. Using the form of the free energy functional given in Section 2, <span class="arithmatex">\(F \propto -\int d^dx (\vec{h} \cdot \vec{\phi})\)</span>, we obtain <span class="arithmatex">\(\delta F / \delta \vec{h} = -\vec{\phi}\)</span>. Therefore, the total work done on the system during the entire protocol (from <span class="arithmatex">\(t=0\)</span> to <span class="arithmatex">\(t=t_f\)</span>), i.e., the <strong>Jarzynski work</strong> <span class="arithmatex">\(W_J[\vec{\phi}]\)</span>, is the result of integrating the infinitesimal work along a specific trajectory <span class="arithmatex">\(\vec{\phi}(t)\)</span>:</p>
<div class="arithmatex">\[W_J[\vec{\phi}] := \int_0^{t_f} dt \, \frac{\partial F[\vec{\phi}]}{\partial t} = -\int_0^{t_f} dt \int d^dx \, \vec{\phi}(\vec{x},t) \cdot \frac{\partial \vec{h}(\vec{x},t)}{\partial t}\]</div>
<p>This definition profoundly reveals the physical essence of nonequilibrium work:</p>
<ul>
<li>
<p><strong>Work is random</strong>: <span class="arithmatex">\(W_J\)</span> is a <strong>functional</strong> whose value depends on the specific microscopic path <span class="arithmatex">\(\vec{\phi}(\vec{x},t)\)</span> that the system experiences. Since the system's evolution is influenced by thermal noise and is random, different trajectories will produce different work values. Therefore, work itself is a random variable with a probability distribution <span class="arithmatex">\(P(W_J)\)</span>.</p>
</li>
<li>
<p><strong>Source of work</strong>: Work is the direct result of the coupling between the system's state field <span class="arithmatex">\(\vec{\phi}(t)\)</span> and the <strong>rate of change of the external protocol</strong> <span class="arithmatex">\(\partial \vec{h} / \partial t\)</span>. If the protocol does not change with time (<span class="arithmatex">\(\partial \vec{h}/\partial t = 0\)</span>), then no work is done on the system by the external world.</p>
</li>
</ul>
<h2 id="32-ensemble-average-in-the-path-integral">3.2 Ensemble Average in the Path Integral<a class="headerlink" href="#32-ensemble-average-in-the-path-integral" title="Permanent link">&para;</a></h2>
<p>To calculate the ensemble average of any observable <span class="arithmatex">\(O[\vec{\phi}]\)</span> (such as work itself <span class="arithmatex">\(W_J\)</span> or its exponential function <span class="arithmatex">\(e^{-\beta W_J}\)</span>), we need to average over the entire path ensemble of the nonequilibrium driving experiment defined in Section 2. This averaging process can be systematically decomposed into three levels of integration in the path integral formalism:</p>
<div class="arithmatex">\[\langle O[\vec{\phi}] \rangle = \int \mathcal{D}[\vec{\phi}_0] \underbrace{P_0[\vec{\phi}_0]}_{\text{initial state weight}} \int \mathcal{D}[\vec{\phi}_f] \int_{\vec{\phi}(0)=\vec{\phi}_0}^{\vec{\phi}(t_f)=\vec{\phi}_f} \underbrace{\mathcal{D}[\vec{\phi}, \tilde{\phi}] \exp(-S[\tilde{\phi}, \vec{\phi}])}_{\text{path weight}} O[\vec{\phi}]\]</div>
<p>Note: To maintain consistency with the lecture board, the response field integration measure here is <span class="arithmatex">\(\mathcal{D}[\tilde{\phi}]\)</span>, corresponding to the real action after Wick rotation.</p>
<p>This seemingly complex expression is actually a precise, step-by-step mathematical simulation of the nonequilibrium process:</p>
<ol>
<li>
<p><strong>Initial state averaging</strong>: The integral <span class="arithmatex">\(\int \mathcal{D}[\vec{\phi}_0] P_0[\vec{\phi}_0] \dots\)</span> corresponds to the first step of the experiment: randomly "sampling" an initial configuration <span class="arithmatex">\(\vec{\phi}_0\)</span> from the initial equilibrium ensemble according to the Boltzmann probability <span class="arithmatex">\(P_0[\vec{\phi}_0] = \frac{1}{Z_0} e^{-\beta F_0[\vec{\phi}_0]}\)</span>.</p>
</li>
<li>
<p><strong>Path averaging</strong>: For each given initial configuration <span class="arithmatex">\(\vec{\phi}_0\)</span> and final configuration <span class="arithmatex">\(\vec{\phi}_f\)</span>, the inner integral <span class="arithmatex">\(\int \mathcal{D}[\vec{\phi}, \tilde{\phi}] \exp(-S) \dots\)</span> sums over all possible historical paths connecting these two points that follow stochastic dynamics. The statistical weight of each path is given by the <strong>J-D action</strong> <span class="arithmatex">\(e^{-S[\tilde{\phi}, \vec{\phi}]}\)</span>, which has completely encoded the dynamical constraints of the Langevin equation and noise statistics.</p>
</li>
<li>
<p><strong>Summing over final states</strong>: The outermost integral <span class="arithmatex">\(\int \mathcal{D}[\vec{\phi}_f] \dots\)</span> sums over all possible final configurations, because in nonequilibrium processes, even starting from the same initial state, different random trajectories will reach different final states.</p>
</li>
</ol>
<p>This expression is the solid mathematical foundation for deriving all fluctuation theorems. It precisely decomposes the macroscopic statistical average of a nonequilibrium process into sampling from the initial equilibrium state and summing over stochastic dynamical paths. The next task is to reveal the universal laws hidden within by performing a series of clever symmetry transformations on this path integral expression.</p>
<h1 id="4-path-integral-derivation-of-fluctuation-theorems">4. Path-Integral Derivation of Fluctuation Theorems<a class="headerlink" href="#4-path-integral-derivation-of-fluctuation-theorems" title="Permanent link">&para;</a></h1>
<h2 id="step-1-response-field-change-of-variables-isolating-thermodynamic-terms">Step 1: Response-Field Change of Variables - Isolating Thermodynamic Terms<a class="headerlink" href="#step-1-response-field-change-of-variables-isolating-thermodynamic-terms" title="Permanent link">&para;</a></h2>
<p>This section is the mathematical core of the lecture, which will demonstrate in detail how to derive the core relationship connecting nonequilibrium work and equilibrium free energy through a series of ingenious transformations of the J-D path integral action. The cornerstone of the entire derivation process is the intrinsic symmetry of the action under <strong>time reversal</strong>, which is precisely the profound manifestation of microscopic reversibility at the path level.</p>
<p>To clearly demonstrate the derivation, consider a system dominated by gradient descent (such as Model A), with drift term <span class="arithmatex">\(A_\alpha = -L (\delta F / \delta \phi_\alpha)\)</span>. According to Lecture 32, its J-D action is:</p>
<div class="arithmatex">\[S[\tilde{\vec{\phi}}, \vec{\phi}] = \int_{\vec{x}, t} \left[ \tilde{\phi}_{\alpha} \left(\partial_t \phi_{\alpha} + L\frac{\delta F}{\delta \phi_{\alpha}} \right) - \frac{1}{2} \tilde{\phi}_{\alpha} N_{\alpha\beta} \tilde{\phi}_{\beta} \right]\]</div>
<p>According to the requirements of the fluctuation-dissipation theorem, in equilibrium the noise intensity and dissipation coefficient satisfy the <strong>Einstein-Onsager relation</strong> <span class="arithmatex">\(N_{\alpha\beta} = 2LT \delta_{\alpha\beta}\)</span>.</p>
<p><strong>Physical motivation</strong>: The first step is a purely mathematical technique, but its physical motivation is very clear: <strong>reorganize the action to explicitly separate quantities directly related to thermodynamics (free energy, work) from complex dynamical terms</strong>. This transformation is designed precisely to allow the final result to be presented in a clear thermodynamic form.</p>
<p>Define new response field variables <span class="arithmatex">\(\bar{\phi}_\alpha\)</span>:</p>
<div class="arithmatex">\[\bar{\phi}_\alpha(t) \equiv -\tilde{\phi}_\alpha(t) + \frac{1}{T} \frac{\delta F}{\delta \phi_\alpha(t)}\]</div>
<p>The Jacobian determinant of this transformation is 1, so the path integral measure remains unchanged. Substituting <span class="arithmatex">\(\tilde{\phi}_\alpha(t) = -\bar{\phi}_\alpha(t) + \frac{1}{T} \frac{\delta F}{\delta \phi_\alpha(t)}\)</span> into the action <span class="arithmatex">\(S\)</span> and using <span class="arithmatex">\(N=2LT\)</span>, after some algebraic manipulation, the action can be precisely decomposed as:</p>
<div class="arithmatex">\[S[\tilde{\vec{\phi}}, \vec{\phi}] = \int_{\vec{x}, t} \left[ \bar{\phi}_{\alpha} \left( -\partial_t \phi_{\alpha} + L\frac{\delta F}{\delta \phi_{\alpha}} - LT\bar{\phi}_{\alpha} \right) + \frac{1}{T}\frac{\delta F}{\delta \phi_{\alpha}} \partial_t \phi_{\alpha} \right]\]</div>
<p>The last term <span class="arithmatex">\(\frac{1}{T}\frac{\delta F}{\delta \phi_{\alpha}} \partial_t \phi_{\alpha}\)</span> in this form is the key to separating thermodynamic quantities. Using the chain rule for functionals, the total derivative of the free energy <span class="arithmatex">\(F[\vec{\phi}(t)]\)</span> along a trajectory with respect to time is:</p>
<div class="arithmatex">\[\frac{dF[\vec{\phi}(t)]}{dt} = \int d^dx \frac{\delta F}{\delta \phi_\alpha}\frac{\partial \phi_\alpha}{\partial t} + \frac{\partial F}{\partial t}\]</div>
<p>Here:</p>
<ul>
<li><span class="arithmatex">\(\frac{dF}{dt}\)</span> is the total rate of change of free energy along the specific trajectory <span class="arithmatex">\(\vec{\phi}(t)\)</span>.</li>
<li>The first term <span class="arithmatex">\(\int d^dx \dots\)</span> is the free energy change due to the evolution of the system's <strong>internal configuration</strong> <span class="arithmatex">\(\vec{\phi}\)</span> itself.</li>
<li>The second term <span class="arithmatex">\(\frac{\partial F}{\partial t}\)</span> is the explicit time dependence of free energy due to the <strong>external protocol</strong> <span class="arithmatex">\(\vec{h}(t)\)</span> changing the energy landscape itself. According to the definition in Section 3, the integral of this term is precisely the <strong>Jarzynski work</strong> <span class="arithmatex">\(W_J[\vec{\phi}]\)</span>.</li>
</ul>
<p>Therefore, the integral of the last term can be precisely written as:</p>
<div class="arithmatex">\[\frac{1}{T} \int_0^{t_f} dt \int d^dx \frac{\delta F}{\delta \phi_\alpha} \partial_t \phi_\alpha =\beta \int_0^{t_f} dt \left( \frac{dF[\vec{\phi}]}{dt} - \frac{\partial F[\vec{\phi}]}{\partial t} \right) = \beta \left( (F_f[\vec{\phi}_f] - F_0[\vec{\phi}_0]) - W_J[\vec{\phi}] \right)\]</div>
<p><strong>Physical meaning</strong>: The profound result of this algebraic transformation is that it converts the original path weight factor <span class="arithmatex">\(e^{-S}\)</span> into a new form containing the core thermodynamic part <span class="arithmatex">\(e^{-\beta (F_f - F_0 - W_J)}\)</span>. We have successfully "pre-extracted" the physical quantities needed in the final result at the action level.</p>
<h2 id="step-2-time-reversal-transformation-employ-core-symmetry">Step 2: Time-Reversal Transformation - Employ Core Symmetry<a class="headerlink" href="#step-2-time-reversal-transformation-employ-core-symmetry" title="Permanent link">&para;</a></h2>
<p><strong>Physical motivation</strong>: The second step is the physical core of the entire derivation. By performing time reversal operations on the path integral variables, we employ the fundamental symmetry of <strong>microscopic reversibility</strong>. The idea is to compare the probabilities of "forward-playing movies" and "rewind-playing movies".</p>
<p>Define the time-reversed path variables as:</p>
<div class="arithmatex">\[(\vec{\phi}^R(t), \bar{\vec{\phi}}^R(t)) \equiv (\vec{\phi}(t_f - t), \bar{\vec{\phi}}(t_f - t))\]</div>
<p>Simultaneously, the external protocol also undergoes corresponding time reversal, i.e., the <strong>reversed protocol</strong>: <span class="arithmatex">\(\vec{h}^R(t) = \vec{h}(t_f - t)\)</span>. Now examine the behavior of key terms in the action under this transformation:</p>
<ul>
<li>
<p><strong>Time derivative term</strong>: As shown in the lecture board, the term <span class="arithmatex">\(\int dt \, \bar{\phi}_{\alpha} \partial_t \phi_{\alpha}\)</span> changes sign under time reversal. It represents the part of the action directly related to the direction of time evolution.</p>
</li>
<li>
<p><strong>Work term</strong>: We need to calculate the work done along the <strong>reversed path</strong> <span class="arithmatex">\(\vec{\phi}^R(t)\)</span> under the <strong>reversed protocol</strong> <span class="arithmatex">\(\vec{h}^R(t)\)</span>, denoted as <span class="arithmatex">\(W_J^R\)</span>. Through variable substitution <span class="arithmatex">\(\tau = t_f - t\)</span>, it can be strictly proven that:</p>
<div class="arithmatex">\[W_J^R[\vec{\phi}^R] = -\int_0^{t_f} dt \int d^dx \, \vec{\phi}^R(\vec{x},t) \cdot \frac{\partial \vec{h}^R(\vec{x},t)}{\partial t} = - W_J[\vec{\phi}]\]</div>
<p><strong>Physical meaning</strong>: The physical connotation of this result is that the work done along the reversed path under the reversed protocol is exactly the opposite of the work done along the forward path under the forward protocol.</p>
</li>
</ul>
<p>After these transformations, the original action <span class="arithmatex">\(S\)</span> becomes a new action <span class="arithmatex">\(S^R\)</span>, which has a similar form to the original action but describes the dynamics under the reversed protocol.</p>
<h2 id="step-3-assemble-results-derive-universal-relation">Step 3: Assemble Results - Derive Universal Relation<a class="headerlink" href="#step-3-assemble-results-derive-universal-relation" title="Permanent link">&para;</a></h2>
<p><strong>Logical integration</strong>: Now, integrate the transformation results from the previous two steps into the path integral expression for the observable <span class="arithmatex">\(\langle O[\vec{\phi}] \rangle\)</span>. Through variable substitution and using the invariance of the path integral measure (Jacobian determinant is 1), we can prove a profound duality relationship:</p>
<div class="arithmatex">\[\langle O[\vec{\phi}] \rangle = \frac{Z_f(T)}{Z_0(T)} \langle \hat{O}[\vec{\phi}] e^{-\beta W_J^R[\vec{\phi}]} \rangle_R\]</div>
<p>where:</p>
<ul>
<li><span class="arithmatex">\(\langle \dots \rangle_R\)</span> denotes ensemble averaging under the <strong>reversed protocol</strong> starting from the equilibrium ensemble corresponding to the final state <span class="arithmatex">\(F_f\)</span>.</li>
<li><span class="arithmatex">\(\hat{O}[\vec{\phi}]\)</span> is the observable calculated on the time-reversed path.</li>
<li><span class="arithmatex">\(Z_f\)</span> and <span class="arithmatex">\(Z_0\)</span> are the equilibrium partition functions corresponding to the final external field <span class="arithmatex">\(\vec{h}(t_f)\)</span> and initial external field <span class="arithmatex">\(\vec{h}(0)\)</span>, respectively.</li>
</ul>
<p>Finally, using the definition of free energy <span class="arithmatex">\(\Delta F = F_f - F_0 = -T \ln(Z_f / Z_0)\)</span> and the relationship <span class="arithmatex">\(W_J^R = -W_J[\vec{\phi}]\)</span> derived in Step 2, we obtain a universal fluctuation relationship:</p>
<div class="arithmatex">\[\langle O[\vec{\phi}] \rangle = e^{-\beta \Delta F} \langle \hat{O}[\vec{\phi}] e^{\beta W_J[\vec{\phi}]} \rangle_R\]</div>
<p><strong>Physical meaning</strong>:
This result is astonishing. It shows that the average of a physical quantity measured under the <strong>forward protocol</strong> (LHS) can be precisely transformed into an average under the <strong>reversed protocol</strong> of the time-reversed observable weighted by an exponential work factor <span class="arithmatex">\(e^{\beta W_J}\)</span> (RHS).</p>
<p>This duality relationship is a direct manifestation of microscopic reversibility in nonequilibrium processes. The macroscopic irreversibility observed (such as <span class="arithmatex">\(\langle W \rangle &gt; \Delta F\)</span>) does not arise from the physical laws themselves not satisfying time symmetry, but from the <strong>asymmetric boundary conditions</strong> of the process: starting from a specific equilibrium state and letting time evolve forward. Fluctuation theorems are precisely the exact quantification of the statistical consequences produced by this asymmetry in boundary conditions.</p>
<h2 id="step-3-assemble-results-a-universal-relation">Step 3: Assemble Results - A Universal Relation<a class="headerlink" href="#step-3-assemble-results-a-universal-relation" title="Permanent link">&para;</a></h2>
<p>Using path-integral measure invariance and the above transformations, one finds the duality
$$
\langle O[\phi] \rangle = \frac{Z_f(T)}{Z_0(T)}\, \Big\langle \hat{O}[\phi]\, e^{-\beta W_J^R[\phi]} \Big\rangle_R,
$$
where <span class="arithmatex">\(\langle \cdots \rangle_R\)</span> denotes averaging under the reversed protocol starting from the equilibrium ensemble at the final control parameter, <span class="arithmatex">\(\hat{O}\)</span> denotes the time-reversed observable, and <span class="arithmatex">\(Z_0, Z_f\)</span> are partition functions for <span class="arithmatex">\(h(0)\)</span> and <span class="arithmatex">\(h(t_f)\)</span>. Using <span class="arithmatex">\(\Delta F = F_f - F_0 = -T \ln(Z_f/Z_0)\)</span> and <span class="arithmatex">\(W_J^R = -W_J\)</span>, this becomes
$$
\langle O[\phi] \rangle = e^{-\beta \Delta F}\, \Big\langle \hat{O}[\phi]\, e^{\beta W_J[\phi]} \Big\rangle_R.
$$</p>
<p>Physically: an average under the forward protocol equals a reversed-protocol average of the time-reversed observable weighted by <span class="arithmatex">\(e^{\beta W_J}\)</span>, up to <span class="arithmatex">\(e^{-\beta \Delta F}\)</span>. This duality reflects microscopic reversibility; apparent macroscopic irreversibility arises from asymmetric boundary conditions (preparing in a specific equilibrium state and letting time move forward).</p>
<h1 id="5-jarzynski-work-relation">5. Jarzynski Work Relation<a class="headerlink" href="#5-jarzynski-work-relation" title="Permanent link">&para;</a></h1>
<p>The universal fluctuation relationship derived in the previous section is a universal bridge connecting forward and reverse nonequilibrium processes. Now, through an extremely concise and ingenious choice, we will extract the first milestone achievement from this bridge—the <strong>Jarzynski equality (Jarzynski's Work Relation)</strong>.</p>
<p>The <strong>Jarzynski equality</strong> was proposed by physicist Christopher Jarzynski in <strong>1997</strong>. Its profound <strong>physical essence</strong> lies in establishing a precise bridge between nonequilibrium statistical physics and equilibrium thermodynamics. The equality states that in any nonequilibrium process that drives a system from one equilibrium state to another, the ensemble average of the exponential of the work done <span class="arithmatex">\(W\)</span> is exactly equal to the Boltzmann factor corresponding to the free energy difference <span class="arithmatex">\(\Delta F\)</span> between the initial and final equilibrium states, i.e., <span class="arithmatex">\(\langle e^{-\beta W} \rangle = e^{-\beta \Delta F}\)</span>. This theorem is a remarkable strengthening of the traditional second law inequality (<span class="arithmatex">\(\langle W \rangle \ge \Delta F\)</span>), because it precisely connects a nonequilibrium average that depends on specific dynamical paths with a pure thermodynamic quantity that depends only on equilibrium states.</p>
<p>In <strong>specific applications</strong>, this equality has revolutionary significance, allowing scientists to precisely calculate equilibrium free energy differences through fast, irreversible computer simulations or single-molecule experiments (such as stretching RNA hairpins or proteins with optical tweezers), which is particularly important in biophysics and materials science where traditional quasistatic methods are difficult to implement.</p>
<h2 id="51-from-the-universal-relation-to-an-exact-equality">5.1 From the Universal Relation to an Exact Equality<a class="headerlink" href="#51-from-the-universal-relation-to-an-exact-equality" title="Permanent link">&para;</a></h2>
<p>Recall the final result from the previous section, the universal duality relationship:
<span class="arithmatex">\(<span class="arithmatex">\(\langle O[\vec{\phi}] \rangle = e^{-\beta \Delta F} \langle \hat{O}[\vec{\phi}] e^{\beta W_J[\vec{\phi}]} \rangle_R\)</span>\)</span>
This relationship holds for any observable <span class="arithmatex">\(O[\vec{\phi}]\)</span>. To obtain the most concise relationship, we can choose the simplest observable, namely the <strong>identity operator <span class="arithmatex">\(O[\vec{\phi}] = 1\)</span></strong>.</p>
<p>Substituting this choice into the universal relationship:</p>
<ul>
<li>
<p>On the left-hand side, due to probability normalization, the average of any quantity <span class="arithmatex">\(\langle 1 \rangle\)</span> equals 1.</p>
</li>
<li>
<p>On the right-hand side, time reversal operation does not change a constant, so <span class="arithmatex">\(\hat{1} = 1\)</span>.</p>
</li>
</ul>
<p>Thus, the universal relationship immediately simplifies to:</p>
<div class="arithmatex">\[1 = e^{-\beta \Delta F} \langle e^{\beta W_J[\vec{\phi}]} \rangle_R\]</div>
<p>The left side of this expression is the average of the <strong>forward process</strong> (implicit), while the right side is the ensemble average under the <strong>reversed protocol</strong> <span class="arithmatex">\(\langle \dots \rangle_R\)</span>. However, the standard form of the Jarzynski equality is about the forward process. To obtain it, we use an equivalent derivation: in the universal relationship, we choose a different observable <span class="arithmatex">\(O'[\phi] = O[\phi] e^{-\beta W_J[\phi]}\)</span>. After algebraic manipulation, we can obtain another equivalent universal relationship: <span class="arithmatex">\(\langle O[\phi] e^{-\beta W_J[\phi]} \rangle = e^{-\beta \Delta F} \langle \hat{O}[\phi] \rangle_R\)</span>.</p>
<p>Now, choosing <span class="arithmatex">\(O[\vec{\phi}] = 1\)</span> again in this new relationship:</p>
<div class="arithmatex">\[\langle 1 \cdot e^{-\beta W_J[\vec{\phi}]} \rangle = e^{-\beta \Delta F} \langle \hat{1} \rangle_R\]</div>
<p>Since <span class="arithmatex">\(\langle \hat{1} \rangle_R = 1\)</span>, we directly obtain the final <strong>Jarzynski equality</strong>:</p>
<div class="arithmatex">\[\langle e^{-\beta W_J[\vec{\phi}]} \rangle = e^{-\beta \Delta F}\]</div>
<p>Physical meaning: the nonequilibrium exponential average of work equals the equilibrium Boltzmann factor of the free-energy difference. This remarkable exact equality links a path-dependent nonequilibrium average to a purely equilibrium thermodynamic quantity. Practically, it enables computing <span class="arithmatex">\(\Delta F\)</span> from fast, highly irreversible simulations or single-molecule experiments by accumulating an exponential average that emphasizes rare, low-work trajectories.</p>
<h2 id="52-refining-the-second-law">5.2 Refining the Second Law<a class="headerlink" href="#52-refining-the-second-law" title="Permanent link">&para;</a></h2>
<p>The Jarzynski equality is not only perfectly compatible with the second law of thermodynamics, but is also a profound <strong>refinement</strong> of the latter. Using <strong>Jensen's inequality</strong> in mathematics, i.e., for any convex function <span class="arithmatex">\(f(x)\)</span> (such as <span class="arithmatex">\(f(x)=e^x\)</span>), we have <span class="arithmatex">\(\langle f(x) \rangle \geq f(\langle x \rangle)\)</span>. Applying this to the Jarzynski equality:</p>
<div class="arithmatex">\[\langle e^{-\beta W_J} \rangle \geq e^{\langle -\beta W_J \rangle} = e^{-\beta \langle W_J \rangle}\]</div>
<p>Combining this inequality with the Jarzynski equality itself:</p>
<div class="arithmatex">\[e^{-\beta \Delta F} = \langle e^{-\beta W_J} \rangle \geq e^{-\beta \langle W_J \rangle}\]</div>
<p>Taking the logarithm of both sides and multiplying by <span class="arithmatex">\(-T\)</span> (which reverses the inequality sign), we recover the familiar statement of the second law of thermodynamics:</p>
<div class="arithmatex">\[\langle W_J \rangle \geq \Delta F\]</div>
<p><strong>Physical meaning</strong>:
This derivation clearly shows that the Jarzynski equality is a <strong>stronger</strong> statement than the second law.</p>
<p><strong>Second law</strong> only constrains the <strong>average</strong> of work. It acknowledges that in a single experiment, the work <span class="arithmatex">\(W_J\)</span> may be less than <span class="arithmatex">\(\Delta F\)</span> (i.e., the so-called instantaneous "violation" of the second law), but remains silent about the probability of such events.</p>
<p><strong>Jarzynski equality</strong> imposes an exact integral constraint on the <strong>entire probability distribution</strong> <span class="arithmatex">\(P(W_J)\)</span> of work. It shows that trajectories with <span class="arithmatex">\(W_J &lt; \Delta F\)</span> do indeed occur, but their statistical weights are exponentially suppressed, while dissipative trajectories with <span class="arithmatex">\(W_J &gt; \Delta F\)</span> contribute more. Ultimately, through the nonlinear weighted average <span class="arithmatex">\(e^{-\beta W_J}\)</span>, all fluctuation contributions are ingeniously combined to exactly equal the thermodynamic factor corresponding to the equilibrium free energy difference.</p>
<h1 id="6-code-practice-i-verification-of-the-jarzynski-equality">6. Code Practice I: Verification of the Jarzynski Equality<a class="headerlink" href="#6-code-practice-i-verification-of-the-jarzynski-equality" title="Permanent link">&para;</a></h1>
<p>Below we will use Python code to simulate a classical nonequilibrium physical process—dragging an overdamped Brownian particle in a harmonic potential well—to numerically verify the Jarzynski equality.</p>
<h2 id="physical-model">Physical Model<a class="headerlink" href="#physical-model" title="Permanent link">&para;</a></h2>
<p>Consider a one-dimensional overdamped Brownian particle whose dynamics is described by the following <strong>Langevin equation</strong>:</p>
<div class="arithmatex">\[\gamma \frac{dx}{dt} = -\frac{\partial V(x,t)}{\partial x} + \eta(t)\]</div>
<p>where:</p>
<ul>
<li>
<p><span class="arithmatex">\(x(t)\)</span> is the particle position.</p>
</li>
<li>
<p><span class="arithmatex">\(\gamma\)</span> is the friction coefficient.</p>
</li>
<li>
<p><span class="arithmatex">\(V(x,t) = \frac{1}{2} k (x - \lambda(t))^2\)</span> is a harmonic potential well whose center position <span class="arithmatex">\(\lambda(t)\)</span> is controlled by an external protocol. <span class="arithmatex">\(k\)</span> is the stiffness coefficient of the potential well.</p>
</li>
<li>
<p><span class="arithmatex">\(\eta(t)\)</span> is Gaussian white noise representing random collisions from the thermal bath, with statistical properties <span class="arithmatex">\(\langle \eta(t) \rangle = 0\)</span> and <span class="arithmatex">\(\langle \eta(t) \eta(t') \rangle = 2 \gamma T \delta(t - t')\)</span>, where <span class="arithmatex">\(T\)</span> is the temperature.</p>
</li>
</ul>
<p><strong>Nonequilibrium protocol</strong>: The potential well center <span class="arithmatex">\(\lambda(t)\)</span> moves linearly from initial position <span class="arithmatex">\(\lambda_0\)</span> to final position <span class="arithmatex">\(\lambda_f\)</span> during time <span class="arithmatex">\(t=0\)</span> to <span class="arithmatex">\(t=t_f\)</span>:</p>
<div class="arithmatex">\[\lambda(t) = \lambda_0 + (\lambda_f - \lambda_0) \frac{t}{t_f}\]</div>
<p><strong>Nonequilibrium work</strong>: According to the previous definition, the work done along a trajectory <span class="arithmatex">\(x(t)\)</span> is:</p>
<div class="arithmatex">\[W_J = \int_0^{t_f} \frac{\partial V(x(t),t)}{\partial \lambda} \frac{d\lambda}{dt} dt = \int_0^{t_f} k (x(t) - \lambda(t)) \frac{d\lambda}{dt} dt\]</div>
<p><strong>Free energy change</strong>: Since the shape of the potential well (determined by <span class="arithmatex">\(k\)</span>) has not changed, the equilibrium free energy difference between initial and final states is <span class="arithmatex">\(\Delta F = 0\)</span>. Therefore, the Jarzynski equality predicts <span class="arithmatex">\(\langle e^{-\beta W_J} \rangle = e^0 = 1\)</span>.</p>
<p>The code below uses the simple Euler-Maruyama method to numerically integrate the Langevin equation and calculate the work for multiple trajectories, finally verifying the Jarzynski equality.</p>
<h2 id="python-implementation">Python Implementation<a class="headerlink" href="#python-implementation" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- 1. Parameter settings (same as before) ---</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">T</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span> <span class="n">t_f</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">;</span> <span class="n">num_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_f</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">num_trajectories</span> <span class="o">=</span> <span class="mi">20000</span> <span class="c1"># Increase trajectory count for smoother distribution</span>

<span class="c1"># --- 2. Forward protocol simulation ---</span>
<span class="n">lambda_0_fwd</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">lambda_f_fwd</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">v_lambda_fwd</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambda_f_fwd</span> <span class="o">-</span> <span class="n">lambda_0_fwd</span><span class="p">)</span> <span class="o">/</span> <span class="n">t_f</span>
<span class="n">work_forward</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_trajectories</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulating forward protocol...&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_trajectories</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">lambda_0_fwd</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span> <span class="o">/</span> <span class="n">k</span><span class="p">))</span>
    <span class="n">total_work</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_steps</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">lambda_t</span> <span class="o">=</span> <span class="n">lambda_0_fwd</span> <span class="o">+</span> <span class="n">v_lambda_fwd</span> <span class="o">*</span> <span class="n">t</span>
        <span class="n">force_lambda</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">lambda_t</span><span class="p">)</span>
        <span class="c1"># Key correction: definition of work</span>
        <span class="n">dW</span> <span class="o">=</span> <span class="o">-</span><span class="n">force_lambda</span> <span class="o">*</span> <span class="p">(</span><span class="n">v_lambda_fwd</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>
        <span class="n">total_work</span> <span class="o">+=</span> <span class="n">dW</span>
        <span class="n">force_x</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">lambda_t</span><span class="p">)</span>
        <span class="n">noise_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="p">(</span><span class="n">force_x</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">+</span> <span class="n">noise_term</span> <span class="o">/</span> <span class="n">gamma</span>
    <span class="n">work_forward</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_work</span>

<span class="c1"># --- 3. Reverse protocol simulation ---</span>
<span class="n">lambda_0_rev</span> <span class="o">=</span> <span class="n">lambda_f_fwd</span><span class="p">;</span> <span class="n">lambda_f_rev</span> <span class="o">=</span> <span class="n">lambda_0_fwd</span>
<span class="n">v_lambda_rev</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambda_f_rev</span> <span class="o">-</span> <span class="n">lambda_0_rev</span><span class="p">)</span> <span class="o">/</span> <span class="n">t_f</span> <span class="c1"># Velocity is negative</span>
<span class="n">work_reverse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_trajectories</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulating reverse protocol...&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_trajectories</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">lambda_0_rev</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span> <span class="o">/</span> <span class="n">k</span><span class="p">))</span>
    <span class="n">total_work</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_steps</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">lambda_t</span> <span class="o">=</span> <span class="n">lambda_0_rev</span> <span class="o">+</span> <span class="n">v_lambda_rev</span> <span class="o">*</span> <span class="n">t</span>
        <span class="n">force_lambda</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">lambda_t</span><span class="p">)</span>
        <span class="c1"># Key correction: definition of work</span>
        <span class="n">dW</span> <span class="o">=</span> <span class="o">-</span><span class="n">force_lambda</span> <span class="o">*</span> <span class="p">(</span><span class="n">v_lambda_rev</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>
        <span class="n">total_work</span> <span class="o">+=</span> <span class="n">dW</span>
        <span class="n">force_x</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">lambda_t</span><span class="p">)</span>
        <span class="n">noise_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="p">(</span><span class="n">force_x</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">+</span> <span class="n">noise_term</span> <span class="o">/</span> <span class="n">gamma</span>
    <span class="n">work_reverse</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_work</span>

<span class="c1"># --- 4. Visualizing Crooks Theorem ---</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;dark_background&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Numerical Verification of Crooks Fluctuation Theorem&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="c1"># --- Figure 1: Intersection point of work distributions ---</span>
<span class="n">delta_F</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">work_forward</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Forward work distribution $P(W)$&#39;</span><span class="p">)</span>
<span class="c1"># Plot distribution of negative reverse work P_R(-W)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="o">-</span><span class="n">work_reverse</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Reverse work distribution $P_R(-W)$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">delta_F</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Delta F = </span><span class="si">{</span><span class="n">delta_F</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Work W&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Verification Method 1: Work Distributions Intersect at Delta F&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># --- Figure 2: Linear relationship of logarithmic probability ratio ---</span>
<span class="c1"># Calculate histogram data</span>
<span class="n">hist_fwd</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">work_forward</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hist_rev</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="o">-</span><span class="n">work_reverse</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">bin_centers</span> <span class="o">=</span> <span class="p">(</span><span class="n">bin_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">bin_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span>

<span class="c1"># Avoid division by zero, only select regions where both distributions are non-zero</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">hist_fwd</span> <span class="o">&gt;</span> <span class="mf">1e-4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hist_rev</span> <span class="o">&gt;</span> <span class="mf">1e-4</span><span class="p">)</span>
<span class="n">log_ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">hist_fwd</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">/</span> <span class="n">hist_rev</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
<span class="n">work_vals</span> <span class="o">=</span> <span class="n">bin_centers</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="c1"># Plot scatter diagram</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">work_vals</span><span class="p">,</span> <span class="n">log_ratio</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation data (ln[P(W)/P_R(-W)])&#39;</span><span class="p">)</span>

<span class="c1"># Plot theoretical prediction line</span>
<span class="n">w_theory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">work_vals</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">work_vals</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">log_ratio_theory</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="n">w_theory</span> <span class="o">-</span> <span class="n">delta_F</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_theory</span><span class="p">,</span> <span class="n">log_ratio_theory</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Theoretical prediction: Slope beta=</span><span class="si">{</span><span class="n">beta</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Work W&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\ln[P(W) / P_R(-W)]$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Verification Method 2: Linear Relationship of Log Probability Ratio&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="Run Output" src="../../../assets/images/remote/jarzynski_verification_optimized.gif" /></p>
<p><strong>Physical process</strong>: The left panel shows the physical process, where the particle trajectory (red solid line) always <strong>lags</strong> behind the potential well center (blue dashed lines representing initial/final positions and the unshown moving trajectory). This is precisely the physical source of dissipative work.</p>
<p><strong>Second law of thermodynamics holds</strong>: The work distribution plot in the upper right shows that the average work <span class="arithmatex">\(\langle W \rangle\)</span> is much greater than the free energy difference <span class="arithmatex">\(\Delta F = 0\)</span>. This verifies the second law of thermodynamics <span class="arithmatex">\(\langle W \rangle \geq \Delta F\)</span>.</p>
<p><strong>Convergence of Jarzynski average</strong>:
One of the most important characteristics of the Jarzynski equality: its convergence is very slow and is dramatically affected by rare events. The Jarzynski average is <span class="arithmatex">\(\langle e^{-\beta W} \rangle\)</span>, a nonlinear exponential average. This average is extremely sensitive to trajectories with <strong>very small or even negative work <span class="arithmatex">\(W\)</span></strong> (i.e., those events at the far left of the histogram in the upper right plot). These are "lucky" trajectories where thermal fluctuations happen to help the particle keep up with the moving potential well, reducing dissipation. However, these trajectories are very rare. In limited simulation runs (such as 1480), it is likely that we have not sufficiently sampled enough of these rare events. Therefore, the calculated average will have statistical bias, usually less than 1. The dramatic fluctuations of the purple curve in the plot precisely reflect this sensitivity to rare events. If we increase the number of simulated trajectories to 10,000 or more, we will see this value converge more stably to 1.</p>
<p>The animation shows sample trajectories and the running exponential average <span class="arithmatex">\(\langle e^{-\beta W}\rangle\)</span> converging to <span class="arithmatex">\(e^{-\beta \Delta F}\)</span>, validating Jarzynski's equality.</p>
<h1 id="7-crooks-fluctuation-theorem-a-more-refined-symmetry">7. Crooks Fluctuation Theorem: A More Refined Symmetry<a class="headerlink" href="#7-crooks-fluctuation-theorem-a-more-refined-symmetry" title="Permanent link">&para;</a></h1>
<h2 id="71-derivation-and-form">7.1 Derivation and Form<a class="headerlink" href="#71-derivation-and-form" title="Permanent link">&para;</a></h2>
<p>The Jarzynski equality is an integral constraint on nonequilibrium work, acting on the <strong>average</strong> of the exponential of work. However, it originates from a more universal and refined relationship, namely the <strong>Crooks fluctuation theorem</strong>. This theorem does not constrain averages, but directly relates the <strong>entire work distribution functions</strong> of <strong>forward</strong> and <strong>reverse</strong> processes.</p>
<p>The <strong>Crooks fluctuation theorem</strong> was proposed by Gavin E. Crooks in 1999 as a generalization and refinement of the Jarzynski equality. Its <strong>physical essence</strong> is a more refined and powerful symmetry relationship that is no longer limited to constraining some average of work, but directly relates the <strong>entire probability distribution functions of work</strong> for <strong>forward processes</strong> and <strong>reverse processes</strong>. The theorem states that the ratio of the probability <span class="arithmatex">\(P(W)\)</span> of doing work <span class="arithmatex">\(W\)</span> in the forward process to the probability <span class="arithmatex">\(\tilde{p}(-W)\)</span> of doing work <span class="arithmatex">\(-W\)</span> under the reversed protocol is determined by a simple exponential relationship: <span class="arithmatex">\(P(W)/\tilde{p}(-W) = e^{\beta (W - \Delta F)}\)</span>. This relationship quantitatively explains how rare instantaneous "violations" of the second law (i.e., <span class="arithmatex">\(W &lt; \Delta F\)</span>) are, and reveals the profound time-reversal symmetry in nonequilibrium fluctuations.</p>
<p>In <strong>specific applications</strong>, the Crooks theorem provides a more numerically robust and reliable free energy calculation method than the Jarzynski equality, because it allows direct determination of <span class="arithmatex">\(\Delta F\)</span> by finding the intersection point of forward and reverse work distribution curves. This "intersection method" has become a standard tool for analyzing single-molecule force spectroscopy experiments (such as RNA folding/unfolding) and computational simulation data.</p>
<p>For forward protocol work distribution <span class="arithmatex">\(P(W)\)</span> and reversed-protocol opposite-work distribution <span class="arithmatex">\(P_R(-W)\)</span>, Crooks' theorem states:
$$
\frac{P(W)}{P_R(-W)} = e^{\beta (W-\Delta F)}.
$$
This detailed relation refines Jarzynski by connecting entire distributions, predicting that the crossing point of <span class="arithmatex">\(P(W)\)</span> and <span class="arithmatex">\(P_R(-W)\)</span> occurs at <span class="arithmatex">\(W=\Delta F\)</span>.</p>
<h2 id="72-jarzynski-from-crooks">7.2 Jarzynski from Crooks<a class="headerlink" href="#72-jarzynski-from-crooks" title="Permanent link">&para;</a></h2>
<p>The Crooks theorem is a stronger conclusion than the Jarzynski equality. We can rederive the Jarzynski equality by integrating the Crooks theorem, proving this point:</p>
<ol>
<li>
<p>Starting from the Crooks theorem: <span class="arithmatex">\(P(W_J) = P_R(-W_J) e^{\beta (W_J - \Delta F)}\)</span></p>
</li>
<li>
<p>Calculate the Jarzynski average:
   <span class="arithmatex">\(<span class="arithmatex">\(\langle e^{-\beta W_J} \rangle \equiv \int dW_J \, P(W_J) e^{-\beta W_J}\)</span>\)</span></p>
</li>
<li>
<p>Substitute the expression for <span class="arithmatex">\(P(W_J)\)</span>:
   <span class="arithmatex">\(<span class="arithmatex">\(\langle e^{-\beta W_J} \rangle = \int dW_J \, P_R(-W_J) e^{\beta (W_J - \Delta F)} e^{-\beta W_J}\)</span>\)</span></p>
</li>
<li>
<p>Simplify the exponential terms:
   <span class="arithmatex">\(<span class="arithmatex">\(\langle e^{-\beta W_J} \rangle = \int dW_J \, P_R(-W_J) e^{-\beta \Delta F} = e^{-\beta \Delta F} \int dW_J \, P_R(-W_J)\)</span>\)</span></p>
</li>
<li>
<p>Since <span class="arithmatex">\(P_R\)</span> is a normalized probability distribution, its integral is 1:
   <span class="arithmatex">\(<span class="arithmatex">\(\int dW_J \, P_R(-W_J) = 1\)</span>\)</span></p>
</li>
<li>
<p>Finally obtain the Jarzynski equality:
   <span class="arithmatex">\(<span class="arithmatex">\(\langle e^{-\beta W_J} \rangle = e^{-\beta \Delta F}\)</span>\)</span></p>
</li>
</ol>
<p>This derivation clearly shows that the Jarzynski equality is a direct corollary of the Crooks theorem at the integral level.</p>
<h1 id="8-code-practice-ii-visualizing-crooks-theorem">8. Code Practice II: Visualizing Crooks' Theorem<a class="headerlink" href="#8-code-practice-ii-visualizing-crooks-theorem" title="Permanent link">&para;</a></h1>
<div class="highlight"><pre><span></span><code><span class="c1"># --- 1. Parameter settings (same as before) ---</span>
<span class="c1"># --- 2. Forward protocol simulation ---</span>
<span class="c1"># --- 3. Reverse protocol simulation ---</span>
<span class="c1"># --- 4. Visualizing Crooks Theorem ---</span>
<span class="c1"># --- Figure 1: Intersection point of work distributions ---</span>
<span class="c1"># Plot distribution of negative reverse work P_R(-W)</span>
<span class="c1"># --- Figure 2: Linear relationship of logarithmic probability ratio ---</span>
<span class="c1"># Calculate histogram data</span>
<span class="c1"># Avoid division by zero, only select regions where both distributions are non-zero</span>
<span class="c1"># Plot scatter diagram</span>
<span class="c1"># Plot theoretical prediction line</span>
</code></pre></div>
<p><img alt="Run Output" src="../../../assets/images/remote/22bf615e-1cb8-4373-8e99-7345db9a2ab7-21558a2f47.png" /></p>
<p>The left plot shows the forward work distribution <span class="arithmatex">\(P(W)\)</span> (blue) and the distribution of the negative of reverse work <span class="arithmatex">\(P_R(-W)\)</span> (orange). The forward process is on average dissipative, so <span class="arithmatex">\(P(W)\)</span> peaks in the positive work region. The reverse process is also on average dissipative (<span class="arithmatex">\(W_R &gt; \Delta F_{rev} = -\Delta F = 0\)</span>), so <span class="arithmatex">\(-W_R\)</span> is predominantly negative, and its distribution <span class="arithmatex">\(P_R(-W)\)</span> peaks in the negative work region. <strong>The most crucial feature is the intersection point of the two distributions</strong>. According to the Crooks theorem, this intersection should be precisely located at <span class="arithmatex">\(W = \Delta F\)</span>. In the simulation, since <span class="arithmatex">\(\Delta F = 0\)</span>, the curves of both histograms intersect at the red dashed line at <span class="arithmatex">\(W = 0\)</span>.</p>
<p>The right plot provides a more rigorous and quantitative verification. It directly tests the linear relationship:
$$
\ln\left[\frac{P(W)}{P_R(-W)}\right] = \beta (W - \Delta F)
$$
The simulation data points (blue scatter) clearly fall on a straight line, highly consistent with the theoretical prediction (red line). The slope of this line is exactly <span class="arithmatex">\(\beta = 1/T = 1.0\)</span>, and the x-intercept is also precisely located at <span class="arithmatex">\(\Delta F = 0\)</span>.</p>
<h1 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h1>
<p>At the end of this lecture, Professor Erwin Frey recommends an authoritative review article in this field:</p>
<p><strong>Seifert U. Stochastic thermodynamics, fluctuation theorems and molecular machines[J]. Reports on progress in physics, 2012, 75(12): 126001.</strong></p>
<p>This review systematically constructs the theoretical framework of <strong>stochastic thermodynamics</strong>. Its core idea is to <strong>successfully extend</strong> the macroscopic concepts of classical thermodynamics, such as work, heat, and entropy production, <strong>to the level of single microscopic random trajectories</strong>. For a nonequilibrium system coupled to a constant temperature heat bath (whether a continuous system described by Langevin equations or a discrete system described by master equations), how to establish first-law-like energy balance relationships on single fluctuation trajectories. The article demonstrates how to derive the Jarzynski equality, Crooks theorem, and other various integral and detailed fluctuation theorems (IFT &amp; DFT) learned in this lecture from a "master theorem" in a unified way. The paper covers a large number of paradigmatic systems, including the colloid particles, biopolymers, molecular motors, and small biochemical networks we have simulated. As Professor Frey said, this is a "...beautiful review of all the different aspects of stochastic thermodynamics...".</p>
<p><strong>This lecture marks a crucial turning point in this series of courses from near-equilibrium to nonequilibrium fields.</strong> Starting from reviewing the fluctuation-dissipation relationship of near-equilibrium systems, we have expanded the vision of statistical physics to stochastic processes driven by arbitrary external protocols that are far from equilibrium. Through the use of powerful JDD path-integral tools, we ultimately proved that even when systems undergo highly irreversible processes, universal and exact equality relationships beyond classical thermodynamic inequalities can still be found.</p>
<p>The core content can be summarized into the following four points:</p>
<ol>
<li>
<p><strong>Nonequilibrium work is a random variable</strong>: At the microscopic scale, due to the presence of thermal fluctuations, the work done on the system is no longer a deterministic value, but a random variable that depends on the specific evolution trajectory of the system. Therefore, it must be described by its complete probability distribution.</p>
</li>
<li>
<p><strong>Jarzynski equality</strong>: The exponential average of work, this quantity measured in nonequilibrium processes, is proven to be exactly equal to the thermodynamic factor corresponding to the free energy difference between the initial and final equilibrium states, i.e., <span class="arithmatex">\(\langle e^{-\beta W_J} \rangle = e^{-\beta \Delta F}\)</span>. This theorem provides a solid theoretical foundation for extracting equilibrium information from irreversible processes.</p>
</li>
<li>
<p><strong>Crooks fluctuation theorem</strong>: This is a more refined and powerful "detailed" symmetry relationship. Through the formula <span class="arithmatex">\(\frac{P(W_J)}{P_R(-W_J)} = e^{\beta (W_J - \Delta F)}\)</span>, it precisely relates the entire work distributions of forward and reverse processes, thereby quantitatively explaining the rarity of instantaneous "violations" of the second law.</p>
</li>
<li>
<p><strong>Central role of time-reversal symmetry</strong>: The fundamental source of all these nonequilibrium theorems is the <strong>time reversibility</strong> of the underlying microscopic dynamics. The macroscopic irreversibility observed arises from asymmetric boundary conditions (i.e., starting from a specific equilibrium state and letting time evolve forward), and fluctuation theorems are precisely the exact description of the statistical consequences produced by this asymmetry in boundary conditions.</p>
</li>
</ol>
<p>We considered transient processes driving a system between equilibrium states in finite time. Next, we turn to nonequilibrium steady states (NESS), with directed percolation as a paradigmatic model of nonequilibrium phase transitions. Unlike equilibrium transitions, DP is inherently dynamical and irreversible (preferred direction), describing critical behavior such as spreading to absorbing states. To analyze long-time behavior and spectra (relaxation rates, fluctuation spectra) in NESS, spectral methods of the evolution operator (e.g., Fokker-Planck) will be central-shifting our lens from path integrals to operator theory.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy", "navigation.sections", "navigation.expand", "navigation.top", "toc.integrate", "search.highlight"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../assets/javascripts/mathjax.js"></script>
      
        <script src="../../assets/javascripts/language-nav.js"></script>
      
        <script src="../../assets/javascripts/video-init.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>