
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Course Notes and Code (Erwin Frey, LMU Munich, 2025)">
      
      
        <meta name="author" content="Zhihang Liu">
      
      
        <link rel="canonical" href="https://liu-zhihang.github.io/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/notes/4.%20Gillespie%20Algorithm%2C%20Master%20Equation%2C%20Generating%20Functions%20and%20Population%20Dynamics/">
      
      
        <link rel="prev" href="../3.%20Gaussian%20Random%20Walk%20and%20Poisson%20Process/">
      
      
        <link rel="next" href="../5.%20Population%20Dynamics%20-%20Linear%20Death%20Process%20and%20Lotka-Volterra%20System/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>4. Gillespie Algorithm, Master Equation, Generating Functions and Population Dynamics - Nonequilibrium Field Theories and Stochastic Dynamics</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#review-poisson-process-and-its-simulation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Nonequilibrium Field Theories and Stochastic Dynamics" class="md-header__button md-logo" aria-label="Nonequilibrium Field Theories and Stochastic Dynamics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nonequilibrium Field Theories and Stochastic Dynamics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              4. Gillespie Algorithm, Master Equation, Generating Functions and Population Dynamics
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/zh/" hreflang="zh" class="md-select__link">
              简体中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Liu-Zhihang/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Nonequilibrium Field Theories and Stochastic Dynamics" class="md-nav__button md-logo" aria-label="Nonequilibrium Field Theories and Stochastic Dynamics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Nonequilibrium Field Theories and Stochastic Dynamics
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Liu-Zhihang/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Course Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Course Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20Course%20Introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Course Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.%20Simple%20Random%20Walk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Simple Random Walk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.%20Gaussian%20Random%20Walk%20and%20Poisson%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. Gaussian Random Walk and Poisson Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    4. Gillespie Algorithm, Master Equation, Generating Functions and Population Dynamics
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    4. Gillespie Algorithm, Master Equation, Generating Functions and Population Dynamics
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#waiting-time-distribution-and-memorylessness" class="md-nav__link">
    <span class="md-ellipsis">
      Waiting Time Distribution and Memorylessness
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simulation-dilemma-limitations-of-fixed-time-step-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Simulation Dilemma: Limitations of Fixed Time Step Methods
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.%20Population%20Dynamics%20-%20Linear%20Death%20Process%20and%20Lotka-Volterra%20System/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. Population Dynamics - Linear Death Process and Lotka-Volterra System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.%20Fundamental%20Equations%20of%20Markov%20Processes%20%E2%80%94%20Chapman%E2%80%93Kolmogorov%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6. Fundamental Equations of Markov Processes — Chapman–Kolmogorov Equation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.%20Forward%20Master%20Equation%20and%20the%20Q%20Matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7. Forward Master Equation and the Q Matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8.%20Perron%E2%80%93Frobenius%20Theorem%2C%20Steady%20States%2C%20and%20Detailed%20Balance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8. Perron–Frobenius Theorem, Steady States, and Detailed Balance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9.%20Nonequilibrium%20States%20%E2%80%94%20Irreversibility%20and%20Entropy%20Production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    9. Nonequilibrium States — Irreversibility and Entropy Production
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10.%20Ehrenfest%20Model%2C%20Entropy%2C%20and%20KL%20Divergence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10. Ehrenfest Model, Entropy, and KL Divergence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11.%20Continuous%20Markov%20Processes%20and%20the%20Fokker%E2%80%93Planck%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11. Continuous Markov Processes and the Fokker–Planck Equation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12.%20Brownian%20Motion%20and%20the%20Ornstein%E2%80%93Uhlenbeck%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    12. Brownian Motion and the Ornstein–Uhlenbeck Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13.%20Monte%20Carlo%20Sampling%20as%20a%20Stochastic%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    13. Monte Carlo Sampling as a Stochastic Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14.%20Hamiltonian%20Monte%20Carlo%20Sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    14. Hamiltonian Monte Carlo Sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15.%20Chemotaxis%2C%20Run-and-Tumble%20Motion%2C%20and%20the%20Keller%E2%80%93Segel%20Model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15. Chemotaxis, Run-and-Tumble Motion, and the Keller–Segel Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../16.%20The%20Schnitzer%20Model%2C%20Anomalous%20Diffusion%2C%20and%20Motility%E2%80%91Induced%20Phase%20Separation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    16. The Schnitzer Model, Anomalous Diffusion, and Motility‑Induced Phase Separation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../17.%20Langevin%20Equation%2C%20Brownian%20Particle%2C%20and%20the%20Fluctuation%E2%80%93Dissipation%20Theorem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    17. Langevin Equation, Brownian Particle, and the Fluctuation–Dissipation Theorem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18.%20Fokker%E2%80%93Planck%20Equation%20and%20the%20Smoluchowski%20Equation%20%E2%80%94%20From%20Random%20Trajectories%20to%20Probability%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    18. Fokker–Planck Equation and the Smoluchowski Equation — From Random Trajectories to Probability Dynamics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19.%20Path%20Integral%20Formulation%20of%20Stochastic%20Processes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    19. Path Integral Formulation of Stochastic Processes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.%20Stochastic%20Differential%20Equations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20. Stochastic Differential Equations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    中文笔记
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            中文笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    首页
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/1.%20%E8%AF%BE%E7%A8%8B%E5%AF%BC%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. 课程导论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/2.%20%E7%AE%80%E5%8D%95%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. 简单随机游走
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/3.%20%E9%AB%98%E6%96%AF%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E4%B8%8E%E6%B3%8A%E6%9D%BE%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. 高斯随机游走与泊松过程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/4.%20Gillespie%20%E7%AE%97%E6%B3%95%E3%80%81%E4%B8%BB%E6%96%B9%E7%A8%8B%E3%80%81%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E4%B8%8E%E7%A7%8D%E7%BE%A4%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Gillespie 算法、主方程、生成函数与种群动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/5.%20%E7%A7%8D%E7%BE%A4%E5%8A%A8%E6%80%81%E5%AD%A6%EF%BC%9A%E7%BA%BF%E6%80%A7%E6%AD%BB%E4%BA%A1%E8%BF%87%E7%A8%8B%E4%B8%8ELotka-Volterra%20%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. 种群动态学：线性死亡过程与Lotka-Volterra 系统
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/6.%20%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%96%B9%E7%A8%8B%EF%BC%9A%E6%9F%A5%E6%99%AE%E6%9B%BC-%E7%A7%91%E5%B0%94%E8%8E%AB%E6%88%88%E7%BD%97%E5%A4%AB%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6. 马尔可夫过程的基本方程：查普曼-科尔莫戈罗夫方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/7.%20%E5%89%8D%E5%90%91%E4%B8%BB%E6%96%B9%E7%A8%8B%E4%B8%8EQ%E7%9F%A9%E9%98%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7. 前向主方程与Q矩阵
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/8.%20%E4%BD%A9%E9%BE%99-%E5%BC%97%E7%BD%97%E8%B4%9D%E5%B0%BC%E4%B9%8C%E6%96%AF%E5%AE%9A%E7%90%86%E3%80%81%E7%A8%B3%E6%80%81%E4%B8%8E%E7%BB%86%E8%87%B4%E5%B9%B3%E8%A1%A1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8. 佩龙-弗罗贝尼乌斯定理、稳态与细致平衡
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/9.%20%E9%9D%9E%E5%B9%B3%E8%A1%A1%E6%80%81%EF%BC%9A%E4%B8%8D%E5%8F%AF%E9%80%86%E6%80%A7%E4%B8%8E%E7%86%B5%E4%BA%A7%E7%94%9F%E7%9A%84%E6%8E%A8%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    9. 非平衡态：不可逆性与熵产生的推论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/10.%20%E5%9F%83%E4%BC%A6%E8%B4%B9%E6%96%AF%E7%89%B9%E6%A8%A1%E5%9E%8B%E3%80%81%E7%86%B5%E4%B8%8EKL%E6%95%A3%E5%BA%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10. 埃伦费斯特模型、熵与KL散度
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/11.%20%E8%BF%9E%E7%BB%AD%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E4%B8%8E%E7%A6%8F%E5%85%8B-%E6%99%AE%E6%9C%97%E5%85%8B%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11. 连续马尔可夫过程与福克-普朗克方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/12.%20%E5%B8%83%E6%9C%97%E8%BF%90%E5%8A%A8%E4%B8%8E%E5%A5%A5%E6%81%A9%E6%96%AF%E5%9D%A6-%E4%B9%8C%E4%BC%A6%E8%B4%9D%E5%85%8B%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    12. 布朗运动与奥恩斯坦-乌伦贝克过程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/13.%20%E4%BD%9C%E4%B8%BA%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E9%87%87%E6%A0%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    13. 作为随机过程的蒙特卡洛采样
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/14.%20%E5%93%88%E5%AF%86%E5%B0%94%E9%A1%BF%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E9%87%87%E6%A0%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    14. 哈密尔顿蒙特卡洛采样
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/15.%20%E8%B6%8B%E5%8C%96%E6%80%A7%E3%80%81%E8%B7%91%E5%8A%A8-%E7%BF%BB%E6%BB%9A%E8%BF%90%E5%8A%A8%E4%B8%8EKeller-Segel%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15. 趋化性、跑动-翻滚运动与Keller-Segel模型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/16.%20Schnitzer%E6%A8%A1%E5%9E%8B%E3%80%81%E5%8F%8D%E5%B8%B8%E6%89%A9%E6%95%A3%E4%B8%8E%E8%BF%90%E5%8A%A8%E8%AF%B1%E5%AF%BC%E7%9B%B8%E5%88%86%E7%A6%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    16. Schnitzer模型、反常扩散与运动诱导相分离
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/17.%20%E6%9C%97%E4%B9%8B%E4%B8%87%E6%96%B9%E7%A8%8B%E3%80%81%E5%B8%83%E6%9C%97%E7%B2%92%E5%AD%90%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    17. 朗之万方程、布朗粒子与涨落-耗散定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/18.%20%E7%A6%8F%E5%85%8B-%E6%99%AE%E6%9C%97%E5%85%8B%E6%96%B9%E7%A8%8B%E4%B8%8E%E6%96%AF%E6%91%A9%E6%A3%B1%E9%9C%8D%E5%A4%AB%E6%96%AF%E5%9F%BA%E6%96%B9%E7%A8%8B%EF%BC%9A%E4%BB%8E%E9%9A%8F%E6%9C%BA%E8%BD%A8%E8%BF%B9%E5%88%B0%E6%A6%82%E7%8E%87%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    18. 福克-普朗克方程与斯摩棱霍夫斯基方程：从随机轨迹到概率动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/19.%20%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E8%A1%A8%E8%BF%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    19. 随机过程的路径积分表述
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/20.%20%E9%9A%8F%E6%9C%BA%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20. 随机微分方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/21.%20%E4%BC%8A%E8%97%A4%E7%A7%AF%E5%88%86%E4%B8%8E%E7%BB%9F%E4%B8%80%E7%9A%84%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    21. 伊藤积分与统一的随机过程框架
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/22.%20%E5%90%AB%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    22. 含乘性噪声系统的路径积分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/23.%20%E4%BB%8E%E7%B2%97%E7%B2%92%E5%8C%96%E5%88%B0%E8%BF%9E%E7%BB%AD%E5%9C%BA%E8%AE%BA%E6%B6%A8%E8%90%BD%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    23. 从粗粒化到连续场论涨落动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/24.%20%E6%98%82%E8%90%A8%E6%A0%BC%E7%B3%BB%E6%95%B0%E3%80%81%E5%80%92%E6%98%93%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%8A%A8%E6%80%81%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    24. 昂萨格系数、倒易关系与动态涨落-耗散定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/25.%20%E6%A2%AF%E5%BA%A6%E5%8A%A8%E5%8A%9B%E5%AD%A6%E3%80%81%E7%9B%B8%E5%8F%98%E4%B8%8E%E5%BC%9B%E8%B1%AB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    25. 梯度动力学、相变与弛豫
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/26.%20%E4%B8%B4%E7%95%8C%E6%85%A2%E5%8C%96%E3%80%81%E5%8A%A8%E6%80%81%E5%93%8D%E5%BA%94%E4%B8%8E%E5%AE%88%E6%81%92%E5%BE%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    26. 临界慢化、动态响应与守恒律
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/27.%20%E7%AE%80%E5%8D%95%E6%B5%81%E4%BD%93%E3%80%81%E6%97%A0%E6%91%A9%E6%93%A6%E6%B5%81%E4%BD%93%E4%B8%8E%E6%AC%A7%E6%8B%89%E6%96%B9%E7%A8%8B%E7%9A%84%E6%B5%81%E4%BD%93%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    27. 简单流体、无摩擦流体与欧拉方程的流体动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/28.%20%E7%B2%98%E6%80%A7%E6%B5%81%E4%BD%93%E3%80%81%E7%BA%B3%E7%BB%B4-%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E6%96%B9%E7%A8%8B%E3%80%81%E7%86%B5%E5%B9%B3%E8%A1%A1%E4%B8%8E%E7%83%AD%E4%BC%A0%E5%AF%BC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    28. 粘性流体、纳维-斯托克斯方程、熵平衡与热传导
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/29.%20%E4%B8%8D%E5%8F%AF%E9%80%86%E7%BA%BF%E6%80%A7%E7%83%AD%E5%8A%9B%E5%AD%A6%E4%B8%8E%E5%B9%B2%E6%80%A7%E6%89%A9%E6%95%A3%E7%B2%92%E5%AD%90%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    29. 不可逆线性热力学与干性扩散粒子系统
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/30.%20%E6%82%AC%E6%B5%AE%E5%9C%A8%E6%B5%81%E4%BD%93%E4%B8%AD%E7%9A%84%E5%B8%83%E6%9C%97%E7%B2%92%E5%AD%90%20%E2%80%94%20H%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    30. 悬浮在流体中的布朗粒子 — H模型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/31.%20%E5%8A%A8%E6%80%81%E6%B3%9B%E5%87%BD%E3%80%81%E5%8A%A0%E6%80%A7%E5%99%AA%E5%A3%B0%E5%9C%BA%E8%AE%BA%E4%B8%8EOnsager-Machlup%E6%B3%9B%E5%87%BD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    31. 动态泛函、加性噪声场论与Onsager-Machlup泛函
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/32.%20Janssen-De%20Dominicis%20%E5%93%8D%E5%BA%94%E6%B3%9B%E5%87%BD%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%85%B3%E7%B3%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    32. Janssen-De Dominicis 响应泛函与涨落-耗散关系
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/33.%20%E9%9D%9E%E5%B9%B3%E8%A1%A1%E5%8A%9F%E4%B8%8E%E6%B6%A8%E8%90%BD%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    33. 非平衡功与涨落定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/34.%20%E6%9C%89%E5%90%91%E6%B8%97%E6%B5%81%E3%80%81%E5%90%B8%E6%94%B6%E6%80%81%E4%B8%8E%E8%B0%B1%E6%96%B9%E6%B3%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    34. 有向渗流、吸收态与谱方法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/35.%20%E4%B8%BB%E6%96%B9%E7%A8%8B%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E8%A1%A8%E7%A4%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    35. 主方程的路径积分表示
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/36.%20%E7%9B%B8%E5%B9%B2%E6%80%81%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E3%80%81%E7%AE%97%E7%AC%A6%E4%BB%A3%E6%95%B0%E4%B8%8E%E8%99%9A%E5%99%AA%E5%A3%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    36. 相干态路径积分、算符代数与虚噪声
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/37.%20Kramers-Moyal%20%E5%B1%95%E5%BC%80%E4%B8%8E%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E7%9A%84%E4%BD%8E%E5%99%AA%E5%A3%B0%E6%9E%81%E9%99%90/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    37. Kramers-Moyal 展开与路径积分的低噪声极限
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/38.%20%E5%A4%9A%E7%89%A9%E7%A7%8D%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E4%B8%8E%E5%BE%AA%E7%8E%AF%E7%AB%9E%E4%BA%89%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    38. 多物种路径积分与循环竞争动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/39.%20%E4%BB%8E%E7%B2%92%E5%AD%90%E8%B7%B3%E8%B7%83%E5%88%B0%E8%BF%9E%E7%BB%AD%E5%9C%BA%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    39. 从粒子跳跃到连续场论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/40.%20%E7%BB%9F%E4%B8%80%E7%9A%84%E5%9C%BA%E8%AE%BA%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    40. 统一的场论框架
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="review-poisson-process-and-its-simulation">Review: Poisson Process and Its Simulation<a class="headerlink" href="#review-poisson-process-and-its-simulation" title="Permanent link">&para;</a></h1>
<p>In the previous lecture, Prof. Erwin Frey discussed in detail the Poisson process, which describes a stochastic process where events occur at a constant average rate in continuous time. This section begins by reviewing the core mathematical characteristics of the Poisson process and uses this as a foundation to introduce more advanced stochastic process simulation and analysis methods.</p>
<h2 id="waiting-time-distribution-and-memorylessness">Waiting Time Distribution and Memorylessness<a class="headerlink" href="#waiting-time-distribution-and-memorylessness" title="Permanent link">&para;</a></h2>
<p>A core feature of the Poisson process is its "<strong>memorylessness</strong>." This means that the probability of the next event occurring in some future time interval is independent of how long we have already waited. This physical property is mathematically manifested as the waiting times between events following an exponential distribution.</p>
<p>The professor reviewed several key formulas describing this property on the blackboard:</p>
<p><img alt="Lecture blackboard screenshot" src="../../assets/images/remote/3bec63e5-dd99-4fe2-bc89-6f70ba2687f5-b75281afa6.jpg" /></p>
<p><strong>Survival Probability <span class="arithmatex">\(S(t)\)</span>:</strong> The probability that no event occurs for a waiting time exceeding <span class="arithmatex">\(t\)</span> starting from any moment. For the Poisson process, this probability decays exponentially with time:</p>
<div class="arithmatex">\[
S(t)=e^{-\nu t}
\]</div>
<p>where <span class="arithmatex">\(\nu\)</span> is the constant rate of event occurrence.</p>
<p><strong>Cumulative Distribution Function (CDF) of Waiting Time <span class="arithmatex">\(W(t)\)</span>:</strong> The probability that the waiting time is less than or equal to <span class="arithmatex">\(t\)</span>. It equals 1 minus the survival probability:</p>
<div class="arithmatex">\[
W(t)=1-S(t)=1-e^{-\nu t}
\]</div>
<p><strong>Probability Density Function (PDF) of Waiting Time <span class="arithmatex">\(w(t)\)</span>:</strong> The probability density of event occurrence in an infinitesimal time window <span class="arithmatex">\(dt\)</span> around time <span class="arithmatex">\(t\)</span>. It is the derivative of the cumulative distribution function:</p>
<div class="arithmatex">\[
w(t)=\frac{dW(t)}{dt}=\nu e^{-\nu t}
\]</div>
<p>This set of formulas forms the foundation of the Poisson process. The exponential form of the waiting time distribution <span class="arithmatex">\(w(t)\)</span> directly embodies memorylessness. We can verify this by calculating conditional probabilities: assuming no event has occurred before time <span class="arithmatex">\(t_0\)</span>, the conditional probability of an event occurring in the next <span class="arithmatex">\(dt\)</span> time is:</p>
<div class="arithmatex">\[
P(t_0 &lt; T \leq t_0 + dt \mid T &gt; t_0) = \frac{w(t_0) \, dt}{S(t_0)} = \frac{\nu e^{-\nu t_0} \, dt}{e^{-\nu t_0}} = \nu \, dt
\]</div>
<p>This result is independent of <span class="arithmatex">\(t_0\)</span>, indicating that regardless of how long we have waited, the probability of an event occurring in the next instant is always <span class="arithmatex">\(\nu dt\)</span>.</p>
<h2 id="simulation-dilemma-limitations-of-fixed-time-step-methods">Simulation Dilemma: Limitations of Fixed Time Step Methods<a class="headerlink" href="#simulation-dilemma-limitations-of-fixed-time-step-methods" title="Permanent link">&para;</a></h2>
<p>With the analytical description of the Poisson process, a natural question arises: How do we simulate such a process on a computer? The most intuitive method is the <strong>fixed time step algorithm</strong>.</p>
<p><img alt="Lecture PPT screenshot" src="../../assets/images/remote/4f1ba484-27a2-43d8-9387-83a5db3f60da-f97aa6d07b.png" /></p>
<p>The approach is as follows:</p>
<p>1.Discretize time into a series of small time steps <span class="arithmatex">\(\Delta t\)</span>.</p>
<p>2.In each time step, the particle has a certain probability of "jumping" forward one step (i.e., one event occurs).</p>
<p>3.This probability <span class="arithmatex">\(p_+\)</span> is set to the rate <span class="arithmatex">\(\nu\)</span> multiplied by the time step <span class="arithmatex">\(\Delta t\)</span>, i.e., <span class="arithmatex">\(p_+=\nu\Delta t\)</span>.</p>
<p>4.Correspondingly, the probability of no jump occurring in this step is <span class="arithmatex">\(p_0=1-p_+=1-\nu\Delta t\)</span>.</p>
<p>However, this seemingly simple method has profound theoretical flaws and practical difficulties:</p>
<ul>
<li>
<p><strong>Accuracy issues</strong>: This method is valid only under the premise that <span class="arithmatex">\(\nu\Delta t\ll 1\)</span>, i.e., the probability of an event occurring in one time step must be very small. If <span class="arithmatex">\(\Delta t\)</span> is not small enough, this approximation no longer holds. More seriously, it completely ignores the possibility of two or more events occurring in one <span class="arithmatex">\(\Delta t\)</span> (with probability proportional to <span class="arithmatex">\((\nu\Delta t)^2\)</span> or higher-order terms).</p>
</li>
<li>
<p><strong>Efficiency issues</strong>: If the event occurrence rate <span class="arithmatex">\(\nu\)</span> is very small, then in the vast majority of time steps, the system is in a "nothing happens" state (<span class="arithmatex">\(p_0\approx 1\)</span>). The computer spends a lot of time simulating these "no-event" steps, resulting in extremely low efficiency.</p>
</li>
<li>
<p><strong>Correctness issues</strong>: This method introduces an artificial time grid, forcing events to occur only at discrete time points <span class="arithmatex">\(k\cdot\Delta t\)</span> (where <span class="arithmatex">\(k\)</span> is an integer), which contradicts the characteristic of real Poisson processes where events can occur at any continuous time.</p>
</li>
</ul>
<p>These limitations drive us to seek a more accurate and efficient simulation method, which is one of the core contents of this lecture—the <strong>Gillespie algorithm</strong>.</p>
<h1 id="1-gillespie-algorithm-a-precise-stochastic-simulation-method">1. Gillespie Algorithm: A Precise Stochastic Simulation Method<a class="headerlink" href="#1-gillespie-algorithm-a-precise-stochastic-simulation-method" title="Permanent link">&para;</a></h1>
<p>The Gillespie algorithm, also known as the Stochastic Simulation Algorithm (SSA), is an <strong>event-driven</strong> method that completely abandons the concept of fixed time steps. Its core idea is not to ask <strong>"Will an event occur in the next <span class="arithmatex">\(\Delta t\)</span>?"</strong> but to directly ask <strong>"When will the next event occur?"</strong> By directly sampling random numbers from the theoretically correct waiting time distribution, this algorithm can precisely simulate every event of the stochastic process, making it an "<strong>exact</strong>" simulation method whose results are statistically identical to the theoretical analytical solution.</p>
<h2 id="11-core-idea-inverse-transform-sampling">1.1 Core Idea: Inverse Transform Sampling<a class="headerlink" href="#11-core-idea-inverse-transform-sampling" title="Permanent link">&para;</a></h2>
<p><img alt="Lecture PPT screenshot" src="../../assets/images/remote/f75b6ff9-c643-4a31-9b67-5ac3f34b7020-3ea3bdae0e.png" /></p>
<p>The foundation of the Gillespie algorithm is how to generate a random number that follows a specific probability distribution (here, the exponential distribution <span class="arithmatex">\(w(t)=\nu e^{-\nu t}\)</span>). This requires a powerful statistical technique—<strong>Inverse Transform Sampling</strong>.</p>
<p>The principle is as follows:</p>
<p>1.We have a target probability density function <span class="arithmatex">\(w(t)\)</span> and its corresponding cumulative distribution function <span class="arithmatex">\(W(t)=\int_0^t w(t')dt'\)</span>.</p>
<p>2.We also have a tool that can generate uniformly distributed random numbers in the <span class="arithmatex">\([0, 1]\)</span> interval, which we call <span class="arithmatex">\(\xi\)</span>.</p>
<p>3.The core equation is probability conservation: the probability <span class="arithmatex">\(w(t)dt\)</span> in the range <span class="arithmatex">\(dt\)</span> around <span class="arithmatex">\(t\)</span> should equal the probability <span class="arithmatex">\(1\cdot d\xi\)</span> in the range <span class="arithmatex">\(d\xi\)</span> around <span class="arithmatex">\(\xi\)</span>. That is:</p>
<div class="arithmatex">\[
w(t)dt=d\xi
\]</div>
<p>4.Integrating both sides of this equation from 0 to <span class="arithmatex">\(t\)</span>, the left side gives the cumulative distribution function <span class="arithmatex">\(W(t)\)</span>, and the right side gives <span class="arithmatex">\(\xi\)</span>:</p>
<div class="arithmatex">\[
\xi=\int_0^t w(t')dt'=W(t)
\]</div>
<p>5.For the Poisson process, we have <span class="arithmatex">\(W(t)=1-e^{-\nu t}\)</span>, so:</p>
<div class="arithmatex">\[
\xi=1-e^{-\nu t}
\]</div>
<p>6.Now, our goal is to solve for <span class="arithmatex">\(t\)</span> given the known <span class="arithmatex">\(\xi\)</span>. Through simple algebraic transformation, we can obtain the expression for <span class="arithmatex">\(t\)</span>:</p>
<div class="arithmatex">\[
e^{-\nu t}=1-\xi
\]</div>
<div class="arithmatex">\[
-\nu t=\ln(1-\xi)
\]</div>
<div class="arithmatex">\[
t=-\frac{1}{\nu}\ln(1-\xi)
\]</div>
<p>7.<strong>Here is a clever simplification:</strong> Since <span class="arithmatex">\(\xi\)</span> is a uniformly distributed random number in the <span class="arithmatex">\([0, 1]\)</span> interval, <span class="arithmatex">\(1-\xi\)</span> is also a uniformly distributed random number in the <span class="arithmatex">\([0, 1]\)</span> interval. Therefore, we can use another uniform random number <span class="arithmatex">\(\xi'\)</span> to replace <span class="arithmatex">\(1-\xi\)</span>, thus obtaining the final sampling formula:</p>
<div class="arithmatex">\[
t=-\frac{1}{\nu}\ln(\xi')
\]</div>
<p>In the lecture notes, the professor used the characteristic time <span class="arithmatex">\(\tau=1/\nu\)</span> to express this, writing the formula as <span class="arithmatex">\(t=-\tau\ln(\xi)\)</span>.</p>
<p>This derivation not only provides a method for generating waiting times in the Poisson process but, more importantly, reveals a universal principle: <strong>to sample from any probability distribution, one only needs to first generate a uniform random number <span class="arithmatex">\(\xi\)</span> on <span class="arithmatex">\([0, 1]\)</span>, then calculate the inverse function of its cumulative distribution function <span class="arithmatex">\(W^{-1}(\xi)\)</span></strong>.</p>
<h2 id="12-gillespie-algorithm-steps-for-poisson-process">1.2 Gillespie Algorithm Steps for Poisson Process<a class="headerlink" href="#12-gillespie-algorithm-steps-for-poisson-process" title="Permanent link">&para;</a></h2>
<p>Based on the above principle, the Gillespie algorithm for simulating the Poisson process can be clearly summarized as the following three-step loop:</p>
<p>1.<strong>Initialization</strong>: Set initial time <span class="arithmatex">\(T=0\)</span> and initial position (event count) <span class="arithmatex">\(n=0\)</span>.</p>
<p>2.<strong>Sample waiting time</strong>:</p>
<p>a. Generate a uniformly distributed random number <span class="arithmatex">\(\xi\)</span> in the <span class="arithmatex">\([0, 1]\)</span> interval.</p>
<p>b. Calculate the waiting time <span class="arithmatex">\(t\)</span> for the next event occurrence according to the formula <span class="arithmatex">\(t=-\frac{1}{\nu}\ln(\xi)\)</span>.</p>
<p>3.<strong>Update system state</strong>:</p>
<p>a. Advance the current time by <span class="arithmatex">\(t\)</span>: <span class="arithmatex">\(T \leftarrow T+t\)</span>.</p>
<p>b. Increment the event count by one: <span class="arithmatex">\(n \leftarrow n+1\)</span>.</p>
<p>4.<strong>Loop</strong>: Repeat steps 2 and 3 until the simulation time <span class="arithmatex">\(T\)</span> reaches the preset termination time.</p>
<p>This event-driven simulation method, where the time step <span class="arithmatex">\(t\)</span> itself is random, perfectly reproduces the inherent uncertainty of stochastic processes. It is both accurate and efficient because the computer only performs calculations when events actually occur.</p>
<p><img alt="Lecture PPT screenshot" src="../../assets/images/remote/ae38f836-f653-4721-b943-2634dc9de086-b5e7b9c1d7.png" /></p>
<h2 id="13-python-code-implementation">1.3 Python Code Implementation<a class="headerlink" href="#13-python-code-implementation" title="Permanent link">&para;</a></h2>
<p>Below is an example Python code implementing the Gillespie algorithm to simulate the Poisson process. The code will generate and reproduce the trajectories shown in the PPT.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gillespie_poisson</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">t_max</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate a Poisson process using the Gillespie algorithm.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    nu (float): Event rate.</span>
<span class="sd">    t_max (float): Total simulation time.</span>

<span class="sd">    Returns:</span>
<span class="sd">    tuple: Two lists containing event times and corresponding event counts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialization</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Current time</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c1"># Current event count</span>

    <span class="c1"># Lists to store trajectory</span>
    <span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">]</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span>

    <span class="c1"># Simulation loop until maximum time is reached</span>
    <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">t_max</span><span class="p">:</span>
        <span class="c1"># 1. Draw a uniform random number from (0, 1]</span>
        <span class="c1">#    Note: xi cannot be 0 because log(0) is negative infinity.</span>
        <span class="c1">#    np.random.random() generates random numbers in (0, 1), which meets the requirement.</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>

        <span class="c1"># 2. Calculate waiting time according to the formula</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">nu</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>

        <span class="c1"># 3. Update time and count</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># 4. Record trajectory point</span>
        <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">counts</span>

<span class="c1"># --- Simulation and plotting ---</span>
<span class="c1"># Set parameters</span>
<span class="n">nu</span> <span class="o">=</span> <span class="mf">1.0</span>      <span class="c1"># Event rate</span>
<span class="n">t_max</span> <span class="o">=</span> <span class="mi">100</span>   <span class="c1"># Total simulation time</span>
<span class="n">num_traj</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># Number of simulated trajectories</span>

<span class="c1"># Create figure with two subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Left subplot: Single trajectory</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">times</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">gillespie_poisson</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">t_max</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="c1"># Add theoretical expectation line (straight line y = νt)</span>
<span class="n">t_theory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">n_theory</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="n">t_theory</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_theory</span><span class="p">,</span> <span class="n">n_theory</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time ($t$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Event Count ($x$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Single Trajectory&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Right subplot: Multiple trajectories</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_traj</span><span class="p">):</span>
    <span class="n">times</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">gillespie_poisson</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">t_max</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Add theoretical expectation line (straight line y = νt)</span>
<span class="n">t_theory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">n_theory</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="n">t_theory</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_theory</span><span class="p">,</span> <span class="n">n_theory</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Expected $</span><span class="se">\\</span><span class="s1">nu t$&#39;</span><span class="p">)</span>

<span class="c1"># Set chart properties</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time ($t$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Event Count ($x$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Multiple Trajectories&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="Code execution output" src="../../assets/images/remote/7d080bb1-a706-4934-8cc3-ab7732cb265c-446060f7a9.png" /></p>
<h1 id="2-master-equation-deterministic-evolution-of-probability-distribution">2. Master Equation: Deterministic Evolution of Probability Distribution<a class="headerlink" href="#2-master-equation-deterministic-evolution-of-probability-distribution" title="Permanent link">&para;</a></h1>
<p>Although the Gillespie algorithm can generate single random trajectories, to understand the statistical properties of the entire stochastic process, we need a more macroscopic descriptive tool. This is the <strong>Master Equation</strong>. The master equation describes how the probability of the system being in various possible states evolves over time, and it is a deterministic differential equation.</p>
<p>The history of the master equation can be traced back to the early 20th century, first proposed by physicists Max Born and Werner Heisenberg in their research on quantum mechanics and statistical physics. Its core idea is to transform microscopic stochastic processes into macroscopic probability evolution descriptions, enabling systematic analysis of the overall behavioral characteristics of stochastic systems.</p>
<p><strong>The basic principle of the master equation method is probability conservation: the rate of change of the probability that the system is in a specific state at a certain time equals the probability flow into that state minus the probability flow out of that state. This "gain-loss" balance concept not only applies to physical systems but is also widely used in chemical reactions, biological population dynamics, financial modeling, and many other fields.</strong></p>
<p>In specific applications, the master equation is particularly suitable for handling Markov processes with discrete state spaces. For example:</p>
<ul>
<li>
<p>In chemical reactions, describing the probability distribution of reactant molecule numbers changing over time</p>
</li>
<li>
<p>In biological population dynamics, characterizing the probability evolution process of population size</p>
</li>
<li>
<p>In epidemic models, analyzing the probability distribution of susceptible, infected, and recovered individuals</p>
</li>
<li>
<p>In finance, used for modeling the probability characteristics of asset price movements</p>
</li>
</ul>
<p>Compared to the Gillespie algorithm, the master equation provides a more systematic and comprehensive analytical framework. <strong>The Gillespie algorithm focuses on the random evolution of single trajectories, while the master equation focuses on the deterministic evolution of the entire probability distribution.</strong> The two complement each other and together constitute an important toolkit for stochastic process analysis.</p>
<p>For beginners, it is necessary to distinguish between the master equation and the mean-field self-consistent equation introduced later. The two have fundamental differences in both mathematical structure and physical meaning and should not be confused.</p>
<p>The difference between self-consistent equations and master equations lies in: master equations describe the time evolution of probability distributions, while self-consistent equations focus on the internal consistency of system steady-state solutions.</p>
<ul>
<li>
<p><strong>Master equation</strong>: Describes the time evolution of probability distributions, in the form <span class="arithmatex">\(\frac{d}{dt}p(n,t) = \text{gain term} - \text{loss term}\)</span>, focusing on the statistical behavior of the entire ensemble.</p>
</li>
<li>
<p><strong>Self-consistent equation</strong>: Usually refers to equations of the form <span class="arithmatex">\(x = f(x)\)</span>, where the unknown <span class="arithmatex">\(x\)</span> appears on both sides of the equation, requiring the solution to be consistent with itself. In physics, it is commonly found in mean-field approximations, such as <span class="arithmatex">\(m = \tanh(\beta(Jm + h))\)</span> where the magnetization <span class="arithmatex">\(m\)</span> is determined through its own value.</p>
</li>
</ul>
<h2 id="21-from-microscopic-processes-to-macroscopic-evolution">2.1 From Microscopic Processes to Macroscopic Evolution<a class="headerlink" href="#21-from-microscopic-processes-to-macroscopic-evolution" title="Permanent link">&para;</a></h2>
<p>Let us return to the microscopic description of the Poisson process. When deriving the Gillespie algorithm, we considered the probability <span class="arithmatex">\(p(n, t+dt)\)</span> that the system is in state <span class="arithmatex">\(n\)</span> (i.e., <span class="arithmatex">\(n\)</span> events have occurred) at time <span class="arithmatex">\(t+dt\)</span>. To reach this state, there are only two possible precursor paths:</p>
<p>1.At time <span class="arithmatex">\(t\)</span>, the system was already in state <span class="arithmatex">\(n-1\)</span>, and then one jump occurred in the next <span class="arithmatex">\(dt\)</span> time. The probability of this jump is <span class="arithmatex">\(\nu dt\)</span>. Therefore, the contribution of this path is <span class="arithmatex">\(p(n-1, t) \cdot \nu dt\)</span>.</p>
<p>2.At time <span class="arithmatex">\(t\)</span>, the system was already in state <span class="arithmatex">\(n\)</span>, and then no jump occurred in the next <span class="arithmatex">\(dt\)</span> time. The probability of no jump is <span class="arithmatex">\(1 - \nu dt\)</span>. Therefore, the contribution of this path is <span class="arithmatex">\(p(n, t) \cdot (1 - \nu dt)\)</span>.</p>
<p>Adding the probabilities of these two mutually exclusive cases, we obtain the expression for <span class="arithmatex">\(p(n, t+dt)\)</span>:</p>
<div class="arithmatex">\[p(n, t+dt) = p(n-1, t) \cdot \nu dt + p(n, t) \cdot (1 - \nu dt)\]</div>
<p>Next, we rearrange this equation:</p>
<div class="arithmatex">\[p(n, t+dt) - p(n, t) = \nu p(n-1, t) dt - \nu p(n, t) dt\]</div>
<div class="arithmatex">\[\frac{p(n, t+dt) - p(n, t)}{dt} = \nu p(n-1, t) - \nu p(n, t)\]</div>
<p>When <span class="arithmatex">\(dt \to 0\)</span>, the left side is the derivative of <span class="arithmatex">\(p(n, t)\)</span> with respect to time. Thus, we obtain the master equation for the Poisson process:</p>
<div class="arithmatex">\[\frac{d}{dt} p(n, t) = \nu p(n-1, t) - \nu p(n, t)\]</div>
<p>This equation holds for all <span class="arithmatex">\(n \ge 1\)</span>. For the special case <span class="arithmatex">\(n=0\)</span>, since there is no state <span class="arithmatex">\(n=-1\)</span>, the system can only leave state 0 but cannot enter it. Therefore, its equation is:</p>
<div class="arithmatex">\[\frac{d}{dt} p(0, t) = -\nu p(0, t)\]</div>
<h2 id="22-gain-loss-interpretation">2.2 Gain-Loss Interpretation<a class="headerlink" href="#22-gain-loss-interpretation" title="Permanent link">&para;</a></h2>
<p>The structure of the master equation has a very clear physical meaning, and it can be viewed as a balance equation for probability flow on each state <span class="arithmatex">\(n\)</span>:</p>
<div class="arithmatex">\[\frac{d}{dt} p(n, t) = \underbrace{\nu p(n-1, t)}_{\text{GAIN}} - \underbrace{\nu p(n, t)}_{\text{LOSS}}\]</div>
<ul>
<li>
<p><strong>Gain term (GAIN):</strong> <span class="arithmatex">\(\nu p(n-1, t)\)</span> represents the probability flux flowing from state <span class="arithmatex">\(n-1\)</span> into state <span class="arithmatex">\(n\)</span>. Its magnitude equals the probability of the source state <span class="arithmatex">\(p(n-1, t)\)</span> multiplied by the transition rate <span class="arithmatex">\(\nu\)</span>.</p>
</li>
<li>
<p><strong>Loss term (LOSS):</strong> <span class="arithmatex">\(\nu p(n, t)\)</span> represents the probability flux flowing from state <span class="arithmatex">\(n\)</span> out to state <span class="arithmatex">\(n+1\)</span>. Its magnitude equals the probability of the current state <span class="arithmatex">\(p(n, t)\)</span> multiplied by the total rate <span class="arithmatex">\(\nu\)</span> of leaving that state.</p>
</li>
</ul>
<p><img alt="Lecture blackboard screenshot" src="../../assets/images/remote/230e1dcf-63c8-475c-b840-3cd8b548d768-5939bfbb00.jpg" /></p>
<p>This "gain-loss" structure is a common feature of all master equations. It is essentially a <strong>continuity equation</strong> in discrete state space, describing how the rate of change of probability "density" <span class="arithmatex">\(p(n, t)\)</span> equals the net difference between the probability "flows" into and out of that state. This also ensures total probability conservation, i.e., <span class="arithmatex">\(\frac{d}{dt} \sum_n p(n, t) = 0\)</span>.</p>
<h2 id="23-from-random-trajectories-to-deterministic-evolution">2.3 From Random Trajectories to Deterministic Evolution<a class="headerlink" href="#23-from-random-trajectories-to-deterministic-evolution" title="Permanent link">&para;</a></h2>
<p>Here we see a profound conceptual shift. The Gillespie algorithm simulates a random, unpredictable path <span class="arithmatex">\(n(t)\)</span>. The master equation, on the other hand, is a <strong>deterministic system of differential equations</strong> whose solution <span class="arithmatex">\(p(n, t)\)</span> is a smooth, predictable function.</p>
<p>The connection between these two lies in: the master equation describes the statistical behavior of an <strong>ensemble</strong> composed of infinitely many Gillespie trajectories. If we run countless Gillespie simulations and then count the distribution histogram of <span class="arithmatex">\(n\)</span> values at some fixed time <span class="arithmatex">\(t\)</span> in all simulation results, the shape of this histogram will approach the solution <span class="arithmatex">\(p(n, t)\)</span> of the master equation. Therefore, the master equation connects microscopic randomness with macroscopic deterministic evolution of probabilities.</p>
<p>In the later part of the lecture, the professor also showed the matrix form of the master equation:</p>
<div class="arithmatex">\[\frac{d}{dt} \vec{p}(t) = W \vec{p}(t)\]</div>
<p>where <span class="arithmatex">\(\vec{p}(t)\)</span> is a column vector with elements <span class="arithmatex">\([p(0,t), p(1,t), \dots]^T\)</span>, and <span class="arithmatex">\(W\)</span> is a <strong>transition rate matrix</strong>. This form reveals that the master equation is essentially a system of linear ordinary differential equations, opening the way for using linear algebra tools (such as eigenvalue decomposition) to solve system dynamics.</p>
<h1 id="3-solving-master-equations-with-generating-functions">3. Solving Master Equations with Generating Functions<a class="headerlink" href="#3-solving-master-equations-with-generating-functions" title="Permanent link">&para;</a></h1>
<p>Although the master equation has an elegant form, it is an infinite-dimensional coupled system of ordinary differential equations, making direct solution usually very difficult. To solve this problem, a powerful tool has been developed in mathematical physics—the <strong>Generating Function</strong>.</p>
<h2 id="31-definition-and-transformation-of-generating-functions">3.1 Definition and Transformation of Generating Functions<a class="headerlink" href="#31-definition-and-transformation-of-generating-functions" title="Permanent link">&para;</a></h2>
<p>The core idea of generating functions is to encode an infinite sequence of probabilities <span class="arithmatex">\(p(0,t), p(1,t), \dots\)</span> into a single function <span class="arithmatex">\(G(s, t)\)</span>. Its definition is:</p>
<div class="arithmatex">\[G(s, t) = \sum_{n=0}^{\infty} p(n, t) s^n\]</div>
<p>Here, the variable <span class="arithmatex">\(s\)</span> is an auxiliary variable with no direct physical meaning, but it acts like a "ledger" where the coefficient of <span class="arithmatex">\(s^n\)</span> is the probability <span class="arithmatex">\(p(n, t)\)</span> we care about.</p>
<p>The magic of generating functions lies in their ability to transform difference operations in master equations (such as <span class="arithmatex">\(p(n-1, t)\)</span>) into algebraic operations. We multiply both sides of the master equation <span class="arithmatex">\(\frac{d}{dt} p(n, t) = \nu p(n-1, t) - \nu p(n, t)\)</span> by <span class="arithmatex">\(s^n\)</span> and then sum over all <span class="arithmatex">\(n\)</span>:</p>
<div class="arithmatex">\[\sum_{n=0}^{\infty} \frac{d}{dt} p(n, t) s^n = \sum_{n=0}^{\infty} \nu p(n-1, t) s^n - \sum_{n=0}^{\infty} \nu p(n, t) s^n\]</div>
<p>We handle this equation term by term:</p>
<ul>
<li><strong>Left side</strong>: Since summation and differentiation can be interchanged, we get</li>
</ul>
<div class="arithmatex">\[
\frac{d}{dt} \sum_{n=0}^{\infty} p(n, t) s^n = \frac{dG(s, t)}{dt}
\]</div>
<ul>
<li><strong>Right side second term</strong>:</li>
</ul>
<div class="arithmatex">\[
\sum_{n=0}^{\infty} \nu p(n, t) s^n = \nu \sum_{n=0}^{\infty} p(n, t) s^n = \nu G(s, t)
\]</div>
<ul>
<li><strong>Right side first term</strong>: This is the most crucial step. We make a variable substitution, let <span class="arithmatex">\(m=n-1\)</span>, then <span class="arithmatex">\(n=m+1\)</span>.</li>
</ul>
<div class="arithmatex">\[
\sum_{n=1}^{\infty} \nu p(n-1, t) s^n = \nu \sum_{m=0}^{\infty} p(m, t) s^{m+1} = \nu s \sum_{m=0}^{\infty} p(m, t) s^m = \nu s G(s, t)
\]</div>
<p>(Note that the summation starts from <span class="arithmatex">\(n=1\)</span> because <span class="arithmatex">\(p(-1,t)=0\)</span>)</p>
<p>Combining these three terms, we successfully transform the infinite-dimensional system of ordinary differential equations into a <strong>single-variable partial differential equation</strong>:</p>
<div class="arithmatex">\[
\frac{dG(s, t)}{dt} = \nu s G(s, t) - \nu G(s, t) = \nu(s-1) G(s, t)
\]</div>
<h2 id="32-solution-and-result-recovery">3.2 Solution and Result Recovery<a class="headerlink" href="#32-solution-and-result-recovery" title="Permanent link">&para;</a></h2>
<p>This equation for <span class="arithmatex">\(G(s,t)\)</span> is a simple first-order linear ordinary differential equation (for fixed <span class="arithmatex">\(s\)</span>), which we can solve directly by integration. First, we need an initial condition. Usually, we assume the system starts from <span class="arithmatex">\(n=0\)</span> at <span class="arithmatex">\(t=0\)</span>, i.e., <span class="arithmatex">\(p(n, 0) = \delta_{n,0}\)</span> (1 when <span class="arithmatex">\(n=0\)</span>, 0 otherwise). This initial condition corresponds in generating function space to:</p>
<div class="arithmatex">\[
G(s, 0) = \sum_{n=0}^{\infty} p(n, 0) s^n = p(0, 0) s^0 = 1
\]</div>
<p>Now solving the differential equation <span class="arithmatex">\(\frac{dG}{G} = \nu(s-1) dt\)</span> by integrating from <span class="arithmatex">\(t=0\)</span> to <span class="arithmatex">\(t\)</span>, we get:</p>
<div class="arithmatex">\[\ln(G(s, t)) - \ln(G(s, 0)) = \nu(s-1)t\]</div>
<div class="arithmatex">\[\ln(G(s, t)) = \nu(s-1)t\]</div>
<div class="arithmatex">\[G(s, t) = e^{\nu t(s-1)}\]</div>
<p>We have obtained the analytical expression for the generating function. The final step is how to "decode" the desired <span class="arithmatex">\(p(n,t)\)</span> from <span class="arithmatex">\(G(s,t)\)</span>. According to the definition of Taylor expansion, <span class="arithmatex">\(p(n,t)\)</span> is exactly the coefficient of the <span class="arithmatex">\(s^n\)</span> term in the Taylor expansion of <span class="arithmatex">\(G(s,t)\)</span> at <span class="arithmatex">\(s=0\)</span> divided by <span class="arithmatex">\(n!\)</span>. A more intuitive method is to directly expand <span class="arithmatex">\(G(s,t)\)</span>:</p>
<div class="arithmatex">\[G(s, t) = e^{\nu t s} e^{-\nu t} = e^{-\nu t} \sum_{n=0}^{\infty} \frac{(\nu t s)^n}{n!} = \sum_{n=0}^{\infty} \left[ e^{-\nu t} \frac{(\nu t)^n}{n!} \right] s^n\]</div>
<p>By comparing this expansion term by term with the generating function definition <span class="arithmatex">\(G(s, t) = \sum_{n=0}^{\infty} p(n, t) s^n\)</span>, we immediately obtain the solution to the master equation:</p>
<div class="arithmatex">\[p(n, t) = e^{-\nu t} \frac{(\nu t)^n}{n!}\]</div>
<p>This is the familiar <strong>Poisson distribution</strong> with mean <span class="arithmatex">\(\lambda = \nu t\)</span>.</p>
<h2 id="33-the-power-of-generating-functions-computing-moments">3.3 The Power of Generating Functions: Computing Moments<a class="headerlink" href="#33-the-power-of-generating-functions-computing-moments" title="Permanent link">&para;</a></h2>
<p>Generating functions can not only be used to solve probability distributions but also serve as a powerful "moment generating machine." We can conveniently compute various moments of the distribution by taking derivatives of <span class="arithmatex">\(G(s,t)\)</span>.</p>
<ul>
<li><strong>Mean <span class="arithmatex">\(\langle n(t) \rangle\)</span>:</strong></li>
</ul>
<div class="arithmatex">\[
\langle n(t) \rangle = \sum_{n=0}^{\infty} n \cdot p(n, t)
\]</div>
<p>Noting that <span class="arithmatex">\(\frac{\partial G}{\partial s} = \sum n \cdot p(n,t) s^{n-1}\)</span>. Therefore,</p>
<div class="arithmatex">\[
\langle n(t) \rangle = \left. \frac{\partial G(s, t)}{\partial s} \right|_{s=1} = \left. \nu t e^{\nu t(s-1)} \right|_{s=1} = \nu t
\]</div>
<ul>
<li><strong>Variance <span class="arithmatex">\(\text{Var}[n(t)]\)</span>:</strong></li>
</ul>
<p>Computing variance requires the second moment. We can first calculate <span class="arithmatex">\(\langle n(n-1) \rangle = \left. \frac{\partial^2 G(s, t)}{\partial s^2} \right|_{s=1} = (\nu t)^2\)</span></p>
<p>Then using the formula <span class="arithmatex">\(\text{Var}(n) = \langle n^2 \rangle - \langle n \rangle^2 = \langle n(n-1) \rangle + \langle n \rangle - \langle n \rangle^2\)</span>:</p>
<div class="arithmatex">\[
\text{Var}[n(t)] = (\nu t)^2 + \nu t - (\nu t)^2 = \nu t
\]</div>
<p>These two results <span class="arithmatex">\(\langle n(t) \rangle = \nu t\)</span> and <span class="arithmatex">\(\text{Var}[n(t)] = \nu t\)</span> are the hallmark characteristics of the Poisson distribution, which we have now obtained again through the systematic method of generating functions.</p>
<h1 id="4-application-introduction-to-population-dynamics">4. Application: Introduction to Population Dynamics<a class="headerlink" href="#4-application-introduction-to-population-dynamics" title="Permanent link">&para;</a></h1>
<p>So far, all the content we have discussed has revolved around the Poisson process with constant rates. However, the power of the master equation framework lies in its universality. By changing the functional form of transition rates, we can use it to describe a wide variety of more complex stochastic processes. In the final part of the lecture, the professor demonstrates this through an example of <strong>Population Dynamics</strong>.</p>
<h2 id="41-simple-death-process">4.1 Simple Death Process<a class="headerlink" href="#41-simple-death-process" title="Permanent link">&para;</a></h2>
<p>Consider the simplest model: the <strong>Simple Death Process</strong>. This process can be represented by a chemical reaction-like equation:</p>
<div class="arithmatex">\[A \xrightarrow{\lambda} \varnothing\]</div>
<p>This indicates that individuals of species <span class="arithmatex">\(A\)</span> die or disappear from the system at a certain rate. The key here is the physical meaning of <span class="arithmatex">\(\lambda\)</span>: it is the <strong>per capita death rate</strong>.</p>
<p>This means that if there are currently <span class="arithmatex">\(n\)</span> individuals in the system, the <strong>total death rate</strong> of the entire population is <span class="arithmatex">\(n \cdot \lambda\)</span>. This is a crucial distinction: the transition rate is no longer a constant but depends on the current state <span class="arithmatex">\(n\)</span> of the system. This <strong>state-dependent rate</strong> is a very common and important concept in stochastic modeling.</p>
<h2 id="42-master-equation-for-death-process">4.2 Master Equation for Death Process<a class="headerlink" href="#42-master-equation-for-death-process" title="Permanent link">&para;</a></h2>
<p>We can again apply the "gain-loss" logic to construct the master equation for this process. We are concerned with the probability <span class="arithmatex">\(p(n,t)\)</span> that the population size is <span class="arithmatex">\(n\)</span> at time <span class="arithmatex">\(t\)</span>.</p>
<ul>
<li>
<p><strong>Gain term (GAIN):</strong> For the system to reach state <span class="arithmatex">\(n\)</span> at time <span class="arithmatex">\(t\)</span>, it must have come from state <span class="arithmatex">\(n+1\)</span> through one death event. When the population size is <span class="arithmatex">\(n+1\)</span>, the total death rate is <span class="arithmatex">\((n+1)\lambda\)</span>. Therefore, the probability flux flowing from state <span class="arithmatex">\(n+1\)</span> into state <span class="arithmatex">\(n\)</span> is <span class="arithmatex">\(\lambda (n+1) p(n+1, t)\)</span>.</p>
</li>
<li>
<p><strong>Loss term (LOSS):</strong> If the system is currently in state <span class="arithmatex">\(n\)</span>, it will leave this state due to a death event. The total death rate at this time is <span class="arithmatex">\(n\lambda\)</span>. Therefore, the probability flux flowing out of state <span class="arithmatex">\(n\)</span> is <span class="arithmatex">\(\lambda n p(n, t)\)</span>.</p>
</li>
</ul>
<p>Combining the gain and loss terms, we obtain the master equation for the simple death process:</p>
<div class="arithmatex">\[\frac{d}{dt} p(n, t) = \lambda (n+1) p(n+1, t) - \lambda n p(n, t)\]</div>
<p>The structure of this equation is similar to the master equation for the Poisson process, but the transition rate has changed from the constant <span class="arithmatex">\(\nu\)</span> to the state-dependent <span class="arithmatex">\(n\lambda\)</span>. This simple change causes a qualitative change in the dynamic behavior of the model.</p>
<h2 id="43-stochastic-model-vs-deterministic-model">4.3 Stochastic Model vs. Deterministic Model<a class="headerlink" href="#43-stochastic-model-vs-deterministic-model" title="Permanent link">&para;</a></h2>
<p>It is worth noting that the deterministic model corresponding to this stochastic model is the differential equation <span class="arithmatex">\(\frac{dN}{dt} = -\lambda N\)</span>, whose solution is exponential decay <span class="arithmatex">\(N(t) = N_0 e^{-\lambda t}\)</span>.</p>
<p>The stochastic model described by the master equation provides much richer information than the deterministic model:</p>
<ul>
<li>
<p>It can not only give the evolution of the average population size (it can be proven that <span class="arithmatex">\(\langle n(t) \rangle = n_0 e^{-\lambda t}\)</span>, consistent with the deterministic model) but also describe the <strong>fluctuations</strong> around the average.</p>
</li>
<li>
<p>More importantly, it can calculate the <strong>extinction probability</strong>, i.e., <span class="arithmatex">\(p(0,t)\)</span>. This is a purely stochastic phenomenon. In the deterministic model, the population size only asymptotically approaches zero but never actually reaches zero. For small populations, this extinction caused by randomness is a crucial dynamic characteristic.</p>
</li>
</ul>
<h2 id="44-python-code-implementation-gillespie-simulation-of-death-process">4.4 Python Code Implementation: Gillespie Simulation of Death Process<a class="headerlink" href="#44-python-code-implementation-gillespie-simulation-of-death-process" title="Permanent link">&para;</a></h2>
<p>We can modify the previous Gillespie algorithm to simulate this state-dependent death process. The only key change is that when calculating waiting times, the rate used is no longer a constant but a function of the current population size <span class="arithmatex">\(n\)</span>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gillespie_death_process</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">n0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate a simple death process using the Gillespie algorithm.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    lam (float): Per capita death rate.</span>
<span class="sd">    n0 (int): Initial population size.</span>
<span class="sd">    t_max (float): Total simulation time.</span>

<span class="sd">    Returns:</span>
<span class="sd">    tuple: Two lists containing event times and corresponding population sizes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialization</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">n0</span>

    <span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">]</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span>

    <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">t_max</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Key difference: Rate depends on state</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="n">lam</span> <span class="o">*</span> <span class="n">n</span>

        <span class="c1"># Draw waiting time</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">rate</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>

        <span class="c1"># Update time</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>

        <span class="c1"># Check if exceeding maximum time</span>
        <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;=</span> <span class="n">t_max</span><span class="p">:</span>
            <span class="c1"># If exceeding maximum time, record final state and exit</span>
            <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_max</span><span class="p">)</span>
            <span class="n">counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="c1"># Record state before event occurs</span>
        <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

        <span class="c1"># Update population size (one individual dies)</span>
        <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="c1"># Record state after event occurs</span>
        <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="c1"># If extinction occurs before t_max, extend trajectory to t_max</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">t_max</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_max</span><span class="p">)</span>
        <span class="n">counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">counts</span>

<span class="c1"># --- Simulation and plotting ---</span>
<span class="c1"># Set parameters</span>
<span class="n">lam</span> <span class="o">=</span> <span class="mf">0.1</span>     <span class="c1"># Per capita death rate</span>
<span class="n">n0</span> <span class="o">=</span> <span class="mi">50</span>       <span class="c1"># Initial population size</span>
<span class="n">t_max</span> <span class="o">=</span> <span class="mi">50</span>    <span class="c1"># Total simulation time</span>
<span class="n">num_traj</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Simulate 5 trajectories</span>

<span class="c1"># Create figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># Plot multiple trajectories to show randomness</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_traj</span><span class="p">):</span>
    <span class="n">times</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">gillespie_death_process</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">n0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Trajectory </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Plot deterministic model solution for comparison</span>
<span class="n">t_deterministic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">n_deterministic</span> <span class="o">=</span> <span class="n">n0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">lam</span> <span class="o">*</span> <span class="n">t_deterministic</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_deterministic</span><span class="p">,</span> <span class="n">n_deterministic</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Deterministic Model ($N_0 e^{-\lambda t}$)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (t)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Population Size (n)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Simple Death Process: Stochastic vs. Deterministic&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="Code execution output" src="../../assets/images/remote/2544ec66-8794-4a40-b84c-1ed5e3a7e8cc-032623abea.png" /></p>
<p>Running this code will show multiple colored step-like curves, each representing a simulated random history. You will find that although their overall trend is downward, the specific timing of decline and the final extinction time (when the curve touches the horizontal axis) are all random. The black dashed line represents the solution of the deterministic model, depicting the average behavior of all random trajectories. This comparison vividly demonstrates the rich dynamics that stochastic models can capture.</p>
<h1 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h1>
<p>This lecture led us to deeply understand stochastic processes from three complementary perspectives: the Gillespie algorithm, master equations, and generating functions. These three together constitute a powerful and complete theoretical and computational framework.</p>
<p>1.<strong>Gillespie Algorithm</strong>: Provides a <strong>numerical simulation</strong> perspective. It is an event-driven exact algorithm that can generate specific single trajectories of stochastic processes, allowing us to intuitively see how randomness manifests.</p>
<p>2.<strong>Master Equation</strong>: Provides a <strong>probability evolution</strong> perspective. It is a deterministic differential equation that describes how the probability of the system being in various possible states evolves over time, capturing the statistical laws of the entire stochastic process ensemble.</p>
<p>3.<strong>Generating Function</strong>: Provides an <strong>analytical solution</strong> perspective. It is a powerful mathematical tool that can transform complex master equations (infinite-dimensional differential equation systems) into simple single equations, thereby obtaining analytical solutions for probability distributions and conveniently computing their various moments.</p>
<p>These three methods each have their focus and together provide a solid foundation for analyzing various stochastic phenomena from particle motion in physics to population dynamics in biology.</p>
<p>By introducing state-dependent rates, we have begun to glimpse how to apply this framework to more complex systems, such as chemical reaction networks and more realistic ecological models.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.sections", "navigation.expand", "navigation.top", "toc.integrate", "search.highlight"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../assets/javascripts/mathjax.js"></script>
      
        <script src="../../assets/javascripts/language-nav.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>