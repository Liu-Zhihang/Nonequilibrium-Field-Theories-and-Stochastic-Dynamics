
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Course Notes and Code (Erwin Frey, LMU Munich, 2025)">
      
      
        <meta name="author" content="Zhihang Liu">
      
      
        <link rel="canonical" href="https://liu-zhihang.github.io/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/notes/27.%20Hydrodynamics%20of%20Simple%20Fluids%2C%20Inviscid%20Flow%2C%20and%20the%20Euler%20Equation/">
      
      
        <link rel="prev" href="../26.%20Critical%20Slowing%20Down%2C%20Dynamic%20Response%2C%20and%20Conservation%20Laws/">
      
      
        <link rel="next" href="../28.%20Viscous%20Fluids%2C%20the%20Navier%E2%80%93Stokes%20Equation%2C%20Entropy%20Balance%2C%20and%20Heat%20Conduction/">
      
      
        
          <link rel="alternate" href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/" hreflang="en">
        
          <link rel="alternate" href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/zh/" hreflang="zh">
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>27. Hydrodynamics of Simple Fluids, Inviscid Flow, and the Euler Equation - Nonequilibrium Field Theories and Stochastic Dynamics</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/video.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction-from-scalar-fields-to-fluids" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Nonequilibrium Field Theories and Stochastic Dynamics" class="md-header__button md-logo" aria-label="Nonequilibrium Field Theories and Stochastic Dynamics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nonequilibrium Field Theories and Stochastic Dynamics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              27. Hydrodynamics of Simple Fluids, Inviscid Flow, and the Euler Equation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/zh/" hreflang="zh" class="md-select__link">
              简体中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Liu-Zhihang/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Nonequilibrium Field Theories and Stochastic Dynamics" class="md-nav__button md-logo" aria-label="Nonequilibrium Field Theories and Stochastic Dynamics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Nonequilibrium Field Theories and Stochastic Dynamics
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Liu-Zhihang/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Course Notes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Course Notes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20Course%20Introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Course Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.%20Simple%20Random%20Walk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Simple Random Walk
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.%20Gaussian%20Random%20Walk%20and%20Poisson%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Gaussian Random Walk and Poisson Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.%20Gillespie%20Algorithm%2C%20Master%20Equation%2C%20Generating%20Functions%20and%20Population%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Gillespie Algorithm, Master Equation, Generating Functions and Population Dynamics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.%20Population%20Dynamics%20-%20Linear%20Death%20Process%20and%20Lotka-Volterra%20System/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Population Dynamics - Linear Death Process and Lotka-Volterra System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.%20Fundamental%20Equations%20of%20Markov%20Processes%20%E2%80%94%20Chapman%E2%80%93Kolmogorov%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Fundamental Equations of Markov Processes — Chapman–Kolmogorov Equation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.%20Forward%20Master%20Equation%20and%20the%20Q%20Matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. Forward Master Equation and the Q Matrix
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8.%20Perron%E2%80%93Frobenius%20Theorem%2C%20Steady%20States%2C%20and%20Detailed%20Balance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. Perron–Frobenius Theorem, Steady States, and Detailed Balance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9.%20Nonequilibrium%20States%20%E2%80%94%20Irreversibility%20and%20Entropy%20Production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. Nonequilibrium States — Irreversibility and Entropy Production
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10.%20Ehrenfest%20Model%2C%20Entropy%2C%20and%20KL%20Divergence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. Ehrenfest Model, Entropy, and KL Divergence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11.%20Continuous%20Markov%20Processes%20and%20the%20Fokker%E2%80%93Planck%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. Continuous Markov Processes and the Fokker–Planck Equation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12.%20Brownian%20Motion%20and%20the%20Ornstein%E2%80%93Uhlenbeck%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. Brownian Motion and the Ornstein–Uhlenbeck Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13.%20Monte%20Carlo%20Sampling%20as%20a%20Stochastic%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. Monte Carlo Sampling as a Stochastic Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14.%20Hamiltonian%20Monte%20Carlo%20Sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. Hamiltonian Monte Carlo Sampling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15.%20Chemotaxis%2C%20Run-and-Tumble%20Motion%2C%20and%20the%20Keller%E2%80%93Segel%20Model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. Chemotaxis, Run-and-Tumble Motion, and the Keller–Segel Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../16.%20The%20Schnitzer%20Model%2C%20Anomalous%20Diffusion%2C%20and%20Motility%E2%80%91Induced%20Phase%20Separation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. The Schnitzer Model, Anomalous Diffusion, and Motility‑Induced Phase Separation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../17.%20Langevin%20Equation%2C%20Brownian%20Particle%2C%20and%20the%20Fluctuation%E2%80%93Dissipation%20Theorem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. Langevin Equation, Brownian Particle, and the Fluctuation–Dissipation Theorem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18.%20Fokker%E2%80%93Planck%20Equation%20and%20the%20Smoluchowski%20Equation%20%E2%80%94%20From%20Random%20Trajectories%20to%20Probability%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    18. Fokker–Planck Equation and the Smoluchowski Equation — From Random Trajectories to Probability Dynamics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19.%20Path%20Integral%20Formulation%20of%20Stochastic%20Processes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    19. Path Integral Formulation of Stochastic Processes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.%20Stochastic%20Differential%20Equations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    20. Stochastic Differential Equations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.%20Ito%20Integral%20and%20Unified%20Stochastic%20Process%20Framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    21. Ito Integral and Unified Stochastic Process Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.%20Path%20Integrals%20for%20Systems%20with%20Multiplicative%20Noise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    22. Path Integrals for Systems with Multiplicative Noise
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.%20From%20Coarse-Graining%20to%20Fluctuation%20Dynamics%20of%20Continuous%20Field%20Theories/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    23. From Coarse-Graining to Fluctuation Dynamics of Continuous Field Theories
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.%20Onsager%20Coefficients%2C%20Reciprocity%2C%20and%20the%20Dynamic%20Fluctuation%E2%80%93Dissipation%20Theorem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    24. Onsager Coefficients, Reciprocity, and the Dynamic Fluctuation–Dissipation Theorem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../25.%20Gradient%20Dynamics%2C%20Phase%20Transitions%2C%20and%20Relaxation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    25. Gradient Dynamics, Phase Transitions, and Relaxation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../26.%20Critical%20Slowing%20Down%2C%20Dynamic%20Response%2C%20and%20Conservation%20Laws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    26. Critical Slowing Down, Dynamic Response, and Conservation Laws
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    27. Hydrodynamics of Simple Fluids, Inviscid Flow, and the Euler Equation
  

    
  </span>
  
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../28.%20Viscous%20Fluids%2C%20the%20Navier%E2%80%93Stokes%20Equation%2C%20Entropy%20Balance%2C%20and%20Heat%20Conduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    28. Viscous Fluids, the Navier–Stokes Equation, Entropy Balance, and Heat Conduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../29.%20Irreversible%20Linear%20Thermodynamics%20and%20Dry%20Diffusive%20Particle%20Systems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    29. Irreversible Linear Thermodynamics and Dry Diffusive Particle Systems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../30.%20Brownian%20Particles%20Suspended%20in%20a%20Fluid%20%E2%80%94%20Model%20H/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    30. Brownian Particles Suspended in a Fluid — Model H
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../31.%20Dynamical%20Functionals%2C%20Additive%E2%80%91Noise%20Field%20Theory%2C%20and%20the%20Onsager%E2%80%93Machlup%20Functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    31. Dynamical Functionals, Additive‑Noise Field Theory, and the Onsager–Machlup Functional
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../32.%20Janssen%E2%80%93De%20Dominicis%20Response%20Functional%20and%20the%20Fluctuation%E2%80%93Dissipation%20Relation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    32. Janssen–De Dominicis Response Functional and the Fluctuation–Dissipation Relation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../33.%20Nonequilibrium%20Work%20and%20Fluctuation%20Theorems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    33. Nonequilibrium Work and Fluctuation Theorems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../34.%20Directed%20Percolation%2C%20Absorbing%20States%2C%20and%20Spectral%20Methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    34. Directed Percolation, Absorbing States, and Spectral Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../35.%20Path-Integral%20Representation%20of%20the%20Master%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    35. Path-Integral Representation of the Master Equation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../36.%20Coherent-State%20Path%20Integrals%2C%20Operator%20Algebra%2C%20and%20Imaginary%20Noise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    36. Coherent-State Path Integrals, Operator Algebra, and Imaginary Noise
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../37.%20Kramers-Moyal%20Expansion%20and%20the%20Low-Noise%20Limit%20of%20Path%20Integrals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    37. Kramers-Moyal Expansion and the Low-Noise Limit of Path Integrals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../38.%20Multi-Species%20Path%20Integrals%20and%20Cyclic%20Competition%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    38. Multi-Species Path Integrals and Cyclic Competition Dynamics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../39.%20From%20Particle%20Jumps%20to%20Continuous%20Field%20Theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    39. From Particle Jumps to Continuous Field Theory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../40.%20Unified%20Field%20Theory%20Framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    40. Unified Field Theory Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    中文笔记
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    中文笔记
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    首页
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/1.%20%E8%AF%BE%E7%A8%8B%E5%AF%BC%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. 课程导论
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/2.%20%E7%AE%80%E5%8D%95%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. 简单随机游走
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/3.%20%E9%AB%98%E6%96%AF%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E4%B8%8E%E6%B3%8A%E6%9D%BE%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. 高斯随机游走与泊松过程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/4.%20Gillespie%20%E7%AE%97%E6%B3%95%E3%80%81%E4%B8%BB%E6%96%B9%E7%A8%8B%E3%80%81%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E4%B8%8E%E7%A7%8D%E7%BE%A4%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Gillespie 算法、主方程、生成函数与种群动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/5.%20%E7%A7%8D%E7%BE%A4%E5%8A%A8%E6%80%81%E5%AD%A6%EF%BC%9A%E7%BA%BF%E6%80%A7%E6%AD%BB%E4%BA%A1%E8%BF%87%E7%A8%8B%E4%B8%8ELotka-Volterra%20%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. 种群动态学：线性死亡过程与Lotka-Volterra 系统
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/6.%20%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%96%B9%E7%A8%8B%EF%BC%9A%E6%9F%A5%E6%99%AE%E6%9B%BC-%E7%A7%91%E5%B0%94%E8%8E%AB%E6%88%88%E7%BD%97%E5%A4%AB%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. 马尔可夫过程的基本方程：查普曼-科尔莫戈罗夫方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/7.%20%E5%89%8D%E5%90%91%E4%B8%BB%E6%96%B9%E7%A8%8B%E4%B8%8EQ%E7%9F%A9%E9%98%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. 前向主方程与Q矩阵
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/8.%20%E4%BD%A9%E9%BE%99-%E5%BC%97%E7%BD%97%E8%B4%9D%E5%B0%BC%E4%B9%8C%E6%96%AF%E5%AE%9A%E7%90%86%E3%80%81%E7%A8%B3%E6%80%81%E4%B8%8E%E7%BB%86%E8%87%B4%E5%B9%B3%E8%A1%A1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. 佩龙-弗罗贝尼乌斯定理、稳态与细致平衡
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/9.%20%E9%9D%9E%E5%B9%B3%E8%A1%A1%E6%80%81%EF%BC%9A%E4%B8%8D%E5%8F%AF%E9%80%86%E6%80%A7%E4%B8%8E%E7%86%B5%E4%BA%A7%E7%94%9F%E7%9A%84%E6%8E%A8%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. 非平衡态：不可逆性与熵产生的推论
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/10.%20%E5%9F%83%E4%BC%A6%E8%B4%B9%E6%96%AF%E7%89%B9%E6%A8%A1%E5%9E%8B%E3%80%81%E7%86%B5%E4%B8%8EKL%E6%95%A3%E5%BA%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. 埃伦费斯特模型、熵与KL散度
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/11.%20%E8%BF%9E%E7%BB%AD%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E4%B8%8E%E7%A6%8F%E5%85%8B-%E6%99%AE%E6%9C%97%E5%85%8B%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. 连续马尔可夫过程与福克-普朗克方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/12.%20%E5%B8%83%E6%9C%97%E8%BF%90%E5%8A%A8%E4%B8%8E%E5%A5%A5%E6%81%A9%E6%96%AF%E5%9D%A6-%E4%B9%8C%E4%BC%A6%E8%B4%9D%E5%85%8B%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. 布朗运动与奥恩斯坦-乌伦贝克过程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/13.%20%E4%BD%9C%E4%B8%BA%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E9%87%87%E6%A0%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. 作为随机过程的蒙特卡洛采样
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/14.%20%E5%93%88%E5%AF%86%E5%B0%94%E9%A1%BF%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E9%87%87%E6%A0%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. 哈密尔顿蒙特卡洛采样
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/15.%20%E8%B6%8B%E5%8C%96%E6%80%A7%E3%80%81%E8%B7%91%E5%8A%A8-%E7%BF%BB%E6%BB%9A%E8%BF%90%E5%8A%A8%E4%B8%8EKeller-Segel%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. 趋化性、跑动-翻滚运动与Keller-Segel模型
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/16.%20Schnitzer%E6%A8%A1%E5%9E%8B%E3%80%81%E5%8F%8D%E5%B8%B8%E6%89%A9%E6%95%A3%E4%B8%8E%E8%BF%90%E5%8A%A8%E8%AF%B1%E5%AF%BC%E7%9B%B8%E5%88%86%E7%A6%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. Schnitzer模型、反常扩散与运动诱导相分离
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/17.%20%E6%9C%97%E4%B9%8B%E4%B8%87%E6%96%B9%E7%A8%8B%E3%80%81%E5%B8%83%E6%9C%97%E7%B2%92%E5%AD%90%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. 朗之万方程、布朗粒子与涨落-耗散定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/18.%20%E7%A6%8F%E5%85%8B-%E6%99%AE%E6%9C%97%E5%85%8B%E6%96%B9%E7%A8%8B%E4%B8%8E%E6%96%AF%E6%91%A9%E6%A3%B1%E9%9C%8D%E5%A4%AB%E6%96%AF%E5%9F%BA%E6%96%B9%E7%A8%8B%EF%BC%9A%E4%BB%8E%E9%9A%8F%E6%9C%BA%E8%BD%A8%E8%BF%B9%E5%88%B0%E6%A6%82%E7%8E%87%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    18. 福克-普朗克方程与斯摩棱霍夫斯基方程：从随机轨迹到概率动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/19.%20%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E8%A1%A8%E8%BF%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    19. 随机过程的路径积分表述
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/20.%20%E9%9A%8F%E6%9C%BA%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    20. 随机微分方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/21.%20%E4%BC%8A%E8%97%A4%E7%A7%AF%E5%88%86%E4%B8%8E%E7%BB%9F%E4%B8%80%E7%9A%84%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    21. 伊藤积分与统一的随机过程框架
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/22.%20%E5%90%AB%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    22. 含乘性噪声系统的路径积分
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/23.%20%E4%BB%8E%E7%B2%97%E7%B2%92%E5%8C%96%E5%88%B0%E8%BF%9E%E7%BB%AD%E5%9C%BA%E8%AE%BA%E6%B6%A8%E8%90%BD%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    23. 从粗粒化到连续场论涨落动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/24.%20%E6%98%82%E8%90%A8%E6%A0%BC%E7%B3%BB%E6%95%B0%E3%80%81%E5%80%92%E6%98%93%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%8A%A8%E6%80%81%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    24. 昂萨格系数、倒易关系与动态涨落-耗散定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/25.%20%E6%A2%AF%E5%BA%A6%E5%8A%A8%E5%8A%9B%E5%AD%A6%E3%80%81%E7%9B%B8%E5%8F%98%E4%B8%8E%E5%BC%9B%E8%B1%AB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    25. 梯度动力学、相变与弛豫
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/26.%20%E4%B8%B4%E7%95%8C%E6%85%A2%E5%8C%96%E3%80%81%E5%8A%A8%E6%80%81%E5%93%8D%E5%BA%94%E4%B8%8E%E5%AE%88%E6%81%92%E5%BE%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    26. 临界慢化、动态响应与守恒律
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/27.%20%E7%AE%80%E5%8D%95%E6%B5%81%E4%BD%93%E3%80%81%E6%97%A0%E6%91%A9%E6%93%A6%E6%B5%81%E4%BD%93%E4%B8%8E%E6%AC%A7%E6%8B%89%E6%96%B9%E7%A8%8B%E7%9A%84%E6%B5%81%E4%BD%93%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    27. 简单流体、无摩擦流体与欧拉方程的流体动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/28.%20%E7%B2%98%E6%80%A7%E6%B5%81%E4%BD%93%E3%80%81%E7%BA%B3%E7%BB%B4-%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E6%96%B9%E7%A8%8B%E3%80%81%E7%86%B5%E5%B9%B3%E8%A1%A1%E4%B8%8E%E7%83%AD%E4%BC%A0%E5%AF%BC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    28. 粘性流体、纳维-斯托克斯方程、熵平衡与热传导
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/29.%20%E4%B8%8D%E5%8F%AF%E9%80%86%E7%BA%BF%E6%80%A7%E7%83%AD%E5%8A%9B%E5%AD%A6%E4%B8%8E%E5%B9%B2%E6%80%A7%E6%89%A9%E6%95%A3%E7%B2%92%E5%AD%90%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    29. 不可逆线性热力学与干性扩散粒子系统
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/30.%20%E6%82%AC%E6%B5%AE%E5%9C%A8%E6%B5%81%E4%BD%93%E4%B8%AD%E7%9A%84%E5%B8%83%E6%9C%97%E7%B2%92%E5%AD%90%20%E2%80%94%20H%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    30. 悬浮在流体中的布朗粒子 — H模型
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/31.%20%E5%8A%A8%E6%80%81%E6%B3%9B%E5%87%BD%E3%80%81%E5%8A%A0%E6%80%A7%E5%99%AA%E5%A3%B0%E5%9C%BA%E8%AE%BA%E4%B8%8EOnsager-Machlup%E6%B3%9B%E5%87%BD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    31. 动态泛函、加性噪声场论与Onsager-Machlup泛函
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/32.%20Janssen-De%20Dominicis%20%E5%93%8D%E5%BA%94%E6%B3%9B%E5%87%BD%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%85%B3%E7%B3%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    32. Janssen-De Dominicis 响应泛函与涨落-耗散关系
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/33.%20%E9%9D%9E%E5%B9%B3%E8%A1%A1%E5%8A%9F%E4%B8%8E%E6%B6%A8%E8%90%BD%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    33. 非平衡功与涨落定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/34.%20%E6%9C%89%E5%90%91%E6%B8%97%E6%B5%81%E3%80%81%E5%90%B8%E6%94%B6%E6%80%81%E4%B8%8E%E8%B0%B1%E6%96%B9%E6%B3%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    34. 有向渗流、吸收态与谱方法
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/35.%20%E4%B8%BB%E6%96%B9%E7%A8%8B%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E8%A1%A8%E7%A4%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    35. 主方程的路径积分表示
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/36.%20%E7%9B%B8%E5%B9%B2%E6%80%81%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E3%80%81%E7%AE%97%E7%AC%A6%E4%BB%A3%E6%95%B0%E4%B8%8E%E8%99%9A%E5%99%AA%E5%A3%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    36. 相干态路径积分、算符代数与虚噪声
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/37.%20Kramers-Moyal%20%E5%B1%95%E5%BC%80%E4%B8%8E%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E7%9A%84%E4%BD%8E%E5%99%AA%E5%A3%B0%E6%9E%81%E9%99%90/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    37. Kramers-Moyal 展开与路径积分的低噪声极限
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/38.%20%E5%A4%9A%E7%89%A9%E7%A7%8D%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E4%B8%8E%E5%BE%AA%E7%8E%AF%E7%AB%9E%E4%BA%89%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    38. 多物种路径积分与循环竞争动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/39.%20%E4%BB%8E%E7%B2%92%E5%AD%90%E8%B7%B3%E8%B7%83%E5%88%B0%E8%BF%9E%E7%BB%AD%E5%9C%BA%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    39. 从粒子跳跃到连续场论
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/40.%20%E7%BB%9F%E4%B8%80%E7%9A%84%E5%9C%BA%E8%AE%BA%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    40. 统一的场论框架
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="introduction-from-scalar-fields-to-fluids">Introduction: From Scalar Fields to Fluids<a class="headerlink" href="#introduction-from-scalar-fields-to-fluids" title="Permanent link">&para;</a></h1>
<p>In earlier lectures we built a powerful framework for describing near-equilibrium systems based on <strong>free energy</strong> and <strong>Onsager relations</strong>, but our discussion has been limited to the evolution of a single <strong>scalar order parameter</strong> <span class="arithmatex">\(\phi(x,t)\)</span>. In this lecture we broaden our scope from gradient dynamics of an abstract order parameter to hydrodynamics—the most ubiquitous macroscopic motion in the physical world. This is not merely adding variables; it is a new level of description.</p>
<p>We will see that the equations governing fluid motion arise from the same foundations as before: symmetries and conservation laws. Our goal is to derive, from first principles, the full dynamical equations for the most idealized fluid—an inviscid (frictionless) fluid.</p>
<p>We systematically develop the three basic conservation laws:
- Mass conservation
- Momentum conservation
- Energy conservation</p>
<p>Along the way we obtain two landmark equations of fluid mechanics—the continuity equation and the Euler equation—and uncover the thermodynamic content of ideal fluid motion.</p>
<h1 id="1-from-gradient-dynamics-to-hydrodynamics">1. From Gradient Dynamics to Hydrodynamics<a class="headerlink" href="#1-from-gradient-dynamics-to-hydrodynamics" title="Permanent link">&para;</a></h1>
<p>In our exploration of near-equilibrium system dynamics, we have deeply studied the gradient dynamics describing the evolution of a single scalar field <span class="arithmatex">\(\phi(x,t)\)</span>. To better connect with the content of this lecture, Professor Erwin Frey first briefly reviews its core ideas and explains how they naturally lead to a more comprehensive and universal theory of fluids.</p>
<p><img alt="Blackboard Screenshot" src="../../assets/images/remote/74734f77-c679-40bc-a1c9-76e8d82a451a-dfb3979cd0.jpg" /></p>
<h2 id="11-review-two-relaxational-models">1.1 Review: Two Relaxational Models<a class="headerlink" href="#11-review-two-relaxational-models" title="Permanent link">&para;</a></h2>
<p>In previous lectures, we learned that gradient dynamics is mainly divided into two models, distinguished by whether the order parameter is <strong>conserved</strong>.</p>
<ul>
<li><strong>Model A (non-conserved field)</strong>: Its dynamics is described by a local Langevin equation:</li>
</ul>
<p><span class="arithmatex">\(<span class="arithmatex">\(\frac{\partial \phi(\vec{x},t)}{\partial t} = -L \frac{\delta F}{\delta \phi} + \eta\)</span>\)</span></p>
<p>The noise term satisfies:</p>
<p><span class="arithmatex">\(<span class="arithmatex">\(\langle \eta(\vec{x}, t) \eta(\vec{x}', t') \rangle = 2LT \delta(\vec{x} - \vec{x}') \delta(t - t')\)</span>\)</span></p>
<p>This equation describes a local <strong>relaxation</strong> process. The field <span class="arithmatex">\(\phi\)</span> at any point in space can independently increase or decrease, and the driving force for its change comes from the decrease of the system's <strong>free energy</strong> <span class="arithmatex">\(F\)</span>. <span class="arithmatex">\(L\)</span> is a <strong>kinetic coefficient</strong>, and <span class="arithmatex">\(\eta\)</span> represents <strong>thermal noise</strong>.</p>
<ul>
<li><strong>Model B (conserved field)</strong>: Its dynamics must follow the form of a <strong>continuity equation</strong>:</li>
</ul>
<p><span class="arithmatex">\(<span class="arithmatex">\(\frac{\partial \phi(\vec{x},t)}{\partial t} = -\nabla \cdot \vec{J}\)</span>\)</span></p>
<p>where the flux <span class="arithmatex">\(\vec{J}\)</span> is driven by the gradient of chemical potential:</p>
<p><span class="arithmatex">\(<span class="arithmatex">\(\vec{J} = -M \nabla \frac{\delta F}{\delta \phi} + \vec{\eta}_J\)</span>\)</span></p>
<p>The fluctuation flux term satisfies:</p>
<p><span class="arithmatex">\(<span class="arithmatex">\(\langle \eta_{J\alpha}(\vec{x}, t) \eta_{J\beta}(\vec{x}', t') \rangle = 2MT \delta_{\alpha\beta} \delta(\vec{x} - \vec{x}') \delta(t - t')\)</span>\)</span></p>
<p>This form is fundamentally different in physics. It indicates that the total amount of the field <span class="arithmatex">\(\phi\)</span> is conserved and cannot be created or destroyed out of thin air in space. Any local change in the field must originate from a physical <strong>flux</strong> <span class="arithmatex">\(\vec{J}\)</span> flowing into or out of that region. (Note: Here we use the more complete Model B expression, where <span class="arithmatex">\(M\)</span> is usually called the mobility. In the blackboard review, the professor may have omitted the gradient operator <span class="arithmatex">\(\nabla\)</span> for simplicity.)</p>
<h2 id="12-hydrodynamics-as-a-universal-theory">1.2 Hydrodynamics as a Universal Theory<a class="headerlink" href="#12-hydrodynamics-as-a-universal-theory" title="Permanent link">&para;</a></h2>
<p>This lecture will transition from Model B describing a single scalar field to <strong>hydrodynamics</strong>. The equation form of Model B, <span class="arithmatex">\(\frac{\partial (\text{density})}{\partial t} + \nabla \cdot (\text{flux}) = 0\)</span>, is not merely an equation describing a single order parameter; it is actually the universal mathematical template for all <strong>conservation laws</strong> in physics.</p>
<p>The core task of hydrodynamics is to extend this universal mathematical framework from describing a single abstract order parameter to describing the most fundamental set of <strong>conserved quantities</strong> that any fluid must obey. These conserved quantities—<strong>mass, momentum, and energy</strong>—are the dominant degrees of freedom for any macroscopic system at low frequencies (long time scales) and long wavelengths (large spatial scales). Because their changes can only be accomplished through long-distance transport, they are the "slowest" variables in the system.</p>
<p>Therefore, hydrodynamics is an extremely universal theory that does not care about microscopic details (such as specific intermolecular forces) but focuses only on the most fundamental symmetries and conservation laws of the system. The entire content of this lecture is to find the corresponding "flux" for each of the three basic conserved quantities of fluids—mass, momentum, and energy—and construct a complete set of dynamical equations describing ideal fluids (frictionless fluids).</p>
<p>Our task is to identify, for each conserved density, its conjugate flux and assemble the ideal (inviscid) fluid equations.</p>
<h1 id="2-foundations-assumptions-and-state-fields">2. Foundations: Assumptions and State Fields<a class="headerlink" href="#2-foundations-assumptions-and-state-fields" title="Permanent link">&para;</a></h1>
<p>To establish a universal theory capable of describing the macroscopic motion of fluids, we do not need to delve into the specific behavior of each molecule. Instead, we start from two powerful and fundamental physical assumptions and define a set of <strong>macroscopic fields</strong> that can describe the state of the fluid based on these assumptions.</p>
<h2 id="21-assumption-i-continuum-medium-and-fluid-element">2.1 Assumption I: Continuum Medium and Fluid Element<a class="headerlink" href="#21-assumption-i-continuum-medium-and-fluid-element" title="Permanent link">&para;</a></h2>
<p>We first introduce the <strong>continuum medium assumption</strong>. Under this assumption, we ignore the microscopic molecular structure of the fluid and treat it as a continuous substance that can be infinitely divided. To mathematically handle this continuum, we define a core concept—the <strong>"fluid element"</strong>.</p>
<p>A "fluid element" is such a small volume:</p>
<ul>
<li><strong>On macroscopic scales, it is small enough</strong> to be approximated as a mathematical point <span class="arithmatex">\((\vec{x}, t)\)</span>, allowing us to use calculus tools (such as gradients and divergences) to describe the spatial variations of physical quantities.</li>
<li><strong>On microscopic scales, it is large enough</strong> to contain a huge number of molecules. This allows statistical physical quantities such as density, pressure, and temperature to be well defined within it, and the internal fluctuations can be averaged out.</li>
</ul>
<p>As the professor mentioned in class, the scope of application of this assumption is surprisingly broad. Even at the scale of 20-30 nanometers, for fluids like water, the continuum description is still valid in most cases.</p>
<p><img alt="Blackboard Screenshot" src="../../assets/images/remote/b9f94dbd-5136-4330-b3c0-d6e6e0b35a8f-837c7521cb.png" />
<img alt="Blackboard Screenshot" src="../../assets/images/remote/d0228f7a-958b-4d65-ae5d-dda1117fa9bd-01b7ad6697.jpg" /></p>
<h2 id="22-assumption-ii-local-thermal-equilibrium">2.2 Assumption II: Local Thermal Equilibrium<a class="headerlink" href="#22-assumption-ii-local-thermal-equilibrium" title="Permanent link">&para;</a></h2>
<p>This is the second cornerstone of fluid dynamics theory: the <strong>local equilibrium assumption</strong>. It states:</p>
<p>Even when the entire fluid system is macroscopically out of equilibrium (for example, there is flow, temperature gradients, etc.), we can still assume that every "fluid element" is in its own <strong>internal thermodynamic equilibrium state</strong> at any moment.</p>
<p>The power of this assumption lies in the fact that it allows us to define a series of local thermodynamic state variables at each spacetime point <span class="arithmatex">\((\vec{x}, t)\)</span>, such as local temperature <span class="arithmatex">\(T(\vec{x}, t)\)</span> and local pressure <span class="arithmatex">\(P(\vec{x}, t)\)</span>. It is precisely because of this that we can apply all the powerful tools and relations of equilibrium thermodynamics (such as the first law of thermodynamics, Gibbs relations, etc.) to describe a dynamically evolving, non-equilibrium fluid system.</p>
<h2 id="23-fundamental-fields-conserved-slow-variables">2.3 Fundamental Fields: Conserved Slow Variables<a class="headerlink" href="#23-fundamental-fields-conserved-slow-variables" title="Permanent link">&para;</a></h2>
<p>Based on the above assumptions, we need to choose a set of the most fundamental physical fields to describe the state of the fluid. Which fields should we choose? The guiding principle of theoretical physics is: <strong>choose the slow variables of the system, because they determine the macroscopic dynamics of the system at long times and large scales</strong>. In a fluid system, the "slowest" variables are precisely those <strong>conserved quantities</strong>, because their changes can only be accomplished through long-distance material transport.</p>
<p>For a <strong>simple fluid</strong> (i.e., a fluid composed of a single component), we choose the densities of the following three basic conserved fields to describe its state:</p>
<ol>
<li>
<p><strong>Mass density field</strong> <span class="arithmatex">\(\rho(\vec{x}, t)\)</span>: the mass of fluid per unit volume. This is our most basic scalar field.</p>
</li>
<li>
<p><strong>Momentum density field</strong> <span class="arithmatex">\(\vec{g}(\vec{x}, t)\)</span>: the momentum of fluid per unit volume. It is a vector field, closely related to the fluid's <strong>velocity field</strong> <span class="arithmatex">\(\vec{v}(\vec{x}, t)\)</span>, defined as:</p>
</li>
</ol>
<p><span class="arithmatex">\(<span class="arithmatex">\(\vec{g}(\vec{x}, t) = \rho(\vec{x}, t) \vec{v}(\vec{x}, t)\)</span>\)</span></p>
<p>The velocity field <span class="arithmatex">\(\vec{v}(\vec{x}, t)\)</span> will be one of the core variables we need to solve for.</p>
<ol>
<li><strong>Energy density field</strong> <span class="arithmatex">\(\epsilon(\vec{x}, t)\)</span>: in the construction of fluid dynamics, we usually focus on the <strong>internal energy per unit mass</strong>. The total energy density of the fluid also needs to consider the kinetic energy of macroscopic flow, which we will discuss in detail in the energy conservation section.</li>
</ol>
<p>Angular momentum is also a conserved quantity, but in the absence of internal spin or external torque, its dynamics can be derived from the evolution of the momentum field, so we do not take it as an independent fundamental field here.</p>
<p>With this set of basic assumptions and descriptive fields, we can now construct the corresponding dynamical equations for each conserved quantity.</p>
<h1 id="3-first-pillar-mass-conservation-and-the-continuity-equation">3. First Pillar: Mass Conservation and the Continuity Equation<a class="headerlink" href="#3-first-pillar-mass-conservation-and-the-continuity-equation" title="Permanent link">&para;</a></h1>
<h2 id="31-integral-form-physical-intuition">3.1 Integral Form: Physical Intuition<a class="headerlink" href="#31-integral-form-physical-intuition" title="Permanent link">&para;</a></h2>
<p>Now we begin to apply the conservation law framework established in the first section. The first, and simplest, fundamental pillar comes from the <strong>mass conservation law</strong>. Our task is to find the corresponding "density" and "flux" for the conserved quantity of mass.</p>
<p>We start from the most intuitive physical picture: consider an arbitrary fixed control volume <span class="arithmatex">\(V\)</span> in space with surface <span class="arithmatex">\(\partial V\)</span>. The physical intuition of mass conservation is: "the change in total mass within a closed volume can only be achieved through material flow across its boundary."</p>
<ul>
<li>
<p><strong>"Density"</strong>: The density describing mass is the <strong>mass density field</strong> <span class="arithmatex">\(\rho(\vec{x}, t)\)</span>. Therefore, the total mass within volume <span class="arithmatex">\(V\)</span> is <span class="arithmatex">\(M = \int_V dV \, \rho(\vec{x}, t)\)</span>.</p>
</li>
<li>
<p><strong>"Flux"</strong>: The physical quantity describing mass flow is the <strong>mass current</strong> or <strong>mass flux</strong> <span class="arithmatex">\(\vec{J}(\vec{x}, t)\)</span>. For a fluid with velocity <span class="arithmatex">\(\vec{v}\)</span>, this flux is intuitively equal to density times velocity: <span class="arithmatex">\(\vec{J}(\vec{x}, t) = \rho(\vec{x}, t) \vec{v}(\vec{x}, t)\)</span>.</p>
</li>
<li>
<p><strong>Conservation law</strong>: The rate of change of total mass within the volume must equal the <strong>net inflow</strong> of mass into that volume. The total flux flowing outward through surface <span class="arithmatex">\(\partial V\)</span> is <span class="arithmatex">\(\oint_{\partial V} d\vec{S} \cdot \vec{J}\)</span>, where <span class="arithmatex">\(d\vec{S} = \hat{n} dS\)</span> is the area element pointing outward from the volume. Therefore, the integral form of mass conservation can be written as:</p>
</li>
</ul>
<div class="arithmatex">\[\frac{d}{dt} \int_V dV \, \rho = -\oint_{\partial V} d\vec{S} \cdot \vec{J}\]</div>
<p>The negative sign on the right side of the equation indicates that when the net flux is positive (outward flow), the internal mass decreases.</p>
<p><img alt="Blackboard Screenshot" src="../../assets/images/remote/f70a1c9a-7a57-4d94-babc-7f82121ce3f6-035b01a218.png" /></p>
<h2 id="32-differential-form-local-conservation">3.2 Differential Form: Local Conservation<a class="headerlink" href="#32-differential-form-local-conservation" title="Permanent link">&para;</a></h2>
<p>The integral form describes the macroscopic behavior of the entire volume. To obtain a local equation applicable to every point in space, we use <strong>Gauss's Divergence Theorem</strong> to convert the surface integral in the above equation into a volume integral:</p>
<div class="arithmatex">\[\oint_{\partial V} d\vec{S} \cdot \vec{J} = \int_V dV (\nabla \cdot \vec{J})\]</div>
<p>Substituting into the integral form of the conservation equation and moving the time derivative inside the integral, we get:</p>
<div class="arithmatex">\[\int_V dV \left( \frac{\partial \rho}{\partial t} + \nabla \cdot \vec{J} \right) = 0\]</div>
<p>Since this relationship must hold for <strong>arbitrarily chosen</strong> control volumes <span class="arithmatex">\(V\)</span>, the integrand itself must be zero everywhere. Thus, we obtain the differential form of mass conservation, the <strong>continuity equation</strong>:</p>
<div class="arithmatex">\[\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \vec{v}) = 0\]</div>
<p>This equation is the first fundamental equation of fluid dynamics. It perfectly embodies the conservation law structure of Model B and lays the foundation for us to derive other equations next.</p>
<h1 id="4-second-pillar-momentum-conservation-and-the-euler-equation">4. Second Pillar: Momentum Conservation and the Euler Equation<a class="headerlink" href="#4-second-pillar-momentum-conservation-and-the-euler-equation" title="Permanent link">&para;</a></h1>
<p>After establishing mass conservation, we now turn to the next conserved quantity—momentum. The description of momentum conservation will reveal to us the dynamical laws of how fluids move. For an ideal fluid without viscosity (i.e., frictionless), this law is given by the famous <strong>Euler equation</strong>.</p>
<h2 id="41-material-derivative-bridging-lagrangian-and-eulerian-views">4.1 Material Derivative: Bridging Lagrangian and Eulerian Views<a class="headerlink" href="#41-material-derivative-bridging-lagrangian-and-eulerian-views" title="Permanent link">&para;</a></h2>
<p>When deriving dynamical equations, we face a core perspective problem: Newton's second law (<span class="arithmatex">\(\vec{F}=m\vec{a}\)</span>) is applied to a specific object (i.e., a particular "fluid element"), describing the acceleration that this object <strong>experiences itself</strong>. This is a "go with the flow" <strong>Lagrangian view</strong>. However, the field theory we have established describes how physical fields evolve in a fixed laboratory coordinate system, which is a "stand and observe" <strong>Eulerian view</strong>.</p>
<p>To build a bridge between these two perspectives, we need a mathematical tool that can answer this question: "What is the total rate of change of a physical quantity <span class="arithmatex">\(f\)</span> experienced by a particle following the fluid motion?" This tool is the <strong>material derivative</strong>, denoted <span class="arithmatex">\(\frac{D f}{D t}\)</span>.</p>
<p>A particle following the fluid motion experiences changes in the physical quantity <span class="arithmatex">\(f(\vec{x}, t)\)</span> from two parts:</p>
<ol>
<li>
<p><strong>Local change</strong>: Even if the particle doesn't move, the value of <span class="arithmatex">\(f\)</span> at its location <span class="arithmatex">\(\vec{x}\)</span> may change over time, described by the partial derivative <span class="arithmatex">\(\frac{\partial f}{\partial t}\)</span>.</p>
</li>
<li>
<p><strong>Convective change</strong>: The particle is "carried" by the velocity field <span class="arithmatex">\(\vec{v}\)</span> to a new position, and the value of <span class="arithmatex">\(f\)</span> at the new position is different from that at the original position. This change caused by position movement is called <strong>convection</strong>, described by <span class="arithmatex">\((\vec{v} \cdot \nabla)f\)</span>.</p>
</li>
</ol>
<p>Adding the two together, we get the complete expression for the material derivative:</p>
<div class="arithmatex">\[\frac{D f}{D t} = \frac{\partial f}{\partial t} + (\vec{v} \cdot \vec{\nabla})f\]</div>
<p>This derivative perfectly combines the field change in the Eulerian view (<span class="arithmatex">\(\frac{\partial f}{\partial t}\)</span>) with the particle motion in the Lagrangian view (<span class="arithmatex">\(\vec{v}\)</span>).</p>
<h2 id="42-euler-equation-newtons-second-law-for-a-fluid-element">4.2 Euler Equation: Newton’s Second Law for a Fluid Element<a class="headerlink" href="#42-euler-equation-newtons-second-law-for-a-fluid-element" title="Permanent link">&para;</a></h2>
<p>Now we can apply Newton's second law <span class="arithmatex">\(\vec{F} = m \vec{a}\)</span> to a fluid element with volume <span class="arithmatex">\(dV\)</span>:</p>
<ul>
<li><strong>Mass</strong> <span class="arithmatex">\(m\)</span>: <span class="arithmatex">\(m = \rho dV\)</span>.</li>
<li><strong>Acceleration</strong> <span class="arithmatex">\(\vec{a}\)</span>: The acceleration of the fluid element is the rate of change of its velocity <strong>following the fluid motion</strong>, so we must use the material derivative: <span class="arithmatex">\(\vec{a} = \frac{D\vec{v}}{Dt}\)</span>.</li>
<li><strong>Force</strong> <span class="arithmatex">\(\vec{F}\)</span>: For an ideal fluid without friction, the only force acting on the fluid element comes from the <strong>pressure</strong> of the surrounding fluid. The net pressure on a fluid element comes from the pressure difference across its surface, and this net force equals the <strong>negative gradient</strong> of pressure times volume: <span class="arithmatex">\(\vec{F} = -(\nabla P) dV\)</span>.</li>
</ul>
<p>Substituting these three terms into Newton's second law:</p>
<div class="arithmatex">\[(\rho dV) \frac{D\vec{v}}{Dt} = -(\nabla P) dV\]</div>
<p>Canceling <span class="arithmatex">\(dV\)</span> and expanding the material derivative, we obtain the final form of the <strong>Euler equation</strong>:</p>
<div class="arithmatex">\[\rho \left( \frac{\partial \vec{v}}{\partial t} + (\vec{v} \cdot \nabla) \vec{v} \right) = -\nabla P\]</div>
<p>This equation describes how the velocity field of an inviscid fluid evolves in time and space due to pressure gradients. The <strong>nonlinear convective term</strong> <span class="arithmatex">\((\vec{v} \cdot \nabla) \vec{v}\)</span> is the core source of the richness and complexity of fluid mechanics. It is precisely this term of the velocity field multiplied by its own gradient that dominates the self-transport of momentum in the fluid and ultimately leads to complex fluid phenomena such as turbulence and vortices.</p>
<h2 id="43-momentum-flux-tensor-a-unified-conservation-form">4.3 Momentum Flux Tensor: A Unified Conservation Form<a class="headerlink" href="#43-momentum-flux-tensor-a-unified-conservation-form" title="Permanent link">&para;</a></h2>
<p>To maintain consistency with the form of mass conservation, we can use the continuity equation to strictly rewrite Euler's equation into the "density-flux" form of momentum conservation:</p>
<div class="arithmatex">\[\frac{\partial (\rho v_i)}{\partial t} = -\sum_k \frac{\partial \Pi_{ik}}{\partial x_k}\]</div>
<p>Here the "density" is the <span class="arithmatex">\(i\)</span>-th component of momentum <span class="arithmatex">\(\rho v_i\)</span>, while the "flux" is a more complex object—the <strong>momentum flux tensor</strong> <span class="arithmatex">\(\Pi_{ik}\)</span>. For an inviscid fluid, it is defined as:</p>
<div class="arithmatex">\[\Pi_{ik} = P \delta_{ik} + \rho v_i v_k\]</div>
<p>The physical meaning of this second-order tensor <span class="arithmatex">\(\Pi_{ik}\)</span> is: <strong>the transport of the <span class="arithmatex">\(i\)</span>-th component of momentum through a unit area with normal pointing in the <span class="arithmatex">\(k\)</span>-th direction per unit time</strong>. It is contributed by two completely different physical processes:</p>
<ol>
<li>
<p><strong>Hydrostatic pressure term</strong> <span class="arithmatex">\(P \delta_{ik}\)</span>: This represents momentum exchange due to random thermal motion of molecules, manifesting as macroscopic isotropic pressure. The <strong>Kronecker delta</strong> <span class="arithmatex">\(\delta_{ik}\)</span> ensures that it only contributes normal stress.</p>
</li>
<li>
<p><strong>Convective transport term</strong> <span class="arithmatex">\(\rho v_i v_k\)</span>: This represents momentum transport carried by the macroscopic overall motion of the fluid. It is the result of the <span class="arithmatex">\(i\)</span>-th component of momentum being "carried" by the <span class="arithmatex">\(k\)</span>-th component of velocity through the plane. This is an anisotropic contribution whose magnitude and direction depend on the flow direction. This term is also called a <strong>dyadic product</strong>.</p>
</li>
</ol>
<p>By introducing the momentum flux tensor, we successfully unify the complex Euler equation into the universal conservation law framework of <span class="arithmatex">\(\frac{\partial (\text{density})}{\partial t} + \nabla \cdot (\text{flux}) = 0\)</span>.</p>
<h2 id="44-visualization-python-advection-of-a-scalar-field">4.4 Visualization: Python Advection of a Scalar Field<a class="headerlink" href="#44-visualization-python-advection-of-a-scalar-field" title="Permanent link">&para;</a></h2>
<p>Before letting a vector field advect itself, visualize how a given velocity field transports a scalar concentration <span class="arithmatex">\(c\)</span>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="kn">import</span> <span class="n">FuncAnimation</span>

<span class="c1"># --- 1. Set simulation parameters ---</span>
<span class="n">L</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">n_steps</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># angular speed for solid-body rotation</span>

<span class="c1"># --- 2. Create grid and field ---</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Initial scalar field: a Gaussian &quot;dye drop&quot;</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">X</span> <span class="o">-</span> <span class="n">L</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Velocity field: a vortex rotating around the origin</span>
<span class="n">vx</span> <span class="o">=</span> <span class="o">-</span><span class="n">omega</span> <span class="o">*</span> <span class="n">Y</span>
<span class="n">vy</span> <span class="o">=</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">X</span>

<span class="c1"># --- 3. Set up plot ---</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot scalar field c</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">L</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span>
               <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Concentration&#39;</span><span class="p">)</span>

<span class="c1"># Plot velocity field v (plot every 10 points to keep it clear)</span>
<span class="n">skip</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span> <span class="n">Y</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span>
          <span class="n">vx</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span> <span class="n">vy</span><span class="p">[::</span><span class="n">skip</span><span class="p">,</span> <span class="p">::</span><span class="n">skip</span><span class="p">],</span>
          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Advection of a Scalar Field (t=0.00)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># --- 4. Define animation update function ---</span>
<span class="k">def</span><span class="w"> </span><span class="nf">animate</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">c</span>
    <span class="c1"># Calculate gradient of scalar field</span>
    <span class="c1"># np.gradient returns dy, dx order</span>
    <span class="n">grad_c_y</span><span class="p">,</span> <span class="n">grad_c_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="c1"># Calculate advection term v dot grad(c)</span>
    <span class="n">advection_term</span> <span class="o">=</span> <span class="n">vx</span> <span class="o">*</span> <span class="n">grad_c_x</span> <span class="o">+</span> <span class="n">vy</span> <span class="o">*</span> <span class="n">grad_c_y</span>

    <span class="c1"># Update scalar field using forward Euler method</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">c</span> <span class="o">-</span> <span class="n">advection_term</span> <span class="o">*</span> <span class="n">dt</span>

    <span class="c1"># Update image data</span>
    <span class="n">im</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Advection of a Scalar Field (t=</span><span class="si">{</span><span class="n">frame</span><span class="o">*</span><span class="n">dt</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">im</span><span class="p">]</span>

<span class="c1"># --- 5. Create and run animation ---</span>
<span class="n">ani</span> <span class="o">=</span> <span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="n">n_steps</span><span class="p">,</span>
                    <span class="n">interval</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># --- 6. Save animation as GIF file ---</span>
<span class="c1"># Requires ImageMagick or ffmpeg</span>
<span class="n">ani</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;advection.gif&#39;</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="s1">&#39;pillow&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="Run Output" src="../../assets/images/remote/advection.gif" /></p>
<ul>
<li>Transport: the dye swirls around under the velocity field.</li>
<li>Deformation: because the velocity varies in space, the drop is stretched and twisted.</li>
</ul>
<p>This illustrates the meaning of <span class="arithmatex">\((\mathbf{v}\cdot\nabla)f\)</span>: advection redistributes a field by the flow. In Euler’s equation the advected field is <span class="arithmatex">\(\mathbf{v}\)</span> itself—momentum is transported by the fluid.</p>
<h1 id="5-third-pillar-energy-conservation-and-isentropic-flow">5. Third Pillar: Energy Conservation and Isentropic Flow<a class="headerlink" href="#5-third-pillar-energy-conservation-and-isentropic-flow" title="Permanent link">&para;</a></h1>
<p>After establishing mass and momentum conservation, we now derive the last and most profound conservation law—<strong>energy conservation</strong>. As the professor mentioned, this derivation is not so intuitive because it requires us to closely combine the dynamical equations we derived earlier with <strong>thermodynamics</strong>. This process will ultimately reveal a crucial thermodynamic property of inviscid fluids.</p>
<p>The total energy of a fluid element consists of two parts: <strong>kinetic energy</strong> contributed by macroscopic overall motion and <strong>internal energy</strong> contributed by random microscopic molecular motion. Therefore, the total energy density per unit volume is:</p>
<div class="arithmatex">\[e_{\text{total}} = \frac{1}{2} \rho v^2 + \rho \epsilon\]</div>
<p>where <span class="arithmatex">\(\epsilon\)</span> is the <strong>internal energy per unit mass</strong>. Our goal is still to find the corresponding <strong>energy current</strong> <span class="arithmatex">\(\vec{J}^{(\epsilon)}\)</span> for this conserved energy density, such that it satisfies the general form of conservation law: <span class="arithmatex">\(\frac{\partial e_{\text{total}}}{\partial t} = -\nabla \cdot \vec{J}^{(\epsilon)}\)</span>.</p>
<h2 id="52-derivation-of-energy-conservation">5.2 Derivation of Energy Conservation<a class="headerlink" href="#52-derivation-of-energy-conservation" title="Permanent link">&para;</a></h2>
<p>This is a relatively complex derivation. We will follow the classroom approach, dividing the total energy into kinetic and internal energy parts and calculating their time derivatives separately.</p>
<h3 id="1-time-derivative-of-the-kinetic-energy-term">1. Time derivative of the kinetic energy term:<a class="headerlink" href="#1-time-derivative-of-the-kinetic-energy-term" title="Permanent link">&para;</a></h3>
<p>We first calculate the time derivative of kinetic energy density <span class="arithmatex">\(\frac{1}{2} \rho v^2\)</span>. Using the product rule and substituting the <strong>continuity equation</strong> we derived (for <span class="arithmatex">\(\partial_t \rho\)</span>) and <strong>Euler's equation</strong> (for <span class="arithmatex">\(\partial_t \vec{v}\)</span>), after a series of algebraic operations, we obtain:</p>
<div class="arithmatex">\[\frac{\partial}{\partial t} \left( \frac{1}{2} \rho v^2 \right) = -\nabla \cdot \left( \rho \vec{v} \frac{1}{2} v^2 \right) - \vec{v} \cdot \nabla P\]</div>
<p>The physical meaning of this expression is: the local change in kinetic energy density comes partly from the convection of kinetic energy (first term, a perfect flux divergence form) and partly from the work done by pressure gradients on the fluid (second term).</p>
<p>2) Thermodynamics:</p>
<p>Local equilibrium implies the Gibbs relation for the specific internal energy <span class="arithmatex">\(\epsilon\)</span>,</p>
<div class="arithmatex">\[d\epsilon = T\,ds + \frac{P}{\rho^2}d\rho,\]</div>
<p>and it is convenient to introduce the specific enthalpy <span class="arithmatex">\(h=\epsilon + P/\rho\)</span> with <span class="arithmatex">\(dh=T\,ds + (1/\rho)\,dP\)</span>.</p>
<p>3) Combine and simplify:</p>
<p>With these relations, the total energy balance becomes</p>
<div class="arithmatex">\[\frac{\partial}{\partial t}\Big(\tfrac{1}{2}\rho v^2 + \rho\epsilon\Big) = -\nabla\cdot\big[\rho\mathbf{v}\,(\tfrac{1}{2}v^2 + h)\big] + \rho T\Big(\frac{\partial s}{\partial t} + (\mathbf{v}\cdot\nabla)s\Big).\]</div>
<h2 id="53-isentropic-condition-a-consequence-of-inviscid-flow">5.3 Isentropic Condition: A Consequence of Inviscid Flow<a class="headerlink" href="#53-isentropic-condition-a-consequence-of-inviscid-flow" title="Permanent link">&para;</a></h2>
<p>For ideal flow without viscosity or heat conduction, there are no irreversible sources of entropy. Hence the advected entropy is constant:</p>
<p>Observing the final form of the above equation, it is almost a perfect conservation equation, except for the last term. The left side is the time derivative of energy density, and the first term on the right side is the divergence of a flux. For energy to be truly conserved, the <strong>source/sink term</strong> on the right side of the equation must be zero. This means:</p>
<div class="arithmatex">\[\rho T \left( \frac{\partial s}{\partial t} + (\vec{v} \cdot \vec{\nabla}) s \right) = \rho T \frac{Ds}{Dt} = 0\]</div>
<p>Since <span class="arithmatex">\(\rho\)</span> and <span class="arithmatex">\(T\)</span> are usually non-zero, we obtain a profound physical conclusion:</p>
<div class="arithmatex">\[\frac{Ds}{Dt} = 0\]</div>
<p>The meaning of this equation is: for an ideal fluid without friction and heat conduction, <strong>every fluid element maintains constant entropy as it follows the fluid motion</strong>. This type of flow is called <strong>isentropic flow</strong>. This is precisely the inevitable thermodynamic result of our initial "frictionless, non-dissipative" assumption: because there is no internal friction producing irreversible heat, the evolution of fluid elements is reversible, so their entropy does not increase.</p>
<p>Thus each fluid element carries constant entropy (isentropic flow), and the energy equation becomes a pure conservation law with flux <span class="arithmatex">\(\mathbf{J}^{(\epsilon)}=\rho\mathbf{v}(\tfrac{1}{2}v^2 + h)\)</span>.</p>
<h2 id="54-physical-meaning-of-the-energy-flux">5.4 Physical Meaning of the Energy Flux<a class="headerlink" href="#54-physical-meaning-of-the-energy-flux" title="Permanent link">&para;</a></h2>
<p>The energy flux combines transport of kinetic energy and enthalpy by the flow—a compact way to express mechanical work and internal‑energy transport under isentropic, inviscid conditions.</p>
<h2 id="55-code-practice-eulerian-fluid-simulation-conjugate-gradient">5.5 Code Practice: Eulerian Fluid Simulation (Conjugate Gradient)<a class="headerlink" href="#55-code-practice-eulerian-fluid-simulation-conjugate-gradient" title="Permanent link">&para;</a></h2>
<p>We will adopt a more direct <strong>macroscopic approach</strong>—a solver based on <strong>Eulerian grids</strong> that directly performs numerical solutions of fluid dynamics equations. The algorithm we will implement is the very classic "Stable Fluids" method in the field of computer graphics.</p>
<p>The core of this algorithm is to decompose the evolution of the fluid into several physically clear steps and execute them sequentially at each time step:</p>
<ol>
<li>
<p><strong>Advection</strong>: This step is responsible for moving the physical properties of the fluid itself, such as velocity and color (dye). It answers the question: "Where will the fluid at the current position move to in the next moment?" We adopt an efficient <strong>semi-Lagrangian method</strong> that calculates which position from the previous time step the physical quantity at the current grid point should "inherit" from through time backtracking.</p>
</li>
<li>
<p><strong>External Forces</strong>: In this step, we can add various forces or sources to the fluid. In our simulation, this mainly manifests as continuously "injecting" new dye and velocity from a specified region.</p>
</li>
<li>
<p><strong>Projection</strong>: This is the <strong>most critical step</strong> for ensuring realistic and natural fluid motion. Its sole goal is to ensure that the flow field satisfies <strong>incompressibility</strong>, i.e., the divergence of the fluid is zero (<span class="arithmatex">\(\nabla \cdot \vec{v} = 0\)</span>). This step itself is divided into three subtasks:
   a. Calculate the <strong>divergence</strong> of the current velocity field to find regions that do not satisfy the incompressibility condition.
   b. Solve a <strong>pressure Poisson equation</strong>, i.e., <span class="arithmatex">\(\nabla^2 p = \nabla \cdot \vec{v}\)</span>. The solved pressure field <span class="arithmatex">\(p\)</span> tells us where pressure needs to be applied to "correct" the fluid flow direction.
   c. Use the calculated pressure gradient <span class="arithmatex">\(\nabla p\)</span> to correct the velocity field, ultimately obtaining a new velocity field with zero divergence that satisfies the incompressibility condition.</p>
</li>
</ol>
<p>We will use the powerful <strong>conjugate gradient method</strong> to efficiently solve the pressure Poisson equation and utilize the parallel computing capabilities of the <code>Taichi</code> framework to accelerate the entire simulation process.</p>
<p>The following Taichi implementation demonstrates an Eulerian fluid solver with projection (pressure Poisson equation solved by CG), semi‑Lagrangian advection, and an RGB dye field.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">taichi</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ti</span>

<span class="n">ti</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">gpu</span><span class="p">)</span>

<span class="c1"># General settings</span>
<span class="n">resolutionX</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">pixels</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">resolutionX</span><span class="p">,</span> <span class="n">resolutionX</span><span class="p">))</span>  <span class="c1"># Use RGB color</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">pause</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">temp_dye</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">pixel_mid</span> <span class="o">=</span> <span class="n">resolutionX</span> <span class="o">//</span> <span class="mi">2</span>
<span class="n">ix_length</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">iy_length</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">area</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="n">pixel_mid</span> <span class="o">-</span> <span class="n">iy_length</span><span class="p">,</span> <span class="mi">8</span> <span class="o">+</span> <span class="n">ix_length</span><span class="p">,</span> <span class="n">pixel_mid</span> <span class="o">+</span> <span class="n">iy_length</span><span class="p">])</span>
<span class="n">inflow_velocity</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>

<span class="c1"># Grid settings</span>
<span class="n">_velocities</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">resolutionX</span><span class="p">,</span> <span class="n">resolutionX</span><span class="p">))</span>
<span class="n">_new_velocities</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">resolutionX</span><span class="p">,</span> <span class="n">resolutionX</span><span class="p">))</span>
<span class="n">velocity_divs</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">resolutionX</span><span class="p">,</span> <span class="n">resolutionX</span><span class="p">))</span>
<span class="n">_pressures</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">resolutionX</span><span class="p">,</span> <span class="n">resolutionX</span><span class="p">))</span>
<span class="n">_new_pressures</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">resolutionX</span><span class="p">,</span> <span class="n">resolutionX</span><span class="p">))</span>
<span class="n">_dye_buffer</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">resolutionX</span><span class="p">,</span> <span class="n">resolutionX</span><span class="p">))</span>  <span class="c1"># RGB dye</span>
<span class="n">_new_dye_buffer</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">resolutionX</span><span class="p">,</span> <span class="n">resolutionX</span><span class="p">))</span>

<span class="c1"># CG settings</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">resolutionX</span> <span class="o">*</span> <span class="n">resolutionX</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">resolutionX</span> <span class="o">*</span> <span class="n">resolutionX</span><span class="p">)</span>
<span class="n">Ax</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">resolutionX</span> <span class="o">*</span> <span class="n">resolutionX</span><span class="p">)</span>
<span class="n">Ap</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">resolutionX</span> <span class="o">*</span> <span class="n">resolutionX</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">resolutionX</span> <span class="o">*</span> <span class="n">resolutionX</span><span class="p">)</span>
<span class="n">new_r</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">resolutionX</span> <span class="o">*</span> <span class="n">resolutionX</span><span class="p">)</span>

<span class="c1"># TexPair class for buffer swapping</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TexPair</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cur</span><span class="p">,</span> <span class="n">nxt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cur</span> <span class="o">=</span> <span class="n">cur</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nxt</span> <span class="o">=</span> <span class="n">nxt</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">swap</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cur</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nxt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nxt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cur</span>

<span class="c1"># Interpolation functions</span>
<span class="nd">@ti</span><span class="o">.</span><span class="n">func</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">qf</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">res</span><span class="p">):</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">res</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
    <span class="n">j</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">res</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">qf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">func</span>
<span class="k">def</span><span class="w"> </span><span class="nf">lerp</span><span class="p">(</span><span class="n">vl</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span> <span class="n">frac</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">vl</span> <span class="o">+</span> <span class="n">frac</span> <span class="o">*</span> <span class="p">(</span><span class="n">vr</span> <span class="o">-</span> <span class="n">vl</span><span class="p">)</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">func</span>
<span class="k">def</span><span class="w"> </span><span class="nf">bilerp</span><span class="p">(</span><span class="n">vf</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">res</span><span class="p">):</span>
    <span class="n">s</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">u</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">v</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">iu</span><span class="p">,</span> <span class="n">iv</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">fu</span><span class="p">,</span> <span class="n">fv</span> <span class="o">=</span> <span class="n">s</span> <span class="o">-</span> <span class="n">iu</span><span class="p">,</span> <span class="n">t</span> <span class="o">-</span> <span class="n">iv</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">sample</span><span class="p">(</span><span class="n">vf</span><span class="p">,</span> <span class="n">iu</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">iv</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">sample</span><span class="p">(</span><span class="n">vf</span><span class="p">,</span> <span class="n">iu</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">iv</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">sample</span><span class="p">(</span><span class="n">vf</span><span class="p">,</span> <span class="n">iu</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">iv</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">sample</span><span class="p">(</span><span class="n">vf</span><span class="p">,</span> <span class="n">iu</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">iv</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lerp</span><span class="p">(</span><span class="n">lerp</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">fu</span><span class="p">),</span> <span class="n">lerp</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">fu</span><span class="p">),</span> <span class="n">fv</span><span class="p">)</span>

<span class="n">velocities_pair</span> <span class="o">=</span> <span class="n">TexPair</span><span class="p">(</span><span class="n">_velocities</span><span class="p">,</span> <span class="n">_new_velocities</span><span class="p">)</span>
<span class="n">pressures_pair</span> <span class="o">=</span> <span class="n">TexPair</span><span class="p">(</span><span class="n">_pressures</span><span class="p">,</span> <span class="n">_new_pressures</span><span class="p">)</span>
<span class="n">dyes_pair</span> <span class="o">=</span> <span class="n">TexPair</span><span class="p">(</span><span class="n">_dye_buffer</span><span class="p">,</span> <span class="n">_new_dye_buffer</span><span class="p">)</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">func</span>
<span class="k">def</span><span class="w"> </span><span class="nf">vel_with_boundary</span><span class="p">(</span><span class="n">vf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">(),</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">:</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span> <span class="o">==</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">i</span> <span class="o">==</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">vf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">vf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">vf</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">vf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">vf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">vf</span><span class="p">[</span><span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">vf</span><span class="p">[</span><span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">vf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">vf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">vf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">func</span>
<span class="k">def</span><span class="w"> </span><span class="nf">p_with_boundary</span><span class="p">(</span><span class="n">pf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">(),</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">:</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span> <span class="o">==</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">i</span> <span class="o">==</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">pf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pf</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">pf</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">pf</span><span class="p">[</span><span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">pf</span><span class="p">[</span><span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">pf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">apply_vel_bc</span><span class="p">(</span><span class="n">vf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">()):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">vf</span><span class="p">:</span>
        <span class="n">vel_with_boundary</span><span class="p">(</span><span class="n">vf</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">apply_p_bc</span><span class="p">(</span><span class="n">pf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">()):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">pf</span><span class="p">:</span>
        <span class="n">p_with_boundary</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">advect</span><span class="p">(</span><span class="n">vf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">(),</span> <span class="n">qf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">(),</span> <span class="n">new_qf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">()):</span>
    <span class="k">for</span> <span class="n">IX</span><span class="p">,</span> <span class="n">IY</span> <span class="ow">in</span> <span class="n">vf</span><span class="p">:</span>
        <span class="c1"># Backtrace using semi-Lagrangian with 2nd order Runge-Kutta</span>
        <span class="n">coord_curr</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span><span class="n">IX</span><span class="p">,</span> <span class="n">IY</span><span class="p">])</span> <span class="o">+</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
        <span class="n">vel_curr</span> <span class="o">=</span> <span class="n">vf</span><span class="p">[</span><span class="n">IX</span><span class="p">,</span> <span class="n">IY</span><span class="p">]</span>
        <span class="n">coord_mid</span> <span class="o">=</span> <span class="n">coord_curr</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">vel_curr</span>
        <span class="n">vel_mid</span> <span class="o">=</span> <span class="n">bilerp</span><span class="p">(</span><span class="n">vf</span><span class="p">,</span> <span class="n">coord_mid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coord_mid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">resolutionX</span><span class="p">)</span>
        <span class="n">coord_prev</span> <span class="o">=</span> <span class="n">coord_curr</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">vel_mid</span>
        <span class="n">q_prev</span> <span class="o">=</span> <span class="n">bilerp</span><span class="p">(</span><span class="n">qf</span><span class="p">,</span> <span class="n">coord_prev</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coord_prev</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">resolutionX</span><span class="p">)</span>
        <span class="n">new_qf</span><span class="p">[</span><span class="n">IX</span><span class="p">,</span> <span class="n">IY</span><span class="p">]</span> <span class="o">=</span> <span class="n">q_prev</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">addInflow</span><span class="p">(</span><span class="n">qf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">(),</span> <span class="n">area</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">(),</span> <span class="n">quality</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">()):</span>
    <span class="n">bl_ix</span><span class="p">,</span> <span class="n">bl_iy</span><span class="p">,</span> <span class="n">tr_ix</span><span class="p">,</span> <span class="n">tr_iy</span> <span class="o">=</span> <span class="n">area</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">qf</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bl_ix</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">tr_ix</span> <span class="ow">and</span> <span class="n">bl_iy</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">tr_iy</span><span class="p">:</span>
            <span class="n">qf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">quality</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fill_color</span><span class="p">(</span><span class="n">ipixels</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">(),</span> <span class="n">idyef</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">()):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">ipixels</span><span class="p">:</span>
        <span class="n">density</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ti</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">idyef</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">norm</span><span class="p">()))</span>
        <span class="n">ipixels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span>
            <span class="n">ti</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">density</span> <span class="o">*</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
            <span class="n">ti</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">density</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">),</span>
            <span class="n">ti</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">density</span> <span class="o">*</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="p">])</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">func</span>
<span class="k">def</span><span class="w"> </span><span class="nf">coeff_matrix</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">resolutionX</span> <span class="o">*</span> <span class="n">resolutionX</span>
    <span class="n">IY</span> <span class="o">=</span> <span class="n">row</span> <span class="o">//</span> <span class="n">resolutionX</span>
    <span class="n">IX</span> <span class="o">=</span> <span class="n">row</span> <span class="o">-</span> <span class="n">resolutionX</span> <span class="o">*</span> <span class="n">IY</span>
    <span class="k">if</span> <span class="n">row</span> <span class="o">&gt;=</span> <span class="n">n</span> <span class="ow">or</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">col</span> <span class="o">&gt;=</span> <span class="n">n</span> <span class="ow">or</span> <span class="n">col</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">IX</span> <span class="o">==</span> <span class="n">IY</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">IX</span> <span class="o">==</span> <span class="n">IY</span> <span class="o">==</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">IX</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">IY</span> <span class="o">==</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="n">IX</span> <span class="o">==</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">IY</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="n">col</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="n">row</span> <span class="o">==</span> <span class="n">col</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.0</span>
        <span class="k">elif</span> <span class="n">ti</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">col</span> <span class="o">-</span> <span class="n">row</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">elif</span> <span class="n">ti</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">col</span> <span class="o">-</span> <span class="n">row</span><span class="p">)</span> <span class="o">==</span> <span class="n">resolutionX</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">func</span>
<span class="k">def</span><span class="w"> </span><span class="nf">visit_vector</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">(),</span> <span class="n">vid</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">if</span> <span class="n">vid</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">vid</span> <span class="o">&gt;=</span> <span class="n">length</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">vid</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">func</span>
<span class="k">def</span><span class="w"> </span><span class="nf">visit_pf_vector</span><span class="p">(</span><span class="n">pf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">(),</span> <span class="n">vid</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">resolutionX</span> <span class="o">*</span> <span class="n">resolutionX</span>
    <span class="k">if</span> <span class="n">vid</span> <span class="o">&gt;=</span> <span class="n">n</span> <span class="ow">or</span> <span class="n">vid</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">IY</span> <span class="o">=</span> <span class="n">vid</span> <span class="o">//</span> <span class="n">resolutionX</span>
        <span class="n">IX</span> <span class="o">=</span> <span class="n">vid</span> <span class="o">-</span> <span class="n">resolutionX</span> <span class="o">*</span> <span class="n">IY</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">pf</span><span class="p">[</span><span class="n">IX</span><span class="p">,</span> <span class="n">IY</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pressure_cg_init</span><span class="p">(</span><span class="n">pf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">(),</span> <span class="n">b</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">()):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">resolutionX</span> <span class="o">*</span> <span class="n">resolutionX</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">ve1</span> <span class="o">=</span> <span class="n">visit_pf_vector</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">row</span> <span class="o">-</span> <span class="n">resolutionX</span><span class="p">)</span>
        <span class="n">ve2</span> <span class="o">=</span> <span class="n">visit_pf_vector</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ve3</span> <span class="o">=</span> <span class="n">visit_pf_vector</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
        <span class="n">ve4</span> <span class="o">=</span> <span class="n">visit_pf_vector</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ve5</span> <span class="o">=</span> <span class="n">visit_pf_vector</span><span class="p">(</span><span class="n">pf</span><span class="p">,</span> <span class="n">row</span> <span class="o">+</span> <span class="n">resolutionX</span><span class="p">)</span>
        <span class="n">me1</span> <span class="o">=</span> <span class="n">coeff_matrix</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">row</span> <span class="o">-</span> <span class="n">resolutionX</span><span class="p">)</span>
        <span class="n">me2</span> <span class="o">=</span> <span class="n">coeff_matrix</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">row</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">me3</span> <span class="o">=</span> <span class="n">coeff_matrix</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
        <span class="n">me4</span> <span class="o">=</span> <span class="n">coeff_matrix</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">me5</span> <span class="o">=</span> <span class="n">coeff_matrix</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">row</span> <span class="o">+</span> <span class="n">resolutionX</span><span class="p">)</span>

        <span class="n">temp_Ax</span> <span class="o">=</span> <span class="n">me1</span> <span class="o">*</span> <span class="n">ve1</span> <span class="o">+</span> <span class="n">me2</span> <span class="o">*</span> <span class="n">ve2</span> <span class="o">+</span> <span class="n">me3</span> <span class="o">*</span> <span class="n">ve3</span> <span class="o">+</span> <span class="n">me4</span> <span class="o">*</span> <span class="n">ve4</span> <span class="o">+</span> <span class="n">me5</span> <span class="o">*</span> <span class="n">ve5</span>

        <span class="n">Ax</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_Ax</span>
        <span class="n">r</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">-</span> <span class="n">Ax</span><span class="p">[</span><span class="n">row</span><span class="p">]</span>
        <span class="n">p</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">row</span><span class="p">]</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pressure_cg_iter</span><span class="p">(</span><span class="n">pf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">resolutionX</span> <span class="o">*</span> <span class="n">resolutionX</span>
    <span class="n">rkT_rk</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">pkT_A_pk</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">rkT_rk</span> <span class="o">+=</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">ve1</span> <span class="o">=</span> <span class="n">visit_vector</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">resolutionX</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">ve2</span> <span class="o">=</span> <span class="n">visit_vector</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">ve3</span> <span class="o">=</span> <span class="n">visit_vector</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">ve5</span> <span class="o">=</span> <span class="n">visit_vector</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">resolutionX</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">me1</span> <span class="o">=</span> <span class="n">coeff_matrix</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="n">resolutionX</span><span class="p">)</span>
        <span class="n">me2</span> <span class="o">=</span> <span class="n">coeff_matrix</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">me3</span> <span class="o">=</span> <span class="n">coeff_matrix</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">me4</span> <span class="o">=</span> <span class="n">coeff_matrix</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">me5</span> <span class="o">=</span> <span class="n">coeff_matrix</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">resolutionX</span><span class="p">)</span>

        <span class="n">temp_Ap</span> <span class="o">=</span> <span class="n">me1</span> <span class="o">*</span> <span class="n">ve1</span> <span class="o">+</span> <span class="n">me2</span> <span class="o">*</span> <span class="n">ve2</span> <span class="o">+</span> <span class="n">me3</span> <span class="o">*</span> <span class="n">ve3</span> <span class="o">+</span> <span class="n">me4</span> <span class="o">*</span> <span class="n">ve4</span> <span class="o">+</span> <span class="n">me5</span> <span class="o">*</span> <span class="n">ve5</span>
        <span class="n">Ap</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_Ap</span>
        <span class="n">pkT_A_pk</span> <span class="o">+=</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">temp_Ap</span><span class="p">)</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="n">rkT_rk</span> <span class="o">/</span> <span class="n">pkT_A_pk</span>
    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">top</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">bottom</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">IY</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">resolutionX</span>
        <span class="n">IX</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">resolutionX</span> <span class="o">*</span> <span class="n">IY</span>
        <span class="n">new_pf_val</span> <span class="o">=</span> <span class="n">pf</span><span class="p">[</span><span class="n">IX</span><span class="p">,</span> <span class="n">IY</span><span class="p">]</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">new_pf_val</span> <span class="o">-</span> <span class="n">pf</span><span class="p">[</span><span class="n">IX</span><span class="p">,</span> <span class="n">IY</span><span class="p">])</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="p">(</span><span class="n">diff</span> <span class="o">*</span> <span class="n">diff</span><span class="p">)</span>
        <span class="n">pf</span><span class="p">[</span><span class="n">IX</span><span class="p">,</span> <span class="n">IY</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_pf_val</span>
        <span class="n">new_r_val</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">Ap</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">new_r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_r_val</span>
        <span class="n">top</span> <span class="o">+=</span> <span class="p">(</span><span class="n">new_r_val</span> <span class="o">*</span> <span class="n">new_r_val</span><span class="p">)</span>
        <span class="n">bottom</span> <span class="o">+=</span> <span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="n">beta</span> <span class="o">=</span> <span class="n">top</span> <span class="o">/</span> <span class="n">bottom</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">construct_cg_b</span><span class="p">(</span><span class="n">divf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">(),</span> <span class="n">b</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">()):</span>
    <span class="k">for</span> <span class="n">IX</span><span class="p">,</span> <span class="n">IY</span> <span class="ow">in</span> <span class="n">divf</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">IX</span> <span class="o">&lt;</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">IY</span> <span class="o">&lt;</span> <span class="n">resolutionX</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">b</span><span class="p">[</span><span class="n">IY</span> <span class="o">*</span> <span class="n">resolutionX</span> <span class="o">+</span> <span class="n">IX</span><span class="p">]</span> <span class="o">=</span> <span class="n">divf</span><span class="p">[</span><span class="n">IX</span><span class="p">,</span> <span class="n">IY</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">b</span><span class="p">[</span><span class="n">IY</span> <span class="o">*</span> <span class="n">resolutionX</span> <span class="o">+</span> <span class="n">IX</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="k">def</span><span class="w"> </span><span class="nf">pressure_cg</span><span class="p">(</span><span class="n">pf_pair</span><span class="p">,</span> <span class="n">divf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">()):</span>
    <span class="n">residual</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">construct_cg_b</span><span class="p">(</span><span class="n">divf</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">pressure_cg_init</span><span class="p">(</span><span class="n">pf_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">residual</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
        <span class="n">residual</span> <span class="o">=</span> <span class="n">pressure_cg_iter</span><span class="p">(</span><span class="n">pf_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="n">apply_p_bc</span><span class="p">(</span><span class="n">pf_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">)</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">divergence</span><span class="p">(</span><span class="n">field</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">(),</span> <span class="n">divf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">()):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">field</span><span class="p">:</span>
        <span class="n">divf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">field</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">field</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">field</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

<span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="k">def</span><span class="w"> </span><span class="nf">correct_divergence</span><span class="p">(</span><span class="n">vf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">(),</span> <span class="n">vf_new</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">(),</span> <span class="n">pf</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">template</span><span class="p">()):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">vf</span><span class="p">:</span>
        <span class="n">vf_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">vf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="p">([(</span><span class="n">pf</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">pf</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="p">(</span><span class="n">pf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">pf</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">])</span>

<span class="n">gui</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">GUI</span><span class="p">(</span><span class="s1">&#39;Colorful Fluid Simulation&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span>
<span class="n">frame_counter</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Initial dye color is blue</span>
<span class="n">initial_dye_color</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">while</span> <span class="n">gui</span><span class="o">.</span><span class="n">get_event</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">GUI</span><span class="o">.</span><span class="n">PRESS</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">gui</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ti</span><span class="o">.</span><span class="n">GUI</span><span class="o">.</span><span class="n">ESCAPE</span><span class="p">,</span> <span class="n">ti</span><span class="o">.</span><span class="n">GUI</span><span class="o">.</span><span class="n">EXIT</span><span class="p">]:</span> 
            <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gui</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="n">ti</span><span class="o">.</span><span class="n">GUI</span><span class="o">.</span><span class="n">SPACE</span><span class="p">:</span>
            <span class="n">pause</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">pause</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pause</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">itr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
            <span class="c1"># Add inflow</span>
            <span class="n">addInflow</span><span class="p">(</span><span class="n">velocities_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">inflow_velocity</span><span class="p">)</span>
            <span class="n">addInflow</span><span class="p">(</span><span class="n">dyes_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">initial_dye_color</span><span class="p">)</span>
            <span class="c1"># Advection</span>
            <span class="n">apply_vel_bc</span><span class="p">(</span><span class="n">velocities_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">)</span>
            <span class="n">advect</span><span class="p">(</span><span class="n">velocities_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">,</span> <span class="n">velocities_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">,</span> <span class="n">velocities_pair</span><span class="o">.</span><span class="n">nxt</span><span class="p">)</span>
            <span class="n">advect</span><span class="p">(</span><span class="n">velocities_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">,</span> <span class="n">dyes_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">,</span> <span class="n">dyes_pair</span><span class="o">.</span><span class="n">nxt</span><span class="p">)</span>
            <span class="n">velocities_pair</span><span class="o">.</span><span class="n">swap</span><span class="p">()</span>
            <span class="n">dyes_pair</span><span class="o">.</span><span class="n">swap</span><span class="p">()</span>
            <span class="n">apply_vel_bc</span><span class="p">(</span><span class="n">velocities_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">)</span>
            <span class="c1"># Projection step</span>
            <span class="n">divergence</span><span class="p">(</span><span class="n">velocities_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">,</span> <span class="n">velocity_divs</span><span class="p">)</span>
            <span class="n">pressure_cg</span><span class="p">(</span><span class="n">pressures_pair</span><span class="p">,</span> <span class="n">velocity_divs</span><span class="p">)</span>
            <span class="n">correct_divergence</span><span class="p">(</span><span class="n">velocities_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">,</span> <span class="n">velocities_pair</span><span class="o">.</span><span class="n">nxt</span><span class="p">,</span> <span class="n">pressures_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">)</span>
            <span class="n">velocities_pair</span><span class="o">.</span><span class="n">swap</span><span class="p">()</span>
        <span class="n">fill_color</span><span class="p">(</span><span class="n">pixels</span><span class="p">,</span> <span class="n">dyes_pair</span><span class="o">.</span><span class="n">cur</span><span class="p">)</span>

    <span class="n">frame_counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;./video/frame_</span><span class="si">{</span><span class="n">frame_counter</span><span class="si">:</span><span class="s1">05d</span><span class="si">}</span><span class="s1">.png&#39;</span>
    <span class="n">gui</span><span class="o">.</span><span class="n">set_image</span><span class="p">(</span><span class="n">pixels</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">gui</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">gui</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<video src="../assets/images/remote/fluid_simulation.mp4"></video>

<p>The complex plumes, rolls, and mixing are driven by the nonlinear convective term <span class="arithmatex">\((\mathbf{v}\cdot\nabla)\mathbf{v}\)</span>—the source of rich flow morphologies from laminar structures to turbulence.</p>
<h1 id="7-summary">7. Summary<a class="headerlink" href="#7-summary" title="Permanent link">&para;</a></h1>
<p>In this lecture, starting from the conserved model of <strong>gradient dynamics</strong>, we systematically constructed a theoretical framework for fluid dynamics describing <strong>frictionless, non-conducting</strong> simple fluids. Its core is based on the <strong>local equilibrium assumption</strong>, establishing conservation law equations for the three basic conserved quantities of fluids—mass, momentum, and energy. By deriving the corresponding physical "flux" for each conserved "density," we finally obtained a closed set of equations describing ideal fluid behavior, which is the <strong>equations of ideal hydrodynamics</strong>.</p>
<p>The following table summarizes the core content of this lecture, clearly showing the unified structure of these three conservation laws:</p>
<table>
<thead>
<tr>
<th>Conserved Quantity</th>
<th>Density</th>
<th>Local Law</th>
<th>Flux</th>
<th>Physical Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mass</td>
<td><span class="arithmatex">\(\rho\)</span></td>
<td><span class="arithmatex">\(\partial_t\rho + \nabla\cdot(\rho\mathbf{v})=0\)</span></td>
<td><span class="arithmatex">\(\mathbf{J}=\rho\mathbf{v}\)</span></td>
<td>Convective transport of mass</td>
</tr>
<tr>
<td>Momentum</td>
<td><span class="arithmatex">\(\rho v_i\)</span></td>
<td><span class="arithmatex">\(\partial_t(\rho v_i) + \partial_k\Pi_{ik}=0\)</span></td>
<td><span class="arithmatex">\(\Pi_{ik}=P\delta_{ik}+\rho v_iv_k\)</span></td>
<td>Isotropic pressure + convective momentum transport</td>
</tr>
<tr>
<td>Energy</td>
<td><span class="arithmatex">\(\tfrac{1}{2}\rho v^2+\rho\epsilon\)</span></td>
<td><span class="arithmatex">\(\partial_t e_{\text{total}} + \nabla\cdot\mathbf{J}^{(\epsilon)}=0\)</span></td>
<td><span class="arithmatex">\(\mathbf{J}^{(\epsilon)}=\rho\mathbf{v}(\tfrac{1}{2}v^2+h)\)</span></td>
<td>Transport of kinetic energy and enthalpy</td>
</tr>
</tbody>
</table>
<p>This set of equations is the cornerstone for our further understanding of more complex fluid phenomena. So far, we have constructed the most fundamental, non-dissipative "motion skeleton" for the fluid world. In the upcoming lectures, we will introduce <strong>dissipative effects</strong> (such as viscosity and heat conduction) on this basis, transitioning from the ideal Euler equation to the more universal <strong>Navier-Stokes equations</strong>, thereby enabling the description of more realistic and complex fluid phenomena.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy", "navigation.sections", "navigation.expand", "navigation.top", "toc.integrate", "search.highlight"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../assets/javascripts/mathjax.js"></script>
      
        <script src="../../assets/javascripts/language-nav.js"></script>
      
        <script src="../../assets/javascripts/video-init.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>