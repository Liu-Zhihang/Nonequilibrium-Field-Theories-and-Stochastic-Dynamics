
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Course Notes and Code (Erwin Frey, LMU Munich, 2025)">
      
      
        <meta name="author" content="Zhihang Liu">
      
      
        <link rel="canonical" href="https://liu-zhihang.github.io/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/notes/10.%20Ehrenfest%20Model%2C%20Entropy%2C%20and%20KL%20Divergence/">
      
      
        <link rel="prev" href="../9.%20Nonequilibrium%20States%20%E2%80%94%20Irreversibility%20and%20Entropy%20Production/">
      
      
        <link rel="next" href="../11.%20Continuous%20Markov%20Processes%20and%20the%20Fokker%E2%80%93Planck%20Equation/">
      
      
        
          <link rel="alternate" href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/" hreflang="en">
        
          <link rel="alternate" href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/zh/" hreflang="zh">
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>10. Ehrenfest Model, Entropy, and KL Divergence - Nonequilibrium Field Theories and Stochastic Dynamics</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/video.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#preface-entropy-production-and-the-signature-of-irreversibility" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Nonequilibrium Field Theories and Stochastic Dynamics" class="md-header__button md-logo" aria-label="Nonequilibrium Field Theories and Stochastic Dynamics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nonequilibrium Field Theories and Stochastic Dynamics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              10. Ehrenfest Model, Entropy, and KL Divergence
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/zh/" hreflang="zh" class="md-select__link">
              简体中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Liu-Zhihang/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Nonequilibrium Field Theories and Stochastic Dynamics" class="md-nav__button md-logo" aria-label="Nonequilibrium Field Theories and Stochastic Dynamics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Nonequilibrium Field Theories and Stochastic Dynamics
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Liu-Zhihang/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Course Notes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Course Notes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20Course%20Introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Course Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.%20Simple%20Random%20Walk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Simple Random Walk
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.%20Gaussian%20Random%20Walk%20and%20Poisson%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Gaussian Random Walk and Poisson Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.%20Gillespie%20Algorithm%2C%20Master%20Equation%2C%20Generating%20Functions%20and%20Population%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Gillespie Algorithm, Master Equation, Generating Functions and Population Dynamics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.%20Population%20Dynamics%20-%20Linear%20Death%20Process%20and%20Lotka-Volterra%20System/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Population Dynamics - Linear Death Process and Lotka-Volterra System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.%20Fundamental%20Equations%20of%20Markov%20Processes%20%E2%80%94%20Chapman%E2%80%93Kolmogorov%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Fundamental Equations of Markov Processes — Chapman–Kolmogorov Equation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.%20Forward%20Master%20Equation%20and%20the%20Q%20Matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. Forward Master Equation and the Q Matrix
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8.%20Perron%E2%80%93Frobenius%20Theorem%2C%20Steady%20States%2C%20and%20Detailed%20Balance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. Perron–Frobenius Theorem, Steady States, and Detailed Balance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9.%20Nonequilibrium%20States%20%E2%80%94%20Irreversibility%20and%20Entropy%20Production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. Nonequilibrium States — Irreversibility and Entropy Production
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    10. Ehrenfest Model, Entropy, and KL Divergence
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    10. Ehrenfest Model, Entropy, and KL Divergence
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quantifying-irreversibility-entropy-production-rate-sigma" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quantifying Irreversibility: Entropy Production Rate \(\sigma\)
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-ehrenfest-model-a-simple-system-for-big-ideas" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Ehrenfest Model: A Simple System for Big Ideas
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-the-classic-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 The Classic Model
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-formal-description-of-the-dog-flea-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 Formal Description of the "Dog-Flea" Model
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-the-nature-of-equilibrium-detailed-balance-and-the-binomial-distribution" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. The Nature of Equilibrium: Detailed Balance and the Binomial Distribution
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#21-finding-the-steady-state" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Finding the Steady State
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#22-solving-the-recurrence-relation" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Solving the Recurrence Relation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#23-physical-interpretation-of-the-result" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 Physical Interpretation of the Result
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-the-statistical-arrow-of-time-reconciling-microscopic-reversibility-with-macroscopic-irreversibility" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. The Statistical Arrow of Time: Reconciling Microscopic Reversibility with Macroscopic Irreversibility
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#31-the-core-paradox" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 The Core Paradox
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#32-the-story-of-two-trajectories" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 The Story of Two Trajectories
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#33-resolution-of-the-paradox-microstates-vs-macrostates" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 Resolution of the Paradox: Microstates vs. Macrostates
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-simulating-the-ehrenfest-model-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Simulating the Ehrenfest Model in Python
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#41-simulating-trajectories" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Simulating Trajectories
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1 Simulating Trajectories">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#42-verifying-the-equilibrium-distribution" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Verifying the Equilibrium Distribution
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-quantifying-the-journey-to-equilibrium-statistical-entropy-and-kl-divergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Quantifying the Journey to Equilibrium: Statistical Entropy and KL Divergence
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#51-defining-time-dependent-entropy" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1 Defining Time-Dependent Entropy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#52-from-micro-to-macro-entropy" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2 From Micro to Macro Entropy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#53-kl-divergence-measuring-distance-to-equilibrium" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3 KL Divergence: Measuring "Distance" to Equilibrium
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#54-simulating-entropy-evolution" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4 Simulating Entropy Evolution
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-basic-insights-of-statistical-mechanics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary: Basic Insights of Statistical Mechanics
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11.%20Continuous%20Markov%20Processes%20and%20the%20Fokker%E2%80%93Planck%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. Continuous Markov Processes and the Fokker–Planck Equation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12.%20Brownian%20Motion%20and%20the%20Ornstein%E2%80%93Uhlenbeck%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. Brownian Motion and the Ornstein–Uhlenbeck Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13.%20Monte%20Carlo%20Sampling%20as%20a%20Stochastic%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. Monte Carlo Sampling as a Stochastic Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14.%20Hamiltonian%20Monte%20Carlo%20Sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. Hamiltonian Monte Carlo Sampling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15.%20Chemotaxis%2C%20Run-and-Tumble%20Motion%2C%20and%20the%20Keller%E2%80%93Segel%20Model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. Chemotaxis, Run-and-Tumble Motion, and the Keller–Segel Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../16.%20The%20Schnitzer%20Model%2C%20Anomalous%20Diffusion%2C%20and%20Motility%E2%80%91Induced%20Phase%20Separation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. The Schnitzer Model, Anomalous Diffusion, and Motility‑Induced Phase Separation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../17.%20Langevin%20Equation%2C%20Brownian%20Particle%2C%20and%20the%20Fluctuation%E2%80%93Dissipation%20Theorem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. Langevin Equation, Brownian Particle, and the Fluctuation–Dissipation Theorem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18.%20Fokker%E2%80%93Planck%20Equation%20and%20the%20Smoluchowski%20Equation%20%E2%80%94%20From%20Random%20Trajectories%20to%20Probability%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    18. Fokker–Planck Equation and the Smoluchowski Equation — From Random Trajectories to Probability Dynamics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19.%20Path%20Integral%20Formulation%20of%20Stochastic%20Processes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    19. Path Integral Formulation of Stochastic Processes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.%20Stochastic%20Differential%20Equations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    20. Stochastic Differential Equations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.%20Ito%20Integral%20and%20Unified%20Stochastic%20Process%20Framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    21. Ito Integral and Unified Stochastic Process Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.%20Path%20Integrals%20for%20Systems%20with%20Multiplicative%20Noise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    22. Path Integrals for Systems with Multiplicative Noise
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.%20From%20Coarse-Graining%20to%20Fluctuation%20Dynamics%20of%20Continuous%20Field%20Theories/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    23. From Coarse-Graining to Fluctuation Dynamics of Continuous Field Theories
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.%20Onsager%20Coefficients%2C%20Reciprocity%2C%20and%20the%20Dynamic%20Fluctuation%E2%80%93Dissipation%20Theorem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    24. Onsager Coefficients, Reciprocity, and the Dynamic Fluctuation–Dissipation Theorem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../25.%20Gradient%20Dynamics%2C%20Phase%20Transitions%2C%20and%20Relaxation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    25. Gradient Dynamics, Phase Transitions, and Relaxation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../26.%20Critical%20Slowing%20Down%2C%20Dynamic%20Response%2C%20and%20Conservation%20Laws/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    26. Critical Slowing Down, Dynamic Response, and Conservation Laws
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../27.%20Hydrodynamics%20of%20Simple%20Fluids%2C%20Inviscid%20Flow%2C%20and%20the%20Euler%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    27. Hydrodynamics of Simple Fluids, Inviscid Flow, and the Euler Equation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../28.%20Viscous%20Fluids%2C%20the%20Navier%E2%80%93Stokes%20Equation%2C%20Entropy%20Balance%2C%20and%20Heat%20Conduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    28. Viscous Fluids, the Navier–Stokes Equation, Entropy Balance, and Heat Conduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../29.%20Irreversible%20Linear%20Thermodynamics%20and%20Dry%20Diffusive%20Particle%20Systems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    29. Irreversible Linear Thermodynamics and Dry Diffusive Particle Systems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../30.%20Brownian%20Particles%20Suspended%20in%20a%20Fluid%20%E2%80%94%20Model%20H/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    30. Brownian Particles Suspended in a Fluid — Model H
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../31.%20Dynamical%20Functionals%2C%20Additive%E2%80%91Noise%20Field%20Theory%2C%20and%20the%20Onsager%E2%80%93Machlup%20Functional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    31. Dynamical Functionals, Additive‑Noise Field Theory, and the Onsager–Machlup Functional
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../32.%20Janssen%E2%80%93De%20Dominicis%20Response%20Functional%20and%20the%20Fluctuation%E2%80%93Dissipation%20Relation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    32. Janssen–De Dominicis Response Functional and the Fluctuation–Dissipation Relation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../33.%20Nonequilibrium%20Work%20and%20Fluctuation%20Theorems/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    33. Nonequilibrium Work and Fluctuation Theorems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../34.%20Directed%20Percolation%2C%20Absorbing%20States%2C%20and%20Spectral%20Methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    34. Directed Percolation, Absorbing States, and Spectral Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../35.%20Path-Integral%20Representation%20of%20the%20Master%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    35. Path-Integral Representation of the Master Equation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../36.%20Coherent-State%20Path%20Integrals%2C%20Operator%20Algebra%2C%20and%20Imaginary%20Noise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    36. Coherent-State Path Integrals, Operator Algebra, and Imaginary Noise
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../37.%20Kramers-Moyal%20Expansion%20and%20the%20Low-Noise%20Limit%20of%20Path%20Integrals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    37. Kramers-Moyal Expansion and the Low-Noise Limit of Path Integrals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../38.%20Multi-Species%20Path%20Integrals%20and%20Cyclic%20Competition%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    38. Multi-Species Path Integrals and Cyclic Competition Dynamics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../39.%20From%20Particle%20Jumps%20to%20Continuous%20Field%20Theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    39. From Particle Jumps to Continuous Field Theory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../40.%20Unified%20Field%20Theory%20Framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    40. Unified Field Theory Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    中文笔记
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    中文笔记
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    首页
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/1.%20%E8%AF%BE%E7%A8%8B%E5%AF%BC%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. 课程导论
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/2.%20%E7%AE%80%E5%8D%95%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. 简单随机游走
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/3.%20%E9%AB%98%E6%96%AF%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E4%B8%8E%E6%B3%8A%E6%9D%BE%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. 高斯随机游走与泊松过程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/4.%20Gillespie%20%E7%AE%97%E6%B3%95%E3%80%81%E4%B8%BB%E6%96%B9%E7%A8%8B%E3%80%81%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E4%B8%8E%E7%A7%8D%E7%BE%A4%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Gillespie 算法、主方程、生成函数与种群动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/5.%20%E7%A7%8D%E7%BE%A4%E5%8A%A8%E6%80%81%E5%AD%A6%EF%BC%9A%E7%BA%BF%E6%80%A7%E6%AD%BB%E4%BA%A1%E8%BF%87%E7%A8%8B%E4%B8%8ELotka-Volterra%20%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. 种群动态学：线性死亡过程与Lotka-Volterra 系统
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/6.%20%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%96%B9%E7%A8%8B%EF%BC%9A%E6%9F%A5%E6%99%AE%E6%9B%BC-%E7%A7%91%E5%B0%94%E8%8E%AB%E6%88%88%E7%BD%97%E5%A4%AB%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. 马尔可夫过程的基本方程：查普曼-科尔莫戈罗夫方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/7.%20%E5%89%8D%E5%90%91%E4%B8%BB%E6%96%B9%E7%A8%8B%E4%B8%8EQ%E7%9F%A9%E9%98%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. 前向主方程与Q矩阵
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/8.%20%E4%BD%A9%E9%BE%99-%E5%BC%97%E7%BD%97%E8%B4%9D%E5%B0%BC%E4%B9%8C%E6%96%AF%E5%AE%9A%E7%90%86%E3%80%81%E7%A8%B3%E6%80%81%E4%B8%8E%E7%BB%86%E8%87%B4%E5%B9%B3%E8%A1%A1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. 佩龙-弗罗贝尼乌斯定理、稳态与细致平衡
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/9.%20%E9%9D%9E%E5%B9%B3%E8%A1%A1%E6%80%81%EF%BC%9A%E4%B8%8D%E5%8F%AF%E9%80%86%E6%80%A7%E4%B8%8E%E7%86%B5%E4%BA%A7%E7%94%9F%E7%9A%84%E6%8E%A8%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. 非平衡态：不可逆性与熵产生的推论
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/10.%20%E5%9F%83%E4%BC%A6%E8%B4%B9%E6%96%AF%E7%89%B9%E6%A8%A1%E5%9E%8B%E3%80%81%E7%86%B5%E4%B8%8EKL%E6%95%A3%E5%BA%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. 埃伦费斯特模型、熵与KL散度
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/11.%20%E8%BF%9E%E7%BB%AD%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E4%B8%8E%E7%A6%8F%E5%85%8B-%E6%99%AE%E6%9C%97%E5%85%8B%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. 连续马尔可夫过程与福克-普朗克方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/12.%20%E5%B8%83%E6%9C%97%E8%BF%90%E5%8A%A8%E4%B8%8E%E5%A5%A5%E6%81%A9%E6%96%AF%E5%9D%A6-%E4%B9%8C%E4%BC%A6%E8%B4%9D%E5%85%8B%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. 布朗运动与奥恩斯坦-乌伦贝克过程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/13.%20%E4%BD%9C%E4%B8%BA%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E9%87%87%E6%A0%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. 作为随机过程的蒙特卡洛采样
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/14.%20%E5%93%88%E5%AF%86%E5%B0%94%E9%A1%BF%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E9%87%87%E6%A0%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. 哈密尔顿蒙特卡洛采样
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/15.%20%E8%B6%8B%E5%8C%96%E6%80%A7%E3%80%81%E8%B7%91%E5%8A%A8-%E7%BF%BB%E6%BB%9A%E8%BF%90%E5%8A%A8%E4%B8%8EKeller-Segel%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. 趋化性、跑动-翻滚运动与Keller-Segel模型
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/16.%20Schnitzer%E6%A8%A1%E5%9E%8B%E3%80%81%E5%8F%8D%E5%B8%B8%E6%89%A9%E6%95%A3%E4%B8%8E%E8%BF%90%E5%8A%A8%E8%AF%B1%E5%AF%BC%E7%9B%B8%E5%88%86%E7%A6%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. Schnitzer模型、反常扩散与运动诱导相分离
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/17.%20%E6%9C%97%E4%B9%8B%E4%B8%87%E6%96%B9%E7%A8%8B%E3%80%81%E5%B8%83%E6%9C%97%E7%B2%92%E5%AD%90%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. 朗之万方程、布朗粒子与涨落-耗散定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/18.%20%E7%A6%8F%E5%85%8B-%E6%99%AE%E6%9C%97%E5%85%8B%E6%96%B9%E7%A8%8B%E4%B8%8E%E6%96%AF%E6%91%A9%E6%A3%B1%E9%9C%8D%E5%A4%AB%E6%96%AF%E5%9F%BA%E6%96%B9%E7%A8%8B%EF%BC%9A%E4%BB%8E%E9%9A%8F%E6%9C%BA%E8%BD%A8%E8%BF%B9%E5%88%B0%E6%A6%82%E7%8E%87%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    18. 福克-普朗克方程与斯摩棱霍夫斯基方程：从随机轨迹到概率动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/19.%20%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E8%A1%A8%E8%BF%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    19. 随机过程的路径积分表述
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/20.%20%E9%9A%8F%E6%9C%BA%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    20. 随机微分方程
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/21.%20%E4%BC%8A%E8%97%A4%E7%A7%AF%E5%88%86%E4%B8%8E%E7%BB%9F%E4%B8%80%E7%9A%84%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    21. 伊藤积分与统一的随机过程框架
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/22.%20%E5%90%AB%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    22. 含乘性噪声系统的路径积分
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/23.%20%E4%BB%8E%E7%B2%97%E7%B2%92%E5%8C%96%E5%88%B0%E8%BF%9E%E7%BB%AD%E5%9C%BA%E8%AE%BA%E6%B6%A8%E8%90%BD%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    23. 从粗粒化到连续场论涨落动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/24.%20%E6%98%82%E8%90%A8%E6%A0%BC%E7%B3%BB%E6%95%B0%E3%80%81%E5%80%92%E6%98%93%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%8A%A8%E6%80%81%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    24. 昂萨格系数、倒易关系与动态涨落-耗散定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/25.%20%E6%A2%AF%E5%BA%A6%E5%8A%A8%E5%8A%9B%E5%AD%A6%E3%80%81%E7%9B%B8%E5%8F%98%E4%B8%8E%E5%BC%9B%E8%B1%AB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    25. 梯度动力学、相变与弛豫
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/26.%20%E4%B8%B4%E7%95%8C%E6%85%A2%E5%8C%96%E3%80%81%E5%8A%A8%E6%80%81%E5%93%8D%E5%BA%94%E4%B8%8E%E5%AE%88%E6%81%92%E5%BE%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    26. 临界慢化、动态响应与守恒律
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/27.%20%E7%AE%80%E5%8D%95%E6%B5%81%E4%BD%93%E3%80%81%E6%97%A0%E6%91%A9%E6%93%A6%E6%B5%81%E4%BD%93%E4%B8%8E%E6%AC%A7%E6%8B%89%E6%96%B9%E7%A8%8B%E7%9A%84%E6%B5%81%E4%BD%93%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    27. 简单流体、无摩擦流体与欧拉方程的流体动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/28.%20%E7%B2%98%E6%80%A7%E6%B5%81%E4%BD%93%E3%80%81%E7%BA%B3%E7%BB%B4-%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E6%96%B9%E7%A8%8B%E3%80%81%E7%86%B5%E5%B9%B3%E8%A1%A1%E4%B8%8E%E7%83%AD%E4%BC%A0%E5%AF%BC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    28. 粘性流体、纳维-斯托克斯方程、熵平衡与热传导
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/29.%20%E4%B8%8D%E5%8F%AF%E9%80%86%E7%BA%BF%E6%80%A7%E7%83%AD%E5%8A%9B%E5%AD%A6%E4%B8%8E%E5%B9%B2%E6%80%A7%E6%89%A9%E6%95%A3%E7%B2%92%E5%AD%90%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    29. 不可逆线性热力学与干性扩散粒子系统
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/30.%20%E6%82%AC%E6%B5%AE%E5%9C%A8%E6%B5%81%E4%BD%93%E4%B8%AD%E7%9A%84%E5%B8%83%E6%9C%97%E7%B2%92%E5%AD%90%20%E2%80%94%20H%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    30. 悬浮在流体中的布朗粒子 — H模型
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/31.%20%E5%8A%A8%E6%80%81%E6%B3%9B%E5%87%BD%E3%80%81%E5%8A%A0%E6%80%A7%E5%99%AA%E5%A3%B0%E5%9C%BA%E8%AE%BA%E4%B8%8EOnsager-Machlup%E6%B3%9B%E5%87%BD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    31. 动态泛函、加性噪声场论与Onsager-Machlup泛函
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/32.%20Janssen-De%20Dominicis%20%E5%93%8D%E5%BA%94%E6%B3%9B%E5%87%BD%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%85%B3%E7%B3%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    32. Janssen-De Dominicis 响应泛函与涨落-耗散关系
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/33.%20%E9%9D%9E%E5%B9%B3%E8%A1%A1%E5%8A%9F%E4%B8%8E%E6%B6%A8%E8%90%BD%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    33. 非平衡功与涨落定理
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/34.%20%E6%9C%89%E5%90%91%E6%B8%97%E6%B5%81%E3%80%81%E5%90%B8%E6%94%B6%E6%80%81%E4%B8%8E%E8%B0%B1%E6%96%B9%E6%B3%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    34. 有向渗流、吸收态与谱方法
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/35.%20%E4%B8%BB%E6%96%B9%E7%A8%8B%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E8%A1%A8%E7%A4%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    35. 主方程的路径积分表示
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/36.%20%E7%9B%B8%E5%B9%B2%E6%80%81%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E3%80%81%E7%AE%97%E7%AC%A6%E4%BB%A3%E6%95%B0%E4%B8%8E%E8%99%9A%E5%99%AA%E5%A3%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    36. 相干态路径积分、算符代数与虚噪声
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/37.%20Kramers-Moyal%20%E5%B1%95%E5%BC%80%E4%B8%8E%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E7%9A%84%E4%BD%8E%E5%99%AA%E5%A3%B0%E6%9E%81%E9%99%90/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    37. Kramers-Moyal 展开与路径积分的低噪声极限
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/38.%20%E5%A4%9A%E7%89%A9%E7%A7%8D%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E4%B8%8E%E5%BE%AA%E7%8E%AF%E7%AB%9E%E4%BA%89%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    38. 多物种路径积分与循环竞争动力学
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/39.%20%E4%BB%8E%E7%B2%92%E5%AD%90%E8%B7%B3%E8%B7%83%E5%88%B0%E8%BF%9E%E7%BB%AD%E5%9C%BA%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    39. 从粒子跳跃到连续场论
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../zh/notes/40.%20%E7%BB%9F%E4%B8%80%E7%9A%84%E5%9C%BA%E8%AE%BA%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    40. 统一的场论框架
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="preface-entropy-production-and-the-signature-of-irreversibility">Preface: Entropy Production and the Signature of Irreversibility<a class="headerlink" href="#preface-entropy-production-and-the-signature-of-irreversibility" title="Permanent link">&para;</a></h1>
<p>In the previous lectures (especially 8 and 9) we studied the master equation and distinguished global balance from detailed balance. Detailed balance implies a steady state, but not every steady state satisfies detailed balance. This distinction is key for nonequilibrium physics and leads us to irreversibility.</p>
<p>In a nonequilibrium steady state (NESS), macroscopic observables (e.g., the distribution) are time‑independent, yet persistent probability currents flow inside the system. These net currents signal irreversibility. To quantify it we use the entropy production rate.</p>
<h2 id="quantifying-irreversibility-entropy-production-rate-sigma">Quantifying Irreversibility: Entropy Production Rate <span class="arithmatex">\(\sigma\)</span><a class="headerlink" href="#quantifying-irreversibility-entropy-production-rate-sigma" title="Permanent link">&para;</a></h2>
<p><img alt="Lecture blackboard screenshot" src="../../assets/images/remote/5b69a53c-1400-4813-9c0e-ddc9a759f2a3-cd096cb93f.jpg" /></p>
<p>When reviewing the previous lecture content, the professor first presented the expression for the entropy production rate <span class="arithmatex">\(\sigma\)</span>:</p>
<div class="arithmatex">\[
\sigma = \sum_{i j} \pi_j w_{i j} \ln\left(\frac{w_{j i}}{w_{i j}}\right)
\]</div>
<p>Let us analyze this formula:</p>
<ul>
<li>
<p><span class="arithmatex">\(\pi_j\)</span> is the steady-state probability of the system being in state <span class="arithmatex">\(j\)</span>.</p>
</li>
<li>
<p><span class="arithmatex">\(w_{ij}\)</span> is the transition rate from state <span class="arithmatex">\(j\)</span> to state <span class="arithmatex">\(i\)</span>.</p>
</li>
<li>
<p>Therefore, <span class="arithmatex">\(\pi_j w_{ij}\)</span> represents the <strong>probability flux</strong> from state <span class="arithmatex">\(j\)</span> to state <span class="arithmatex">\(i\)</span> in the steady state.</p>
</li>
<li>
<p>The logarithmic term <span class="arithmatex">\(\ln\left(\frac{w_{j i}}{w_{i j}}\right)\)</span> measures the <strong>asymmetry</strong> between the forward process (<span class="arithmatex">\(j \to i\)</span>) and the reverse process (<span class="arithmatex">\(i \to j\)</span>) rates. If <span class="arithmatex">\(w_{ij} = w_{ji}\)</span>, this term vanishes, indicating that this pair of transitions is reversible.</p>
</li>
</ul>
<p>The entire expression <span class="arithmatex">\(\sigma\)</span> is the sum of rate asymmetries weighted by probability fluxes for all possible transitions in the system. Therefore, <span class="arithmatex">\(\sigma\)</span> precisely quantifies the temporal asymmetry or irreversibility of the entire system at the macroscopic level.</p>
<p>Next, through a clever mathematical transformation, the professor gave another equivalent form of <span class="arithmatex">\(\sigma\)</span>:</p>
<div class="arithmatex">\[
\sigma = \sum_{i j} \pi_j w_{i j} \ln\left(\frac{\pi_i w_{j i}}{\pi_j w_{i j}}\right)
\]</div>
<p>This transformation is not an approximation but is exact. The derivation utilizes the global balance condition of the steady state <span class="arithmatex">\(\sum_j [\pi_j w_{j i} - \pi_i w_{i j}] = 0\)</span>. Through this condition, one can prove an identity <span class="arithmatex">\(\sum_{i j} \pi_j w_{i j} \ln(\pi_j / \pi_i) = 0\)</span>. By adding this zero term inside the logarithm of the original <span class="arithmatex">\(\sigma\)</span> expression, the new form is obtained.</p>
<p>This new form is conceptually more profound. The term inside the logarithm becomes the ratio of <strong>forward flux</strong> <span class="arithmatex">\(\pi_j w_{ij}\)</span> to <strong>reverse flux</strong> <span class="arithmatex">\(\pi_i w_{ji}\)</span>. This directly reflects that entropy production originates from the net circulation of probability flow within the system.</p>
<p>An equivalent symmetric expression over unordered pairs is</p>
<div class="arithmatex">\[
\sigma \,=\, \sum_{i&lt;j} J_{i j}\,\ln\!\left(\frac{w_{i\to j}}{w_{j\to i}}\right),\quad
J_{i j}:=\pi_i w_{i\to j}-\pi_j w_{j\to i}.
\]</div>
<p>This makes explicit the universal (flux)<span class="arithmatex">\(\times\)</span>(force) structure with thermodynamic force (affinity) <span class="arithmatex">\(A_{i j}:=\ln\!\left(\frac{w_{i\to j}}{w_{j\to i}}\right)\)</span>.</p>
<p>The entropy production rate has two fundamental properties:</p>
<ol>
<li>
<p><strong>Nonnegativity</strong>: <span class="arithmatex">\(\sigma \geq 0\)</span>. This is a mathematical conclusion based on <strong>Jensen's inequality</strong>. Its physical significance is extremely profound: the steady-state entropy production rate of any system can only be positive or zero, never negative. This is the manifestation of the second law of thermodynamics in stochastic processes.</p>
</li>
<li>
<p><strong>Relation to detailed balance</strong>:</p>
</li>
<li>
<p><span class="arithmatex">\(\sigma = 0\)</span> if and only if the system satisfies <strong>detailed balance</strong> (DB). Under detailed balance, the forward and reverse fluxes between every pair of states are equal, i.e., <span class="arithmatex">\(\pi_j w_{ij} = \pi_i w_{ji}\)</span>, so the logarithmic terms are zero everywhere. This corresponds to true thermodynamic equilibrium.</p>
</li>
<li>
<p>When the system is in a <strong>nonequilibrium steady state</strong> (NESS), <span class="arithmatex">\(\sigma &gt; 0\)</span>. In this case, at least one net probability current <span class="arithmatex">\(J_{ij} = \pi_j w_{ij} - \pi_i w_{ji} \neq 0\)</span> exists.</p>
</li>
</ol>
<p>Therefore, <span class="arithmatex">\(\sigma\)</span> is not merely a "switch" to determine whether a system is in equilibrium; its <strong>numerical magnitude</strong> itself is a measure that quantitatively describes the degree to which a system deviates from detailed balance (i.e., reversible equilibrium). The larger <span class="arithmatex">\(\sigma\)</span>, the stronger the probability flow circulation within the system, the further the system is driven from equilibrium, and the stronger its irreversibility.</p>
<h2 id="1-ehrenfest-model-a-simple-system-for-big-ideas">1. Ehrenfest Model: A Simple System for Big Ideas<a class="headerlink" href="#1-ehrenfest-model-a-simple-system-for-big-ideas" title="Permanent link">&para;</a></h2>
<h2 id="11-the-classic-model">1.1 The Classic Model<a class="headerlink" href="#11-the-classic-model" title="Permanent link">&para;</a></h2>
<p><img alt="Lecture slide" src="../../assets/images/remote/33ff277e-6fdb-4e90-a9b8-b8a56b843538-048d628c2d.png" /></p>
<p>To understand more concretely the nature of irreversibility, entropy, and equilibrium, the professor introduced a classic pedagogical model in physics—the <strong>Ehrenfest Model</strong>. This model was proposed by Paul Ehrenfest and Tatyana Ehrenfest in the early 20th century, aiming to clarify the statistical nature of the second law of thermodynamics, rather than an absolute law.</p>
<p>The emergence of the Ehrenfest Model was to solve a core paradox in statistical mechanics: how the irreversible processes we observe in the macroscopic world (such as gas always diffusing from high-pressure regions to low-pressure regions, conforming to the second law of thermodynamics) emerge from microscopically completely reversible physical laws.</p>
<p>To this end, the physicist Ehrenfest couple designed an extremely simple "urn model" (or "dog-flea model"): imagine two boxes and <span class="arithmatex">\(N\)</span> distinguishable particles, randomly select one particle at each step and move it to the other box. Although each microscopic move is reversible, the model clearly demonstrates that the system will evolve with overwhelming probability from any imbalanced initial state (such as all particles in one box) to the most probable macroscopic equilibrium state (roughly equal distribution of particles in both boxes).</p>
<p>Therefore, it is not meant to simulate a specific physical system, but as a classic thought experiment and pedagogical tool, it profoundly reveals that macroscopic irreversibility is essentially a statistical phenomenon, and provides the most intuitive and simplest mathematical example for understanding equilibrium states, detailed balance, and how entropy serves as the driving force for the system to approach equilibrium.</p>
<p>This seemingly simple model, by simulating random jumps of particles between two containers, is sufficient to help us answer three fundamental questions:</p>
<ol>
<li>
<p>What is the equilibrium state of the system?</p>
</li>
<li>
<p>How does the system approach equilibrium?</p>
</li>
<li>
<p>What is the nature of equilibrium?</p>
</li>
</ol>
<h2 id="12-formal-description-of-the-dog-flea-model">1.2 Formal Description of the "Dog-Flea" Model<a class="headerlink" href="#12-formal-description-of-the-dog-flea-model" title="Permanent link">&para;</a></h2>
<p>The model has a vivid metaphor: imagine two dogs (A and B) and <span class="arithmatex">\(N\)</span> fleas. The fleas will randomly jump between the two dogs at a certain rate. We are concerned with the number of fleas on dog A.</p>
<p>The formal definition of the model is as follows:</p>
<p><strong>State</strong>: The macroscopic state of the system is defined by the number of fleas <span class="arithmatex">\(n\)</span> on dog A, where <span class="arithmatex">\(n\)</span> can take integer values <span class="arithmatex">\(0, 1, \ldots, N\)</span>.</p>
<p><strong>Transition rates</strong>:</p>
<p><strong>Losing a flea</strong> (from A to B): The rate from state <span class="arithmatex">\(n\)</span> to <span class="arithmatex">\(n-1\)</span> is <span class="arithmatex">\(\omega_{n \to n-1} = \lambda n\)</span>.</p>
<p><strong>Gaining a flea</strong> (from B to A): The rate from state <span class="arithmatex">\(n\)</span> to <span class="arithmatex">\(n+1\)</span> is <span class="arithmatex">\(\omega_{n \to n+1} = \lambda (N-n)\)</span>.</p>
<p>The setting of these rates is very intuitive:</p>
<p>The rate at which dog A loses fleas should be proportional to the number of fleas <span class="arithmatex">\(n\)</span> it already has, because each flea has the possibility of jumping away at rate <span class="arithmatex">\(\lambda\)</span> per unit time.</p>
<p>The rate at which dog A gains fleas should be proportional to the number of fleas on the other dog B, i.e., <span class="arithmatex">\((N-n)\)</span>.</p>
<p>This simple linear dependence is the core feature of the model. For ease of understanding, we summarize the key components of the model in the table below.</p>
<h2 id="2-the-nature-of-equilibrium-detailed-balance-and-the-binomial-distribution">2. The Nature of Equilibrium: Detailed Balance and the Binomial Distribution<a class="headerlink" href="#2-the-nature-of-equilibrium-detailed-balance-and-the-binomial-distribution" title="Permanent link">&para;</a></h2>
<h2 id="21-finding-the-steady-state">2.1 Finding the Steady State<a class="headerlink" href="#21-finding-the-steady-state" title="Permanent link">&para;</a></h2>
<p><strong>Now let us answer the first question: what is the equilibrium state (i.e., the steady-state probability distribution <span class="arithmatex">\(\pi_n\)</span>) of this system?</strong></p>
<p>Since there are no external driving forces in this system (such as a "flea pump") to create sustained circulation flows, we can expect the system to eventually relax to a true thermodynamic equilibrium state. Such an equilibrium state must satisfy the stronger <strong>detailed balance</strong> condition.</p>
<p>The detailed balance condition requires that in the steady state, the forward and reverse probability flows between any two adjacent states must be equal:</p>
<div class="arithmatex">\[
\pi_n \cdot \omega_{n \to n-1} = \pi_{n-1} \cdot \omega_{n-1 \to n}
\]</div>
<p>Substituting the specific rates of our model:</p>
<div class="arithmatex">\[
\pi_n \cdot (\lambda n) = \pi_{n-1} \cdot (\lambda (N-(n-1)))
\]</div>
<h2 id="22-solving-the-recurrence-relation">2.2 Solving the Recurrence Relation<a class="headerlink" href="#22-solving-the-recurrence-relation" title="Permanent link">&para;</a></h2>
<p>By solving the above equation, we can obtain the steady-state distribution <span class="arithmatex">\(\pi_n\)</span>.</p>
<p>First, eliminating the rate constant <span class="arithmatex">\(\lambda\)</span>, we get a <strong>recurrence relation</strong> for <span class="arithmatex">\(\pi_n\)</span>:</p>
<div class="arithmatex">\[
\pi_n = \frac{n}{N-n+1} \pi_{n-1}
\]</div>
<p>We can "unfold" this relation to express <span class="arithmatex">\(\pi_n\)</span> in terms of <span class="arithmatex">\(\pi_0\)</span>:</p>
<div class="arithmatex">\[
\pi_n = \frac{n}{N-n+1} \cdot \frac{n-1}{N-n+2} \pi_{n-2} = \ldots = \frac{n! N (N-1) \ldots (N-n+1)}{1} \pi_0
\]</div>
<p>We recognize that the fractional part on the right is exactly the definition of the binomial coefficient, i.e., <span class="arithmatex">\(\binom{N}{n} = \frac{N!}{n!(N-n)!}\)</span>. So:</p>
<div class="arithmatex">\[
\pi_n = \binom{N}{n} \pi_0
\]</div>
<p>Finally, we use the <strong>normalization condition</strong> for probabilities <span class="arithmatex">\(\sum_{n=0}^{N} \pi_n = 1\)</span> to determine the constant <span class="arithmatex">\(\pi_0\)</span>:</p>
<div class="arithmatex">\[
\sum_{n=0}^{N} \binom{N}{n} \pi_0 = \pi_0 \sum_{n=0}^{N} \binom{N}{n} = 1
\]</div>
<p>According to the binomial theorem, we know that <span class="arithmatex">\(\sum_{n=0}^{N} \binom{N}{n} = 2^N\)</span>. Therefore, <span class="arithmatex">\(\pi_0 = 1/2^N\)</span>.</p>
<p>Substituting <span class="arithmatex">\(\pi_0\)</span> back, we obtain the final steady-state distribution:</p>
<div class="arithmatex">\[
\pi_n = \frac{1}{2^N} \binom{N}{n}
\]</div>
<p>This is a binomial distribution.</p>
<h2 id="23-physical-interpretation-of-the-result">2.3 Physical Interpretation of the Result<a class="headerlink" href="#23-physical-interpretation-of-the-result" title="Permanent link">&para;</a></h2>
<p>This result is very intuitive. We can understand it from a more fundamental level—<strong>microstates</strong>. A microstate precisely specifies which dog each flea is on. Assuming each flea has two possibilities <span class="arithmatex">\(\{+1, -1\}\)</span> (representing dog A and dog B respectively), there are a total of <span class="arithmatex">\(2^N\)</span> different microstates.</p>
<p>If we assume that when the system reaches equilibrium, all <span class="arithmatex">\(2^N\)</span> microstates are <strong>equally likely</strong>, then the probability of each microstate occurring is <span class="arithmatex">\(1/2^N\)</span>. How many microstates correspond to macrostate <span class="arithmatex">\(n\)</span> (i.e., <span class="arithmatex">\(n\)</span> fleas on dog A)? This is equivalent to the number of ways to choose <span class="arithmatex">\(n\)</span> fleas from <span class="arithmatex">\(N\)</span> fleas to place on dog A, which is <span class="arithmatex">\(\binom{N}{n}\)</span>.</p>
<p>Therefore, the probability of macrostate <span class="arithmatex">\(n\)</span> is:</p>
<div class="arithmatex">\[
P_n = (\text{Number of microstates corresponding to macrostate } n) \times (\text{Probability of each microstate}) = \binom{N}{n} \cdot \frac{1}{2^N}
\]</div>
<p>This is completely consistent with the result we derived through dynamics (detailed balance). <strong>This shows that the dynamic process of the Ehrenfest model ultimately results in the system exploring all possible microstates and staying in them with equal probability.</strong></p>
<p>This binomial distribution has mean <span class="arithmatex">\(\langle n \rangle = N/2\)</span> and standard deviation <span class="arithmatex">\(\sigma_n = \frac{1}{2}\sqrt{N}\)</span>. This means that at equilibrium, we are most likely to find fleas roughly equally distributed on both dogs, with fluctuations around the mean.</p>
<p>When we consider a large system, i.e., when <span class="arithmatex">\(N\)</span> becomes very large (thermodynamic limit), a profound phenomenon emerges. The relative size of fluctuations is:</p>
<div class="arithmatex">\[
\frac{\sigma_n}{\langle n \rangle} = \frac{\frac{1}{2}\sqrt{N}}{N/2} = \frac{1}{\sqrt{N}}
\]</div>
<p>When <span class="arithmatex">\(N \to \infty\)</span>, this ratio tends to zero. This means that although the absolute size of fluctuations (<span class="arithmatex">\(\propto \sqrt{N}\)</span>) is increasing, relative to the average, it becomes negligible. This is how a macroscopically "sharp," predictable equilibrium state (like the temperature or pressure of gas in a container) emerges from a microscopically chaotic, fluctuating world. The Ehrenfest model perfectly demonstrates the law of large numbers in a physical context.</p>
<h2 id="3-the-statistical-arrow-of-time-reconciling-microscopic-reversibility-with-macroscopic-irreversibility">3. The Statistical Arrow of Time: Reconciling Microscopic Reversibility with Macroscopic Irreversibility<a class="headerlink" href="#3-the-statistical-arrow-of-time-reconciling-microscopic-reversibility-with-macroscopic-irreversibility" title="Permanent link">&para;</a></h2>
<h2 id="31-the-core-paradox">3.1 The Core Paradox<a class="headerlink" href="#31-the-core-paradox" title="Permanent link">&para;</a></h2>
<p>Now we address the most central problem. The microscopic dynamics of the model is time-reversible: a flea jumping from A to B and from B to A are equally reasonable physical processes. So why do we always observe macroscopic irreversible behavior? For example, a system with initial state of all fleas on dog A (<span class="arithmatex">\(n=N\)</span>) always evolves to a roughly equal distribution state (<span class="arithmatex">\(n \approx N/2\)</span>), and we almost never see the reverse process—a system in an equal distribution state spontaneously evolving to a state where all fleas are clustered on one side.</p>
<h2 id="32-the-story-of-two-trajectories">3.2 The Story of Two Trajectories<a class="headerlink" href="#32-the-story-of-two-trajectories" title="Permanent link">&para;</a></h2>
<p>The professor reveals the answer to this paradox by comparing the probabilities of two trajectories.</p>
<ul>
<li>
<p><strong>Trajectory 1 (forward)</strong>: The system is in a highly improbable state <span class="arithmatex">\(n=N\)</span> at time <span class="arithmatex">\(t\)</span> and evolves to the most probable state <span class="arithmatex">\(n=N/2\)</span> at time <span class="arithmatex">\(t+\tau\)</span>.</p>
</li>
<li>
<p><strong>Trajectory 2 (reverse)</strong>: The system is in the most probable state <span class="arithmatex">\(n=N/2\)</span> at time <span class="arithmatex">\(t\)</span> and evolves to a highly improbable state <span class="arithmatex">\(n=N\)</span> at time <span class="arithmatex">\(t+\tau\)</span>.</p>
</li>
</ul>
<p><img alt="Lecture blackboard screenshot" src="../../assets/images/remote/8d64adc2-771e-45e2-8bb0-14909d670de3-a743c4f559.jpg" /></p>
<p>Let us calculate the ratio of the joint probabilities of these two complete paths:</p>
<div class="arithmatex">\[
\frac{P(n=\frac{N}{2} \text{ at } t+\tau; n=N \text{ at } t)}{P(n=N \text{ at } t+\tau; n=\frac{N}{2} \text{ at } t)}
\]</div>
<p>Using the definition of conditional probability <span class="arithmatex">\(P(A, B) = P(A|B)P(B)\)</span>, where <span class="arithmatex">\(P(B)\)</span> is the probability of the initial state given by the steady-state distribution <span class="arithmatex">\(\pi\)</span>, the above can be rewritten as:</p>
<div class="arithmatex">\[
= \frac{P(\frac{N}{2}, t+\tau | N, t) \cdot \pi_N}{P(N, t+\tau | \frac{N}{2}, t) \cdot \pi_{N/2}}
\]</div>
<p>Here, the professor makes a key approximation: for a system described by the master equation, the conditional probabilities of transitions are symmetric in some sense, i.e., the conditional probability of transitioning from one state to another is roughly equivalent to the conditional probability of the reverse process. Therefore, <span class="arithmatex">\(P(N/2, t+\tau | N, t) \approx P(N, t+\tau | N/2, t)\)</span>.</p>
<p>This way, the entire ratio simplifies to the ratio of the steady-state probabilities of the two endpoint states:</p>
<div class="arithmatex">\[
\approx \frac{\pi_N}{\pi_{N/2}}
\]</div>
<p>Substituting our derived binomial distribution result:</p>
<div class="arithmatex">\[
\frac{\pi_N}{\pi_{N/2}} = \frac{\frac{1}{2^N} \binom{N}{N}}{\frac{1}{2^N} \binom{N}{N/2}} = \frac{\binom{N}{N}}{\binom{N}{N/2}} = \frac{1}{\binom{N}{N/2}} = \frac{(N/2)! (N/2)!}{N!}
\]</div>
<p>Using Stirling's approximation <span class="arithmatex">\(N! \approx \sqrt{2\pi N} \left(\frac{N}{e}\right)^N\)</span>, we can estimate that this ratio is approximately <span class="arithmatex">\(2^{-N}\)</span>. Even for a moderately sized system, say <span class="arithmatex">\(N=50\)</span>, this ratio is an astronomical number (<span class="arithmatex">\(\approx 10^{-15}\)</span>).</p>
<p>This means that the path from an ordered state (<span class="arithmatex">\(n=N\)</span>) evolving to a disordered state (<span class="arithmatex">\(n=N/2\)</span>) is astronomically more likely than its time-reversed path.</p>
<h2 id="33-resolution-of-the-paradox-microstates-vs-macrostates">3.3 Resolution of the Paradox: Microstates vs. Macrostates<a class="headerlink" href="#33-resolution-of-the-paradox-microstates-vs-macrostates" title="Permanent link">&para;</a></h2>
<p>The key here lies in distinguishing <strong>microstates</strong> and <strong>macrostates</strong>. Macroscopic irreversibility does not arise from temporal asymmetry in the underlying physical laws, but from pure, overwhelming statistics.</p>
<ul>
<li>
<p>Macrostate <span class="arithmatex">\(n=N\)</span> corresponds to only <strong>1</strong> microstate (all fleas on dog A).</p>
</li>
<li>
<p>Macrostate <span class="arithmatex">\(n=N/2\)</span> corresponds to <span class="arithmatex">\(\binom{N}{N/2}\)</span> microstates, which is a huge number.</p>
</li>
</ul>
<p>The system is not being "pulled" toward equilibrium by some mysterious force; it is simply exploring all <span class="arithmatex">\(2^N\)</span> possible microstates equally. Since the number of microstates corresponding to the equilibrium macrostate is so vast, the system will spend the vast majority of its time in one of these microstates. Therefore, starting from a macrostate with only one microstate, the system will almost inevitably evolve to a macrostate with a huge number of microstates. The reverse process is not impossible, but its probability is so small that it is almost unobservable even on the time scale of the age of the universe.</p>
<p>This leads to a profound conclusion about the arrow of time. "A statistically determined direction of time arises from the assumption that a system in an extremely improbable ordered state is 'prepared' by external influences." We can only perceive the arrow of time because we (or nature) can create a low-entropy, highly ordered initial state. Starting from this special starting point, overwhelming probability determines that it must inevitably move toward disorder. If we observe a system already in equilibrium, we see it making small, symmetric fluctuations around the average. At this point, "a movie of these fluctuations, played forward or backward, is statistically indistinguishable," because near equilibrium, "fluctuations have no sense of time direction." Therefore, the arrow of time is not an intrinsic property of dynamics itself, but arises from a very special, nonequilibrium initial condition.</p>
<h2 id="4-simulating-the-ehrenfest-model-in-python">4. Simulating the Ehrenfest Model in Python<a class="headerlink" href="#4-simulating-the-ehrenfest-model-in-python" title="Permanent link">&para;</a></h2>
<p>We use the Gillespie algorithm for continuous‑time Markov processes: compute the total exit rate, draw an exponential waiting time, then choose the jump by relative rates.</p>
<h2 id="41-simulating-trajectories">4.1 Simulating Trajectories<a class="headerlink" href="#41-simulating-trajectories" title="Permanent link">&para;</a></h2>
<p><img alt="Lecture slide" src="../../assets/images/remote/7027b105-d864-4516-b289-d132fa9add76-9178981de9.png" /></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">simulate_ehrenfest_trajectory</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">n_initial</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lambda_rate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">t_max</span><span class="o">=</span><span class="mi">40</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate a single trajectory of the Ehrenfest model using the Gillespie algorithm.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">n_initial</span>
    <span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">]</span>
    <span class="n">n_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">t_max</span><span class="p">:</span>
        <span class="n">rate_gain</span> <span class="o">=</span> <span class="n">lambda_rate</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">rate_lose</span> <span class="o">=</span> <span class="n">lambda_rate</span> <span class="o">*</span> <span class="n">n</span>
        <span class="n">total_rate</span> <span class="o">=</span> <span class="n">rate_gain</span> <span class="o">+</span> <span class="n">rate_lose</span>
        <span class="k">if</span> <span class="n">total_rate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">total_rate</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
        <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="n">t_max</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">rate_gain</span> <span class="o">/</span> <span class="n">total_rate</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">n_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">n_values</span>

<span class="c1"># --- Simulation parameters ---</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">mean_n</span> <span class="o">=</span> <span class="n">N</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">std_n</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">lambda_rate_sim</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Stochastic Trajectories&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">)</span>

<span class="c1"># Left: relaxation from far from equilibrium</span>
<span class="n">num_trajectories</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">n_initial_short</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">t_max_short</span> <span class="o">=</span> <span class="mi">50</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_trajectories</span><span class="p">):</span>
    <span class="n">times</span><span class="p">,</span> <span class="n">n_values</span> <span class="o">=</span> <span class="n">simulate_ehrenfest_trajectory</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">n_initial</span><span class="o">=</span><span class="n">n_initial_short</span><span class="p">,</span> <span class="n">lambda_rate</span><span class="o">=</span><span class="n">lambda_rate_sim</span><span class="p">,</span> <span class="n">t_max</span><span class="o">=</span><span class="n">t_max_short</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">n_values</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">mean_n</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orangered&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\langle n \rangle$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">mean_n</span> <span class="o">+</span> <span class="n">std_n</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\langle n \rangle \pm \sigma$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">mean_n</span> <span class="o">-</span> <span class="n">std_n</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Fleas on Alice&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max_short</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">38</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Right: long equilibrium fluctuations</span>
<span class="n">n_initial_long</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mean_n</span><span class="p">);</span> <span class="n">t_max_long</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">times_long</span><span class="p">,</span> <span class="n">n_values_long</span> <span class="o">=</span> <span class="n">simulate_ehrenfest_trajectory</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">n_initial</span><span class="o">=</span><span class="n">n_initial_long</span><span class="p">,</span> <span class="n">lambda_rate</span><span class="o">=</span><span class="n">lambda_rate_sim</span><span class="p">,</span> <span class="n">t_max</span><span class="o">=</span><span class="n">t_max_long</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times_long</span><span class="p">,</span> <span class="n">n_values_long</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">mean_n</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orangered&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">mean_n</span> <span class="o">+</span> <span class="n">std_n</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">mean_n</span> <span class="o">-</span> <span class="n">std_n</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max_long</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">38</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="Code execution output" src="../../assets/images/remote/4bd5a9d7-9449-4e91-80b5-d1476218444d-e6262499c2.png" /></p>
<p>The system quickly relaxes from <span class="arithmatex">\(n=50\)</span> to <span class="arithmatex">\(\langle n\rangle=25\)</span> and then fluctuates around the mean within roughly one standard deviation.</p>
<h3 id="42-verifying-the-equilibrium-distribution">4.2 Verifying the Equilibrium Distribution<a class="headerlink" href="#42-verifying-the-equilibrium-distribution" title="Permanent link">&para;</a></h3>
<p><img alt="Lecture slide" src="../../assets/images/remote/d85cc48f-351c-4d30-89a0-26840f431eb7-f414440146.png" /></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">comb</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>

<span class="k">def</span><span class="w"> </span><span class="nf">simulate_ehrenfest_trajectory</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">n_initial</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lambda_rate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">t_max</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="n">n_initial</span>
    <span class="n">times</span><span class="p">,</span> <span class="n">n_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">t_max</span><span class="p">:</span>
        <span class="n">rate_gain</span> <span class="o">=</span> <span class="n">lambda_rate</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">rate_lose</span> <span class="o">=</span> <span class="n">lambda_rate</span> <span class="o">*</span> <span class="n">n</span>
        <span class="n">total_rate</span> <span class="o">=</span> <span class="n">rate_gain</span> <span class="o">+</span> <span class="n">rate_lose</span>
        <span class="k">if</span> <span class="n">total_rate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">total_rate</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
        <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="n">t_max</span><span class="p">:</span> <span class="k">break</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">rate_gain</span> <span class="o">/</span> <span class="n">total_rate</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">);</span> <span class="n">n_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">n_values</span>

<span class="k">def</span><span class="w"> </span><span class="nf">simulate_for_distribution</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lambda_rate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">num_steps</span><span class="o">=</span><span class="mi">100000</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">n_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_steps</span><span class="p">):</span>
        <span class="n">rate_gain</span> <span class="o">=</span> <span class="n">lambda_rate</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">rate_lose</span> <span class="o">=</span> <span class="n">lambda_rate</span> <span class="o">*</span> <span class="n">n</span>
        <span class="n">total_rate</span> <span class="o">=</span> <span class="n">rate_gain</span> <span class="o">+</span> <span class="n">rate_lose</span>
        <span class="k">if</span> <span class="n">total_rate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">rate_gain</span> <span class="o">/</span> <span class="n">total_rate</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">n_counts</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">n_counts</span> <span class="o">/</span> <span class="n">num_steps</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span> <span class="n">mean_n</span> <span class="o">=</span> <span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="n">std_n</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Equilibrium Distribution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">)</span>

<span class="n">times</span><span class="p">,</span> <span class="n">n_values</span> <span class="o">=</span> <span class="n">simulate_ehrenfest_trajectory</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">n_initial</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">t_max</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">n_values</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">mean_n</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orangered&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">mean_n</span> <span class="o">+</span> <span class="n">std_n</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">mean_n</span> <span class="o">-</span> <span class="n">std_n</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Fleas on Alice&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">simulated_dist</span> <span class="o">=</span> <span class="n">simulate_for_distribution</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">num_steps</span><span class="o">=</span><span class="mi">5_000_000</span><span class="p">)</span>
<span class="n">n_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">analytical_dist</span> <span class="o">=</span> <span class="n">comb</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">n_range</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">N</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">n_range</span><span class="p">,</span> <span class="n">simulated_dist</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;simulation&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n_range</span><span class="p">,</span> <span class="n">analytical_dist</span><span class="p">,</span> <span class="s1">&#39;ko-&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;analytic solution&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Fleas on Alice&#39;</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">38</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="Code execution output" src="../../assets/images/remote/e34a2d8a-4d4b-43b1-9825-b391c10608c4-35fe60f14b.png" /></p>
<p>The empirical distribution matches the binomial prediction.</p>
<h2 id="5-quantifying-the-journey-to-equilibrium-statistical-entropy-and-kl-divergence">5. Quantifying the Journey to Equilibrium: Statistical Entropy and KL Divergence<a class="headerlink" href="#5-quantifying-the-journey-to-equilibrium-statistical-entropy-and-kl-divergence" title="Permanent link">&para;</a></h2>
<p>We have qualitatively described how the system approaches equilibrium. Now we want to quantitatively characterize this process with a quantity. This quantity is <strong>entropy</strong>.</p>
<p><img alt="Lecture slide" src="../../assets/images/remote/e07aeb02-1559-4bf5-b8e2-eb35b61a83be-746ccb4c4f.png" /></p>
<h2 id="51-defining-time-dependent-entropy">5.1 Defining Time-Dependent Entropy<a class="headerlink" href="#51-defining-time-dependent-entropy" title="Permanent link">&para;</a></h2>
<p>In statistical mechanics, the most fundamental definition of entropy is the Gibbs/Shannon entropy, which measures the uncertainty or "spread" of the probability distribution over all possible microstates:</p>
<div class="arithmatex">\[
S(t) := -\sum_{\{\sigma_i\}} p(\{\sigma_i\}, t) \ln p(\{\sigma_i\}, t)
\]</div>
<p>where the sum runs over all <span class="arithmatex">\(2^N\)</span> microstates <span class="arithmatex">\(\{\sigma_i\}\)</span>, and <span class="arithmatex">\(p(\{\sigma_i\}, t)\)</span> is the probability that the system is in a specific microstate at time <span class="arithmatex">\(t\)</span>.</p>
<h2 id="52-from-micro-to-macro-entropy">5.2 From Micro to Macro Entropy<a class="headerlink" href="#52-from-micro-to-macro-entropy" title="Permanent link">&para;</a></h2>
<p>Directly handling microstate probabilities is usually difficult. The professor shows how to transition from the microscopic definition to entropy expressed in terms of macrostate probabilities <span class="arithmatex">\(p_n(t)\)</span>. The core assumption is: at any time <span class="arithmatex">\(t\)</span>, all <span class="arithmatex">\(\binom{N}{n}\)</span> microstates belonging to the same macrostate <span class="arithmatex">\(n\)</span> are equally likely. Therefore, the relationship between macrostate and microstate probabilities is:</p>
<div class="arithmatex">\[
p_n(t) = \binom{N}{n} p(\{\sigma_i\}, t)
\]</div>
<p>Substituting this relationship into the entropy definition and simplifying, we obtain the macro-entropy expression:</p>
<div class="arithmatex">\[
S(t) = -\sum_{n=0}^{N} p_n(t) \ln p_n(t) + \sum_{n=0}^{N} p_n(t) \ln \binom{N}{n}
\]</div>
<p>This formula reveals that the total entropy consists of two parts:</p>
<ol>
<li>
<p><strong>First term</strong> <span class="arithmatex">\(-\sum p_n \ln p_n\)</span>: This is the entropy of uncertainty about which <strong>macrostate</strong> the system is in.</p>
</li>
<li>
<p><strong>Second term</strong> <span class="arithmatex">\(\sum p_n \ln \binom{N}{n}\)</span>: This is the average uncertainty about <strong>microstates</strong> given the macrostate distribution <span class="arithmatex">\(p_n(t)\)</span>. Each term <span class="arithmatex">\(\ln \binom{N}{n}\)</span> is the Boltzmann entropy of macrostate <span class="arithmatex">\(n\)</span> (proportional to the logarithm of its number of microstates), and the entire sum is the expectation value of this Boltzmann entropy under the current macrostate distribution.</p>
</li>
</ol>
<h2 id="53-kl-divergence-measuring-distance-to-equilibrium">5.3 KL Divergence: Measuring "Distance" to Equilibrium<a class="headerlink" href="#53-kl-divergence-measuring-distance-to-equilibrium" title="Permanent link">&para;</a></h2>
<p>To describe the difference between the system's current state <span class="arithmatex">\(p_n(t)\)</span> and the final equilibrium state <span class="arithmatex">\(\pi_n\)</span>, the professor introduces a powerful tool from information theory—the <strong>Kullback-Leibler Divergence</strong> (KL divergence):</p>
<div class="arithmatex">\[
H(t) = \sum_n p_n(t) \ln \left(\frac{p_n(t)}{\pi_n}\right)
\]</div>
<p>The KL divergence <span class="arithmatex">\(H(t)\)</span> is an asymmetric measure used to quantify the "deviation" of probability distribution <span class="arithmatex">\(p_n(t)\)</span> relative to the reference distribution <span class="arithmatex">\(\pi_n\)</span>. It is always non-negative (<span class="arithmatex">\(H(t) \geq 0\)</span>), and equals zero if and only if the two distributions are identical (i.e., <span class="arithmatex">\(p_n(t) = \pi_n\)</span> for all <span class="arithmatex">\(n\)</span>). In our physical context, <span class="arithmatex">\(H(t)\)</span> quantitatively describes the "information distance" between the system's current probability distribution and its final equilibrium distribution.</p>
<p>The most profound connection lies in a simple relationship between the KL divergence and the macro-entropy we defined:</p>
<div class="arithmatex">\[
H(t) = S_\infty - S(t)
\]</div>
<p>where <span class="arithmatex">\(S_\infty\)</span> is the maximum entropy when the system reaches equilibrium. This relationship shows that the process of <span class="arithmatex">\(H(t)\)</span> monotonically decreasing to zero over time is completely equivalent to the process of the system's entropy <span class="arithmatex">\(S(t)\)</span> monotonically increasing to its maximum value <span class="arithmatex">\(S_\infty\)</span>. This provides a formal, quantitative description of the second law of thermodynamics (entropy increase principle), known as the H-theorem.</p>
<h2 id="54-simulating-entropy-evolution">5.4 Simulating Entropy Evolution<a class="headerlink" href="#54-simulating-entropy-evolution" title="Permanent link">&para;</a></h2>
<p>To visualize the evolution of entropy and KL divergence, we need to simulate an <strong>ensemble</strong>, i.e., a large number of independent system copies. By statistically analyzing the states of the ensemble at different times, we can approximate the time-dependent probability distribution <span class="arithmatex">\(p_n(t)\)</span>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">comb</span>

<span class="k">def</span><span class="w"> </span><span class="nf">simulate_ensemble</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">n_initial</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">num_trajectories</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">t_points</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">100</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates an ensemble of Ehrenfest trajectories to calculate p_n(t).</span>
<span class="sd">    Returns p_n_t with p_n_t[i, j] = p_j(t_i).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Tau-leaping approximation for speed (sufficient for demonstration)</span>
    <span class="n">p_n_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">t_points</span><span class="p">),</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">p_n_t</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_initial</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">t_points</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_points</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">lambda_rate</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_points</span><span class="p">)):</span>
        <span class="n">p_prev</span> <span class="o">=</span> <span class="n">p_n_t</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">p_curr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">p_prev</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">p_curr</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-=</span> <span class="n">p_prev</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="n">lambda_rate</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">n</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">p_curr</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+=</span> <span class="n">p_prev</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">lambda_rate</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">:</span>
                <span class="n">p_curr</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+=</span> <span class="n">p_prev</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">lambda_rate</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">p_n_t</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">p_curr</span>
    <span class="k">return</span> <span class="n">p_n_t</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">p_n_t</span> <span class="o">=</span> <span class="n">simulate_ensemble</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">n_initial</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">t_points</span><span class="o">=</span><span class="n">t_eval</span><span class="p">)</span>

<span class="n">pi_n</span> <span class="o">=</span> <span class="n">comb</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">N</span><span class="p">)</span>
<span class="n">log_comb_N_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">comb</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>

<span class="n">S_t</span><span class="p">,</span> <span class="n">H_t</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">p_n</span> <span class="ow">in</span> <span class="n">p_n_t</span><span class="p">:</span>
    <span class="n">p_n_safe</span> <span class="o">=</span> <span class="n">p_n</span><span class="p">[</span><span class="n">p_n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">pi_n_safe</span> <span class="o">=</span> <span class="n">pi_n</span><span class="p">[</span><span class="n">p_n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">term1</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p_n_safe</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_n_safe</span><span class="p">))</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p_n</span> <span class="o">*</span> <span class="n">log_comb_N_n</span><span class="p">)</span>
    <span class="n">S_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span><span class="p">)</span>
    <span class="n">H_t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p_n_safe</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_n_safe</span> <span class="o">/</span> <span class="n">pi_n_safe</span><span class="p">)))</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_eval</span><span class="p">,</span> <span class="n">S_t</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Statistical Entropy S(t)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Entropy S(t)&#39;</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_eval</span><span class="p">,</span> <span class="n">H_t</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Kullback-Leibler Divergence H(t)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;KL Divergence H(t)&#39;</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="Code execution output" src="../../assets/images/remote/StatisticalEntropyKLDivergence.png" /></p>
<p>Running this code, we will get two plots: one showing entropy <span class="arithmatex">\(S(t)\)</span> monotonically increasing from a low initial value (corresponding to a highly ordered initial state) and eventually saturating at a maximum; the other showing KL divergence <span class="arithmatex">\(H(t)\)</span> starting from a positive value, monotonically decreasing, and eventually approaching zero. These two plots vividly visualize the operation of the second law of thermodynamics in the Ehrenfest model.</p>
<h2 id="summary-basic-insights-of-statistical-mechanics">Summary: Basic Insights of Statistical Mechanics<a class="headerlink" href="#summary-basic-insights-of-statistical-mechanics" title="Permanent link">&para;</a></h2>
<p>Some basic insights:</p>
<p>(i) A macroscopically imbalanced initial state overwhelmingly evolves toward more disordered, near-equilibrium states.</p>
<p>(ii) In equilibrium, fluctuations have no arrow of time.</p>
<p>(iii) Large fluctuations away from equilibrium (to extremely improbable states) are exceedingly rare.</p>
<p>(iv) Through detailed analysis and simulation of the Ehrenfest model, we have actually touched upon several of the most central ideas of statistical mechanics. The professor summarizes four "basic insights" at the end of the lecture, which are a perfect summary of this lecture's content:</p>
<p><img alt="Lecture slide" src="../../assets/images/remote/822f95a5-fddc-402b-b89f-248c27607903-74630f12a1.png" /></p>
<p><strong>1. A macroscopically imbalanced initial state will evolve with overwhelming probability toward more disordered, near-equilibrium states.</strong></p>
<p>This is exactly what we revealed through calculating the probability ratio <span class="arithmatex">\(\pi_{N/2}/\pi_N \sim 2^{-N}\)</span>. The system approaches equilibrium not because there is some "force" driving it, but because the number of microstates corresponding to the equilibrium state is simply too vast.</p>
<p><strong>2. In equilibrium, fluctuations have no arrow of time.</strong></p>
<p>This is closely related to the concept of detailed balance. Near equilibrium, the system jumps back and forth between two states with similar probabilities, and the forward and reverse processes are statistically indistinguishable.</p>
<p><strong>3. Large fluctuations from equilibrium (i.e., evolution to extremely improbable states) are exceedingly rare.</strong></p>
<p>This is a direct consequence of the properties of the binomial distribution. The probability distribution forms a sharp peak at the mean, with probabilities dropping exponentially for states far from the mean, making the spontaneous generation of macroscopically ordered states virtually impossible.</p>
<p><strong>4. A statistically determined arrow of time originates from the assumption that a system is prepared in a highly ordered, very improbable state. Even for the relatively small system we considered, using words like "overwhelmingly" and "exceedingly" is very conservative.</strong></p>
<p>A statistically determined arrow of time arises from our assumption that the system is "prepared" in a highly improbable ordered state. This is the most profound insight into the origin of the "arrow of time." We see irreversibility because we always start observing from a special, low-entropy initial condition. <strong>The arrow of time is not an intrinsic property of physical laws, but a reflection of the initial conditions of the universe (or our experiments).</strong></p>
<p>In summary, despite its extreme simplicity, the Ehrenfest model allows us to clearly observe and understand the <strong>cornerstones of statistical mechanics—irreversibility, entropy, equilibrium, and the statistical origin of the arrow of time.</strong></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy", "navigation.sections", "navigation.expand", "navigation.top", "toc.integrate", "search.highlight"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../assets/javascripts/mathjax.js"></script>
      
        <script src="../../assets/javascripts/language-nav.js"></script>
      
        <script src="../../assets/javascripts/video-init.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>