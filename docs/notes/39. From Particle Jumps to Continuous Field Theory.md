# Introduction: Two Paths from Discrete Jumps to Continuous Field Theory

In the previous lectures (particularly **Lectures 32** through **37**), various powerful path integral formalisms have been systematically established to describe the collective behavior of stochastic many-body systems. Whether based on continuous Langevin equations through the **Janssen-De Dominicis response functional** or handling discrete particle birth-death processes through **coherent-state path integrals**, the core objective is to transform the microscopic dynamics describing individual stochastic events (master equations or Langevin equations) into an equivalent, more analytically tractable field theory.

**Lecture 38** extended this framework to spatial dimensions by defining multi-species local reactions and diffusion processes on a discrete **spatial lattice**, laying the foundation for describing spatiotemporal dynamics. This naturally raises a fundamental and crucial question: How can we construct path integrals on this discrete lattice system and correctly derive a macroscopic, continuous field theory description from it?

This question may seem like merely a mathematical operation of taking limits (i.e., letting the lattice spacing $a \to 0$), but it conceals profound physical implications. This limiting process is not always straightforward; different mathematical formalisms (ways of constructing path integrals) may yield drastically different physical results after taking the limit.

This lecture will reveal the subtleties in this process by comparing two famous path integral methods. The core issue is: which method can truly capture the **stochastic fluctuations** inherent to the underlying discrete particle system's random jumps?

This lecture will focus on two main methods for constructing path integrals:

1. **Doi-Peliti (DP) Path Integral**: This is a "field-first" approach, whose ideas originate from the coherent-state representation of **Lecture 36**. From the beginning, it maps particle creation and annihilation operators to continuous field variables and their derivatives, naturally leading to a description of smooth fields.

2. **Kramers-Moyal Path Integral (KMPI)**: This is an "event-first" approach, whose ideas originate from the Kramers-Moyal expansion of **Lecture 37**. It starts directly from the jump processes in master equations, explicitly preserving in mathematical form the discrete event characteristics of particles jumping from one lattice site to another.

By comparing how these two methods describe the same physical process—diffusion—we will see that the Doi-Peliti path integral ultimately gives a deterministic, mean-field level description, while the Kramers-Moyal path integral successfully preserves the system's stochasticity, ultimately deriving a stochastic field theory containing **intrinsic noise**. This "confrontation" will profoundly reveal how the choice of mathematical formalism determines the depth and breadth of the physical image that can ultimately be seen.

# 1. Doi-Peliti Formalism: A Deterministic Mean-Field Picture

In **Lecture 38**, the theoretical framework has been extended to spatial dimensions by defining reaction and diffusion processes on a discrete lattice. The first task of this lecture is to apply the **Doi-Peliti (DP) coherent-state path integral** method established in **Lecture 36** to construct path integrals for diffusion processes on this lattice and attempt to derive its continuous field theory. The DP formalism is renowned for its mathematical elegance and simplicity, efficiently deriving the system's average behavior. Through this derivation, we will clearly see the power of this method and the price it pays for capturing true stochasticity.

The Doi-Peliti path integral was independently proposed and systematized by Japanese physicist Masaki Doi and Italian physicist Graham Peliti in the late 1970s to early 1980s. Its historical origin lies in creatively introducing coherent states from quantum field theory and path integral techniques into classical stochastic systems. The physical essence of this method is to construct a rigorous field theory framework for describing stochastic processes with variable particle numbers (such as chemical reactions, population dynamics, and ecological succession): by introducing creation and annihilation operators, it maps master equations into a functional integral form based on coherent states, whose action naturally includes many-body correlations and fluctuation effects caused by particle interactions. The specific applications of Doi-Peliti field theory are extremely broad, having become a core mathematical tool for studying nonequilibrium statistical physics, deeply applied to nonequilibrium phase transitions in reaction-diffusion systems (such as directed percolation), stochastic evolution in population biology, noise propagation in gene regulatory networks, collective motion of active matter, and epidemic transmission dynamics, providing powerful analytical and numerical computational tools for understanding fluctuation-dominated rare events and critical phenomena.

## 1.1 Field Representation of Diffusion Operators

The starting point of the theory is to describe the process of particles jumping between lattice sites (diffusion) using the creation-annihilation operator language developed in **Lecture 36**. For a single-species system, the total Liouvillian operator containing only the diffusion part can be written as:

$$
\hat{\mathcal{Q}}_{\text{DIFF}} = \sum_{i} \sum_{j \sim i} D_{ij} \left( a_i^\dagger a_j - a_i^\dagger a_i \right) = \sum_{i} \sum_{j \sim i} D_{ij} a_i^\dagger (a_j - a_i)
$$

* $i, j$ are indices of lattice sites.

* $j \sim i$ indicates that $j$ is a nearest neighbor of $i$.

* $D_{ij}$ is the rate at which particles jump from lattice site $j$ to lattice site $i$.

* $a_j$ and $a_i^\dagger$ are the annihilation operator at site $j$ and creation operator at site $i$, respectively.

**Physical meaning**: This expression describes the net change in particle number at lattice site $i$.

* The first term $D_{ij} a_i^\dagger a_j$ describes the **gain** process of particles jumping from neighboring site $j$ to site $i$ at rate $D_{ij}$ (annihilation at $j$, creation at $i$).

* The second term $-D_{ij} a_i^\dagger a_i$ describes the **loss** process of particles jumping from site $i$ to neighboring site $j$. Summing over all neighbors $j$ gives the total probability flow out of site $i$.

The core step of the Doi-Peliti formalism is to map these abstract operators to continuous field variables and their differential operators. According to the rules established in **Lecture 36** (including the Doi-shift):

$$
a_i^\dagger \to \phi_i \quad \text{and} \quad a_i \to \partial_i + 1 \quad \text{where} \quad \partial_i \equiv \frac{\partial}{\partial \phi_i}
$$

* Here $\phi_i$ is a continuous (complex) field, which can be understood as some kind of field amplitude or generating function variable at lattice site $i$.

* The introduction of the Doi-shift "+1" is to make the operator algebra perfectly correspond to the bosonic algebra.

When this mapping is substituted into $\hat{\mathcal{Q}}_{\text{DIFF}}$, an important simplification occurs:

$$a_j - a_i = (\partial_j + 1) - (\partial_i + 1) = \partial_j - \partial_i$$

The Doi-shift terms cancel out exactly in describing particle number-conserving diffusion processes. Therefore, the field representation of the operator is:

$$\hat{\mathcal{Q}}_{\text{DIFF}} \to \sum_{i} \sum_{j \sim i} D_{ij} \phi_i (\partial_j - \partial_i)$$

This expression can be rearranged based on lattice symmetry into a more convenient form for subsequent derivations:

$$\hat{\mathcal{Q}}_{\text{DIFF}} \to \sum_{i} \sum_{j \sim i} (D_{ij} \phi_j - D_{ji} \phi_i) \partial_i$$

**Physical meaning**:
This conversion from operators to differential operators is the first and crucial step of the DP method. It transforms a quantized language describing discrete particle jumps into a classical partial differential equation language describing continuous field evolution.

## 1.2 Doi-Peliti Action and Its Continuous Limit

With the field representation of operators, we can follow the Janssen-De Dominicis formalism introduced in **Lecture 32** to construct the path integral action describing system evolution. For a system containing diffusion and local reactions, the action is:

$$S[\{\phi_i, i\tilde{\phi}_i\}] = \int_{t_0}^{t} d\tau \sum_{i \in L} \left[ i\tilde{\phi}_i \partial_\tau \phi_i - \mathcal{Q}^{(i)}_{\text{DIFF}} - \mathcal{Q}^{(i)}_{\text{REACT}} \right]$$

* The response field $i\tilde{\phi}_i$ is introduced, whose role is to act as a Lagrange multiplier to enforce that system evolution follows the dynamical equations defined by the Liouvillian operator $\mathcal{Q}$.

* $\mathcal{Q}^{(i)}_{\text{DIFF}}$ is the "symbolic" form of the diffusion operator derived in the previous subsection, obtained by replacing $\partial_i \to i\tilde{\phi}_i$, i.e., $\sum_{j \sim i} (D_{ij} \phi_j - D_{ji} \phi_i) (i\tilde{\phi}_i)$.

Now, focusing on the diffusion part and taking the **continuum limit**. For simplicity, assume a uniform and isotropic system, i.e., all jump rates are the same, $D_{ij} = D_{ji} = D$. At this point, the diffusion term in the action becomes:

$$
- \sum_i (i\tilde{\phi}_i) D \sum_{j \sim i} (\phi_j - \phi_i)
$$

The sum $\sum_{j \sim i} (\phi_j - \phi_i)$ is precisely the **lattice Laplacian operator**. The rules for taking the continuous limit are as follows:

* The lattice spacing is $a$.

* Lattice summation is replaced by spatial integration: $\sum_{i \in L} a^d \to \int d^d x$.

* Field variables are normalized to density: $\frac{1}{a^d} \phi_i(t) \to \phi(\vec{r}_i, t)$.

* Response fields undergo similar replacement: $\tilde{\phi}_i(t) \to \tilde{\phi}(\vec{r}_i, t)$.

The lattice Laplacian operator converges to the continuous Laplacian operator $\nabla^2$ in the limit $a \to 0$:

$$
\sum_{j \sim i} (\phi_j - \phi_i) \xrightarrow{a \to 0} a^2 \nabla^2 \phi
$$

Substituting all rules and organizing, we finally obtain the continuous action for the diffusion process:

$$
S_{\text{DIFF}}[\phi, i\tilde{\phi}] = \int dt \int d^d x \left[ i\tilde{\phi}(\vec{r}, t) \left( \partial_t - D \nabla^2 \right) \phi(\vec{r}, t) \right]
$$

**Physical meaning**:

This action is in the standard MSRJD form, describing a completely deterministic process. The physical image of the path integral is determined by the **saddle point**, i.e., the path that makes the variation of the action with respect to the response field $i\tilde{\phi}$ zero. Executing this variation ($\delta S / \delta(i\tilde{\phi}) = 0$), we directly obtain the system's "classical" equation of motion:

$$
\partial_t \phi(\vec{r}, t) = D \nabla^2 \phi(\vec{r}, t)
$$

This is precisely the classical, deterministic **diffusion equation**.

## 1.3 Deep Interpretation: The "Premature Averaging" of Doi-Peliti Formalism

This derivation yields a completely deterministic result. This raises a key question: where have the stochastic fluctuations brought by particle discreteness gone?

The answer lies in the construction method of the Doi-Peliti formalism itself. By using the continuous field representation $a^\dagger \to \phi$, $a \to \partial_\phi + 1$ from the beginning, this method actually performs a kind of "averaging" or "smoothing" treatment in the first step.

1. **Blurring of operator algebra**: The underlying creation and annihilation operators satisfy commutation relations $[a_i, a_j^\dagger] = \delta_{ij}$, which contains information about the indivisible discreteness of particles. Although the mapping $[\partial_i, \phi_j] = \delta_{ij}$ preserves this algebraic structure, it immediately projects the problem into a space composed of **continuous functions**, thereby blurring the discrete nature of counting.

2. **Quadratic structure of the action**: The final DP action obtained is a **quadratic form** of field variables $\phi$ and $i\tilde{\phi}$ (i.e., only containing terms like $i\tilde{\phi}\phi$ or $i\tilde{\phi}\nabla^2\phi$). In field theory, quadratic actions always correspond to linear, non-interacting, or deterministic theories. All information about fluctuations and correlations is hidden in higher-order terms (e.g., $(i\tilde{\phi})^2\phi^2$), and these terms do not appear in the DP formalism's derivation for diffusion.

The Doi-Peliti formalism is very suitable for deriving the system's **mean-field dynamics**. It accurately answers the question "How does the average concentration of particles evolve?" However, due to its inherent construction, it "filters out" all information about how concentrations randomly fluctuate around their average values. What it gives is a smooth, noise-free macroscopic image.

## 1.4 The "Classical" Nature of Operator Algebra

Throughout the derivation process, we frequently use terms like "creation operators," "annihilation operators," and "commutation relations" that originate from quantum mechanics, and their algebraic structure $[a, a^\dagger]=1$ is identical to bosonic operators. Does this mean we are dealing with a quantum system?

The answer is no. As the professor emphasized in the course, the theoretical framework here is **essentially classical**. The operator algebra here is not describing quantum state superposition and entanglement, but rather serving as an extremely powerful **mathematical tool** for solving partial differential equations describing classical probability evolution.

* **Classical probability vs. quantum probability amplitude**: The state vector $|\Phi(t)\rangle$ we deal with has expansion coefficients that are real **probabilities** $P(n,t)$; while in quantum mechanics, the expansion coefficients of wave functions are complex **probability amplitudes**, which need to be squared to obtain probabilities.

* **Mathematical isomorphism**: The reason classical stochastic processes and quantum systems can share the same set of operator algebras is that their underlying evolution equations (master equations vs. Schrödinger equations) are mathematically isomorphic. Raising and lowering operators are here a universal technique for solving the spectral series of linear operators, not a patent of quantum phenomena.

Deliberately avoiding purely quantum terminology like "coherent states" and instead using language closer to classical probability theory like "Poisson representation" and "generating functions" is precisely to emphasize this conceptual distinction and avoid confusing classical stochastic processes with true quantum many-body problems.

## 1.5 Background Knowledge: Bosonic Models vs. Exclusion Processes

The field theory model constructed in this lecture implicitly assumes an important physical assumption: each lattice site can accommodate **any number** of particles. This is reflected in the operator algebra as operators from different lattice sites commuting with each other, and the creation operator $a_i^\dagger$ at a single lattice site can act infinitely many times. Such models are called **Bosonic Models** in physics.

In contrast, there is another important class of physical models—**Exclusion Processes**, such as the "Simple Symmetric Exclusion Process" (SSEP). In such models, each lattice site can accommodate at most one particle (fermionic characteristics). This means that when a particle attempts to jump into an already occupied lattice site, this jump will be forbidden.

Describing exclusion processes requires a different, more complex set of operator algebras (such as spin operators or fermionic operators). Understanding the "bosonic" nature of our current model helps clarify its scope of application and lays a conceptual foundation for future study of more complex models (such as systems including volume exclusion effects).

# 2. Kramers-Moyal Path Integral: Capturing Stochastic Jumps

The derivation in the previous section shows that the Doi-Peliti formalism, after taking the continuous limit, loses all information about stochastic fluctuations, ultimately yielding only a deterministic mean-field theory. To construct a more complete field theory that can describe true stochasticity, we need an alternative method that does not take "shortcuts" and remains faithful to the underlying discrete jump events.

This lecture will turn to the **Kramers-Moyal Path Integral (KMPI)** introduced in **Lecture 37**. This method starts directly from discrete jump events described by master equations, and its mathematical form can completely preserve all statistical information of the jump process, thus providing a solid foundation for correctly deriving stochastic field theory containing intrinsic noise.

## 2.1 Construction of the Action: Faithful to Jump Events

Unlike the DP formalism, KMPI starts directly from the integral form of master equations, and its corresponding action has a completely different structure. According to the derivation in **Lecture 37**, for pure diffusion processes on a lattice, the KMPI action is:

$$S[\{n_i, i\tilde{n}_i\}] = \int_{t_0}^{t} d\tau \sum_{i \in L} \left[ i\tilde{n}_i\partial_\tau n_i - \sum_{j \sim i} D_{ji} n_i \left(e^{i (\tilde{n}_j- \tilde{n}_i)}-1\right) \right]$$

* Here the variable $n_i$ represents the **real particle number** (or density) at lattice site $i$, not the abstract field $\phi_i$ in the DP formalism. $\tilde{n}_i$ is its corresponding response field.

* The core of the action is the exponential term $\left(e^{i (\tilde{n}_j - \tilde{n}_i)}-1\right)$, which precisely encodes single particle jump events.

**Physical meaning**: The structure of this term can be interpreted as **total jump rate × (jump operator)**.

* $D_{ji} n_i$ is the **total rate** at which particles jump from lattice site $i$ to its neighbor $j$.

* The exponential term $e^{i (\tilde{n}_j - \tilde{n}_i)}$ is, in the framework of path integrals, a Fourier representation of a **"shift operator"**. It precisely executes the operation of decreasing the particle number at site $i$ by one (corresponding to the factor $e^{-i\tilde{n}_i}$) while increasing the particle number at site $j$ by one (corresponding to the factor $e^{i\tilde{n}_j}$).

* Subtracting 1 ensures that when no jump occurs, this term is zero and contributes no dynamics.

Therefore, the KMPI action does not linearize the jump process in advance like the DP formalism, but completely preserves its exponential form, thereby also preserving all statistical information of jump events.

## 2.2 Continuous Limit and Kramers-Moyal Expansion: The Emergence of Noise

Now, perform the same operation on the KMPI action: take the continuous limit. This is the core calculation of this lecture. This process will reveal that systematically expanding the exponential term is equivalent to a **Kramers-Moyal expansion**, from which noise terms naturally emerge.

Expand the exponential term in a Taylor series:

$$
e^x - 1 = x + \frac{1}{2}x^2 + \mathcal{O}(x^3)
$$

Let $x = i(\tilde{n}_j - \tilde{n}_i)$ and substitute the uniform rate $D_{ij} = D$, the dynamical term in the action becomes:

$$
\sum_{j \sim i} D n_i \left( e^{i(\tilde{n}_j - \tilde{n}_i)} - 1 \right) = D n_i \sum_{j \sim i} \left[ i(\tilde{n}_j - \tilde{n}_i) + \frac{1}{2}(i(\tilde{n}_j - \tilde{n}_i))^2 + \cdots \right]
$$

Now analyze each term of this expansion in the limit $a \to 0$.

### 1. First-order term (Drift Term)
$$
D n_i \sum_{j \sim i} i(\tilde{n}_j - \tilde{n}_i)
$$
This term is proportional to the lattice Laplacian operator acting on $i\tilde{n}_i$. In the continuous limit, it converges to $D n(\vec{r}, t) \nabla^2(i\tilde{n}(\vec{r}, t))$. In the action integral, through **integration by parts**, the Laplacian operator can be transferred from the response field $\tilde{n}$ to the physical field $n$, yielding $-D \nabla(i\tilde{n}) \cdot \nabla n$ or $i\tilde{n} D \nabla^2 n$.

**Physical meaning**: This result is completely consistent with that obtained by the DP formalism, contributing to the system's **deterministic diffusion drift**.

### 2. Second-order term (Noise Term)

$$
D n_i \sum_{j \sim i} \frac{1}{2}(i(\tilde{n}_j - \tilde{n}_i))^2 = -\frac{D n_i}{2} \sum_{j \sim i} (\tilde{n}_j - \tilde{n}_i)^2
$$

The difference $(\tilde{n}_j - \tilde{n}_i)$ is a discrete approximation of the gradient $\nabla\tilde{n}$, i.e., $(\tilde{n}_j - \tilde{n}_i) \approx a \nabla\tilde{n}$. Therefore, in the continuous limit, the second-order term converges to:

$$
- \frac{D n_i}{2} \sum_{j \sim i} (\tilde{n}_j - \tilde{n}_i)^2 \xrightarrow{a \to 0} - D n(\vec{r}, t) (\nabla \tilde{n}(\vec{r}, t))^2 = D n(\vec{r}, t) (\nabla (i\tilde{n}))^2
$$

**Physical meaning**:
This quadratic term does not appear at all in the DP formalism's derivation. It is precisely the term representing **stochastic noise** in field theory.

Combining the first-order and second-order terms (higher-order terms can be ignored in the limit $a \to 0$, consistent with the spirit of Pawula's theorem in **Lecture 37**), the resulting continuous action is:

$$
S[n, i\tilde{n}] = \int dt \int d^d x \left\{ i\tilde{n} \partial_t n - D n \left[ \nabla^2(i\tilde{n}) + (\nabla i\tilde{n})^2 \right] \right\}
$$

This action not only contains the deterministic drift term but also includes a crucial noise term proportional to $(i\tilde{n})^2$.

## 2.3 Exponential Terms as "Memory" of Discreteness

Why does KMPI successfully derive this additional quadratic term while DP fails?

The fundamental reason is that the exponential term $e^{i(\tilde{n}_j - \tilde{n}_i)}$ is the **generating function** of the jump process moments. Taylor expanding this exponential function is actually systematically calculating all moments of the jump process:

* The first-order term of the expansion, proportional to $i\Delta\tilde{n}$, corresponds to the **first moment** of the jump (average displacement), which produces the deterministic **drift**.

* The second-order term of the expansion, proportional to $(i\Delta\tilde{n})^2$, corresponds to the **second moment** of the jump (variance of displacement), which produces the **noise term**.

The Doi-Peliti formalism assumes a linear dynamical structure ($\phi(\partial_j - \partial_i)$) from the beginning, which is equivalent to retaining only the first term of the Taylor expansion. It only captures the average effect of jumps while completely ignoring the stochasticity (variance) of the jump process.

KMPI is a more faithful representation because it makes no approximations to the jump process at the start. It brings the complete mathematical structure describing discrete events (exponential terms) into the continuous limit calculation. The process of taking the limit becomes a systematic Kramers-Moyal expansion. The first term of the expansion gives macroscopic, deterministic dynamics, while the second term gives the inevitable stochastic fluctuations caused by particle discreteness. This noise term is a direct manifestation of the variance of underlying discrete jump events at the macroscopic scale.

# 3. The Emergence of Multiplicative Noise

In the calculation of the previous section, the Kramers-Moyal Path Integral (KMPI) derived an action different from the Doi-Peliti (DP) formalism through a more rigorous limiting process. The key difference lies in an additional term proportional to $n (\nabla (i\tilde{n}))^2$ in the KMPI action. This seemingly purely mathematical additional term actually contains profound physical content. The goal of this lecture is to reveal how this term becomes a bridge connecting microscopic particle discreteness with macroscopic stochastic fluctuations, ultimately leading to the core physical concept of **multiplicative noise**.

## 3.1 From Action to Langevin Equation

To translate the physical meaning of the KMPI action, we can compare it with the standard form of the MSRJD action describing general Langevin equations established in **Lectures 32** and **37**. A continuous stochastic process described by the following Langevin stochastic differential equation (SPDE, using Ito convention):

$$
\partial_t \phi = F[\phi] + G[\phi] \eta(t)
$$

Its corresponding MSRJD action is:

$$
S[\phi, i\tilde{\phi}] = \int dt \int d^d x \left[ i\tilde{\phi} (\partial_t \phi - F[\phi]) - \frac{1}{2} G^2[\phi] (i\tilde{\phi})^2 \right]
$$

* $F[\phi]$ is the deterministic **drift term**.

* $G[\phi]$ is the **noise amplitude**.

* $\eta(t)$ is Gaussian white noise with zero mean and variance $\langle \eta(t) \eta(t') \rangle = 2\delta(t - t')$ (note that the factor 2 here is a common convention that affects the definition of noise strength).

Now, compare the KMPI action derived in the previous section (reorganized through integration by parts for easier comparison) with this standard form term by term:

$$
S_{KMPI}[n, i\tilde{n}] = \int dt \int d^d x \left\{ i\tilde{n} (\partial_t n - D \nabla^2 n) - D n (i\tilde{n})^2 \right\}
$$

Through direct comparison, we can immediately identify the terms in the equivalent Langevin equation:

* **Drift term**: $F[n] = D \nabla^2 n$

* **Noise strength squared**: $\frac{1}{2} G^2[n] = D n \implies G[n] = \sqrt{2Dn}$

Therefore, the physical process described by the KMPI action is given by the following **stochastic partial differential equation (SPDE)**:

$$
\partial_t n(\vec{r}, t) = D \nabla^2 n(\vec{r}, t) + \nabla \cdot \left( \sqrt{2D n(\vec{r}, t)} \, \vec{\eta}(\vec{r}, t) \right)
$$

* $\vec{\eta}$ is spatiotemporal Gaussian white noise satisfying $\langle \eta_\alpha(\vec{r}, t) \eta_\beta(\vec{r}', t') \rangle = \delta_{\alpha\beta} \delta(\vec{r} - \vec{r}') \delta(t - t')$.

* The noise term is written in divergence form $\nabla \cdot (\dots)$, which reflects the particle number conservation property: noise does not create or destroy particles out of nothing, but redistributes them in space, forming random particle flows.

**Note**: The noise term on the lecture board is $\nabla \cdot (\sqrt{D n} \, \vec{\lambda})$. The $\sqrt{2}$ factor difference here stems from different definitions of noise correlation functions (unit variance or variance of 2), with identical physical essence.

## 3.2 What is Multiplicative Noise?

The key difference between this SPDE and the deterministic diffusion equation derived from the DP formalism lies in the second term, the noise term. In particular, the noise strength (amplitude) $\sqrt{2Dn}$ is not a constant but depends on the system state (particle density $n$) itself. This type of noise is called **multiplicative noise**.

Its physical meaning is very intuitive and profound:

* In regions with high particle density ($n$ is large), random jump events per unit time are very frequent, so concentration fluctuations are also large.

* In regions with low particle density or even zero ($n \to 0$), there are almost no particles to jump, so random fluctuations tend to zero.

This noise arising from the finite number and random behavior of "individuals" constituting the system is called **demographic noise** or **shot noise**. It is an intrinsic property of any stochastic system composed of discrete units (whether particles, molecules, animals, or cells).

**Deep connection of physical origins**:

This $\sqrt{n}$ dependence is not accidental. According to the central limit theorem, for a system containing a large number of independent random individuals, the fluctuation (standard deviation $\sigma_N$) of the total number $N$ is proportional to the square root of the average number $\bar{N}$, i.e., $\sigma_N \propto \sqrt{\bar{N}}$. The KMPI derivation, starting from first principles, precisely reproduces this fundamental statistical law in macroscopic field theory.

The reason the Doi-Peliti formalism fails is precisely because it cannot describe fluctuations that depend on the particle number itself. KMPI, by preserving the complete statistical information of the jump process, successfully derives the correct mathematical form describing this fundamental physical phenomenon.

## 3.3 Comparative Summary of the Two Theories

To clearly summarize the core arguments of this lecture, we can directly compare the two formalisms:

| Feature | Doi-Peliti Path Integral | Kramers-Moyal Path Integral |
| :--- | :--- | :--- |
| **Key lattice action term** | $\tilde{\phi}_i \sum_j (\phi_j - \phi_i)$ | $n_i (e^{i(\tilde{n}_j - \tilde{n}_i)} - 1)$ |
| **Physical foundation** | Coherent-state representation (field-like) | Master equation jump processes (event-like) |
| **Continuous limit action** | $i\tilde{\phi} (\partial_t - D \nabla^2) \phi$ | $i\tilde{n} \partial_t n - D n [\nabla^2 (i\tilde{n}) + (\nabla i\tilde{n})^2]$ |
| **Equivalent dynamical equation** | $\partial_t \phi = D \nabla^2 \phi$ | $\partial_t n = D \nabla^2 n + \nabla \cdot (\sqrt{2D n} \, \vec{\eta})$ |
| **Dynamical type** | **Deterministic** (mean-field) | **Stochastic** (fluctuations) |
| **Physical noise described** | **Missing** | Captures demographic/shot noise (**multiplicative noise**) |

A seemingly purely mathematical choice (how to represent jump processes) ultimately leads to two completely different physical theories: one describing only average behavior, the other completely describing average behavior and the random fluctuations around it.

# 4. Incorporating Reactions into the Field Theory Framework

So far, our analysis has strictly focused on **diffusion** processes. However, a complete spatial model (as described in **Lecture 38**) necessarily includes **on-site reactions**. Now, we will extend the continuous limit method for handling diffusion to reaction processes, thereby constructing a complete reaction-diffusion field theory.

## 4.1 Physical Image of "On-site Reactions" and Scaling Transformations

First, we need to clarify the meaning of "reactions" in spatial models. When we discretize space into small cells of side length $a$, "on-site reactions" are understood as events occurring within the same cell. The professor explains that these cells can be physically regarded as mesoscopic volumes that may contain a large number of particles, sufficient for macroscopic chemical reaction laws to take effect within them.

In the limiting process from discrete lattice to continuous space ($a \to 0$), reaction rates themselves need to undergo corresponding **scaling transformations**. For a reaction involving $k$ reactants ($kA \to \dots$), its rate needs to be renormalized in the continuous limit as follows:

$$
\lambda_{\text{discrete}} \cdot a^{d(k-1)} \to \lambda_{\text{continuum}}
$$

**Physical meaning**: This transformation ensures that when we convert particle numbers $\phi_i$ to particle density $\phi(\vec{r}) = \phi_i/a^d$, the form of the law of mass action is preserved. For example, for a bimolecular reaction $2A \to \dots$, its rate is proportional to $(\phi/a^d)^2$. For the rate $\lambda_{\text{continuum}}$ in the continuous theory to have the correct units, the discrete rate $\lambda_{\text{discrete}}$ must absorb a factor $a^d$.

## 4.2 Reaction Action in the DP Framework

Following the same logic as for diffusion processes, we can transform the Liouvillian operator corresponding to any general reaction $kA \xrightarrow{\lambda} \ell A$ (established in **Lecture 38**) into part of the continuous action. According to the board notes, its contribution to the action is:

$$
S_{\text{REACT}} = - \int dt \int d^d x \, Q_{\text{REACT}}(\phi, i\tilde{\phi}+1)
$$

where,

$$
Q_{\text{REACT}}(\phi, i \tilde{\phi} + 1) = \lambda_{\text{continuum}} \phi^k \left( (i \tilde{\phi} + 1)^\ell - (i \tilde{\phi} + 1)^k \right)
$$

A profound insight is that these "mesoscopic" reaction rates $\lambda_{\text{continuum}}$ and diffusion coefficients $D$ appearing in continuous field theory are usually regarded as **phenomenological parameters**. Just as the electron mass in high-energy physics cannot be calculated from first principles, these parameters are extremely difficult to derive precisely from more microscopic levels and usually need to be measured through experiments.

## 4.3 Reaction Terms in the KMPI Framework

Similarly, in the KMPI lattice action, there is also a term $\mathcal{L}_{\text{REACT}}^{(i)}$ describing reactions. This term can also undergo Kramers-Moyal expansion and contribute to the drift and noise terms of the final SPDE.

For example, for proliferation reactions $A \to 2A$ (rate $\mu n$) and death reactions $A \to \emptyset$ (rate $\lambda n$), following the recipe from **Lecture 37**, we can obtain their respective contributions to drift $V(n)$ and diffusion $D(n)$:

* **Drift**: $V_{\text{REACT}} = (\mu n)(+1) + (\lambda n)(-1) = (\mu - \lambda)n$

* **Diffusion**: $D_{\text{REACT}} = \frac{1}{2} (\mu n)(+1)^2 + \frac{1}{2} (\lambda n)(-1)^2 = \frac{1}{2}(\mu + \lambda)n$

Adding these terms to the diffusion contributions gives the drift and noise terms of a complete reaction-diffusion SPDE. This provides a solid theoretical basis for the SPDE used in the simulation in **Section 5**.

# 5. Code Practice: How Stochasticity "Sculpts" Reaction Fronts

The theoretical derivations of the previous three sections revealed that the Kramers-Moyal Path Integral (KMPI) can capture intrinsic noise caused by particle discreteness that the Doi-Peliti (DP) method ignores. To observe the **consequences** of this noise in a more intuitive way, this lecture's simulation will go beyond pure diffusion into a more dynamic **reaction-diffusion** system.

This section will simulate a classic **Fisher-Kolmogorov reaction wave**, which describes the process of one species (or state) invading another region. By comparing wave front propagation under deterministic and stochastic theories, we can intuitively see how stochastic fluctuations evolve from a negligible "jitter" to a dominant force shaping macroscopic morphology in the critical region that determines the wave front's "fate"—the low-density front.

## 5.1 Simulation Setup: Species Invasion Under Two Theories

The simulation will be conducted on a two-dimensional rectangular grid. Initially, a small area on the left is occupied by "active" particles, with the rest empty. We will then observe how this active area "invades" to the right.

1. **Deterministic reaction-diffusion (DP/mean-field theory)**: Numerically solve the classic Fisher-Kolmogorov equation. This represents the **average behavior** of the invasion wave front.

    $$
    \frac{\partial n}{\partial t} = D \nabla^2 n + \mu n \left(1 - \frac{n}{K}\right)
    $$

2. **Stochastic reaction-diffusion (KMPI theory)**: Numerically solve the stochastic partial differential equation (SPDE) containing intrinsic noise. This represents the real physical process of a **single** invasion experiment. The noise term is now contributed by both **diffusion** and **reactions**:

    $$
    \frac{\partial n}{\partial t} = D \nabla^2 n + \mu n \left(1 - \frac{n}{K}\right) + \nabla \cdot \left( \sqrt{2Dn + \frac{\mu n}{K}(K-n)} \, \vec{\eta} \right)
    $$

**Note**: The exact form of the noise term is systematically given by the KMPI recipe, combining diffusion noise ($\propto n$) and reaction noise (birth-death processes). Here, for simplification and to highlight physics, we use an approximate but qualitatively correct form $\sqrt{2Dn + \mu n}$, which also captures the core feature that noise strength depends on particle number $n$.

## 5.2 Python Implementation: Reaction Front Simulator

The following Python code implements the two-dimensional numerical solution of the above two theories and generates a side-by-side comparison of dynamic evolution.

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import convolve2d
import matplotlib.animation as animation

# --- 1. Simulation Parameters ---
GRID_WIDTH = 256
GRID_HEIGHT = 128
D = 0.2              # Diffusion coefficient
MU = 0.1             # Reaction rate (birth rate)
K = 1.0              # Carrying capacity
T_FINAL = 300.0      # Total simulation time
DT = 0.1             # Time step
N_STEPS = int(T_FINAL / DT)
DX = 1.0             # Spatial step

# --- 2. Initial Condition: A front on the left side ---
n0 = np.zeros((GRID_HEIGHT, GRID_WIDTH))
front_width = 10
n0[:, :front_width] = K

# --- 3. Setup for Numerical Simulation ---
laplacian_kernel = np.array([[0, 1, 0], [1, -4, 1], [0, 1, 0]]) / (DX**2)
n_deterministic = n0.copy()
n_stochastic = n0.copy()

# Store history for animation
history_det = [n_deterministic.copy()]
history_sto = [n_stochastic.copy()]
save_interval = 20 # Save one frame every 20 steps

# --- 4. Main Simulation Loop ---
print("Running simulations for reaction fronts...")
for step in range(N_STEPS):
    # --- Deterministic (Mean-Field) Simulation ---
    lap_det = convolve2d(n_deterministic, laplacian_kernel, mode='same', boundary='wrap')
    reaction_det = MU * n_deterministic * (1 - n_deterministic / K)
    n_deterministic += (D * lap_det + reaction_det) * DT

    # --- Stochastic (KMPI) Simulation ---
    n_stochastic[n_stochastic < 0] = 0
    
    # Drift part (same as deterministic)
    lap_sto = convolve2d(n_stochastic, laplacian_kernel, mode='same', boundary='wrap')
    reaction_sto = MU * n_stochastic * (1 - n_stochastic / K)
    drift_term = D * lap_sto + reaction_sto
    
    # Noise part: Combined reaction and diffusion noise
    # The term is approximately sqrt(2*D*n + mu*n)
    noise_strength_sq = 2 * D * n_stochastic + MU * n_stochastic
    noise_amplitude = np.sqrt(np.maximum(0, noise_strength_sq) / (DX**2 * DT))
    
    eta_x = np.random.normal(0, 1, n_stochastic.shape)
    eta_y = np.random.normal(0, 1, n_stochastic.shape)
    
    flux_x = noise_amplitude * eta_x
    flux_y = noise_amplitude * eta_y
    
    grad_flux_y, _ = np.gradient(flux_y, DX, axis=(0, 1))
    _, grad_flux_x = np.gradient(flux_x, DX, axis=(0, 1))
    noise_term = grad_flux_x + grad_flux_y
    
    n_stochastic += (drift_term + noise_term) * DT

    if (step + 1) % save_interval == 0:
        history_det.append(n_deterministic.copy())
        history_sto.append(n_stochastic.copy())

print("Simulation finished. Creating animation...")

# --- 5. Visualization ---
fig, axes = plt.subplots(1, 2, figsize=(16, 8))
fig.patch.set_facecolor('black')
plt.style.use('dark_background')

def update(frame):
    for ax in axes:
        ax.clear()
            
    n_det = history_det[frame]
    n_sto = history_sto[frame]
    
    vmax = K * 1.1
    
    # --- Plot Deterministic Front ---
    axes[0].imshow(n_det, cmap='viridis', vmin=0, vmax=vmax, origin='lower', interpolation='bicubic')
    axes[0].set_title('Deterministic Front (DP/Mean-Field Theory)', color='white')
    axes[0].set_xticks([]); axes[0].set_yticks([])

    # --- Plot Stochastic Front ---
    axes[1].imshow(n_sto, cmap='viridis', vmin=0, vmax=vmax, origin='lower', interpolation='bicubic')
    axes[1].set_title('Stochastic Front (KMPI Theory)', color='white')
    axes[1].set_xticks([]); axes[1].set_yticks([])
    
    fig.suptitle(f'Reaction-Diffusion Front Propagation (Time: {frame*DT*save_interval:.1f})', color='white', fontsize=16)
    fig.tight_layout(rect=[0, 0, 1, 0.95])
    
    return axes[0], axes[1]

ani = animation.FuncAnimation(fig, update, frames=len(history_det), interval=50, blit=False)
try:
    ani.save('reaction_front_comparison.gif', writer='pillow', fps=20)
    print("Animation saved as 'reaction_front_comparison.gif'.")
except Exception as e:
    print(f"Could not save animation: {e}")

plt.show()

```

![Code execution output](../../../assets/images/remote/reaction_front_comparison.gif)

**Left (Deterministic/DP theory)**: The invasion wave front is a straight, smooth line. It propagates to the right at a constant, predictable speed. This represents an idealized average behavior in the infinite particle limit.

**Right (Stochastic/KMPI theory)**: Macroscopically, the wave front also propagates to the right, but its morphology undergoes qualitative changes. The wave front is no longer straight but becomes **rough and jagged**, and **continuously changes shape dynamically** during propagation.

**The "sculpting" effect of noise**: This roughness is precisely the direct effect of **demographic noise**. At the very front of the wave front, particle density $n$ is very low. According to KMPI theory, the relative intensity of noise reaches its maximum here. Random reproduction events (or diffusion jumps) cause some parts of the front to "luckily" jump forward a small step, while other parts temporarily stagnate or retreat. Over time, these microscopic random events "sculpt" a **rugged, constantly evolving** real front at the macroscopic scale.

This reaction-diffusion wave example shows that the intrinsic noise captured by KMPI is not just an irrelevant layer of "fuzz" added to the mean-field solution. On the contrary, in physical situations like reaction fronts, **noise is a key factor determining the system's macroscopic morphology and dynamical behavior**. It transforms a bland straight line in a deterministic world into a rough interface full of dynamics and structure in a stochastic world. This is precisely the necessity of constructing a stochastic field theory capable of describing the real physical world.

# Conclusion

This lecture started from a basic physical process—random jumps of particles on a lattice—and explored its continuous limit through two different path integral formalisms. This exploration revealed a crucial conclusion: **the choice of mathematical formalism profoundly affects the final physical image**.

* The **Doi-Peliti (DP) Path Integral**, originating from the coherent-state representation of **Lecture 36**, efficiently derives the system's **mean-field dynamics**—the classic deterministic diffusion equation—through its elegant algebraic structure. However, the price of this method is the complete loss of information about the system's stochastic fluctuations.

* The **Kramers-Moyal Path Integral (KMPI)**, inheriting the expansion ideas from **Lecture 37**, systematically performs Kramers-Moyal expansion in the continuous limit by faithfully preserving the exponential terms describing discrete jump events. This more rigorous process not only reproduces the deterministic drift term but also reveals a crucial second-order term. This term corresponds to **multiplicative noise**, whose physical origin is the demographic noise brought by particle discreteness.

Ultimately, KMPI derives a stochastic partial differential equation (SPDE) that completely describes the system's macroscopic behavior (drift) and intrinsic stochastic fluctuations (noise). This proves that to correctly derive macroscopic, continuous stochastic field theory from microscopic, discrete stochastic processes, we must carefully handle the limiting process, ensuring that the core mathematical structure describing event stochasticity is not "averaged out" early on.

At this point, KMPI's superiority in handling **diffusion** problems has been confirmed. It provides a universal path for systematically deriving corresponding stochastic Langevin equations from any master equation's jump processes. However, the spatial model introduced in **Lecture 38** contains not only diffusion but also more complex **on-site reactions**.

Therefore, a natural and crucial question arises: Can this KMPI framework, proven effective for diffusion, also be used to correctly describe reaction processes and ultimately construct a complete stochastic reaction-diffusion field theory?

This is precisely the core problem that **the next lecture "Kramers-Moyal Path Integral Method: Field Theory of Reactions"** will address. The course will apply the powerful tools established in this lecture to broader domains:

* **Extending KMPI to reaction systems**: We will explore how to use KMPI's exponential operator form to describe reaction processes with arbitrary stoichiometric ratios such as particle production ($A \to 2A$), annihilation ($2A \to A$), and decay ($A \to \emptyset$).

* **Constructing complete reaction-diffusion field theory**: By combining the diffusion action derived in this lecture with the reaction action to be derived in the next lecture, we will ultimately be able to construct complete stochastic partial differential equations (SPDEs) for complex nonequilibrium models like **directed percolation** (introduced in **Lecture 34**) from first principles.

* **Unification and application of theory**: A unified theoretical framework will ultimately be built that can systematically derive macroscopic stochastic field theory descriptions from any microscopic master equation (containing reactions and diffusion). This will pave the final path for using modern field theory tools like renormalization groups to analyze critical behavior and phase transitions of complex stochastic systems far from equilibrium.

Through this lecture, a key step in understanding the origins of stochastic field theory has been completed. The next lecture will build upon this foundation to continue constructing a more complete and powerful theoretical framework.

Finally, it is worth mentioning that the KMPI framework shows stronger robustness than the DP formalism when handling more complex physical situations. The professor mentioned in the course that if the diffusion coefficient itself depends on particle density or spatial configuration $D(n)$, the DP formalism's derivation would become "stuck" due to its inherent field variable replacement, making it difficult to handle. In contrast, KMPI, starting from real particle numbers $n$, can more naturally incorporate this dependence into the theoretical framework. This advantage highlights KMPI's potential as a modeling tool closer to physical origins when facing complex nonequilibrium systems.
