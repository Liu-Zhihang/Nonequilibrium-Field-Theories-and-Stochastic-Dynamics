# Introduction: From Differential Evolution to Sum Over Histories

In previous lectures we explored two core frameworks for stochastic dynamics—the Langevin equation and the Fokker–Planck equation. Together with the stochastic differential equations (SDEs) and Itô calculus developed in Lectures 20 and 21, these constitute a "differential" viewpoint focusing on how the system state evolves from one instant to the next.

- **Trajectory View**: Represented by the **Langevin equation** (Lecture 17), this framework takes a microscopic perspective and follows a single, specific trajectory $\vec{x}(t)$ under deterministic and random forces. It answers: "Given one noise realization, how does the system's path evolve?"

- **Ensemble View**: Represented by the **Fokker–Planck equation** (Lecture 18), this framework takes a macroscopic statistical view and describes the evolution of the probability density $p(\vec{x}, t)$ via a deterministic PDE. It answers: "At time $t$, what is the probability to find the system in state $\vec{x}$ across many identical replicas?"

Powerful as they are, neither directly answers a more global question: "Given an initial state $\vec{\phi}_0$ and a final state $\vec{\phi}_f$, what is the probability that the system follows a specific path (or 'history') $\vec{\phi}(\vec{x}, t)$?" The Langevin equation yields only one sample path; the Fokker–Planck equation focuses on endpoint probabilities and ignores the detailed temporal history.

To bridge this conceptual gap, we introduce a tool that assigns statistical weight to entire trajectories: the **Path Integral method**, first outlined in Lecture 19. In particular, Lecture 22 showed that for **multiplicative noise** the path integral carries subtleties due to the Jacobian. Here we first focus on the simpler case of **additive noise** and build the framework systematically.

The central idea borrows from Feynman's "sum over histories" method developed in quantum mechanics. The goal is to construct a **probability functional (Probability Functional)**, denoted as $W[\vec{\phi}]$. This functional is capable of assigning a probability value to any complete evolution history of the **continuous field** $\vec{\phi}(\vec{x}, t)$ (obtained through the "coarse-graining" method in Lecture 23) over the time interval $[t_0, t_f]$.

Once this probability functional is constructed, the ensemble average of any observable $\mathcal{O}[\vec{\phi}]$ is computed by a **functional integral**:

$$
\langle \mathcal{O}[\vec{\phi}] \rangle = \int \mathcal{D}[\vec{\phi}]\, \mathcal{O}[\vec{\phi}]\, W[\vec{\phi}]
$$

Here $\int \mathcal{D}[\vec{\phi}]$ means "summing" over all possible field histories. This is powerful because it turns a stochastic dynamics problem into a statistical field theory problem, making it possible to import mature tools from quantum field theory (e.g., **perturbation theory** and the **renormalization group**) to analyze classical stochastic systems. In this lecture we build $W[\vec{\phi}]$ and use it to reveal deep equilibrium symmetries, ultimately deriving physical laws that echo Onsager's theory in Lecture 24.

![Blackboard Screenshot](../../../assets/images/remote/2ccc59d9-7bd8-403d-acf8-0a180274b3d7-edaeefaf68.png)

# 1. Constructing the Probability Functional for Field Trajectories

Our goal is to derive, from the known noise statistics, the probability of any evolution history of the field $\vec{\phi}(\vec{x}, t)$. The key is a clever change of variables in the functional integral: switching from the "language" of noise paths $\vec{\xi}(\vec{x}, t)$ to the "language" of field paths $\vec{\phi}(\vec{x}, t)$. The derivation shows that the probability of a particular field path is inherited from the unique noise path that generates it, corrected by a **Jacobian functional determinant**.

## 1.1 Starting Point: Langevin Equation and Gaussian White Noise

We start from a general set of Langevin equations for a multicomponent field $\vec{\phi}(\vec{x}, t)$—the direct extension of the single-particle Langevin equation (Lecture 17) to a continuum field theory:

$$
\partial_t \phi_{\alpha}(\vec{x}, t) = A_{\alpha}[\vec{\phi}] + \xi_{\alpha}(\vec{x}, t)
$$

Each term has a clear meaning:

- **Field variable $\phi_{\alpha}(\vec{x}, t)$**: This is a continuous field describing the system state, where the subscript $\alpha$ represents its different components (e.g., in Model H, $\vec{\phi}$ may include both a particle density field and a fluid velocity field).

- **Drift functional $A_{\alpha}[\vec{\phi}]$**: This is a deterministic term describing the system's "drift." It typically arises from the system's tendency to evolve toward lower free energy states and depends on the full field configuration. For example:
  - For **Model A** (nonconserved scalar field with simple relaxation): $A_{\alpha} = -L_{\alpha} \, \frac{\delta F}{\delta \phi_{\alpha}}$.
  - For **Model B** (conserved scalar field such as particle density): $A = \nabla \cdot \bigl(M \nabla (\delta F/\delta \phi)\bigr)$.

- **Random noise term $\xi_{\alpha}(\vec{x}, t)$**: This is the stochastic force driving fluctuations.

In this lecture we assume **additive Gaussian white noise**, specified entirely by its first two moments:

1. **Zero mean:**
   $$
   \langle \xi_{\alpha}(\vec{x}, t) \rangle = 0
   $$

2. **Delta-correlated covariance:**
   $$
   \langle \xi_{\alpha}(\vec{x}, t) \, \xi_{\beta}(\vec{x}', t') \rangle = N_{\alpha\beta} \, \delta(\vec{x}-\vec{x}')\, \delta(t-t')
   $$

   - Here $N_{\alpha\beta}$ is a constant matrix representing the noise strength.
   - **"White noise"** refers to the two Dirac delta functions, indicating no correlations at distinct times or positions, i.e., "memoryless."
   - **"Additive noise"** means the noise strength matrix $N_{\alpha\beta}$ is constant and independent of $\vec{\phi}$. This contrasts with the more complex multiplicative noise case discussed in Lecture 22.

## 1.2 Probability of a Noise History

Since we assume the noise at each spacetime point is an independent Gaussian random variable, we can directly write the probability functional for any noise history $\vec{\xi}(\vec{x}, t)$. This can be viewed as the infinite-dimensional generalization of a multivariate Gaussian distribution:

$$
W_{\xi}[\vec{\xi}] \propto \exp\!\left(-\frac{1}{2} \sum_{\alpha\beta} \int_{t_0}^{t_f} dt \int d^d x \, \xi_{\alpha}(\vec{x}, t)\, N_{\alpha\beta}^{-1}\, \xi_{\beta}(\vec{x}, t)\right)
$$

The physical meaning of this expression is very intuitive:

- **Gaussian form**: This arises from the central limit theorem—the superposition of many independent microscopic collision effects leads to a Gaussian field at the macroscopic level.
- **Exponential part**: This can be viewed as the "cost" or "action" of this noise path. Any noise history deviating from zero mean will be exponentially suppressed. The larger the noise, the smaller its probability of occurrence. The matrix $N_{\alpha\beta}^{-1}$ plays the role of a "metric," defining the relative "cost" of fluctuations in different noise components.

## 1.3 Key Step: Change of Variables from Noise to Field

This is the core logic of the entire derivation. The Langevin equation establishes a unique mapping (given initial conditions) between a noise history $\vec{\xi}(t)$ and a field history $\vec{\phi}(t)$. Therefore, the probability of a specific field path $\vec{\phi}(t)$ must equal the probability of the unique noise history $\vec{\xi}(t)$ that produces it.

Mathematically, this corresponds to performing a change of variables in the functional integral. The probability measure must remain invariant:

$$
W_{\xi}[\vec{\xi}]\, \mathcal{D}[\vec{\xi}] = W_{\phi}[\vec{\phi}]\, \mathcal{D}[\vec{\phi}]
$$

Thus the probability functional of field paths is

$$
W_{\phi}[\vec{\phi}] = W_{\xi}[\vec{\xi}(\vec{\phi})] \cdot J[\vec{\phi}]
$$

where $\vec{\xi}(\vec{\phi})$ is the noise obtained by inverting the Langevin equation, and $J[\vec{\phi}]$ is the **Jacobian functional determinant** of this transformation.

## 1.4 Detailed Analysis of the Jacobian Functional Determinant

In ordinary multivariable integration, the Jacobian determinant describes how coordinate transformations change the volume element. In infinite-dimensional function space, the concept is similar, defined as:

$$
J[\vec{\phi}] = \left|\det\!\left(\frac{\delta \xi_{\alpha}(\vec{x}, t)}{\delta \phi_{\beta}(\vec{x}', t')}\right)\right|
$$

Direct calculation of this functional determinant is difficult. Following the method in the lecture, we first discretize time into small segments of step size $\Delta t$, with $t_{\mu} = t_0 + \mu \Delta t$. The discretized Langevin equation can be written as:

$$
\frac{\phi_{\alpha,\mu} - \phi_{\alpha,\mu-1}}{\Delta t} = \Theta A_{\alpha,\mu} + (1 - \Theta) A_{\alpha,\mu-1} + \xi_{\alpha,\mu}
$$

where the parameter $\Theta \in [0, 1]$ defines how to evaluate the deterministic term $A_{\alpha}$ within the time step, which is directly related to the different interpretations of stochastic integrals discussed in detail in Lectures 20 and 21:

- $\Theta = 0$ corresponds to the **Itô** interpretation.
- $\Theta = 1/2$ corresponds to the **Stratonovich** interpretation.

From the above equation, we can solve for $\xi_{\alpha,\mu}$ and calculate the elements of the Jacobian matrix $\frac{\partial \xi_{\alpha,\mu}}{\partial \phi_{\beta,\nu}}$. Since $\xi_{\alpha,\mu}$ only depends on $\phi$ at times no later than $\mu$, this is a lower triangular matrix whose determinant equals the product of diagonal elements. In the continuous limit $\Delta t \to 0$, the logarithm of this determinant contributes a correction term to the action, with a general form related to $\int dt \int d^dx \frac{\delta A_{\alpha}}{\delta \phi_{\alpha}}$.

This result appears quite complex. However, the **additive noise** assumption made in this lecture greatly simplifies the problem:

- For **multiplicative noise** (where $A$ or $N$ depends on $\phi$), the Jacobian determinant introduces a complex term that depends on $\phi$, leading to essential differences between Itô and Stratonovich interpretations (as shown in Lecture 22).
- For **additive noise**, if the $\frac{\delta A_{\alpha}}{\delta \phi_{\beta}}$ terms in the Jacobian determinant are constants or zero (e.g., when $A$ is a linear functional of $\phi$), the Jacobian determinant itself becomes a path-independent constant. This constant can be absorbed into the overall normalization factor and can be ignored when computing relative probabilities.

This is an important simplification that allows us to focus on the core physics of the path integral while temporarily avoiding the full complexity of stochastic calculus.

# 2. The Onsager–Machlup Functional: The "Action" of Random Paths

The derivation in the previous section has prepared all the ingredients for constructing the probability functional $W_{\phi}[\vec{\phi}]$ for field paths. The core step is to rewrite the noise probability functional $W_{\xi}[\vec{\xi}]$ in the language of field variables through the Langevin equation as a "translator." This section will complete this process and explain the final result—the **Onsager–Machlup functional**—and its physical significance as the "action" for stochastic dynamics, analogous to the role of action in classical mechanics.

## 2.1 Assembling the Final Probability Functional

Substituting the relationship $\xi_{\alpha} = \partial_t \phi_{\alpha} - A_{\alpha}[\vec{\phi}]$ obtained by rearranging the Langevin equation directly into the exponential part of the noise probability functional $W_{\xi}[\vec{\xi}]$ from Section 1.2. Meanwhile, as discussed in Section 1.4, for additive noise, the Jacobian functional determinant can be treated as a path-independent constant and absorbed into the overall normalization factor $N_{\phi}$.

Thus, we obtain the final probability functional describing field paths $\vec{\phi}$:

$$
W_{\phi}[\vec{\phi}] = N_{\phi}\, \exp\bigl(-G[\vec{\phi}]\bigr)
$$

where $G[\vec{\phi}]$ is called the **Onsager–Machlup functional**, with the specific form:

$$
G[\vec{\phi}] = \frac{1}{2} \sum_{\alpha\beta} \int_{t_0}^{t_f} dt \int d^d x\, \bigl(\partial_t \phi_{\alpha} - A_{\alpha}[\vec{\phi}]\bigr)\, N_{\alpha\beta}^{-1}\, \bigl(\partial_t \phi_{\beta} - A_{\beta}[\vec{\phi}]\bigr)
$$

This functional is the mathematical core of this lecture. It assigns a scalar value to any complete field evolution history $\vec{\phi}(\vec{x},t)$ from initial time $t_0$ to final time $t_f$, and the negative exponential of this value determines the statistical weight of that history.

The **Onsager–Machlup functional** was proposed in 1953 by Lars Onsager and Stefan Machlup. Its **physical essence** is the generalization of the "principle of least action" from classical mechanics to the field of stochastic dynamics. The core idea is that while a system's random evolution paths are infinite, each path has a probability of occurrence proportional to $e^{-S_{\mathrm{OM}}}$, where $S_{\mathrm{OM}}$ is the Onsager–Machlup action. This action not only quantifies the "cost" of path deviation from the average motion trajectory, but also contains a correction term related to the curvature of the potential landscape, thus deeply revealing the relationship between time-reversal symmetry breaking and path probability in nonequilibrium systems.

In **specific applications**, this functional has become a fundamental tool for understanding noise-driven systems, widely used in physics, biophysics (such as analyzing single-molecule motion trajectories), soft-matter dynamics, and the design of path-sampling algorithms, especially in computing key problems such as "most probable paths" (instantons), transition states, and entropy production during transitions between metastable states.

## 2.2 Physical Meaning of the Onsager–Machlup Functional

The Onsager–Machlup functional $G[\vec{\phi}]$ plays a role in stochastic dynamics that is completely analogous to the action $S$ in classical mechanics and quantum mechanics. It assigns a numerical value to each possible system evolution path, and this value determines the relative probability of that path.

- **Path "Cost"**: Observing the expression of $G[\vec{\phi}]$, we can see that the term $\partial_t \phi_{\alpha} - A_{\alpha}$ in parentheses is precisely the noise $\xi_{\alpha}$ required to realize this specific path $\vec{\phi}(t)$. Therefore, $G[\vec{\phi}]$ essentially integrates the "magnitude" of the noise history corresponding to this path. Paths that require very intense or "unlikely" noise to realize will have large $G[\vec{\phi}]$ values, and their probability $e^{-G[\phi]}$ will be exponentially suppressed.

- **Most Probable Path**: The system's **most probable path** is the one that minimizes $G[\vec{\phi}]$. Through variational methods, setting $\frac{\delta G}{\delta \vec{\phi}} = 0$ yields the equation of motion that exactly makes the integrand zero:
  $$
  \partial_t \phi_{\alpha} = A_{\alpha}[\vec{\phi}]
  $$
  This is exactly the deterministic, noiseless equation of motion. This corresponds completely to the principle of least action in classical mechanics, where the system's classical path is the one that extremizes the action. In stochastic dynamics, the most probable path is the "classical" trajectory driven entirely by deterministic drift.

To better understand this concept, we can compare path-integral formulations across different physical domains:

| Feature | Stochastic Dynamics (this lecture) | Quantum Mechanics (Feynman) | Classical Mechanics (Hamilton's Principle) |
| --- | --- | --- | --- |
| **Dynamical Variable** | Field path $\phi(x, t)$ | Particle path $q(t)$ | Classical trajectory $q_{cl}(t)$ |
| **Core Functional** | Onsager-Machlup functional $G[\phi]$ | Action $S[q]$ | Action $S[q]$ |
| **Path Weight** | Probability $P[\phi] \propto \exp(-G[\phi])$ | Probability amplitude $A[q] \propto \exp(iS[q]/\hbar)$ | Deterministic (only one path exists) |
| **Basic Principle** | Sum over all paths | Sum over all paths (quantum superposition) | Principle of least action ($\delta S = 0$) |
| **Most Probable/Classic** | Path that minimizes $G[\phi]$ (classical path) | Path that extremizes $S[q]$ (classical limit) | Unique path satisfying $\delta S = 0$ |

This table demonstrates the profound analogy of the Onsager–Machlup functional as the "**action**" for random paths. It elevates the study of stochastic processes to a theoretical level parallel to classical and quantum mechanics, laying the foundation for subsequent analysis of system behavior using symmetry principles.

# 3. Symmetries and Consequences: Detailed Balance and Time Reversal

The Onsager–Machlup functional provides a powerful starting point for analyzing random paths. However, its true power emerges when combined with fundamental symmetry principles in physics. This section will apply the path-integral formulation to systems in **thermal equilibrium** and use **time-reversal invariance** as a fundamental principle. This will lead to a profound constraint on path probabilities—the **detailed balance principle**—and ultimately derive a central relationship linking the path "action" to the system's thermodynamic properties.

## 3.1 Physical Content of Thermal Equilibrium

A fundamental property of thermal equilibrium is **time-reversal invariance**, also called **microscopic reversibility**. Although macroscopic irreversible processes exist (such as heat flowing from hot objects to cold objects), the basic physical laws controlling the motion of microscopic particles (such as Newtonian mechanics, the Schrödinger equation) are invariant under $t \to -t$.

This microscopic symmetry manifests at the macroscopic statistical level as the **detailed balance principle**. This principle states that in equilibrium, the rate of any elementary process (for example, a transition from state A to state B) equals the rate of its reverse process (transition from state B to state A). For paths, this means that once the equilibrium probability distributions of initial and final states are accounted for, the joint probability of observing a "forward" trajectory should equal the joint probability of observing its time-reversed trajectory.

## 3.2 Detailed Balance Formulation for Paths

To precisely formulate the detailed balance condition for paths, we first need to define the **joint probability** of a "forward" path. The joint probability of evolving from an initial field configuration $\vec{\phi}_0$ to a final configuration $\vec{\phi}_f$ can be written as the product of a **conditional probability** and the **initial probability**:

$$
P(\vec{\phi}_0, t_0; \vec{\phi}_f, t_f) = \langle \vec{\phi}_f | \vec{\phi}_0 \rangle \, P_{\mathrm{eq}}[\vec{\phi}_0]
$$

Here:

- **$P_{\mathrm{eq}}[\vec{\phi}_0]$** is the equilibrium probability of the system being in the initial state $\vec{\phi}_0$. For a system in contact with a heat bath at temperature $T$, it is given by the Boltzmann distribution:
  $$
  P_{\mathrm{eq}}[\vec{\phi}] \propto \exp(-\beta F[\vec{\phi}])
  $$
  where $F[\vec{\phi}]$ is the system's free energy functional and $\beta = 1/(k_B T)$.

- **$\langle \vec{\phi}_f | \vec{\phi}_0 \rangle$** is the conditional transition probability amplitude from $\vec{\phi}_0$ to $\vec{\phi}_f$. It is given by the path integral, i.e., summing the statistical weights $e^{-G[\vec{\phi}]}$ over all paths connecting the initial and final states:
  $$
  \langle \vec{\phi}_f | \vec{\phi}_0 \rangle = \int_{\vec{\phi}(t_0)=\vec{\phi}_0}^{\vec{\phi}(t_f)=\vec{\phi}_f} \mathcal{D}[\vec{\phi}]\, e^{-G[\vec{\phi}]}
  $$

Next, we define the **time-reversed path** $\vec{\phi}^R(t)$. For a field component $\phi_{\alpha}$, its reversed path is:
$$
\phi^R_{\alpha}(\vec{x}, t) = \epsilon_{\alpha} \, \phi_{\alpha}(\vec{x}, t_f - t)
$$
where $\epsilon_{\alpha} = \pm 1$ is the **parity** of this field component under time reversal. For example, position and density are even parity ($\epsilon = +1$), while velocity and momentum are odd parity ($\epsilon = -1$).

The detailed balance condition requires that the joint probability of the forward path equals the joint probability of its time-reversed path:

$$
\langle \vec{\phi}_f | \vec{\phi}_0 \rangle P_{\mathrm{eq}}[\vec{\phi}_0] = \langle \vec{\phi}_0 | \vec{\phi}_f \rangle P_{\mathrm{eq}}[\vec{\phi}_f]
$$

Note that according to the lecture board, the $\langle \vec{\phi}_0 | \vec{\phi}_f \rangle$ on the right-hand side is the transition probability amplitude from $\vec{\phi}_f$ to $\vec{\phi}_0$ obtained by summing over all reversed paths. Substituting the exponential form of probabilities and taking logarithms of both sides yields a central relationship between the Onsager–Machlup functional and the free energy functional:

$$
G[\vec{\phi}] + \beta F[\vec{\phi}_0] = G_R[\vec{\phi}] + \beta F[\vec{\phi}_f]
$$

where $G_R[\vec{\phi}]$ is the Onsager–Machlup functional evaluated on the time-reversed path. This equation is a direct manifestation of time-reversal symmetry at the level of path probabilities. It quantitatively reveals that to maintain equilibrium symmetry, the change of the path "action" $G[\vec{\phi}]$ under time reversal must be precisely compensated by the change of free energy at the system boundaries.

# 4. Application: Deriving the Fluctuation–Dissipation Theorem for Model A

The path-integral formulation and detailed balance conditions established in the previous sections constitute a universal framework for analyzing near-equilibrium stochastic dynamics. To demonstrate its powerful capabilities, this section applies it to a specific physical model—**Model A**—and derives from it a cornerstone of nonequilibrium statistical physics: the **fluctuation–dissipation theorem (FDT)**.

## 4.1 Model A Dynamics

Model A describes the pure relaxation dynamics of a nonconserved order parameter (such as magnetization in an isotropic ferromagnet):

$$
\partial_t \phi = -L \, \frac{\delta F}{\delta \phi} + \xi
$$

The deterministic drift term here is $A = -L \, \delta F/\delta \phi$.

- $L$ is a dynamical coefficient called the Onsager coefficient, related to the system's mobility or **dissipation** strength.
- $\xi$ is Gaussian white noise with intensity $\langle \xi(\vec{x},t)\, \xi(\vec{x}',t') \rangle = N\, \delta(\vec{x}-\vec{x}')\, \delta(t-t')$. To simplify the derivation, we consider a single-component scalar field here, so the noise strength $N$ is a scalar.

## 4.2 Calculating the "Actions" of Forward and Reverse Paths

First, substitute the drift term $A$ of Model A into the Onsager–Machlup functional defined in Section 2.1 to obtain the "action" $G[\phi]$ of the "forward path":

$$
G[\phi] = \frac{1}{2N} \int_{t_0}^{t_f} dt \int d^d x\, \Bigl(\partial_t \phi + L\, \frac{\delta F}{\delta \phi}\Bigr)^2
$$

Next, we calculate the "action" $G_R[\phi]$ of the time-reversed path. For order parameters like magnetization, they are even parity under time reversal, i.e., $\epsilon = +1$, so the reversed path is $\phi^R(t) = \phi(t_f - t)$. The time derivative term becomes $\partial_t \phi^R(t) = -\partial_{\tilde{t}} \phi(\tilde{t})$ (where $\tilde{t} = t_f - t$). Therefore, the "action" of the reversed path is:

$$
G_R[\phi] = \frac{1}{2N} \int_{t_0}^{t_f} d\tilde{t} \int d^d x\, \Bigl(-\partial_{\tilde t} \phi + L\, \frac{\delta F}{\delta \phi}\Bigr)^2
$$

## 4.3 Final Derivation: Einstein–Onsager Relation

Substituting the above expressions for $G[\phi]$ and $G_R[\phi]$ into the core detailed balance relationship derived in Section 3.2, $G[\phi] - G_R[\phi] = \beta (F[\phi_f] - F[\phi_0])$:

$$
\frac{1}{2N} \int dt\, d^d x\, \Bigl[\bigl(\partial_t \phi + L\, \frac{\delta F}{\delta \phi}\bigr)^2 - \bigl(-\partial_t \phi + L\, \frac{\delta F}{\delta \phi}\bigr)^2\Bigr] = \beta \bigl(F[\phi_f] - F[\phi_0]\bigr)
$$

Expanding the squared terms, the $(\partial_t \phi)^2$ and $(L \frac{\delta F}{\delta \phi})^2$ terms cancel each other out, leaving only the cross term:

$$
\frac{1}{2N} \int dt\, d^d x\, 4L\, (\partial_t \phi)\, \frac{\delta F}{\delta \phi} = \beta \bigl(F[\phi_f] - F[\phi_0]\bigr)
$$

According to the chain rule in functional analysis, the integrand is precisely the total derivative of the free energy functional $F[\phi(t)]$ with respect to time:

$$
\int_{t_0}^{t_f} dt \int d^d x\, (\partial_t \phi)\, \frac{\delta F}{\delta \phi} = \int_{t_0}^{t_f} dt\, \frac{dF[\phi(t)]}{dt} = F[\phi(t_f)] - F[\phi(t_0)]\,.
$$

Substituting this result, we obtain:

$$
\frac{2L}{N} \bigl(F[\phi_f] - F[\phi_0]\bigr) = -\beta \bigl(F[\phi_f] - F[\phi_0]\bigr)
$$

From this, we derive an extremely concise and profound relationship, the **Einstein–Onsager relation**:

$$
N = 2\, L\, k_B T\,.
$$

This derivation process demonstrates a **core paradigm** in physics research: **starting from an abstract symmetry principle (time-reversal invariance), employing a powerful mathematical framework (path integrals), applying it to a specific physical model (Model A), and ultimately arriving at a quantitative relationship connecting macroscopic physical quantities (noise strength $N$, dissipation coefficient $L$, and temperature $T$) that can be experimentally verified.**

This relationship is a specific manifestation of the **fluctuation–dissipation theorem**. It reveals that the intensity of a system's microscopic random **fluctuations** (quantified by the noise amplitude $N$) is not an independent parameter—it is completely determined by the system's macroscopic **dissipative** properties (quantified by the Onsager coefficient $L$) and the environmental temperature $T$. A system with fast dissipation ($L$ large) will inevitably be subject to stronger thermal fluctuations ($N$ large), which is the fundamental reason why the system can maintain thermal equilibrium. Notably, this derivation process made no linear assumptions about the form of the free energy functional $F[\phi]$, so this conclusion holds for nonlinear systems as well.

In Lecture 24, we used Onsager's "top-down" macroscopic theory, based on the linear regression assumption of fluctuations and the time symmetry of correlation functions, to derive the fluctuation–dissipation theorem. In this lecture, starting from a completely different, "sum over histories" microscopic path-integral perspective, by applying the same time-reversal symmetry, we ultimately obtained **exactly the same physical law**. These two completely different mathematical frameworks ultimately point to the same profound physical reality about the intrinsic connection between fluctuations, dissipation, and temperature. This fact once again proves the internal harmony and self-consistency of nonequilibrium statistical physics theory.

# 5. Code Practice: Intrinsic Noise in Systems Biology

To demonstrate the application of Onsager–Machlup action and path-integral ideas beyond physics, this section's code practice explores a core systems biology model: **stochastic expression of a single gene**.

Even the most basic "production–degradation" process in a cell is full of random fluctuations. Therefore, we simulate the stochastic time evolution of the number of protein molecules in a cell and compare the final statistical distribution with theoretical predictions. Through this example, we demonstrate how a system driven by discrete, random chemical reaction events can be described at the macroscopic statistical level by a continuous stochastic process with **additive noise**.

## 5.1 Stochastic Gene-Expression Dynamics

Imagine a simple gene expression process in a cell:

1. **Production**: A certain gene is continuously activated, producing protein molecules at a constant average rate $k_s$ (molecules/second).

2. **Degradation**: Each protein molecule has a certain lifespan and is degraded at a rate proportional to the current protein number $p(t)$, namely $\gamma p(t)$, where $\gamma$ is the first-order degradation rate constant (1/second).

In a deterministic world, this process would reach a stable equilibrium point, where the production rate equals the degradation rate: $k_s = \gamma p_{ss}$, giving the steady-state protein number $p_{ss} = k_s/\gamma$.

However, in real cells, each production and degradation event is an independent, random chemical reaction. This internal, event-driven randomness is called **intrinsic noise**. This noise causes the actual protein number $p(t)$ to fluctuate continuously around the steady-state average $p_{ss}$.

## 5.2 Chemical Langevin Equation (CLE)

To describe these fluctuations, we can use the **Chemical Langevin Equation (CLE)**, which provides a continuous approximation to the underlying discrete random process. For this simple production–degradation model, the corresponding Langevin equation (i.e., an SDE with additive noise) can be written as:

$$
\frac{dp}{dt} = \underbrace{(k_s - \gamma p)}_{\text{drift term } A(p)} + \underbrace{\xi(t)}_{\text{noise term}}
$$

This has exactly the same form as Model A and the Ornstein–Uhlenbeck process that we have simulated before!

- **Drift term** $A(p) = k_s - \gamma p$ describes the deterministic tendency for the protein number to return to its steady-state value $p_{ss}$.
- **Noise term** $\xi(t)$ represents the randomness of production and degradation events. According to a generalization of the fluctuation–dissipation theorem (to be learned in subsequent courses), for such chemical reaction systems, the noise intensity $N$ is related to the total reaction rate at steady state, i.e., $N \approx 2(k_s + \gamma p_{ss}) / 2 = k_s + \gamma (k_s/\gamma) = 2k_s$.

Therefore, we obtain an Ornstein–Uhlenbeck process with **effective additive noise** describing the fluctuations in protein number.

## 5.3 Python Implementation and Results

The following Python code will simulate the protein expression process in a large number of "virtual cells" and demonstrate its dynamic trajectories and final steady-state distribution.

```python
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from scipy.stats import norm

# --- 1. Define biophysical parameters ---
k_s = 20.0     # Protein synthesis rate (molecules/second)
gamma = 0.2    # Protein degradation rate constant (1/second)

# Theoretical steady-state value
p_ss = k_s / gamma # Steady-state average protein number
noise_strength_N = 2 * k_s # Effective noise strength
sigma = np.sqrt(noise_strength_N) # Volatility (std of white noise)

print(f"Theoretical steady-state mean p_ss = {p_ss:.2f} molecules")
print(f"Effective noise strength N = {noise_strength_N:.2f}")

# --- 2. Simulation parameters ---
p0 = 0.0          # Initial protein number
T_total = 40.0    # Total simulation time (seconds)
dt = 0.05         # Time step
n_steps = int(T_total / dt)
num_cells = 5000  # Number of cells to simulate

# --- 3. Run simulation (Euler-Maruyama) ---
# Initialize protein numbers for all cells
p_paths = np.zeros((num_cells, n_steps + 1))
p_paths[:, 0] = p0

# Generate all random increments
dW = np.sqrt(dt) * np.random.randn(num_cells, n_steps)

# Iteratively solve SDE
for i in range(n_steps):
    current_p = p_paths[:, i]
    drift = k_s - gamma * current_p
    diffusion = sigma * dW[:, i] / dt # Convert to Langevin form noise
    p_paths[:, i+1] = current_p + drift * dt + diffusion * dt

# --- 4. Visualization of results ---
sns.set_style("whitegrid")
fig = plt.figure(figsize=(16, 8))
gs = fig.add_gridspec(2, 2, height_ratios=(1, 1))

# Figure 1: Single cell trajectories
ax1 = fig.add_subplot(gs[:, 0])
time_array = np.linspace(0, T_total, n_steps + 1)
for i in range(5): # Plot only 5 trajectories as examples
    ax1.plot(time_array, p_paths[i, :], lw=2, alpha=0.8)

ax1.axhline(p_ss, color='r', linestyle='--', lw=2.5, label=f'Steady-state mean p_ss = {p_ss:.0f}')
ax1.set_title('Stochastic trajectories of protein numbers in single cells', fontsize=18, pad=15)
ax1.set_xlabel('Time (seconds)', fontsize=14)
ax1.set_ylabel('Protein number p(t)', fontsize=14)
ax1.legend(fontsize=12)
ax1.tick_params(axis='both', which='major', labelsize=12)
ax1.set_ylim(bottom=0)

# Figure 2: Steady-state distribution
ax2 = fig.add_subplot(gs[0, 1])
final_p_counts = p_paths[:, -1]
sns.histplot(final_p_counts, bins=50, kde=False, stat='density', ax=ax2, 
             color='skyblue', edgecolor='black', label='Simulated distribution (t=40s)')

# Theoretical Gaussian distribution (steady-state solution of O-U process)
variance_theory = noise_strength_N / (2 * gamma)
std_dev_theory = np.sqrt(variance_theory)
p_range = np.linspace(final_p_counts.min(), final_p_counts.max(), 200)
pdf_theory = norm.pdf(p_range, loc=p_ss, scale=std_dev_theory)
ax2.plot(p_range, pdf_theory, 'k-', lw=3, label='Theoretical Gaussian distribution')

ax2.set_title('Protein distribution in cell population at steady-state', fontsize=18, pad=15)
ax2.set_xlabel('Protein number p', fontsize=14)
ax2.set_ylabel('Probability density', fontsize=14)
ax2.legend(fontsize=12)
ax2.tick_params(axis='both', which='major', labelsize=12)

# Figure 3: Ensemble average evolution
ax3 = fig.add_subplot(gs[1, 1], sharex=ax2)
mean_path = np.mean(p_paths, axis=0)
ax3.plot(time_array, mean_path, color='darkorange', lw=3, label='Ensemble average $\langle p(t) \\rangle$')
ax3.axhline(p_ss, color='r', linestyle='--', lw=2.5)
ax3.set_title('Evolution of ensemble average', fontsize=18, pad=15)
ax3.set_xlabel('Time (seconds)', fontsize=14)
ax3.set_ylabel('Average protein number', fontsize=14)
ax3.tick_params(axis='both', which='major', labelsize=12)
ax3.set_ylim(bottom=0)

plt.tight_layout()
plt.show()
```

![Run Output](../../../assets/images/remote/d49f706c-5155-482a-b24c-7341d98a2bed-8b56c23c88.png)

**Left figure (single-cell trajectories)** demonstrates the effect of intrinsic noise. The protein number in each cell does not stabilize at the average $p_{ss}=100$, but fluctuates vigorously and continuously around it. This is one of the sources of phenotypic heterogeneity between cells.

**Top right figure (steady-state distribution)**: Although individual cells behave stochastically, the statistical behavior of a population of 5000 cells is highly predictable. The simulated protein number histogram (blue) perfectly matches the theoretically predicted steady-state Gaussian distribution (black solid line). This proves that macroscopic, measurable statistical laws (probability distributions) can be precisely predicted from microscopic stochastic rules (the Langevin equation).

**Bottom right figure (ensemble average)**: When all cell trajectories are averaged, the effect of noise "disappears," yielding a smooth path that grows from 0 and approaches the theoretical steady state. This again confirms the martingale property of the Itô integral: noise itself does not produce systematic drift, only fluctuations. This example from systems biology reveals the tremendous potential of fluctuation–dissipation theorem and path-integral ideas in understanding life processes.

# Conclusion

This lecture established a complete path-integral framework applicable to stochastic field theories with additive noise:

- Starting from the noise probability functional and via a change of variables, we derived the probability functional of field histories, $W[\vec{\phi}] \propto e^{-G[\vec{\phi}]}$.
- The exponent $G[\vec{\phi}]$ is the **Onsager–Machlup functional**, the "action" for random paths whose minimum corresponds to the deterministic noiseless trajectory.
- Invoking time-reversal symmetry in equilibrium (**detailed balance**) imposes strong constraints on path probabilities.
- Applying these to Model A yields, from first principles, the **Einstein–Onsager relation** $N = 2 L k_B T$.

**The core difference between additive and multiplicative noise lies in whether the noise strength depends on the system state.**

**Additive noise** can be understood as a constant, background "noise" from the external environment, whose intensity remains unchanged regardless of the system's state. Mathematically, this manifests as the noise term being directly added to the dynamical equation (such as $\partial_t\phi = A(\phi) + \xi(t)$), and its major theoretical advantage is that in the path-integral formulation, the Jacobian determinant is typically a negligible constant, so the differences between Itô and Stratonovich integrals also disappear.

In contrast, **multiplicative noise** has intensity that is a function of the system state (such as $dX_t = A(X_t)dt + C(X_t)dW_t$), meaning the effect of noise is amplified or diminished by the system itself. Typical examples include volatility in financial models that is proportional to stock prices, or random fluctuations in biological systems that are related to population size. This state dependence leads to richer dynamical behavior, such as the "fan-out" phenomenon observed in simulations, and makes the choice between Itô and Stratonovich integrals mathematically crucial, as different choices correspond to different physical assumptions and final dynamical equations.

Additive noise is an ideal starting point and baseline model for understanding stochastic processes. Its mathematical treatment is the simplest and clearest, making it the preferred choice when analyzing random disturbances from external environments with essentially constant intensity. When you are uncertain about the source of noise or want to build the simplest baseline model, additive noise is a reasonable first step.

Multiplicative noise, on the other hand, is a more refined and accurate description of the real world. When the source of randomness is closely related to the system's own state (such as scale, energy, price), choosing multiplicative noise is essential. It can capture richer and more complex dynamical behavior. Choosing it means trading higher mathematical complexity for deeper physical realism.

Therefore, in applications, the decisive factor in choosing which noise model to use is: **physical understanding of the source of randomness in the system under study. Correctly identifying and modeling the source of noise is the key to successfully building a stochastic dynamics theory.**

From the Onsager–Machlup functional describing "spontaneous" paths in this lecture, the natural next step is to introduce the MSRJD formalism to systematically and computationally study how systems "respond" to external probes. In the next lecture, we will learn more deeply about using field-theoretic perturbation techniques (such as Feynman diagrams) to calculate correlation and response functions in stochastic systems.
