# Introduction

This lecture marks a key step in our study of stochastic processes. In previous lectures we established the master equation framework that describes how probabilities evolve among states. Now we move from describing “how” evolution happens to understanding “why” — the thermodynamic meaning behind these evolutions.

We leave the ideal world of equilibrium and step into the broader, real realm of nonequilibrium physics. When detailed balance is broken, the system supports persistent probability currents, like steady water flow in a river. Such one‑way, irreversible flow is a hallmark of living processes, chemical reactions, and all systems driven by external energy. We will start from a single stochastic trajectory, quantify irreversibility, and arrive at entropy production — the direct microscopic manifestation of the second law of thermodynamics.

This lecture is the bridge between microscopic randomness and the macroscopic “arrow of time.”

We first contrast two fundamentally different classes of stochastic processes.

## Reversible Process

Reversible processes microscopically realize thermodynamic equilibrium and satisfy detailed balance. Time has no preferred direction; past and future are statistically indistinguishable.

1) Time symmetry: film a reversible process and play it backward; the backward movie is statistically indistinguishable from the forward one. A Brownian pollen grain in equilibrium water looks equally random in either direction.

2) Microscopic balance (detailed balance):

$$
\pi_j w_{j\to k} = \pi_k w_{k\to j}.
$$

In steady state, every directly connected pair $j,k$ has exactly equal opposing fluxes. This is more than global balance; it is pairwise balance on every edge.

3) No net cycles: with every microscopic path balanced by its reverse, there are no persistent probability cycles. Like a lake: the water level is steady and every microscopic flow A→B is canceled by B→A; macroscopically there is no current.

4) Simple relaxation: dynamics are “pure” — monotone, non‑oscillatory exponential relaxation to equilibrium.

## Irreversible Process

Irreversible processes break detailed balance and characterize active, energy‑consuming nonequilibrium systems. They endow time with a direction.

1) Time asymmetry: backward movies are statistically different. A molecular motor consumes ATP and walks directionally; the reversed movie would synthesize ATP while walking backward — not spontaneous.

2) Persistent microscopic currents: breaking detailed balance, $\pi_j w_{j\to k} \ne \pi_k w_{k\to j}$, yields net probability currents. When these currents form cycles (violating Kolmogorov’s loop criterion), the system is in a nonequilibrium steady state (NESS).

3) Driven “dynamic” balance: like a river with steady level maintained by continuous inflow (energy input). At any cross‑section, inflow equals outflow (steady level), yet there is a net downstream current — the “arrow of time.”

# 1. Detailed Balance

## 1.1 Revisiting the Master Equation: Rules of the Game

![Lecture blackboard screenshot](../../assets/images/remote/0a3803ab-54cd-47f8-b070-26b379ba1408-96a6c2ee27.jpg)

The master equation is the cornerstone:

$$
\frac{d\mathbf{p}(t)}{dt} = Q\,\mathbf{p}(t).
$$

In components,

$$
\frac{dp_n(t)}{dt} = \sum_{m\ne n}\big(p_m(t)\,w_{m\to n} - p_n(t)\,w_{n\to m}\big).
$$

- Gain: $\sum_{m\ne n} p_m(t)\,w_{m\to n}$ — total inflow from other states into $n$.
- Loss: $\sum_{m\ne n} p_n(t)\,w_{n\to m}=p_n(t)\sum_{m\ne n} w_{n\to m}$ — total outflow from $n$.

Q has column sums zero (probability conservation): $\sum_n Q_{n m}=0$. With $Q_{m m}=-\sum_{n\ne m}w_{m\to n}$ and $\sum_{n\ne m}Q_{n m}=\sum_{n\ne m}w_{m\to n}$, their sum vanishes, ensuring total probability remains 1.

## 1.2 Detailed Balance: Hallmark of Equilibrium

For reversible processes, the steady state is defined by detailed balance (DB):

$$
\pi_i\,w_{i\to j}=\pi_j\,w_{j\to i}.
$$

Here $\pi_i$ are steady‑state probabilities; $\pi_i w_{i\to j}$ is the probability flux from $i$ to $j$ per unit time. DB expresses microscopic reversibility: for all pairs $(i,j)$, the net flux $J_{ij}=\pi_i w_{i\to j}-\pi_j w_{j\to i}$ vanishes.

Important: DB is sufficient but not necessary for a steady state. A steady state satisfies $Q\,\boldsymbol\pi=0$; if DB holds, steadiness follows, but the converse need not hold. Systems can have constant $\boldsymbol\pi$ yet nonzero currents (NESS). Thus DB defines the special subclass “equilibrium states.”

## 1.3 Power of Symmetry: Simplifying Dynamics

When DB holds, Q can be symmetrized by a similarity transform. Define

$$
\tilde Q_{m n}:=\pi_m^{-1/2}\,Q_{m n}\,\pi_n^{1/2}.
$$

Using $Q_{m n}=w_{n\to m}$ and DB,

$$
\tilde Q_{m n}=\pi_m^{-1/2}w_{n\to m}\,\pi_n^{1/2}
 = \pi_m^{-1/2}\Big(w_{m\to n}\,\frac{\pi_n}{\pi_m}\Big)\pi_n^{1/2}
 = \pi_m^{1/2} w_{m\to n}\,\pi_n^{-1/2} = \tilde Q_{n m},
$$

so $\tilde Q$ is symmetric. Consequences:

1) Real eigenvalues: Q’s nonsteady eigenvalues $-\lambda$ are real ($\lambda>0$ for decaying modes).

2) Non‑oscillatory relaxation: the general solution is a sum of pure exponentials $p(t)=\sum_\lambda c_\lambda\,\Phi(\lambda)\,e^{-\lambda t}$; relaxation to $\boldsymbol\pi$ (the $\lambda=0$ mode) is smooth and non‑oscillatory.

3) Orthogonal eigenbasis: symmetric matrices have orthogonal eigenvectors; any initial distribution decomposes uniquely into relaxation modes.

## 1.4 Kolmogorov’s Loop Criterion: An Intuitive Equilibrium Test

For a three‑state loop $\{1,2,3\}$, reversibility requires

$$
w_{1\to2}\,w_{2\to3}\,w_{3\to1}=w_{2\to1}\,w_{3\to2}\,w_{1\to3}.
$$

If this fails (e.g., clockwise product > counter‑clockwise), there is a persistent net probability circulation — a hallmark of irreversibility. A single violating loop implies a nonequilibrium state requiring external energy input to maintain.

# 2. Beyond Equilibrium — Irreversibility and the Arrow of Time

We now quantify directional behavior in nonequilibrium.

## 2.1 When Equilibrium Is Broken: NESS

When detailed balance fails, the system can still reach a steady distribution $\frac{d\mathbf{p}}{dt}=0$, but with nonzero net currents

$$
J_{ij}=\pi_i w_{i\to j}-\pi_j w_{j\to i} \ne 0.
$$

Think of a fountain: the water level (probability) is constant but a pump continuously lifts water and it flows back — steady only by constant energy input. Living systems, circuits, and molecular machines operate as NESS.

## 2.2 Forward and Backward Trajectories

![Lecture blackboard screenshot](../../assets/images/remote/753f43e4-2aca-4959-8ec4-2fcaeb4bd3e5-803145793f.png)

Define a forward trajectory $\gamma$ by a sequence of states and dwell times:

$$
\gamma: 0 \xrightarrow{\tau_1} 1 \xrightarrow{\tau_2} \cdots \xrightarrow{\tau_n} n.
$$

Its probability density $P[\gamma]$ factors into events:

1) Initial probability $\pi_0$ at $t=0$.
2) Waiting in state $k$ for time $\tau_k$ without jumping: $e^{-\alpha_k\tau_k}$, with exit rate $\alpha_k=\sum_{\ell\ne k} w_{k\to\ell}$.
3) Jump probability $\propto w_{k\to k+1}$.

Altogether,

$$
P[\gamma]=\pi_0\,e^{-\alpha_0\tau_0}\,w_{0\to1}\,e^{-\alpha_1\tau_1}\,w_{1\to2}\cdots w_{n-1\to n}\,e^{-\alpha_n\tau_n}.
$$

The time‑reversed path $\bar\gamma$ starts at $n$ and traverses the same states in reverse order back to 0:

$$
P[\bar\gamma]=\pi_n\,e^{-\alpha_n\tau_n}\,w_{n\to n-1}\cdots w_{1\to0}\,e^{-\alpha_0\tau_0}.
$$

## 2.3 Quantifying Irreversibility: Entropy Produced Along a Path

The core asymmetry is $P[\gamma]\ne P[\bar\gamma]$. Consider the ratio

$$
\frac{P[\bar\gamma]}{P[\gamma]}=\frac{\pi_n e^{-\alpha_n\tau_n} w_{n\to n-1}\cdots w_{1\to0} e^{-\alpha_0\tau_0}}{\pi_0 e^{-\alpha_0\tau_0} w_{0\to1}\cdots w_{n-1\to n} e^{-\alpha_n\tau_n}}.
$$

All exponential waiting factors cancel — irreversibility (and entropy production) arises from jumps, not waiting. Thus

$$
\frac{P[\bar\gamma]}{P[\gamma]}=\frac{\pi_n}{\pi_0}\,\frac{w_{n\to n-1}\,w_{n-1\to n-2}\cdots w_{1\to0}}{w_{0\to1}\,w_{1\to2}\cdots w_{n-1\to n}}.
$$

Define the total entropy production along $\gamma$ by

$$
\Delta s[\gamma]=\ln\frac{P[\bar\gamma]}{P[\gamma]}.
$$

This log‑ratio mirrors the Kullback–Leibler divergence in information theory. Physically, $\Delta s[\gamma]$ measures our ability to tell forward from backward: large positive values indicate a clear arrow of time. Under detailed balance, $\Delta s[\gamma]$ fluctuates around 0.

## 2.4 Decomposing Entropy: System and Environment

![Lecture blackboard screenshot](../../assets/images/remote/d723de81-a899-417c-b628-84c13c7759d1-161752927f.jpg)

The total entropy production splits into two parts with clear meaning:

$$
\Delta s[\gamma]=\ln\Big(\frac{\pi_n}{\pi_0}\Big) + \sum_{k=1}^n \ln\Big(\frac{w_{k\to k-1}}{w_{k-1\to k}}\Big).
$$

1) System entropy change:

$$
(\Delta s)_\mathrm{system}=\ln\Big(\frac{\pi_n}{\pi_0}\Big)=-\ln\pi_n-(-\ln\pi_0).
$$

State function — depends only on endpoints, analogous to Boltzmann entropy $S=-k_B\ln p$.

2) Environment entropy change:

$$
(\Delta s)_\mathrm{env}=\sum_{k=1}^n \ln\Big(\frac{w_{k\to k-1}}{w_{k-1\to k}}\Big).
$$

Path function — sum over jumps, analogous to heat/work exchanges.

Altogether $\Delta s_\mathrm{total}=\Delta s_\mathrm{sys}+\Delta s_\mathrm{env}$.

## 2.5 Mean Entropy Production Rate $\sigma$

For NESS we care about sustained production:

$$
\sigma=\lim_{T\to\infty}\frac{1}{T}\,\langle\Delta s[\gamma]\rangle.
$$

In the long‑time limit the system term averages out (endpoint‑only); the environment term dominates. One obtains

$$
\sigma=\frac{1}{2}\sum_{i,j}\Big(\pi_i w_{i\to j}-\pi_j w_{j\to i}\Big)\,\ln\Big(\frac{\pi_j w_{j\to i}}{\pi_i w_{i\to j}}\Big)
 = \sum_{i<j} J_{ij}\,\ln\Big(\frac{w_{i\to j}}{w_{j\to i}}\Big).
$$

Structure: (flux)$\times$(thermodynamic force). Here $J_{ij}=\pi_i w_{i\to j}-\pi_j w_{j\to i}$ is the net probability current and $A_{ij}=\ln(\frac{w_{j\to i}}{w_{i\to j}})$ the thermodynamic force (affinity). Using $(x-y)\ln(x/y)\ge 0$ shows $\sigma\ge 0$, with equality iff all $J_{ij}=0$ (detailed balance). Any NESS must have $\sigma>0$.

# 3. Python Simulation

## 3.1 Reversible System: Thermal Motion in a Triple‑Well

We model a particle thermally hopping among three potential wells (A,B,C) in contact with a single‑temperature bath (detailed balance holds).

- Energy landscape: well depths $(E_A,E_B,E_C)$ and barriers.
- Rates: Arrhenius law $w_{i\to j}\propto\exp[-(E_\mathrm{barrier}-E_i)/(k_BT)]$.
- Theoretical steady state: Boltzmann $\pi_i\propto e^{-E_i/(k_BT)}$.
- Verify no net loop current and convergence to Boltzmann.

```python
import numpy as np
import matplotlib.pyplot as plt
from collections import Counter

def gillespie_simulation(Q, initial_state, T_max):
    """
    Simulates a continuous-time Markov process using the Gillespie algorithm.
    Args:
        Q (np.array): Transition rate matrix (Q_ij = w_j->i).
        initial_state (int): Starting state.
        T_max (float): Maximum simulation time.
    Returns:
        tuple: (times, states, transitions)
    """
    num_states = Q.shape[0]
    states = np.arange(num_states)
    current_state = initial_state; t = 0.0
    time_points = [t]; state_trajectory = [current_state]; transitions = []
    while t < T_max:
        rates_out = np.array([Q[j, current_state] for j in states if j != current_state])
        total_rate_out = np.sum(rates_out)
        if total_rate_out == 0: break
        dt = np.random.exponential(1.0 / total_rate_out)
        t += dt
        if t >= T_max: break
        possible_next = [j for j in states if j != current_state]
        next_state = np.random.choice(possible_next, p=rates_out/total_rate_out)
        transitions.append((current_state, next_state))
        current_state = next_state
        time_points.append(t); state_trajectory.append(current_state)
    return time_points, state_trajectory, transitions

print("--- Simulating Reversible System (Thermal Equilibrium) ---")
E = np.array([-1.5, -2.0, -0.5])
E_barrier_base = 0.5; prefactor = 1.0
Z = np.sum(np.exp(-E)); pi_theory = np.exp(-E) / Z

rates = {}
rates[(0,1)] = prefactor * np.exp(-(E_barrier_base + max(E[0], E[1]) - E[0]))
rates[(1,0)] = prefactor * np.exp(-(E_barrier_base + max(E[0], E[1]) - E[1]))
rates[(1,2)] = prefactor * np.exp(-(E_barrier_base + max(E[1], E[2]) - E[1]))
rates[(2,1)] = prefactor * np.exp(-(E_barrier_base + max(E[1], E[2]) - E[2]))
rates[(2,0)] = prefactor * np.exp(-(E_barrier_base + max(E[2], E[0]) - E[2]))
rates[(0,2)] = prefactor * np.exp(-(E_barrier_base + max(E[2], E[0]) - E[0]))

Q_rev = np.zeros((3,3))
for (i,j), rate in rates.items(): Q_rev[j,i] = rate
for i in range(3): Q_rev[i,i] = -np.sum(Q_rev[:,i])

prod_cw  = rates[(0,1)]*rates[(1,2)]*rates[(2,0)]
prod_ccw = rates[(0,2)]*rates[(2,1)]*rates[(1,0)]
print("Kolmogorov's Loop Criterion Check:")
print(f"  Clockwise rate product = {prod_cw:.4f}")
print(f"  Counter-clockwise rate product = {prod_ccw:.4f}")
print(f"  Ratio (should be 1.0): {prod_cw/prod_ccw:.4f}\n")

T_max_rev = 200000
times, states, transitions = gillespie_simulation(Q_rev, 0, T_max_rev)

from collections import Counter
cnt = Counter(transitions)
cw  = cnt.get((0,1),0)+cnt.get((1,2),0)+cnt.get((2,0),0)
ccw = cnt.get((0,2),0)+cnt.get((2,1),0)+cnt.get((1,0),0)
print(f"In a simulation of T={T_max_rev}:")
print(f"  Total clockwise jumps: {cw}")
print(f"  Total counter-clockwise jumps: {ccw}")
print("The counts are very close, indicating no net probability flux.\n")

occupancy = np.zeros(3)
for i in range(len(times)-1): occupancy[states[i]] += times[i+1]-times[i]
occupancy[states[-1]] += T_max_rev - times[-1]
pi_sim = occupancy / T_max_rev
print("Steady-State Distribution (Boltzmann) Comparison:")
print(f"  Theoretical pi = {np.round(pi_theory,4)}")
print(f"  Simulated pi   = {np.round(pi_sim,4)}")

plt.style.use('seaborn-v0_8-whitegrid')
fig = plt.figure(figsize=(12,9)); gs = fig.add_gridspec(2,2)
ax1 = fig.add_subplot(gs[0,:])
x = np.linspace(-1,5,500)
U = 0.1*(x**6 - 12*x**5 + 47*x**4 - 60*x**3 + 16*x**2 + 10*x)
U -= np.min(U)
U[x<1.5] += E[0]-np.min(U[x<1.5])+2.5
U[(x>=1.5)&(x<=3.5)] += E[1]-np.min(U[(x>=1.5)&(x<=3.5)])+2.5
U[x>3.5] += E[2]-np.min(U[x>3.5])+2.5
ax1.plot(x,U,color='black',linewidth=2.5)
ax1.set_title('Physical Model: Particle in a Triple-Well Potential')
ax1.set_xlabel('Position (arbitrary units)'); ax1.set_ylabel(r'Potential Energy $U(x)$')
ax1.text(0.5, E[0]+2.8, 'Well A (State 0)', ha='center')
ax1.text(2.5, E[1]+2.8, 'Well B (State 1)', ha='center')
ax1.text(4.5, E[2]+2.8, 'Well C (State 2)', ha='center')
ax1.set_yticks([])

ax2 = fig.add_subplot(gs[1,0])
labels = ['Well A (0)','Well B (1)','Well C (2)']
limit = min(500, T_max_rev); idx = np.where(np.array(times) <= limit)
ax2.step(np.array(times)[idx], np.array(states)[idx], where='post')
ax2.set_title(f'Sample Trajectory (First {limit} time units)')
ax2.set_xlabel('Time'); ax2.set_ylabel('State')
ax2.set_yticks([0,1,2]); ax2.set_yticklabels(labels); ax2.set_ylim(-0.5,2.5)

ax3 = fig.add_subplot(gs[1,1])
ax3.bar(labels, pi_sim, color='cornflowerblue', edgecolor='black', label='Simulation Result')
ax3.plot(labels, pi_theory, 'ro', markersize=10, label=r'Theory (Boltzmann $\pi$)')
ax3.set_title('Steady-State Probability Distribution')
ax3.set_ylabel('Probability'); ax3.legend()
plt.tight_layout(); plt.show()
```

Code execution output:

```
--- Simulating Reversible System (Thermal Equilibrium) ---
Kolmogorov's Loop Criterion Check:
  Clockwise rate product = 0.0498
  Counter-clockwise rate product = 0.0498
  Ratio (should be 1.0): 1.0000

In a simulation of T=200000:
  Total clockwise jumps: 69792
  Total counter-clockwise jumps: 69734
The counts are very close, indicating no net probability flux.

Steady-State Distribution (Boltzmann) Comparison:
  Theoretical pi = [0.3315 0.5465 0.122 ]
  Simulated pi   = [0.3318 0.5461 0.122 ]
```

![Code execution output](../../assets/images/remote/213a78ef-278d-4eea-8b03-8dd127f0a9b2-15341ba412.png)

Top: the energy landscape with three wells (B deepest, C shallowest). Bottom‑left: a sample trajectory (thermal hopping). Bottom‑right: simulated steady distribution (bars) matches the Boltzmann prediction (red dots).

## 3.2 Irreversible System: Driven Ring

We model a charged particle on three discrete sites (A,B,C) arranged in a ring and subject to a constant circulating field (nonconservative force). The field biases clockwise jumps; thermal fluctuations allow occasional counter‑clockwise jumps, but there is a persistent net current. Energy input is continuously dissipated as heat: a prototypical NESS.

Implementation:

1) Set clockwise rates $w_{\mathrm{cw}}$ ≫ counter‑clockwise $w_{\mathrm{ccw}}$.
2) Verify violation of Kolmogorov’s criterion and simulate.
3) Analyze net clockwise vs counter‑clockwise jumps; compute cumulative entropy production and its slope $\sigma$.

```python
import numpy as np
import matplotlib.pyplot as plt
from collections import Counter
import matplotlib.patches as patches

def gillespie_simulation(Q, initial_state, T_max):
    """Simulates a continuous-time Markov process using the Gillespie algorithm."""
    num_states = Q.shape[0]; states = np.arange(num_states)
    current_state = initial_state; t = 0.0
    time_points=[t]; state_traj=[current_state]; transitions=[]
    while t < T_max:
        rates_out = np.array([Q[j, current_state] for j in states if j != current_state])
        tot = np.sum(rates_out)
        if tot == 0: break
        dt = np.random.exponential(1.0/tot); t += dt
        if t >= T_max: break
        next_state = np.random.choice([j for j in states if j != current_state], p=rates_out/tot)
        transitions.append((current_state,next_state)); current_state=next_state
        time_points.append(t); state_traj.append(current_state)
    return time_points, state_traj, transitions

print("--- Simulating Irreversible System (Non-Equilibrium Steady State) ---")
Q_irrev = np.zeros((3,3))
w_cw, w_ccw = 10.0, 0.5
w01_i, w12_i, w20_i = w_cw, w_cw, w_cw
w10_i, w21_i, w02_i = w_ccw, w_ccw, w_ccw
Q_irrev[1,0]=w01_i; Q_irrev[0,1]=w10_i
Q_irrev[2,1]=w12_i; Q_irrev[1,2]=w21_i
Q_irrev[0,2]=w20_i; Q_irrev[2,0]=w02_i
for i in range(3): Q_irrev[i,i] = -np.sum(Q_irrev[:,i])
prod_cw  = w01_i*w12_i*w20_i
prod_ccw = w02_i*w21_i*w10_i
print("Kolmogorov's Loop Criterion Check:")
print(f"  Clockwise rate product = {prod_cw:.4f}")
print(f"  Counter-clockwise rate product = {prod_ccw:.4f}")
print("The products are unequal, confirming the system is irreversible.\n")

T=5000
times, states, transitions = gillespie_simulation(Q_irrev, 0, T)
cnt = Counter(transitions)
cw  = cnt.get((0,1),0)+cnt.get((1,2),0)+cnt.get((2,0),0)
ccw = cnt.get((0,2),0)+cnt.get((2,1),0)+cnt.get((1,0),0)
print(f"In a simulation of T={T}:")
print(f"  Total clockwise jumps: {cw}")
print(f"  Total counter-clockwise jumps: {ccw}")
print("A strong net clockwise probability current is observed.\n")

# Cumulative entropy production
entropy_times = [0.0]; cumulative_entropy = [0.0]
avg_sigma = 0.0
for (i,j) in transitions:
    # local increment: ln(w_{i->j}/w_{j->i})
    inc = np.log(Q_irrev[j,i]/Q_irrev[i,j]) if Q_irrev[i,j] > 0 else 0.0
    cumulative_entropy.append(cumulative_entropy[-1] + inc)
entropy_times.extend(times[1:])
avg_sigma = cumulative_entropy[-1]/entropy_times[-1] if entropy_times[-1] > 0 else 0.0

fig = plt.figure(figsize=(12,6)); gs = fig.add_gridspec(1,2)
ax1 = fig.add_subplot(gs[0])
pos = {0:(0,0),1:(1,0),2:(0.5,0.866)}
for s,(x,y) in pos.items(): ax1.plot(x,y,'ko'); ax1.text(x,y+0.08,f'State {s}',ha='center')
# Clockwise (strong)
ax1.add_patch(patches.FancyArrowPatch(pos[0], pos[1], connectionstyle="arc3,rad=.3", color="black", arrowstyle='->,head_length=10,head_width=8', linewidth=2.5))
ax1.add_patch(patches.FancyArrowPatch(pos[1], pos[2], connectionstyle="arc3,rad=.3", color="black", arrowstyle='->,head_length=10,head_width=8', linewidth=2.5))
ax1.add_patch(patches.FancyArrowPatch(pos[2], pos[0], connectionstyle="arc3,rad=.3", color="black", arrowstyle='->,head_length=10,head_width=8', linewidth=2.5))
# Counter-clockwise (weak)
ax1.add_patch(patches.FancyArrowPatch(pos[1], pos[0], connectionstyle="arc3,rad=.3", color="gray", arrowstyle='->,head_length=5,head_width=4', linewidth=1, linestyle='--'))
ax1.add_patch(patches.FancyArrowPatch(pos[2], pos[1], connectionstyle="arc3,rad=.3", color="gray", arrowstyle='->,head_length=5,head_width=4', linewidth=1, linestyle='--'))
ax1.add_patch(patches.FancyArrowPatch(pos[0], pos[2], connectionstyle="arc3,rad=.3", color="gray", arrowstyle='->,head_length=5,head_width=4', linewidth=1, linestyle='--'))
ax1.text(0, 1.5, 'Driving Force', ha='center', fontsize=12, style='italic', color='darkred')
ax1.set_xlim(-1.5,1.5); ax1.set_ylim(-1.5,2.0); ax1.set_aspect('equal'); ax1.axis('off')
ax1.set_title('Physical Model: Driven Particle on a Ring')

ax2 = fig.add_subplot(gs[1])
ax2.plot(entropy_times, cumulative_entropy, '-', label=r'Cumulative Entropy Production $\Delta s(t)$')
ax2.plot(entropy_times, avg_sigma*np.array(entropy_times), 'k--', linewidth=2, label=fr'Average Rate $\sigma \approx {avg_sigma:.3f}$')
ax2.set_title('Entropy Production in the Driven System')
ax2.set_xlabel('Time'); ax2.set_ylabel(r'Total Entropy Production, $\Delta s(t)$')
ax2.legend(); ax2.grid(True, linestyle='--', alpha=0.7)
plt.tight_layout(); plt.show()
```

Code execution output

```
--- Simulating Irreversible System (Non-Equilibrium Steady State) ---
Kolmogorov's Loop Criterion Check:
  Clockwise rate product = 1000.0000
  Counter-clockwise rate product = 0.1250
The products are unequal, confirming the system is irreversible.

In a simulation of T=5000:
  Total clockwise jumps: 50008
  Total counter-clockwise jumps: 2508
A strong net clockwise probability current is observed.

Simulated average entropy production rate (sigma) ~ 28.4600
```

![Code execution output](../../assets/images/remote/5a440c99-1910-4a67-bce4-ad6c16e0a896-a2c17b4778.png)

Left: the driven ring (strong clockwise arrows, weak counter‑clockwise dashed arrows). Right: cumulative entropy production grows roughly linearly; the slope is the average production rate $\sigma$.

# Conclusion

We moved from equilibrium to nonequilibrium physics.

- Equilibrium: detailed balance, no net currents ($J_{ij}=0$), zero average entropy production ($\sigma=0$), time‑reversal symmetry; Q can be symmetrized.
- Nonequilibrium: detailed balance broken, sustained currents ($J_{ij}\ne 0$), strictly positive entropy production rate ($\sigma>0$), a clear arrow of time.
- Trajectory‑level thermodynamics: define system, environment, and total entropy along single trajectories; obtain the mean rate $\sigma=\sum J\cdot A$ (flux times force), the universal dissipative structure.

Entropy production is the necessary cost to maintain function and directionality — from molecular motors and ion pumps to information processing, electric circuits, combustion, and weather systems. To stay far from heat death, complex systems must draw energy and dissipate entropy. In nonequilibrium, entropy production is not merely decay; it is the prerequisite for complexity, function, and life.
