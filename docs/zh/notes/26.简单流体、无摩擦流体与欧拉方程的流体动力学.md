å…³æ³¨æˆ‘ä»¬ï¼Œä¸€èµ·å­¦ä¹ ï¼

æœ€è¿‘åœ¨å­¦ä¹ è¯¾ç¨‹ **éå¹³è¡¡åœºè®ºä¸éšæœºåŠ¨åŠ›å­¦** **Nonequilibrium Field Theories and Stochastic Dynamics, Prof. Erwin Frey, LMU Munich, Summer Semester 2025**

å…¶ç›®å½•å¦‚ä¸‹ï¼š

![è¯¾ç¨‹é“¾æ¥ï¼šYouTubeï¼šhttps://www.youtube.com/watch?v=MZUqBwZMN_o&ab_channel=PhysicsOfLifeLMU 
å“”å“©å“”å“©ï¼šhttps://www.bilibili.com/video/BV18X8wzSEa3/?spm_id_from=333.1387.0.0](https://files.mdnice.com/user/30198/fd8f100d-93f9-420c-8ace-e3a67d524181.png)

Erwin Frey æ•™æˆå–œæ¬¢åœ¨é»‘æ¿ä¸Šå†™æ¿ä¹¦ï¼Œä¸ºè®°å½•å­¦ä¹ è¿‡ç¨‹ï¼Œå°†æ‰€å­¦ç¬”è®°æ•´ç†ä¸ºæ–‡ï¼Œå¹¶æ’°å†™pythonä»£ç åŠ æ·±ç†è§£ã€‚

ä¸Šå‡ èŠ‚å†…å®¹è¯·æŸ¥é˜…ï¼š

**1.ç®€å•éšæœºæ¸¸èµ°**

**2.é«˜æ–¯éšæœºæ¸¸èµ°ä¸æ³Šæ¾è¿‡ç¨‹**

**3.Gillespie ç®—æ³•ã€ä¸»æ–¹ç¨‹ã€ç”Ÿæˆå‡½æ•°ä¸ç§ç¾¤åŠ¨åŠ›å­¦**

**4.ç§ç¾¤åŠ¨åŠ›å­¦ï¼šçº¿æ€§æ­»äº¡è¿‡ç¨‹ä¸Lotka-Volterra ç³»ç»Ÿ**

**5.é©¬å°”å¯å¤«è¿‡ç¨‹çš„åŸºæœ¬æ–¹ç¨‹ï¼šæŸ¥æ™®æ›¼-ç§‘å°”è«æˆˆç½—å¤«æ–¹ç¨‹**

**6.å‰å‘ä¸»æ–¹ç¨‹ä¸QçŸ©é˜µ**

**7. ä½©é¾™-å¼—ç½—è´å°¼ä¹Œæ–¯å®šç†ã€ç¨³æ€ä¸ç»†è‡´å¹³è¡¡**

**8. éå¹³è¡¡æ€ï¼šä¸å¯é€†æ€§ä¸ç†µäº§ç”Ÿçš„æ¨è®º**

**9. Ehrenfest Modelã€ç†µä¸KLæ•£åº¦**

**10. è¿ç»­é©¬å°”å¯å¤«è¿‡ç¨‹ä¸ç¦å…‹-æ™®æœ—å…‹æ–¹ç¨‹**

**11. å¸ƒæœ—è¿åŠ¨ä¸ O-U è¿‡ç¨‹**

**12. ä½œä¸ºéšæœºè¿‡ç¨‹çš„è’™ç‰¹å¡æ´›é‡‡æ ·**

**13. å“ˆå¯†å°”é¡¿è’™ç‰¹å¡æ´›é‡‡æ ·**

**14. è¶‹åŒ–æ€§ä¸é›†ä½“åŠ¨åŠ›å­¦**

**15. ç²—ç²’åŒ–ã€åå¸¸æ‰©æ•£ä¸è¿åŠ¨è¯±å¯¼ç›¸åˆ†ç¦»**

**16. æœ—ä¹‹ä¸‡æ–¹ç¨‹ä¸æ¶¨è½-è€—æ•£å®šç†**

**17. ç¦å…‹-æ™®æœ—å…‹æ–¹ç¨‹ä¸ç»å°”å…¹æ›¼åˆ†å¸ƒ**

**18. éšæœºè¿‡ç¨‹çš„è·¯å¾„ç§¯åˆ†è¡¨è¿°**

**19. éšæœºå¾®åˆ†æ–¹ç¨‹**

**20. ä¼Šè—¤ç§¯åˆ†ä¸éšæœºè¿‡ç¨‹ç»Ÿä¸€æ¡†æ¶**

**21. å«ä¹˜æ€§å™ªå£°ç³»ç»Ÿçš„è·¯å¾„ç§¯åˆ†**

**22. ä»ç²—ç²’åŒ–åˆ°è¿ç»­åœºè®ºæ¶¨è½åŠ¨åŠ›å­¦**

**23. æ˜‚è¨æ ¼ç†è®ºä¸æ¶¨è½ã€è€—æ•£åŠå¯¹ç§°æ€§**

**24. æ¢¯åº¦åŠ¨åŠ›å­¦ã€ç›¸å˜ä¸å¼›è±«**

**25. ä¸´ç•Œæ…¢åŒ–ã€åŠ¨æ€å“åº”ä¸å®ˆæ’å¾‹**

# å¼•è¨€ï¼šä»æ ‡é‡åœºåˆ°æµä½“

åœ¨å‰é¢çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä¸ºæè¿°è¿‘å¹³è¡¡æ€çš„ç³»ç»Ÿï¼Œå»ºç«‹äº†ä¸€å¥—åŸºäº**è‡ªç”±èƒ½ (Free Energy)** å’Œ**æ˜‚è¨æ ¼å…³ç³» (Onsager Relations)** çš„å¼ºå¤§ç†è®ºæ¡†æ¶ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬çš„è®¨è®ºè‡³ä»Šä»å±€é™äºå•ä¸ª**æ ‡é‡åºå‚é‡ (scalar order parameter)** $\phi(x,t)$ çš„æ¼”åŒ–ã€‚

è¿™èŠ‚è¯¾æˆ‘ä»¬çš„è§†è§’å°†ä»æè¿°æŠ½è±¡åºå‚é‡çš„**æ¢¯åº¦åŠ¨åŠ›å­¦ (Gradient Dynamics)** ï¼Œæ‹“å±•è‡³æç»˜ç‰©ç†ä¸–ç•Œä¸­æœ€æ™®éçš„å®è§‚è¿åŠ¨â€”â€”**æµä½“åŠ¨åŠ›å­¦ (Hydrodynamics)** ã€‚è¿™å¹¶éç®€å•åœ°å¢åŠ å‡ ä¸ªå˜é‡ï¼Œè€Œæ˜¯è¿›å…¥äº†ä¸€ä¸ªå…¨æ–°çš„ç‰©ç†æè¿°èŒƒç•´ã€‚

æˆ‘ä»¬å°†å‘ç°ï¼Œæ”¯é…æµä½“è¿åŠ¨çš„æ–¹ç¨‹ï¼Œå…¶åº•å±‚é€»è¾‘ä¸æˆ‘ä»¬ä¹‹å‰å­¦åˆ°çš„çŸ¥è¯†ä¸€è„‰ç›¸æ‰¿ï¼Œéƒ½æºäºç‰©ç†å­¦æœ€æ ¹æœ¬çš„**å¯¹ç§°æ€§ (symmetries)** ä¸**å®ˆæ’å¾‹ (conservation laws)** ã€‚è¿™èŠ‚è¯¾çš„æ ¸å¿ƒä»»åŠ¡ï¼Œå°±æ˜¯ä»æœ€åŸºæœ¬çš„ç¬¬ä¸€æ€§åŸç†å‡ºå‘ï¼Œä¸ºä¸€ç§æœ€ç†æƒ³åŒ–çš„æµä½“â€”â€”**æ— æ‘©æ“¦æµä½“ (frictionless fluid)** â€”â€”æ„å»ºå…¶å®Œæ•´çš„åŠ¨åŠ›å­¦æ–¹ç¨‹ç»„ã€‚

æˆ‘ä»¬å°†ç³»ç»Ÿæ€§åœ°æ¨å¯¼ä¸‰å¤§åŸºæœ¬å®ˆæ’å®šå¾‹ï¼š
1.  **è´¨é‡å®ˆæ’ (Mass Conservation)**
2.  **åŠ¨é‡å®ˆæ’ (Momentum Conservation)**
3.  **èƒ½é‡å®ˆæ’ (Energy Conservation)**

é€šè¿‡è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬å°†æ¨å¯¼å‡ºæµä½“åŠ›å­¦ä¸­ä¸¤ä¸ªé‡Œç¨‹ç¢‘å¼çš„æ–¹ç¨‹â€”â€”**è¿ç»­æ€§æ–¹ç¨‹ (Continuity Equation)** å’Œ**æ¬§æ‹‰æ–¹ç¨‹ (Euler Equation)** ï¼Œå¹¶æ­ç¤ºç†æƒ³æµä½“è¿åŠ¨çš„æ·±åˆ»çƒ­åŠ›å­¦æœ¬è´¨ã€‚

# 1. ä»æ¢¯åº¦åŠ¨åŠ›å­¦åˆ°æµä½“åŠ¨åŠ›å­¦
åœ¨æˆ‘ä»¬å¯¹è¿‘å¹³è¡¡ç³»ç»ŸåŠ¨åŠ›å­¦çš„æ¢ç´¢ä¸­ï¼Œå·²ç»æ·±å…¥ç ”ç©¶äº†æè¿°å•ä¸ªæ ‡é‡åœº (scalar field) $\phi(x,t)$æ¼”åŒ–çš„æ¢¯åº¦åŠ¨åŠ›å­¦ (Gradient Dynamics)ã€‚ä¸ºäº†æ›´å¥½åœ°è¡”æ¥æœ¬è®²çš„å†…å®¹ï¼ŒErwin Frey æ•™æˆé¦–å…ˆç®€è¦å›é¡¾äº†å…¶æ ¸å¿ƒæ€æƒ³ï¼Œå¹¶é˜æ˜å®ƒæ˜¯å¦‚ä½•è‡ªç„¶åœ°å¼•å‘æ›´ä¸ºå®å¤§å’Œæ™®é€‚çš„æµä½“åŠ¨åŠ›å­¦ç†è®ºçš„ã€‚


![è¯¾ç¨‹æ¿ä¹¦æˆªå›¾](https://files.mdnice.com/user/129153/74734f77-c679-40bc-a1c9-76e8d82a451a.jpg)


## 1.1 å›é¡¾ï¼šä¸¤ç§å¼›è±«æ¨¡å‹

åœ¨å‰é¢çš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ åˆ°ï¼Œæ¢¯åº¦åŠ¨åŠ›å­¦ä¸»è¦åˆ†ä¸ºä¸¤ç§æ¨¡å‹ï¼Œå…¶æ ¹æœ¬åŒºåˆ«åœ¨äºæ‰€æè¿°çš„åºå‚é‡æ˜¯å¦**å®ˆæ’ (conserved)** ã€‚

* **æ¨¡å‹ A (Model A: éå®ˆæ’åœº, non-conserved field)** ï¼šå…¶åŠ¨åŠ›å­¦ç”±ä¸€ä¸ªå±€åŸŸçš„æœ—ä¹‹ä¸‡æ–¹ç¨‹æè¿°ï¼š

$$\frac{\partial \phi(\vec{x},t)}{\partial t} = -L \frac{\delta F}{\delta \phi} + \eta$$

å…¶å™ªå£°é¡¹æ»¡è¶³ï¼š

$$\langle \eta(\vec{x}, t) \eta(\vec{x}', t') \rangle = 2LT \delta(\vec{x} - \vec{x}') \delta(t - t')$$

è¯¥æ–¹ç¨‹æè¿°äº†ä¸€ä¸ªå±€åŸŸçš„**å¼›è±« (relaxation)** è¿‡ç¨‹ã€‚åœºé‡ $\phi$ åœ¨ç©ºé—´ä¸­ä»»ä½•ä¸€ç‚¹çš„æ•°å€¼éƒ½å¯ä»¥ç‹¬ç«‹åœ°å¢åŠ æˆ–å‡å°‘ï¼Œå…¶å˜åŒ–çš„é©±åŠ¨åŠ›æ¥è‡ªäºç³»ç»Ÿ**è‡ªç”±èƒ½ (Free Energy)** $F$ çš„é™ä½ã€‚$L$ æ˜¯ä¸€ä¸ª**åŠ¨åŠ›å­¦ç³»æ•° (kinetic coefficient)** ï¼Œ$\eta$ ä»£è¡¨**çƒ­å™ªå£° (thermal noise)** ã€‚

* **æ¨¡å‹ B (Model B: å®ˆæ’åœº, conserved field)** ï¼šå…¶åŠ¨åŠ›å­¦å¿…é¡»éµå¾ª**è¿ç»­æ€§æ–¹ç¨‹ (continuity equation)** çš„å½¢å¼ï¼š
    $$\frac{\partial \phi(\vec{x},t)}{\partial t} = -\nabla \cdot \vec{J}$$
    å…¶ä¸­ï¼Œæµ (flux) $\vec{J}$ ç”±åŒ–å­¦åŠ¿çš„æ¢¯åº¦é©±åŠ¨ï¼š
    $$\vec{J} = -M \nabla \frac{\delta F}{\delta \phi} + \vec{\eta}_J$$
    å…¶æ¶¨è½æµé¡¹æ»¡è¶³ï¼š
    $$\langle \eta_{J\alpha}(\vec{x}, t) \eta_{J\beta}(\vec{x}', t') \rangle = 2MT \delta_{\alpha\beta} \delta(\vec{x} - \vec{x}') \delta(t - t')$$
    è¿™ä¸ªå½¢å¼åœ¨ç‰©ç†ä¸Šæœ‰ç€æœ¬è´¨çš„ä¸åŒã€‚å®ƒè¡¨æ˜åœºé‡ $\phi$ çš„æ€»é‡æ˜¯å®ˆæ’çš„ï¼Œä¸èƒ½åœ¨ç©ºé—´ä¸­å‡­ç©ºäº§ç”Ÿæˆ–æ¶ˆå¤±ã€‚ä»»ä½•å±€åŸŸåœºé‡çš„å˜åŒ–ï¼Œéƒ½å¿…é¡»æºäºä¸€ä¸ªç‰©ç†çš„**æµ (flux or current)** $\vec{J}$ æµå…¥æˆ–æµå‡ºè¯¥åŒºåŸŸã€‚(æ³¨ï¼šæ­¤å¤„é‡‡ç”¨äº†æ›´å®Œæ•´çš„æ¨¡å‹Bè¡¨è¾¾å¼ï¼Œå…¶ä¸­Mé€šå¸¸è¢«ç§°ä¸ºè¿ç§»ç‡(Mobility)ã€‚åœ¨æ¿ä¹¦å›é¡¾ä¸­ï¼Œæ•™æˆä¸ºäº†ç®€æ´å¯èƒ½çœç•¥äº†æ¢¯åº¦ç®—å­ $\nabla$)

## 1.2 æµä½“åŠ¨åŠ›å­¦ä½œä¸ºæ™®é€‚ç†è®º

è¿™èŠ‚è¯¾å°†ä»æè¿°å•ä¸ªæ ‡é‡åœºçš„æ¨¡å‹Bè½¬å‘çš„**æµä½“åŠ¨åŠ›å­¦ (Hydrodynamics)** ã€‚æ¨¡å‹ B çš„æ–¹ç¨‹å½¢å¼ $\frac{\partial (\text{å¯†åº¦})}{\partial t} + \nabla \cdot (\text{æµ}) = 0$ ä¸ä»…ä»…æ˜¯æè¿°ä¸€ä¸ªåºå‚é‡çš„æ–¹ç¨‹ï¼Œå®ƒå®é™…ä¸Šæ˜¯ç‰©ç†å­¦ä¸­æ‰€æœ‰**å®ˆæ’å¾‹ (conservation laws)** çš„é€šç”¨æ•°å­¦æ¨¡æ¿ã€‚

æµä½“åŠ¨åŠ›å­¦çš„æ ¸å¿ƒä»»åŠ¡ï¼Œæ­£æ˜¯å°†è¿™ä¸ªæ™®é€‚çš„æ•°å­¦æ¡†æ¶ï¼Œä»æè¿°å•ä¸ªæŠ½è±¡çš„åºå‚é‡ï¼Œæ¨å¹¿åˆ°æè¿°ä»»ä½•æµä½“éƒ½å¿…é¡»æœä»çš„ã€ä¸€ç»„æœ€åŸºæœ¬çš„**å®ˆæ’é‡ (conserved quantities)** ã€‚è¿™äº›å®ˆæ’é‡ï¼Œå³**è´¨é‡ã€åŠ¨é‡å’Œèƒ½é‡** ï¼Œæ˜¯ä»»ä½•å®è§‚ç³»ç»Ÿåœ¨ä½é¢‘ï¼ˆé•¿æ—¶é—´å°ºåº¦ï¼‰å’Œé•¿æ³¢ï¼ˆå¤§ç©ºé—´å°ºåº¦ï¼‰ä¸‹çš„ä¸»å¯¼è‡ªç”±åº¦ã€‚å› ä¸ºå®ƒä»¬çš„æ”¹å˜åªèƒ½é€šè¿‡é•¿è·ç¦»çš„è¾“è¿æ¥å®Œæˆï¼Œæ‰€ä»¥å®ƒä»¬æ˜¯ç³»ç»Ÿä¸­æœ€â€œæ…¢â€çš„å˜é‡ã€‚

å› æ­¤ï¼Œæµä½“åŠ¨åŠ›å­¦æ˜¯ä¸€å¥—æå…¶æ™®é€‚çš„ç†è®ºï¼Œå®ƒä¸å…³å¿ƒå¾®è§‚ç»†èŠ‚ï¼ˆå¦‚åˆ†å­é—´çš„å…·ä½“ä½œç”¨åŠ›ï¼‰ï¼Œåªä¸“æ³¨äºç³»ç»Ÿæœ€åŸºæœ¬çš„å¯¹ç§°æ€§ä¸å®ˆæ’å®šå¾‹ã€‚æœ¬è®²çš„å…¨éƒ¨å†…å®¹ï¼Œå°±æ˜¯ä¸ºæµä½“çš„è´¨é‡ã€åŠ¨é‡å’Œèƒ½é‡è¿™ä¸‰ä¸ªåŸºæœ¬å®ˆæ’é‡ï¼Œå¯»æ‰¾å®ƒä»¬å„è‡ªå¯¹åº”çš„â€œæµâ€ï¼Œä¹Ÿå³**é€šé‡ (flux)** ï¼Œå¹¶æ„å»ºèµ·æè¿°ç†æƒ³æµä½“ï¼ˆæ— æ‘©æ“¦æµä½“ï¼‰çš„å®Œæ•´åŠ¨åŠ›å­¦æ–¹ç¨‹ç»„ã€‚

# 2. æ„å»ºç†è®ºçš„åŸºçŸ³ï¼šåŸºæœ¬å‡è®¾ä¸æè¿°åœº

ä¸ºäº†å»ºç«‹ä¸€å¥—èƒ½å¤Ÿæè¿°æµä½“å®è§‚è¿åŠ¨çš„æ™®é€‚ç†è®ºï¼Œæˆ‘ä»¬æ— éœ€æ·±å…¥åˆ°æ¯ä¸ªåˆ†å­çš„å…·ä½“è¡Œä¸ºã€‚ç›¸åï¼Œæˆ‘ä»¬ä»ä¸¤ä¸ªå¼ºå¤§ä¸”æ ¹æœ¬çš„ç‰©ç†å‡è®¾å‡ºå‘ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šå®šä¹‰ä¸€å¥—èƒ½å¤Ÿæè¿°æµä½“çŠ¶æ€çš„**å®è§‚åœº (macroscopic fields)** ã€‚

## 2.1 å‡è®¾ä¸€ï¼šè¿ç»­ä»‹è´¨ä¸â€œæµä½“å…ƒâ€

æˆ‘ä»¬é¦–å…ˆå¼•å…¥**è¿ç»­ä»‹è´¨å‡è®¾ (Continuous Medium Assumption)** ã€‚åœ¨è¿™ä¸ªå‡è®¾ä¸‹ï¼Œæˆ‘ä»¬å¿½ç•¥æµä½“çš„å¾®è§‚åˆ†å­ç»“æ„ï¼Œå°†å…¶è§†ä¸ºä¸€ä¸ªå¯ä»¥æ— é™åˆ†å‰²çš„è¿ç»­ç‰©è´¨ã€‚ä¸ºäº†åœ¨æ•°å­¦ä¸Šå¤„ç†è¿™ä¸ªè¿ç»­ä½“ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µâ€”â€”**â€œæµä½“å…ƒâ€ (fluid element)** ã€‚


![è¯¾å ‚æ¿ä¹¦æˆªå›¾](https://files.mdnice.com/user/129153/b9f94dbd-5136-4330-b3c0-d6e6e0b35a8f.png)

![è¯¾å ‚æ¿ä¹¦æˆªå›¾](https://files.mdnice.com/user/129153/d0228f7a-958b-4d65-ae5d-dda1117fa9bd.jpg)


ä¸€ä¸ªâ€œæµä½“å…ƒâ€æ˜¯è¿™æ ·ä¸€ä¸ªå°ä½“ç§¯ï¼š

  * **åœ¨å®è§‚å°ºåº¦ä¸Šï¼Œå®ƒè¶³å¤Ÿå°**ï¼Œå¯ä»¥è¢«è¿‘ä¼¼ä¸ºä¸€ä¸ªæ•°å­¦ä¸Šçš„ç‚¹ $(\vec{x}, t)$ï¼Œä»è€Œå…è®¸æˆ‘ä»¬ä½¿ç”¨å¾®ç§¯åˆ†å·¥å…·ï¼ˆå¦‚æ¢¯åº¦ã€æ•£åº¦ï¼‰æ¥æè¿°ç‰©ç†é‡çš„ç©ºé—´å˜åŒ–ã€‚
  * **åœ¨å¾®è§‚å°ºåº¦ä¸Šï¼Œå®ƒåˆè¶³å¤Ÿå¤§**ï¼Œå†…éƒ¨åŒ…å«äº†æ•°é‡å·¨å¤§çš„åˆ†å­ã€‚è¿™ä½¿å¾—è¯¸å¦‚å¯†åº¦ã€å‹å¼ºã€æ¸©åº¦ç­‰ç»Ÿè®¡ç‰©ç†é‡å¯ä»¥åœ¨å…¶ä¸­è¢«è‰¯å¥½åœ°å®šä¹‰ï¼Œå…¶å†…éƒ¨çš„æ¶¨è½å¯ä»¥è¢«å¹³å‡æ‰ã€‚

æ­£å¦‚æ•™æˆåœ¨è¯¾å ‚ä¸Šæåˆ°çš„ï¼Œè¿™ä¸ªå‡è®¾çš„é€‚ç”¨èŒƒå›´æƒŠäººåœ°å¹¿æ³›ï¼Œå³ä½¿åœ¨20-30çº³ç±³çš„å°ºåº¦ä¸Šï¼Œå¯¹äºåƒæ°´è¿™æ ·çš„æµä½“ï¼Œè¿ç»­ä»‹è´¨æè¿°åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¾ç„¶æœ‰æ•ˆã€‚

## 2.2 å‡è®¾äºŒï¼šå±€åŸŸçƒ­å¹³è¡¡

è¿™æ˜¯æµä½“åŠ¨åŠ›å­¦ç†è®ºçš„ç¬¬äºŒä¸ªåŸºçŸ³ï¼š**å±€åŸŸå¹³è¡¡å‡è®¾ (Local Equilibrium Assumption)** ã€‚å®ƒæŒ‡å‡ºï¼š

å³ä½¿æ•´ä¸ªæµä½“ç³»ç»Ÿå®è§‚ä¸Šå¤„äºéå¹³è¡¡æ€ï¼ˆä¾‹å¦‚ï¼Œå­˜åœ¨æµåŠ¨ã€æ¸©åº¦æ¢¯åº¦ç­‰ï¼‰ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥è®¤ä¸ºæ¯ä¸€ä¸ªâ€œæµä½“å…ƒâ€åœ¨ä»»ä½•æ—¶åˆ»éƒ½å¤„äºå…¶è‡ªèº«çš„**å†…éƒ¨çƒ­åŠ›å­¦å¹³è¡¡çŠ¶æ€**ã€‚

è¿™ä¸ªå‡è®¾çš„å¨åŠ›åœ¨äºï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨æ¯ä¸ªæ—¶ç©ºç‚¹ $(\vec{x}, t)$ ä¸Šï¼Œå®šä¹‰ä¸€ç³»åˆ—å±€åŸŸçš„çƒ­åŠ›å­¦çŠ¶æ€å˜é‡ï¼Œä¾‹å¦‚å±€åŸŸæ¸©åº¦ $T(\vec{x}, t)$ å’Œå±€åŸŸå‹å¼º $P(\vec{x}, t)$ã€‚æ­£å› å¦‚æ­¤ï¼Œæˆ‘ä»¬æ‰èƒ½å°†å¹³è¡¡æ€çƒ­åŠ›å­¦çš„å…¨éƒ¨å¼ºå¤§å·¥å…·å’Œå…³ç³»å¼ï¼ˆå¦‚çƒ­åŠ›å­¦ç¬¬ä¸€å®šå¾‹ã€å‰å¸ƒæ–¯å…³ç³»ç­‰ï¼‰åº”ç”¨äºæè¿°ä¸€ä¸ªåŠ¨æ€æ¼”åŒ–ä¸­çš„ã€éå¹³è¡¡çš„æµä½“ç³»ç»Ÿã€‚

## 2.3 æµä½“åŠ¨åŠ›å­¦çš„åŸºæœ¬åœºï¼šå®ˆæ’çš„æ…¢å˜é‡

åŸºäºä»¥ä¸Šå‡è®¾ï¼Œæˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸€å¥—æœ€åŸºæœ¬çš„ç‰©ç†åœºæ¥æè¿°æµä½“çš„çŠ¶æ€ã€‚æˆ‘ä»¬åº”è¯¥é€‰æ‹©å“ªäº›åœºå‘¢ï¼Ÿç†è®ºç‰©ç†çš„æŒ‡å¯¼åŸåˆ™æ˜¯ï¼š**é€‰æ‹©ç³»ç»Ÿçš„æ…¢å˜é‡ï¼Œå› ä¸ºå®ƒä»¬å†³å®šäº†ç³»ç»Ÿåœ¨é•¿æ—¶é—´ã€å¤§å°ºåº¦ä¸‹çš„å®è§‚åŠ¨åŠ›å­¦**ã€‚åœ¨ä¸€ä¸ªæµä½“ç³»ç»Ÿä¸­ï¼Œæœ€â€œæ…¢â€çš„å˜é‡æ­£æ˜¯é‚£äº›**å®ˆæ’é‡**ï¼Œå› ä¸ºå®ƒä»¬çš„æ”¹å˜åªèƒ½é€šè¿‡é•¿è·ç¦»çš„ç‰©è´¨è¾“è¿æ¥å®Œæˆã€‚

å¯¹äºä¸€ä¸ª**ç®€å•æµä½“ (simple fluid)** ï¼ˆå³ç”±å•ä¸€ç»„åˆ†æ„æˆçš„æµä½“ï¼‰ï¼Œæˆ‘ä»¬é€‰æ‹©ä»¥ä¸‹ä¸‰ä¸ªåŸºæœ¬å®ˆæ’åœºçš„å¯†åº¦æ¥æè¿°å…¶çŠ¶æ€ï¼š

1.  **è´¨é‡å¯†åº¦åœº (mass density)** $\rho(\vec{x}, t)$ï¼šå•ä½ä½“ç§¯å†…çš„æµä½“è´¨é‡ã€‚è¿™æ˜¯æˆ‘ä»¬æœ€åŸºæœ¬çš„æ ‡é‡åœºã€‚

2.  **åŠ¨é‡å¯†åº¦åœº (momentum density)** $\vec{g}(\vec{x}, t)$ï¼šå•ä½ä½“ç§¯å†…çš„æµä½“åŠ¨é‡ã€‚å®ƒæ˜¯ä¸€ä¸ªçŸ¢é‡åœºï¼Œä¸æµä½“çš„**é€Ÿåº¦åœº (velocity field)** $\vec{v}(\vec{x}, t)$ å¯†åˆ‡ç›¸å…³ï¼Œå…¶å®šä¹‰ä¸ºï¼š
 
    $$\vec{g}(\vec{x}, t) = \rho(\vec{x}, t) \vec{v}(\vec{x}, t)$$
    é€Ÿåº¦åœº $\vec{v}(\vec{x}, t)$ å°†æ˜¯æˆ‘ä»¬è¦æ±‚è§£çš„æ ¸å¿ƒå˜é‡ä¹‹ä¸€ã€‚

3.  **èƒ½é‡å¯†åº¦åœº (energy density)** $\epsilon(\vec{x}, t)$ï¼šåœ¨æµä½“åŠ¨åŠ›å­¦çš„æ„å»ºä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å…³æ³¨çš„æ˜¯**å•ä½è´¨é‡çš„å†…èƒ½ (internal energy per unit mass)** ã€‚æµä½“çš„æ€»èƒ½é‡å¯†åº¦è¿˜éœ€è¦é¢å¤–è€ƒè™‘å®è§‚æµåŠ¨çš„åŠ¨èƒ½ï¼Œæˆ‘ä»¬å°†åœ¨èƒ½é‡å®ˆæ’éƒ¨åˆ†è¯¦ç»†è®¨è®ºã€‚

è§’åŠ¨é‡ä¹Ÿæ˜¯ä¸€ä¸ªå®ˆæ’é‡ï¼Œä½†åœ¨æ²¡æœ‰å†…éƒ¨è‡ªæ—‹æˆ–å¤–éƒ¨æ‰­çŸ©çš„æƒ…å†µä¸‹ï¼Œå…¶åŠ¨åŠ›å­¦å¯ä»¥ç”±åŠ¨é‡åœºçš„æ¼”åŒ–å¯¼å‡ºï¼Œå› æ­¤æˆ‘ä»¬åœ¨è¿™é‡Œä¸æŠŠå®ƒä½œä¸ºç‹¬ç«‹çš„åŸºæœ¬åœºã€‚

æœ‰äº†è¿™å¥—åŸºæœ¬å‡è®¾å’Œæè¿°åœºï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±å¯ä»¥ä¸ºæ¯ä¸€ä¸ªå®ˆæ’é‡æ„å»ºå…¶å¯¹åº”çš„åŠ¨åŠ›å­¦æ–¹ç¨‹äº†ã€‚


# 3. ç¬¬ä¸€æ”¯æŸ±ï¼šè´¨é‡å®ˆæ’ä¸è¿ç»­æ€§æ–¹ç¨‹ (Continuity Equation)

ç°åœ¨ï¼Œæˆ‘ä»¬å¼€å§‹åº”ç”¨åœ¨ç¬¬ä¸€èŠ‚ä¸­å»ºç«‹çš„å®ˆæ’å¾‹æ¡†æ¶ã€‚ç¬¬ä¸€ä¸ªï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„ä¸€ä¸ªåŸºæœ¬æ”¯æŸ±ï¼Œæ¥è‡ªäº**è´¨é‡å®ˆæ’å®šå¾‹ (mass conservation law)** ã€‚æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯ä¸ºè´¨é‡è¿™ä¸ªå®ˆæ’é‡ï¼Œæ‰¾å‡ºå…¶å¯¹åº”çš„â€œå¯†åº¦â€å’Œâ€œæµâ€ã€‚

## 3.1 ç§¯åˆ†å½¢å¼ï¼šç‰©ç†ç›´è§‰çš„ä½“ç°

æˆ‘ä»¬ä»æœ€ç›´è§‚çš„ç‰©ç†å›¾åƒå‡ºå‘ï¼šè€ƒè™‘ç©ºé—´ä¸­ä¸€ä¸ªä»»æ„å›ºå®šçš„æ§åˆ¶ä½“ç§¯ $V$ï¼Œå…¶è¡¨é¢ä¸º $\partial V$ã€‚è´¨é‡å®ˆæ’çš„ç‰©ç†ç›´è§‰æ˜¯ï¼šâ€œä¸€ä¸ªå°é—­ä½“ç§¯å†…æ€»è´¨é‡çš„å˜åŒ–ï¼Œåªèƒ½é€šè¿‡ç‰©è´¨æµç©¿è¿‡å…¶è¾¹ç•Œæ¥å®ç°â€ã€‚

* **â€œå¯†åº¦â€**: æè¿°è´¨é‡çš„å¯†åº¦å°±æ˜¯**è´¨é‡å¯†åº¦åœº (mass density)** $\rho(\vec{x}, t)$ã€‚å› æ­¤ï¼Œä½“ç§¯ $V$ å†…çš„æ€»è´¨é‡ä¸º $M = \int_V dV \, \rho(\vec{x}, t)$ã€‚

* **â€œæµâ€**: æè¿°è´¨é‡æµåŠ¨çš„ç‰©ç†é‡æ˜¯**è´¨é‡æµ (mass current)** æˆ–**è´¨é‡é€šé‡ (mass flux)** $\vec{J}(\vec{x}, t)$ã€‚å¯¹äºä¸€ä¸ªé€Ÿåº¦ä¸º $\vec{v}$ çš„æµä½“ï¼Œè¿™ä¸ªé€šé‡ç›´è§‚åœ°ç­‰äºå¯†åº¦ä¹˜ä»¥é€Ÿåº¦ï¼š$\vec{J}(\vec{x}, t) = \rho(\vec{x}, t) \vec{v}(\vec{x}, t)$ã€‚
* **å®ˆæ’å®šå¾‹**: ä½“ç§¯å†…æ€»è´¨é‡çš„å˜åŒ–ç‡ï¼Œå¿…é¡»ç­‰äº**å‡€æµå…¥**è¯¥ä½“ç§¯çš„è´¨é‡ã€‚é€šè¿‡è¡¨é¢ $\partial V$ å‘å¤–æµå‡ºçš„æ€»é€šé‡ä¸º $\oint_{\partial V} d\vec{S} \cdot \vec{J}$ï¼Œå…¶ä¸­ $d\vec{S} = \hat{n} dS$ æ˜¯æŒ‡å‘ä½“ç§¯å¤–éƒ¨çš„é¢ç§¯å¾®å…ƒã€‚å› æ­¤ï¼Œè´¨é‡å®ˆæ’çš„ç§¯åˆ†å½¢å¼å¯ä»¥å†™ä¸ºï¼š

    $$\frac{d}{dt} \int_V dV \, \rho = -\oint_{\partial V} d\vec{S} \cdot \vec{J}$$

    ç­‰å¼å³è¾¹çš„è´Ÿå·è¡¨ç¤ºï¼Œå½“å‡€é€šé‡ä¸ºæ­£ï¼ˆå‘å¤–æµï¼‰æ—¶ï¼Œå†…éƒ¨è´¨é‡å‡å°‘ã€‚

![è¯¾å ‚æ¿ä¹¦æˆªå›¾](https://files.mdnice.com/user/129153/f70a1c9a-7a57-4d94-babc-7f82121ce3f6.png)

## 3.2 å¾®åˆ†å½¢å¼ï¼šå±€åŸŸçš„å®ˆæ’å®šå¾‹

ç§¯åˆ†å½¢å¼æè¿°çš„æ˜¯æ•´ä¸ªä½“ç§¯çš„å®è§‚è¡Œä¸ºã€‚ä¸ºäº†å¾—åˆ°ä¸€ä¸ªé€‚ç”¨äºç©ºé—´æ¯ä¸€ç‚¹çš„å±€åŸŸæ–¹ç¨‹ï¼Œæˆ‘ä»¬ä½¿ç”¨**é«˜æ–¯æ•£åº¦å®šç† (Gauss's Divergence Theorem)** å°†ä¸Šå¼ä¸­çš„é¢ç§¯åˆ†è½¬æ¢æˆä½“ç§¯åˆ†ï¼š

$$\oint_{\partial V} d\vec{S} \cdot \vec{J} = \int_V dV (\nabla \cdot \vec{J})$$

ä»£å…¥ç§¯åˆ†å½¢å¼çš„å®ˆæ’æ–¹ç¨‹ï¼Œå¹¶å°†æ—¶é—´å¯¼æ•°ç§»å…¥ç§¯åˆ†å·å†…ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š

$$\int_V dV \left( \frac{\partial \rho}{\partial t} + \nabla \cdot \vec{J} \right) = 0$$

ç”±äºè¿™ä¸ªå…³ç³»å¼å¿…é¡»å¯¹**ä»»æ„é€‰å–**çš„æ§åˆ¶ä½“ç§¯ $V$ éƒ½æˆç«‹ï¼Œå› æ­¤è¢«ç§¯å‡½æ•°æœ¬èº«å¿…é¡»å¤„å¤„ä¸ºé›¶ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†è´¨é‡å®ˆæ’çš„å¾®åˆ†å½¢å¼ï¼Œå³**è¿ç»­æ€§æ–¹ç¨‹ (Continuity Equation)** ï¼š

$$\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \vec{v}) = 0$$

è¿™ä¸ªæ–¹ç¨‹æ˜¯æµä½“åŠ¨åŠ›å­¦çš„ç¬¬ä¸€ä¸ªåŸºæœ¬æ–¹ç¨‹ã€‚å®ƒå®Œç¾åœ°ä½“ç°äº†æ¨¡å‹ B çš„å®ˆæ’å¾‹ç»“æ„ï¼Œå¹¶ä¸ºæˆ‘ä»¬æ¥ä¸‹æ¥æ¨å¯¼å…¶ä»–æ–¹ç¨‹å¥ å®šäº†åŸºç¡€ã€‚

# 4. ç¬¬äºŒæ”¯æŸ±ï¼šåŠ¨é‡å®ˆæ’ä¸æ¬§æ‹‰æ–¹ç¨‹ (Euler Equation)

åœ¨å»ºç«‹äº†è´¨é‡å®ˆæ’ä¹‹åï¼Œæˆ‘ä»¬è½¬å‘ä¸‹ä¸€ä¸ªå®ˆæ’é‡â€”â€”åŠ¨é‡ã€‚å¯¹åŠ¨é‡å®ˆæ’çš„æè¿°å°†ä¸ºæˆ‘ä»¬æ­ç¤ºæµä½“å¦‚ä½•è¿åŠ¨çš„åŠ¨åŠ›å­¦è§„å¾‹ã€‚å¯¹äºä¸€ä¸ªæ²¡æœ‰ç²˜æ€§ï¼ˆå³æ— æ‘©æ“¦ï¼‰çš„ç†æƒ³æµä½“ï¼Œè¿™ä¸ªè§„å¾‹ç”±è‘—åçš„**æ¬§æ‹‰æ–¹ç¨‹ (Euler Equation)** ç»™å‡º ã€‚

## 4.1 ç‰©è´¨å¯¼æ•°ï¼šè¿æ¥â€œè·Ÿéšè€…â€ä¸â€œè§‚å¯Ÿè€…â€çš„è§†è§’

æ¨å¯¼åŠ¨åŠ›å­¦æ–¹ç¨‹æ—¶ï¼Œæˆ‘ä»¬é¢ä¸´ä¸€ä¸ªæ ¸å¿ƒçš„è§†è§’é—®é¢˜ï¼šç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼ˆ$\vec{F}=m\vec{a}$ï¼‰æ˜¯åº”ç”¨äºä¸€ä¸ªå…·ä½“çš„ç‰©ä½“ï¼ˆå³ä¸€ä¸ªç‰¹å®šçš„â€œæµä½“å…ƒâ€ï¼‰çš„ï¼Œæè¿°çš„æ˜¯è¿™ä¸ªç‰©ä½“**è‡ªèº«ç»å†**çš„åŠ é€Ÿåº¦ã€‚è¿™æ˜¯ä¸€ç§â€œéšæ³¢é€æµâ€çš„**æ‹‰æ ¼æœ—æ—¥è§†è§’ (Lagrangian View)** ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å»ºç«‹çš„åœºè®ºæ˜¯åœ¨å®éªŒå®¤å›ºå®šçš„åæ ‡ç³»ä¸­æè¿°ç‰©ç†åœºå¦‚ä½•æ¼”åŒ–çš„ï¼Œè¿™æ˜¯ä¸€ç§â€œé™è§‚å…¶å˜â€çš„**æ¬§æ‹‰è§†è§’ (Eulerian View)** ã€‚

ä¸ºäº†åœ¨è¿™ä¸¤ç§è§†è§’é—´å»ºç«‹æ¡¥æ¢ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ•°å­¦å·¥å…·ï¼Œå®ƒèƒ½å›ç­”è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šâ€œä¸€ä¸ªè·Ÿéšç€æµä½“è¿åŠ¨çš„ç²’å­ï¼Œå®ƒæ‰€æ„Ÿå—åˆ°çš„æŸä¸ªç‰©ç†é‡ $f$ çš„æ€»å˜åŒ–ç‡æ˜¯å¤šå°‘ï¼Ÿâ€ è¿™ä¸ªå·¥å…·å°±æ˜¯**ç‰©è´¨å¯¼æ•° (Material Derivative)** ï¼Œè®°ä½œ $\frac{D f}{D t}$ ã€‚

ä¸€ä¸ªè·Ÿéšæµä½“è¿åŠ¨çš„ç²’å­ï¼Œå…¶æ„Ÿå—åˆ°çš„ç‰©ç†é‡ $f(\vec{x}, t)$ çš„å˜åŒ–æ¥è‡ªä¸¤éƒ¨åˆ†ï¼š

1. **å±€åŸŸå˜åŒ–**: å³ä½¿ç²’å­ä¸åŠ¨ï¼Œå…¶æ‰€åœ¨ä½ç½® $\vec{x}$ çš„ $f$ å€¼ä¹Ÿå¯èƒ½éšæ—¶é—´å˜åŒ–ï¼Œè¿™ç”±åå¯¼æ•° $\frac{\partial f}{\partial t}$ æè¿° ã€‚

2.  **å¯¹æµå˜åŒ–** : ç²’å­è¢«é€Ÿåº¦åœº $\vec{v}$ â€œæºå¸¦â€åˆ°äº†ä¸€ä¸ªæ–°çš„ä½ç½®ï¼Œè€Œæ–°ä½ç½®çš„ $f$ å€¼ä¸åŸä½ç½®ä¸åŒï¼Œè¿™ç§ç”±ä½ç½®ç§»åŠ¨å¼•èµ·çš„å˜åŒ–è¢«ç§°ä¸º**å¯¹æµ (convection)** ï¼Œç”± $(\vec{v} \cdot \nabla)f$ æè¿°ã€‚

ä¸¤è€…ç›¸åŠ ï¼Œä¾¿å¾—åˆ°äº†ç‰©è´¨å¯¼æ•°çš„å®Œæ•´è¡¨è¾¾å¼ï¼š

$$\frac{D f}{D t} = \frac{\partial f}{\partial t} + (\vec{v} \cdot \vec{\nabla})f$$

è¿™ä¸ªå¯¼æ•°å®Œç¾åœ°å°†æ¬§æ‹‰è§†è§’ä¸‹çš„åœºå˜åŒ–ï¼ˆ$\frac{\partial f}{\partial t}$ï¼‰å’Œæ‹‰æ ¼æœ—æ—¥è§†è§’ä¸‹çš„ç²’å­è¿åŠ¨ï¼ˆ$\vec{v}$ï¼‰ç»“åˆåœ¨äº†ä¸€èµ·ã€‚

## 4.2 æ¬§æ‹‰æ–¹ç¨‹ï¼šæµä½“å…ƒçš„ç‰›é¡¿ç¬¬äºŒå®šå¾‹

ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†ç‰›é¡¿ç¬¬äºŒå®šå¾‹ $\vec{F} = m \vec{a}$ åº”ç”¨äºä¸€ä¸ªä½“ç§¯ä¸º $dV$ çš„æµä½“å…ƒï¼š

* **è´¨é‡** $m$ï¼š$m = \rho dV$ã€‚
* **åŠ é€Ÿåº¦** $\vec{a}$ï¼šæµä½“å…ƒçš„åŠ é€Ÿåº¦æ˜¯å…¶é€Ÿåº¦**è·Ÿéšæµä½“è¿åŠ¨**æ—¶çš„å˜åŒ–ç‡ï¼Œå› æ­¤å¿…é¡»ä½¿ç”¨ç‰©è´¨å¯¼æ•°ï¼š$\vec{a} = \frac{D\vec{v}}{Dt}$ã€‚
* **åŠ› $\vec{F}$ï¼š**å¯¹äºä¸€ä¸ªæ— æ‘©æ“¦çš„ç†æƒ³æµä½“ï¼Œä½œç”¨åœ¨æµä½“å…ƒä¸Šçš„å”¯ä¸€çš„åŠ›æ¥è‡ªäºå‘¨å›´æµä½“å¯¹å®ƒçš„**å‹å¼º (pressure)**ã€‚ä¸€ä¸ªæµä½“å…ƒå—åˆ°çš„å‡€å‹åŠ›æ¥è‡ªäºå…¶è¡¨é¢ä¸¤ä¾§çš„å‹å¼ºå·®ï¼Œè¿™ä¸ªå‡€åŠ›ç­‰äºå‹å¼ºçš„**è´Ÿæ¢¯åº¦**ä¹˜ä»¥ä½“ç§¯ï¼š$\vec{F} = -(\nabla P) dV$ ã€‚

å°†ä»¥ä¸Šä¸‰é¡¹ä»£å…¥ç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼š

$$(\rho dV) \frac{D\vec{v}}{Dt} = -(\nabla P) dV$$


æ¶ˆå» $dV$ å¹¶å±•å¼€ç‰©è´¨å¯¼æ•°ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†**æ¬§æ‹‰æ–¹ç¨‹ (Euler Equation)** çš„æœ€ç»ˆå½¢å¼ï¼š

$$\rho \left( \frac{\partial \vec{v}}{\partial t} + (\vec{v} \cdot \nabla) \vec{v} \right) = -\nabla P$$


è¿™ä¸ªæ–¹ç¨‹æè¿°äº†æ— ç²˜æ€§æµä½“çš„é€Ÿåº¦åœºå¦‚ä½•å› å‹å¼ºæ¢¯åº¦è€Œéšæ—¶é—´å’Œç©ºé—´æ¼”åŒ–ã€‚å…¶ä¸­ï¼Œ**éçº¿æ€§å¯¹æµé¡¹ (nonlinear convective term)** $(\vec{v} \cdot \nabla) \vec{v}$ æ˜¯æµä½“åŠ›å­¦ä¸°å¯Œæ€§å’Œå¤æ‚æ€§çš„æ ¸å¿ƒæ¥æºã€‚æ­£æ˜¯è¿™ä¸ªé€Ÿåº¦åœºä¸è‡ªèº«æ¢¯åº¦ç›¸ä¹˜çš„é¡¹ï¼Œä¸»å¯¼äº†åŠ¨é‡åœ¨æµä½“ä¸­çš„è‡ªèº«è¾“è¿ï¼Œå¹¶æœ€ç»ˆå¯¼è‡´äº†è¯¸å¦‚æ¹æµã€æ¶¡æ—‹ç­‰å¤æ‚çš„æµä½“ç°è±¡ã€‚

## 4.3 åŠ¨é‡é€šé‡å¼ é‡ï¼šå®ˆæ’å®šå¾‹çš„ç»Ÿä¸€è§†è§’

ä¸ºäº†ä¸è´¨é‡å®ˆæ’çš„å½¢å¼ä¿æŒä¸€è‡´ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿ç»­æ€§æ–¹ç¨‹ï¼Œå°†æ¬§æ‹‰æ–¹ç¨‹ä¸¥æ ¼åœ°æ”¹å†™æˆåŠ¨é‡å®ˆæ’çš„â€œå¯†åº¦-æµâ€å½¢å¼ï¼š
$$\frac{\partial (\rho v_i)}{\partial t} = -\sum_k \frac{\partial \Pi_{ik}}{\partial x_k}$$


è¿™é‡Œçš„â€œå¯†åº¦â€æ˜¯åŠ¨é‡çš„ç¬¬ $i$ ä¸ªåˆ†é‡ $\rho v_i$ï¼Œè€Œâ€œæµâ€åˆ™æ˜¯ä¸€ä¸ªæ›´å¤æ‚çš„å¯¹è±¡â€”â€”**åŠ¨é‡é€šé‡å¼ é‡ (momentum flux tensor)** $\Pi_{ik}$ ã€‚å¯¹äºæ— æ‘©æ“¦æµä½“ï¼Œå…¶å®šä¹‰ä¸ºï¼š

$$\Pi_{ik} = P \delta_{ik} + \rho v_i v_k$$

è¿™ä¸ªäºŒé˜¶å¼ é‡ $\Pi_{ik}$ çš„ç‰©ç†æ„ä¹‰æ˜¯ï¼š**åŠ¨é‡çš„ç¬¬ $i$ ä¸ªåˆ†é‡ï¼Œé€šè¿‡ä¸€ä¸ªæ³•å‘æŒ‡å‘ç¬¬ $k$ ä¸ªæ–¹å‘çš„å•ä½é¢ç§¯ï¼Œåœ¨å•ä½æ—¶é—´å†…çš„è¾“è¿é‡** ã€‚å®ƒç”±ä¸¤éƒ¨åˆ†æˆªç„¶ä¸åŒçš„ç‰©ç†è¿‡ç¨‹è´¡çŒ®ï¼š

1. **é™æ°´å‹å¼ºé¡¹ (Hydrostatic pressure term)** $P \delta_{ik}$ï¼šè¿™ä»£è¡¨äº†ç”±äºåˆ†å­æ— è§„åˆ™çƒ­è¿åŠ¨è€Œäº§ç”Ÿçš„åŠ¨é‡äº¤æ¢ï¼Œè¡¨ç°ä¸ºå®è§‚çš„å„å‘åŒæ€§å‹å¼ºã€‚**å…‹ç½—å†…å…‹ç¬¦å· (Kronecker delta)** $\delta_{ik}$ ç¡®ä¿äº†å®ƒåªè´¡çŒ®æ³•å‘åº”åŠ›ã€‚

2. **å¯¹æµè¾“è¿é¡¹ (Convective transport term)** $\rho v_i v_k$ï¼šè¿™ä»£è¡¨äº†ç”±äºæµä½“å®è§‚çš„æ•´ä½“è¿åŠ¨è€Œæºå¸¦çš„åŠ¨é‡è¾“è¿ã€‚å®ƒæ˜¯åŠ¨é‡çš„ç¬¬ $i$ åˆ†é‡è¢«é€Ÿåº¦çš„ç¬¬ $k$ åˆ†é‡â€œæºå¸¦â€é€šè¿‡å¹³é¢çš„ç»“æœã€‚è¿™æ˜¯ä¸€ä¸ªå„å‘å¼‚æ€§çš„è´¡çŒ®ï¼Œå…¶å¤§å°å’Œæ–¹å‘ä¾èµ–äºæµåŠ¨çš„æ–¹å‘ã€‚è¿™ä¸ªé¡¹ä¹Ÿè¢«ç§°ä¸º**äºŒåˆç§¯ (dyadic product)** ã€‚

é€šè¿‡å¼•å…¥åŠ¨é‡é€šé‡å¼ é‡ï¼Œæˆ‘ä»¬æˆåŠŸåœ°å°†å¤æ‚çš„æ¬§æ‹‰æ–¹ç¨‹ï¼Œä¹Ÿç»Ÿä¸€åˆ°äº†  $\frac{\partial (\text{å¯†åº¦})}{\partial t} + \nabla \cdot (\text{æµ}) = 0$ è¿™ä¸€æ™®é€‚çš„å®ˆæ’å¾‹æ¡†æ¶ä¹‹ä¸‹ã€‚

## 4.4 å¯è§†åŒ–æ¨¡æ‹Ÿï¼šPython å®ç°æ ‡é‡åœºçš„å¯¹æµ

æˆ‘ä»¬æ¨å¯¼äº†æ¬§æ‹‰æ–¹ç¨‹ï¼Œå¹¶é‡åˆ°äº†æ ¸å¿ƒçš„**éçº¿æ€§å¯¹æµé¡¹ (nonlinear convective term)** $(\vec{v} \cdot \nabla) \vec{v}$ã€‚ä¸ºäº†ç›´è§‚åœ°ç†è§£è¿™ä¸ªæŠ½è±¡çš„æ•°å­¦è¡¨è¾¾å¼â€”â€”ä¸€ä¸ªçŸ¢é‡åœºå¦‚ä½•â€œè¾“è¿â€å®ƒè‡ªèº«â€”â€”æˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡ä¸€ä¸ªæ›´ç®€å•çš„ä¾‹å­æ¥å»ºç«‹ç‰©ç†å›¾åƒï¼š**ä¸€ä¸ªç»™å®šçš„é€Ÿåº¦åœº $\vec{v}$ æ˜¯å¦‚ä½•è¾“è¿ä¸€ä¸ªæ ‡é‡åœº $c$ï¼ˆä¾‹å¦‚ä¸€æ»´æŸ“æ–™çš„æµ“åº¦ï¼‰çš„ã€‚**

è¿™ä¸ªè¿‡ç¨‹ç”±çº¯å¯¹æµæ–¹ç¨‹æè¿°ï¼š
$$\frac{\partial c}{\partial t} = -(\vec{v} \cdot \nabla) c$$

ä¸‹é¢çš„ Python æ¨¡æ‹Ÿå°†ç²¾ç¡®åœ°å±•ç¤ºè¿™ä¸€è¿‡ç¨‹ã€‚æˆ‘ä»¬å°†åˆå§‹åŒ–ä¸€å›¢é«˜æ–¯åˆ†å¸ƒçš„â€œæŸ“æ–™â€ï¼Œå¹¶å°†å®ƒç½®äºä¸€ä¸ªå›ºå®šçš„æ—‹è½¬æ¶¡æ—‹é€Ÿåº¦åœºä¸­ï¼Œè§‚å¯Ÿå®ƒæ˜¯å¦‚ä½•è¢«â€œå·åŠ¨â€å’Œè¾“è¿çš„ã€‚


```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.animation import FuncAnimation

# --- 1. Set simulation parameters ---
grid_size = 100  # Grid size
L = 10.0         # Spatial size (-L/2 to L/2)
dt = 0.01        # Time step
n_steps = 300    # Total steps
omega = 1.0      # Vortex angular velocity

# --- 2. Create grid and field ---
x = np.linspace(-L/2, L/2, grid_size)
y = np.linspace(-L/2, L/2, grid_size)
X, Y = np.meshgrid(x, y)

# Initial scalar field: a Gaussian "dye drop"
c = np.exp(-((X - L/4)**2 + Y**2) / (0.5**2))

# Velocity field: a vortex rotating around the origin
vx = -omega * Y
vy = omega * X

# --- 3. Set up plot ---
fig, ax = plt.subplots(figsize=(7, 6))

# Plot scalar field c
im = ax.imshow(c, extent=[-L/2, L/2, -L/2, L/2], origin='lower',
               cmap='viridis', vmin=0, vmax=1)
fig.colorbar(im, label='Concentration')

# Plot velocity field v (plot every 10 points to keep it clear)
skip = 10
ax.quiver(X[::skip, ::skip], Y[::skip, ::skip],
          vx[::skip, ::skip], vy[::skip, ::skip],
          color='white', scale=30)

ax.set_title("Advection of a Scalar Field (t=0.00)")
ax.set_xlabel("x")
ax.set_ylabel("y")
ax.set_aspect('equal')

# --- 4. Define animation update function ---
def animate(frame):
    global c
    # Calculate gradient of scalar field
    # np.gradient returns dy, dx order [10, 11]
    grad_c_y, grad_c_x = np.gradient(c, y, x)

    # Calculate advection term v dot grad(c)
    advection_term = vx * grad_c_x + vy * grad_c_y

    # Update scalar field using forward Euler method
    c = c - advection_term * dt

    # Update image data
    im.set_array(c)
    ax.set_title(f"Advection of a Scalar Field (t={frame*dt:.2f})")
    return [im]

# --- 5. Create and run animation ---
ani = FuncAnimation(fig, animate, frames=n_steps,
                    interval=30, blit=True)

# --- 6. Save animation as GIF file ---
# Note: This requires ImageMagick or ffmpeg
# If not installed, you can install with:
# Windows: conda install -c conda-forge imagemagick
# macOS: brew install imagemagick
# Linux: sudo apt-get install imagemagick
ani.save('advection.gif', writer='pillow', dpi=80, fps=20)

plt.show()
```

![è¿è¡Œä»£ç è¾“å‡º](https://files.mdnice.com/user/129153/496eb735-c454-45cd-a1ff-2147d2a72c96.png)



  * **è¾“è¿ (Transport)** ï¼šæ•´å—â€œæŸ“æ–™â€è¢«æ—‹è½¬çš„é€Ÿåº¦åœºå¸¦ç€åšåœ†å‘¨è¿åŠ¨ï¼Œå…¶æ•´ä½“ä½ç½®å‘ç”Ÿäº†æ”¹å˜ã€‚
  * **å˜å½¢ (Deformation)** ï¼šæ›´é‡è¦çš„æ˜¯ï¼Œç”±äºé€Ÿåº¦åœºä¸æ˜¯å‡åŒ€çš„ï¼ˆè¶Šé è¿‘ä¸­å¿ƒçš„ç‚¹é€Ÿåº¦è¶Šå°ï¼Œè¶Šå¤–ä¾§çš„ç‚¹é€Ÿåº¦è¶Šå¤§ï¼‰ï¼Œâ€œæŸ“æ–™æ»´â€å¹¶ä¸ä»…ä»…æ˜¯å¹³ç§»ï¼Œå®ƒåœ¨è¿åŠ¨è¿‡ç¨‹ä¸­è¢«ä¸æ–­åœ°**æ‹‰ä¼¸å’Œæ‰­æ›²**ã€‚
  
è¯ é‡Šäº† $(\vec{v} \cdot \nabla)f$ çš„å«ä¹‰ï¼šå®ƒæè¿°çš„æ­£æ˜¯ç‰©ç†é‡ $f$ å¦‚ä½•è¢«æµåœº $\vec{v}$ â€œæºå¸¦â€ç€åœ¨ç©ºé—´ä¸­ç§»åŠ¨å’Œé‡æ–°åˆ†å¸ƒã€‚åœ¨æ¬§æ‹‰æ–¹ç¨‹ä¸­ï¼Œè¢«æºå¸¦çš„ç‰©ç†é‡æ­£æ˜¯é€Ÿåº¦åœº $\vec{v}$ è‡ªèº«ï¼Œè¿™ä¾¿æ˜¯åŠ¨é‡è¢«æµä½“è‡ªèº«è¾“è¿çš„ç‰©ç†å›¾åƒã€‚

# 5. ç¬¬ä¸‰æ”¯æŸ±ï¼šèƒ½é‡å®ˆæ’ä¸ç­‰ç†µæµ

åœ¨ç¡®ç«‹äº†è´¨é‡å’ŒåŠ¨é‡å®ˆæ’ä¹‹åï¼Œæˆ‘ä»¬æ¥æ¨å¯¼æœ€åä¸€ä¸ªã€ä¹Ÿæ˜¯æœ€æ·±åˆ»çš„å®ˆæ’å®šå¾‹â€”â€”**èƒ½é‡å®ˆæ’ (Energy Conservation)** ã€‚æ­£å¦‚æ•™æˆæ‰€è¨€ï¼Œè¿™ä¸ªæ¨å¯¼ä¸é‚£ä¹ˆç›´è§‚ï¼Œå› ä¸ºå®ƒè¦æ±‚æˆ‘ä»¬å°†ä¹‹å‰æ¨å¯¼çš„åŠ¨åŠ›å­¦æ–¹ç¨‹ä¸**çƒ­åŠ›å­¦**ç´§å¯†ç»“åˆèµ·æ¥ã€‚è¿™ä¸ªè¿‡ç¨‹æœ€ç»ˆå°†æ­ç¤ºæ— æ‘©æ“¦æµä½“ä¸€ä¸ªè‡³å…³é‡è¦çš„çƒ­åŠ›å­¦ç‰¹æ€§ã€‚

## 5.1 æµä½“çš„æ€»èƒ½é‡å¯†åº¦

ä¸€ä¸ªæµä½“å…ƒçš„æ€»èƒ½é‡ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šç”±å®è§‚æ•´ä½“è¿åŠ¨è´¡çŒ®çš„**åŠ¨èƒ½ (kinetic energy)** ï¼Œå’Œç”±å¾®è§‚åˆ†å­æ— è§„åˆ™è¿åŠ¨è´¡çŒ®çš„**å†…èƒ½ (internal energy)** ã€‚å› æ­¤ï¼Œå•ä½ä½“ç§¯çš„æ€»èƒ½é‡å¯†åº¦ä¸ºï¼š

$$e_{\text{total}} = \frac{1}{2} \rho v^2 + \rho \epsilon$$

å…¶ä¸­ $\epsilon$ æ˜¯**å•ä½è´¨é‡çš„å†…èƒ½** ã€‚æˆ‘ä»¬çš„ç›®æ ‡ï¼Œä¾ç„¶æ˜¯ä¸ºè¿™ä¸ªå®ˆæ’çš„èƒ½é‡å¯†åº¦æ‰¾åˆ°å…¶å¯¹åº”çš„**èƒ½é‡æµ (energy current)** $\vec{J}^{(\epsilon)}$ï¼Œä½¿å…¶æ»¡è¶³å®ˆæ’å¾‹çš„ä¸€èˆ¬å½¢å¼ï¼š$\frac{\partial e_{\text{total}}}{\partial t} = -\nabla \cdot \vec{J}^{(\epsilon)}$ã€‚

## 5.2 èƒ½é‡å®ˆæ’å®šå¾‹çš„æ¨å¯¼

è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºå¤æ‚çš„æ¨å¯¼ï¼Œæˆ‘ä»¬å°†è·Ÿéšè¯¾å ‚çš„æ€è·¯ï¼Œå°†æ€»èƒ½é‡åˆ†ä¸ºåŠ¨èƒ½å’Œå†…èƒ½ä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«è®¡ç®—å®ƒä»¬çš„æ—¶é—´å¯¼æ•°ã€‚

### 1. åŠ¨èƒ½é¡¹çš„æ—¶é—´å¯¼æ•°ï¼š

æˆ‘ä»¬é¦–å…ˆè®¡ç®—åŠ¨èƒ½å¯†åº¦ $\frac{1}{2} \rho v^2$ çš„æ—¶é—´å¯¼æ•°ã€‚åˆ©ç”¨ä¹˜æ³•æ³•åˆ™ï¼Œå¹¶ä»£å…¥æˆ‘ä»¬å·²ç»æ¨å¯¼å‡ºçš„**è¿ç»­æ€§æ–¹ç¨‹**ï¼ˆç”¨äº $\partial_t \rho$ï¼‰å’Œ**æ¬§æ‹‰æ–¹ç¨‹**ï¼ˆç”¨äº $\partial_t \vec{v}$ï¼‰ï¼Œç»è¿‡ä¸€ç³»åˆ—ä»£æ•°è¿ç®—ï¼Œå¯ä»¥å¾—åˆ°ï¼š

$$\frac{\partial}{\partial t} \left( \frac{1}{2} \rho v^2 \right) = -\nabla \cdot \left( \rho \vec{v} \frac{1}{2} v^2 \right) - \vec{v} \cdot \nabla P$$

è¿™ä¸ªè¡¨è¾¾å¼çš„ç‰©ç†å«ä¹‰æ˜¯ï¼šåŠ¨èƒ½å¯†åº¦çš„å±€åŸŸå˜åŒ–ï¼Œä¸€éƒ¨åˆ†æ¥è‡ªäºåŠ¨èƒ½çš„å¯¹æµï¼ˆç¬¬ä¸€é¡¹ï¼Œä¸€ä¸ªå®Œç¾çš„é€šé‡æ•£åº¦å½¢å¼ï¼‰ï¼Œå¦ä¸€éƒ¨åˆ†åˆ™æ¥è‡ªäºå‹å¼ºæ¢¯åº¦å¯¹æµä½“åšåŠŸï¼ˆç¬¬äºŒé¡¹ï¼‰ã€‚

### 2. å¼•å…¥çƒ­åŠ›å­¦å…³ç³»ï¼š

ä¸ºäº†å¤„ç†å†…èƒ½é¡¹å’Œå‹å¼ºé¡¹ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥çƒ­åŠ›å­¦çš„åŸºæœ¬å…³ç³»ã€‚æ ¹æ®**å±€åŸŸå¹³è¡¡å‡è®¾**ï¼Œæ¯ä¸ªæµä½“å…ƒéƒ½æ»¡è¶³å‰å¸ƒæ–¯å…³ç³»ã€‚å¯¹äºå•ä½è´¨é‡çš„å†…èƒ½ $\epsilon$ï¼Œå…¶å˜åŒ–é‡ä¸ºï¼š

$$d\epsilon = T ds - P dv_s = Tds + \frac{P}{\rho^2}d\rho$$

å…¶ä¸­ $s$ æ˜¯å•ä½è´¨é‡çš„ç†µï¼Œ$v_s = 1/\rho$ æ˜¯**æ¯”å®¹ (specific volume)** ã€‚

åœ¨æµä½“åŠ¨åŠ›å­¦ä¸­ï¼Œå¤„ç†å‹å¼ºæ—¶ï¼Œå¼•å…¥**ç„“ (Enthalpy)** é€šå¸¸æ›´ä¸ºæ–¹ä¾¿ã€‚å•ä½è´¨é‡çš„ç„“ï¼ˆæ¯”ç„“ï¼‰$h$ å®šä¹‰ä¸ºï¼š

$$h = \epsilon + \frac{P}{\rho}$$

å®ƒçš„å…¨å¾®åˆ†ä¸º $dh = Tds + \frac{1}{\rho}dP$ã€‚

### 3. ç»„åˆä¸åŒ–ç®€ï¼š

åˆ©ç”¨ä¸Šè¿°çƒ­åŠ›å­¦å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥å¤„ç†å†…èƒ½é¡¹çš„æ—¶é—´å¯¼æ•° $\partial_t(\rho\epsilon)$ ï¼Œå¹¶å°†åŠ¨èƒ½æ–¹ç¨‹ä¸­çš„å‹å¼ºæ¢¯åº¦é¡¹ $\nabla P$ æ›¿æ¢ä¸ºä¸ç„“å’Œç†µç›¸å…³çš„é¡¹ã€‚è¿™æ˜¯ä¸€ä¸ªç¹çä½†é€»è¾‘ç›´æ¥çš„ä»£æ•°è¿‡ç¨‹ã€‚å°†åŠ¨èƒ½å’Œå†…èƒ½ä¸¤éƒ¨åˆ†çš„æ¼”åŒ–æ–¹ç¨‹ç›¸åŠ ï¼Œæœ€ç»ˆå¯ä»¥å¾—åˆ°æ€»èƒ½é‡å¯†åº¦çš„å®ˆæ’æ–¹ç¨‹ï¼š

$$\frac{\partial}{\partial t} \left( \frac{1}{2} \rho v^2 + \rho \epsilon \right) = -\nabla \cdot \left[ \rho \vec{v} \left( \frac{1}{2} v^2 + h \right) \right] + \rho T \left( \frac{\partial s}{\partial t} + (\vec{v} \cdot \nabla) s \right)$$

## 5.3 ç­‰ç†µæ¡ä»¶ï¼šæ— æ‘©æ“¦çš„å¿…ç„¶ç»“æœ

è§‚å¯Ÿä¸Šå¼çš„æœ€ç»ˆå½¢å¼ï¼Œå®ƒå‡ ä¹æ˜¯ä¸€ä¸ªå®Œç¾çš„å®ˆæ’æ–¹ç¨‹ï¼Œé™¤äº†æœ€åä¸€é¡¹ã€‚å·¦è¾¹æ˜¯èƒ½é‡å¯†åº¦çš„æ—¶é—´å¯¼æ•°ï¼Œå³è¾¹ç¬¬ä¸€é¡¹æ˜¯ä¸€ä¸ªé€šé‡çš„æ•£åº¦ã€‚ä¸ºäº†è®©èƒ½é‡çœŸæ­£å®ˆæ’ï¼Œæ–¹ç¨‹å³ä¾§çš„**æº/æ±‡é¡¹**å¿…é¡»ä¸ºé›¶ã€‚è¿™æ„å‘³ç€ï¼š

$$\rho T \left( \frac{\partial s}{\partial t} + (\vec{v} \cdot \vec{\nabla}) s \right) = \rho T \frac{Ds}{Dt} = 0$$

ç”±äº $\rho$ å’Œ $T$ é€šå¸¸ä¸ä¸ºé›¶ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªæ·±åˆ»çš„ç‰©ç†ç»“è®ºï¼š

$$\frac{Ds}{Dt} = 0$$

è¿™ä¸ªæ–¹ç¨‹çš„å«ä¹‰æ˜¯ï¼šå¯¹äºä¸€ä¸ªæ— æ‘©æ“¦ã€æ— çƒ­ä¼ å¯¼çš„ç†æƒ³æµä½“ï¼Œ**æ¯ä¸€ä¸ªæµä½“å…ƒåœ¨è·Ÿéšæµä½“è¿åŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œå…¶ç†µä¿æŒä¸å˜**ã€‚è¿™ç§æµåŠ¨è¢«ç§°ä¸º**ç­‰ç†µæµ (Isentropic Flow)** ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬æœ€åˆâ€œæ— æ‘©æ“¦ã€æ— è€—æ•£â€å‡è®¾åœ¨çƒ­åŠ›å­¦ä¸Šçš„å¿…ç„¶ç»“æœï¼šå› ä¸ºæ²¡æœ‰ä»»ä½•å†…éƒ¨æ‘©æ“¦äº§ç”Ÿä¸å¯é€†çš„çƒ­é‡ï¼Œæµä½“å…ƒçš„æ¼”åŒ–æ˜¯å¯é€†çš„ï¼Œå› æ­¤å…¶ç†µä¸å¢åŠ ã€‚

## 5.4 èƒ½é‡æµçš„ç‰©ç†æ„ä¹‰

åœ¨ç­‰ç†µæ¡ä»¶ä¸‹ï¼Œæºé¡¹ä¸ºé›¶ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥æ¸…æ™°åœ°è¯†åˆ«å‡º**èƒ½é‡æµ (energy current)** çš„è¡¨è¾¾å¼ï¼š

$$\vec{J}^{(\epsilon)} = \rho \vec{v} \left( \frac{1}{2} v^2 + h \right)$$

è¿™ä¸ªè¡¨è¾¾å¼çš„ç‰©ç†å«ä¹‰éå¸¸ä¸°å¯Œã€‚å®ƒè¡¨æ˜èƒ½é‡æ˜¯é€šè¿‡å¯¹æµæ–¹å¼è¾“è¿çš„ï¼Œè¾“è¿çš„è½½ä½“æ˜¯è´¨é‡æµ $\rho\vec{v}$ï¼Œè€Œè¢«è¾“è¿çš„é‡æ˜¯å•ä½è´¨é‡çš„æ€»èƒ½é‡ $\left( \frac{1}{2} v^2 + h \right)$ã€‚

è¿™é‡Œæœ€å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¢«è¾“è¿çš„ä¸æ˜¯å†…èƒ½ $\epsilon$ï¼Œè€Œæ˜¯**æ¯”ç„“ $h$** ã€‚è¿™å¹¶éå¶ç„¶çš„æ•°å­¦å·§åˆï¼Œè€Œæ˜¯æœ‰ç€æ·±åˆ»çš„ç‰©ç†åŸå› ã€‚ç„“çš„å®šä¹‰æ˜¯ $h = \epsilon + P/\rho$ã€‚å…¶ä¸­ï¼Œ$P/\rho$ è¿™ä¸€é¡¹ï¼ˆæˆ–å¯¹ä¸€ä¸ªå®è§‚ç³»ç»Ÿè€Œè¨€çš„ $PV$ï¼‰ä»£è¡¨äº†**æµåŠ¨åŠŸ (flow work)** ã€‚å®ƒæ˜¯åœ¨ä¸€ä¸ªæœ‰å‹å¼ºçš„ç¯å¢ƒä¸­ï¼Œå°†ä¸€ä¸ªæµä½“å…ƒæ¨å…¥ç›¸é‚»åŒºåŸŸæ‰€å¿…é¡»åšçš„åŠŸã€‚å› æ­¤ï¼Œå½“æµä½“æµåŠ¨æ—¶ï¼Œå®ƒä¸ä»…æºå¸¦äº†è‡ªèº«çš„åŠ¨èƒ½å’Œå†…èƒ½ï¼Œè¿˜å¿…é¡»â€œæ¨å¼€â€å‰é¢çš„æµä½“å¹¶è¢«åé¢çš„æµä½“â€œæ¨åŠ¨â€ï¼Œè¿™éƒ¨åˆ†èƒ½é‡äº¤æ¢æ­£å¥½ç”± $P/\rho$ æ¥è¡¡é‡ã€‚ç„“ä½œä¸ºä¸€ä¸ªçƒ­åŠ›å­¦åŠ¿ï¼Œæ°å¥½å°†å†…èƒ½å’ŒæµåŠ¨åŠŸè¿™ä¸¤éƒ¨åˆ†èƒ½é‡æ‰“åŒ…åœ¨äº†ä¸€èµ·ã€‚æ‰€ä»¥ï¼Œèƒ½é‡æµä¸­å‡ºç°çš„æ˜¯ç„“ï¼Œè€Œä¸æ˜¯å†…èƒ½ã€‚

## 5.5 ä»£ç å®è·µï¼šç”¨æ¬§æ‹‰ç½‘æ ¼æ³•æ¨¡æ‹Ÿæµä½“

æˆ‘ä»¬å°†é‡‡ç”¨ä¸€ç§æ›´ç›´æ¥çš„**å®è§‚æ–¹æ³•**â€”â€”åŸºäº**æ¬§æ‹‰ç½‘æ ¼ (Eulerian Grid)** çš„æ±‚è§£å™¨ï¼Œç›´æ¥å¯¹æµä½“åŠ¨åŠ›å­¦æ–¹ç¨‹è¿›è¡Œæ•°å€¼æ±‚è§£ã€‚æˆ‘ä»¬å°†è¦å®ç°çš„ç®—æ³•ï¼Œæ˜¯è®¡ç®—æœºå›¾å½¢å­¦é¢†åŸŸéå¸¸ç»å…¸çš„â€œç¨³å®šæµä½“â€ (Stable Fluids) æ–¹æ³•ã€‚

è¯¥ç®—æ³•çš„æ ¸å¿ƒï¼Œæ˜¯å°†æµä½“çš„æ¼”åŒ–åˆ†è§£ä¸ºå‡ ä¸ªåœ¨ç‰©ç†ä¸Šæ¸…æ™°çš„æ­¥éª¤ï¼Œå¹¶åœ¨æ¯ä¸ªæ—¶é—´æ­¥å†…ä¾æ¬¡æ‰§è¡Œï¼š

1.  **å¹³æµ (Advection)** ï¼šæ­¤æ­¥éª¤è´Ÿè´£ç§»åŠ¨æµä½“è‡ªèº«çš„ç‰©ç†å±æ€§ï¼Œå¦‚é€Ÿåº¦å’Œé¢œè‰²ï¼ˆæŸ“æ–™ï¼‰ã€‚å®ƒå›ç­”äº†è¿™ä¸ªé—®é¢˜ï¼šâ€œä¸‹ä¸€åˆ»ï¼Œå½“å‰ä½ç½®çš„æµä½“å°†ç§»åŠ¨åˆ°å“ªé‡Œï¼Ÿâ€ã€‚æˆ‘ä»¬é‡‡ç”¨ä¸€ç§é«˜æ•ˆçš„**åŠæ‹‰æ ¼æœ—æ—¥æ³• (Semi-Lagrangian method)** ï¼Œé€šè¿‡æ—¶é—´å›æº¯æ¥è®¡ç®—å½“å‰ç½‘æ ¼ç‚¹ä¸Šçš„ç‰©ç†é‡åº”è¯¥ä»ä¸Šä¸€æ—¶åˆ»çš„å“ªä¸ªä½ç½®â€œç»§æ‰¿â€è€Œæ¥ã€‚

2.  **æ–½åŠ å¤–åŠ› (External Forces)** ï¼šåœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥å‘æµä½“ä¸­åŠ å…¥å„ç§åŠ›æˆ–æºã€‚åœ¨æˆ‘ä»¬çš„æ¨¡æ‹Ÿä¸­ï¼Œè¿™ä¸»è¦ä½“ç°ä¸ºä»ä¸€ä¸ªæŒ‡å®šåŒºåŸŸæŒç»­â€œæ³¨å…¥â€æ–°çš„æŸ“æ–™å’Œé€Ÿåº¦ã€‚

3.  **æŠ•å½± (Projection)** ï¼šè¿™æ˜¯ç¡®ä¿æµä½“è¿åŠ¨çœŸå®è‡ªç„¶**æœ€å…³é”®çš„ä¸€æ­¥**ã€‚å®ƒçš„å”¯ä¸€ç›®æ ‡æ˜¯ä¿è¯æµåœºæ»¡è¶³**ä¸å¯å‹ç¼©æ€§ (incompressibility)** ï¼Œå³æµä½“çš„æ•£åº¦ä¸ºé›¶ ($\nabla \cdot \vec{v} = 0$)ã€‚è¿™ä¸€æ­¥æœ¬èº«åˆåˆ†ä¸ºä¸‰ä¸ªå­ä»»åŠ¡ï¼š
    a.  è®¡ç®—å½“å‰é€Ÿåº¦åœºçš„**æ•£åº¦ (divergence)** ï¼Œæ‰¾åˆ°é‚£äº›ä¸æ»¡è¶³ä¸å¯å‹ç¼©æ¡ä»¶çš„åŒºåŸŸã€‚
    b.  æ±‚è§£ä¸€ä¸ª**å‹åŠ›æ³Šæ¾æ–¹ç¨‹ (Pressure Poisson Equation)** ï¼Œå³ $\nabla^2 p = \nabla \cdot \vec{v}$ã€‚è§£å‡ºçš„å‹åŠ›åœº $p$ å‘Šè¯‰æˆ‘ä»¬ï¼Œéœ€è¦åœ¨ä½•å¤„æ–½åŠ å‹åŠ›æ¥â€œä¿®æ­£â€æµä½“çš„æµå‘ã€‚
    c.  ç”¨è®¡ç®—å‡ºçš„å‹åŠ›æ¢¯åº¦ $\nabla p$ æ¥ä¿®æ­£é€Ÿåº¦åœºï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªæ•£åº¦ä¸ºé›¶ã€æ»¡è¶³ä¸å¯å‹ç¼©æ¡ä»¶çš„æ–°é€Ÿåº¦åœºã€‚

æˆ‘ä»¬å°†ä½¿ç”¨å¼ºå¤§çš„**å…±è½­æ¢¯åº¦æ³• (Conjugate Gradient method)** æ¥é«˜æ•ˆæ±‚è§£å‹åŠ›æ³Šæ¾æ–¹ç¨‹ï¼Œå¹¶åˆ©ç”¨ `Taichi` æ¡†æ¶çš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›ä¸ºæ•´ä¸ªæ¨¡æ‹Ÿè¿‡ç¨‹åŠ é€Ÿã€‚


```python
# Eulerian Fluid Simulation with Conjugate Gradient Solver
# Based on: https://github.com/JerryYan97/Taichi_HW1_EulerianFluid

import taichi as ti

ti.init(arch=ti.gpu)

# General settings
resolutionX = 512
pixels = ti.Vector.field(3, dtype=ti.f32, shape=(resolutionX, resolutionX))  # Use RGB color
dt = 0.02
pause = False
temp_dye = 1.0
pixel_mid = resolutionX // 2
ix_length = 5
iy_length = 10
area = ti.Vector([8, pixel_mid - iy_length, 8 + ix_length, pixel_mid + iy_length])
inflow_velocity = ti.Vector([3.0, 0.0])

# Grid settings
_velocities = ti.Vector.field(2, dtype=ti.f32, shape=(resolutionX, resolutionX))
_new_velocities = ti.Vector.field(2, dtype=ti.f32, shape=(resolutionX, resolutionX))
velocity_divs = ti.field(dtype=ti.f32, shape=(resolutionX, resolutionX))
_pressures = ti.field(dtype=ti.f32, shape=(resolutionX, resolutionX))
_new_pressures = ti.field(dtype=ti.f32, shape=(resolutionX, resolutionX))
_dye_buffer = ti.Vector.field(3, dtype=ti.f32, shape=(resolutionX, resolutionX))  # RGB dye
_new_dye_buffer = ti.Vector.field(3, dtype=ti.f32, shape=(resolutionX, resolutionX))

# CG settings
b = ti.field(dtype=ti.f32, shape=resolutionX * resolutionX)
p = ti.field(dtype=ti.f32, shape=resolutionX * resolutionX)
Ax = ti.field(dtype=ti.f32, shape=resolutionX * resolutionX)
Ap = ti.field(dtype=ti.f32, shape=resolutionX * resolutionX)
r = ti.field(dtype=ti.f32, shape=resolutionX * resolutionX)
new_r = ti.field(dtype=ti.f32, shape=resolutionX * resolutionX)

# TexPair class for buffer swapping
class TexPair:
    def __init__(self, cur, nxt):
        self.cur = cur
        self.nxt = nxt

    def swap(self):
        self.cur, self.nxt = self.nxt, self.cur

# Interpolation functions
@ti.func
def sample(qf, u, v, res):
    i, j = int(u), int(v)
    # Nearest
    i = max(0, min(res - 1, i))
    j = max(0, min(res - 1, j))
    return qf[i, j]

@ti.func
def lerp(vl, vr, frac):
    # frac: [0.0, 1.0]
    return vl + frac * (vr - vl)

@ti.func
def bilerp(vf, u, v, res):
    s, t = u - 0.5, v - 0.5
    # floor
    iu, iv = int(s), int(t)
    # fract
    fu, fv = s - iu, t - iv
    a = sample(vf, iu + 0.5, iv + 0.5, res)
    b = sample(vf, iu + 1.5, iv + 0.5, res)
    c = sample(vf, iu + 0.5, iv + 1.5, res)
    d = sample(vf, iu + 1.5, iv + 1.5, res)
    return lerp(lerp(a, b, fu), lerp(c, d, fu), fv)

velocities_pair = TexPair(_velocities, _new_velocities)
pressures_pair = TexPair(_pressures, _new_pressures)
dyes_pair = TexPair(_dye_buffer, _new_dye_buffer)

@ti.func
def vel_with_boundary(vf: ti.template(), i: int, j: int) -> ti.f32:
    if (i == j == 0) or (i == j == resolutionX - 1) or (i == 0 and j == resolutionX - 1) or (
            i == resolutionX - 1 and j == 0):
        vf[i, j] = ti.Vector([0.0, 0.0])
    elif i == 0:
        vf[i, j] = -vf[1, j]
    elif j == 0:
        vf[i, 0] = -vf[i, 1]
    elif i == resolutionX - 1:
        vf[resolutionX - 1, j] = -vf[resolutionX - 2, j]
    elif j == resolutionX - 1:
        vf[i, resolutionX - 1] = -vf[i, resolutionX - 2]
    return vf[i, j]

@ti.func
def p_with_boundary(pf: ti.template(), i: int, j: int) -> ti.f32:
    if (i == j == 0) or (i == j == resolutionX - 1) or (i == 0 and j == resolutionX - 1) or (
            i == resolutionX - 1 and j == 0):
        pf[i, j] = 0.0
    elif i == 0:
        pf[0, j] = pf[1, j]
    elif j == 0:
        pf[i, 0] = pf[i, 1]
    elif i == resolutionX - 1:
        pf[resolutionX - 1, j] = pf[resolutionX - 2, j]
    elif j == resolutionX - 1:
        pf[i, resolutionX - 1] = pf[i, resolutionX - 2]
    return pf[i, j]

@ti.kernel
def apply_vel_bc(vf: ti.template()):
    for i, j in vf:
        vel_with_boundary(vf, i, j)

@ti.kernel
def apply_p_bc(pf: ti.template()):
    for i, j in pf:
        p_with_boundary(pf, i, j)

@ti.kernel
def advect(vf: ti.template(), qf: ti.template(), new_qf: ti.template()):
    for IX, IY in vf:
        # Backtrace using semi-lagrangian with 2nd order Runge-Kutta
        coord_curr = ti.Vector([IX, IY]) + ti.Vector([0.5, 0.5])
        vel_curr = vf[IX, IY]
        coord_mid = coord_curr - 0.5 * dt * vel_curr
        vel_mid = bilerp(vf, coord_mid[0], coord_mid[1], resolutionX)
        coord_prev = coord_curr - dt * vel_mid
        # Get previous quality
        q_prev = bilerp(qf, coord_prev[0], coord_prev[1], resolutionX)
        # Update current quality
        new_qf[IX, IY] = q_prev

@ti.kernel
def addInflow(qf: ti.template(), area: ti.template(), quality: ti.template()):
    bl_ix, bl_iy, tr_ix, tr_iy = area[0], area[1], area[2], area[3]
    for i, j in qf:
        if bl_ix <= i <= tr_ix and bl_iy <= j <= tr_iy:
            qf[i, j] = quality

@ti.kernel
def fill_color(ipixels: ti.template(), idyef: ti.template()):
    for i, j in ipixels:
        # Convert dye density to color display
        density = ti.min(1.0, ti.max(0.0, idyef[i, j].norm()))
        # Generate color based on density - blue to red gradient
        ipixels[i, j] = ti.Vector([
            ti.min(density * 2.0, 1.0),  # Red component
            ti.max(0.0, density * 2.0 - 1.0),  # Green component
            ti.max(0.0, 1.0 - density * 2.0)   # Blue component
        ])

@ti.func
def coeff_matrix(row: int, col: int) -> ti.f32:
    res = 0.0
    n = resolutionX * resolutionX
    IY = row // resolutionX
    IX = row - resolutionX * IY
    if row >= n or row < 0 or col >= n or col < 0:
        res = 0.0
    else:
        if (IX == IY == 0) or (IX == IY == resolutionX - 1) or (IX == 0 and IY == resolutionX - 1) or (
                IX == resolutionX - 1 and IY == 0):
            if row == col:
                res = 1.0
            else:
                res = 0.0
        if row == col:
            res = -4.0
        elif ti.abs(col - row) == 1:
            res = 1.0
        elif ti.abs(col - row) == resolutionX:
            res = 1.0
    return res

@ti.func
def visit_vector(v: ti.template(), vid: int, length: int) -> ti.f32:
    res = 0.0
    if vid < 0 or vid >= length:
        res = 0.0
    else:
        res = v[vid]
    return res

@ti.func
def visit_pf_vector(pf: ti.template(), vid: int) -> ti.f32:
    res = 0.0
    n = resolutionX * resolutionX
    if vid >= n or vid < 0:
        res = 0.0
    else:
        IY = vid // resolutionX
        IX = vid - resolutionX * IY
        res = pf[IX, IY]
    return res

@ti.kernel
def pressure_cg_init(pf: ti.template(), b: ti.template()):
    n = resolutionX * resolutionX
    for row in range(n):
        ve1 = visit_pf_vector(pf, row - resolutionX)
        ve2 = visit_pf_vector(pf, row - 1)
        ve3 = visit_pf_vector(pf, row)
        ve4 = visit_pf_vector(pf, row + 1)
        ve5 = visit_pf_vector(pf, row + resolutionX)
        me1 = coeff_matrix(row, row - resolutionX)
        me2 = coeff_matrix(row, row - 1)
        me3 = coeff_matrix(row, row)
        me4 = coeff_matrix(row, row + 1)
        me5 = coeff_matrix(row, row + resolutionX)

        temp_Ax = me1 * ve1 + me2 * ve2 + me3 * ve3 + me4 * ve4 + me5 * ve5

        Ax[row] = temp_Ax
        r[row] = b[row] - Ax[row]
        p[row] = r[row]

@ti.kernel
def pressure_cg_iter(pf: ti.template()) -> ti.f32:
    n = resolutionX * resolutionX
    rkT_rk = 0.0
    pkT_A_pk = 0.0

    for i in range(n):
        rkT_rk += (r[i] * r[i])
        ve1 = visit_vector(p, i - resolutionX, n)
        ve2 = visit_vector(p, i - 1, n)
        ve3 = visit_vector(p, i, n)
        ve4 = visit_vector(p, i + 1, n)
        ve5 = visit_vector(p, i + resolutionX, n)
        me1 = coeff_matrix(i, i - resolutionX)
        me2 = coeff_matrix(i, i - 1)
        me3 = coeff_matrix(i, i)
        me4 = coeff_matrix(i, i + 1)
        me5 = coeff_matrix(i, i + resolutionX)

        temp_Ap = me1 * ve1 + me2 * ve2 + me3 * ve3 + me4 * ve4 + me5 * ve5
        Ap[i] = temp_Ap
        pkT_A_pk += (p[i] * temp_Ap)

    alpha = rkT_rk / pkT_A_pk
    res = 0.0
    top = 0.0
    bottom = 0.0
    for i in range(n):
        IY = i // resolutionX
        IX = i - resolutionX * IY
        new_pf_val = pf[IX, IY] + alpha * p[i]
        diff = ti.abs(new_pf_val - pf[IX, IY])
        res += (diff * diff)
        pf[IX, IY] = new_pf_val
        new_r_val = r[i] - alpha * Ap[i]
        new_r[i] = new_r_val
        top += (new_r_val * new_r_val)
        bottom += (r[i] * r[i])

    beta = top / bottom
    for i in range(n):
        p[i] = new_r[i] + beta * p[i]
        r[i] = new_r[i]
    res = ti.sqrt(res)
    return res

@ti.kernel
def construct_cg_b(divf: ti.template(), b: ti.template()):
    for IX, IY in divf:
        if (0 < IX < resolutionX - 1) and (0 < IY < resolutionX - 1):
            b[IY * resolutionX + IX] = divf[IX, IY]
        else:
            b[IY * resolutionX + IX] = 0.0

def pressure_cg(pf_pair, divf: ti.template()):
    residual = 10
    counter = 0
    construct_cg_b(divf, b)
    pressure_cg_init(pf_pair.cur, b)
    while residual > 0.01:
        residual = pressure_cg_iter(pf_pair.cur)
        counter += 1
        if counter > 30:
            break
    apply_p_bc(pf_pair.cur)

@ti.kernel
def divergence(field: ti.template(), divf: ti.template()):
    for i, j in field:
        divf[i, j] = 0.5 * (field[i + 1, j][0] - field[i - 1, j][0] + field[i, j + 1][1] - field[i, j - 1][1])

@ti.kernel
def correct_divergence(vf: ti.template(), vf_new: ti.template(), pf: ti.template()):
    for i, j in vf:
        vf_new[i, j] = vf[i, j] - ti.Vector([(pf[i + 1, j] - pf[i - 1, j]) / 2.0, (pf[i, j + 1] - pf[i, j - 1]) / 2.0])

gui = ti.GUI('Colorful Fluid Simulation', (512, 512))
frame_counter = 0

# Initial dye color is blue
initial_dye_color = ti.Vector([0.2, 0.2, 1.0])

while True:
    while gui.get_event(ti.GUI.PRESS):
        if gui.event.key in [ti.GUI.ESCAPE, ti.GUI.EXIT]: 
            exit(0)
        if gui.event.key == ti.GUI.SPACE:
            pause = not pause
    if not pause:
        for itr in range(15):
            # Add inflow
            addInflow(velocities_pair.cur, area, inflow_velocity)
            addInflow(dyes_pair.cur, area, initial_dye_color)
            # Advection calculation
            apply_vel_bc(velocities_pair.cur)
            advect(velocities_pair.cur, velocities_pair.cur, velocities_pair.nxt)
            advect(velocities_pair.cur, dyes_pair.cur, dyes_pair.nxt)
            velocities_pair.swap()
            dyes_pair.swap()
            apply_vel_bc(velocities_pair.cur)
            # Projection step
            divergence(velocities_pair.cur, velocity_divs)
            pressure_cg(pressures_pair, velocity_divs)
            correct_divergence(velocities_pair.cur, velocities_pair.nxt, pressures_pair.cur)
            velocities_pair.swap()
        fill_color(pixels, dyes_pair.cur)

    frame_counter += 1
    filename = f'./video/frame_{frame_counter:05d}.png'
    gui.set_image(pixels.to_numpy())
    try:
        gui.show(filename)
    except:
        gui.show()
```


![è¿è¡Œä»£ç è¾“å‡º](https://files.mdnice.com/user/129153/ca36fbaa-83ca-46df-a84a-84118db4fbbb.png)

æˆ‘ä»¬çœ‹åˆ°çš„è¿™äº›å¤æ‚çš„ç¾½æµã€å·æ›²å’Œæ··åˆç°è±¡ï¼Œéƒ½æ˜¯ç”±åŠ¨é‡æ–¹ç¨‹ä¸­çš„**éçº¿æ€§å¯¹æµé¡¹** $(\vec{v} \cdot \nabla)\vec{v}$ æ‰€ä¸»å¯¼çš„ã€‚è¿™ä¸ªçœ‹ä¼¼ç®€å•çš„é¡¹ï¼Œå´æ˜¯æµä½“èƒ½å¤Ÿäº§ç”Ÿä»ç®€å•å±‚æµåˆ°å¤æ‚æ¹æµç­‰æ— ç©·æ— å°½æ¨¡å¼çš„æ ¹æºã€‚




# 7. æ€»ç»“

è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬ä»**æ¢¯åº¦åŠ¨åŠ›å­¦**çš„å®ˆæ’æ¨¡å‹å‡ºå‘ï¼Œç³»ç»Ÿåœ°æ„å»ºäº†æè¿°**æ— æ‘©æ“¦ã€æ— çƒ­ä¼ å¯¼**çš„ç®€å•æµä½“çš„æµä½“åŠ¨åŠ›å­¦ç†è®ºæ¡†æ¶ã€‚å…¶æ ¸å¿ƒæ˜¯åŸºäº**å±€åŸŸå¹³è¡¡å‡è®¾** ï¼Œä¸ºæµä½“çš„ä¸‰ä¸ªåŸºæœ¬å®ˆæ’é‡â€”â€”è´¨é‡ã€åŠ¨é‡å’Œèƒ½é‡â€”â€”å»ºç«‹å®ˆæ’å®šå¾‹æ–¹ç¨‹ã€‚é€šè¿‡ä¸ºæ¯ä¸€ä¸ªå®ˆæ’â€œå¯†åº¦â€æ¨å¯¼å‡ºå…¶å¯¹åº”çš„ç‰©ç†â€œé€šé‡â€ï¼Œæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°äº†ä¸€å¥—æè¿°ç†æƒ³æµä½“è¡Œä¸ºçš„å°é—­æ–¹ç¨‹ç»„ï¼Œè¿™ä¾¿æ˜¯**ç†æƒ³æµä½“åŠ¨åŠ›å­¦æ–¹ç¨‹ç»„ (Equations of Ideal Hydrodynamics)** ã€‚

ä¸‹è¡¨æ€»ç»“äº†æœ¬è®²çš„æ ¸å¿ƒå†…å®¹ï¼Œæ¸…æ™°åœ°å±•ç¤ºäº†è¿™ä¸‰å¤§å®ˆæ’å®šå¾‹çš„ç»Ÿä¸€ç»“æ„ï¼š

| **å®ˆæ’é‡** | **å¯†åº¦** | **å®ˆæ’å¾‹ï¼ˆå¾®åˆ†å½¢å¼ï¼‰** | **é€šé‡/æµ** | **é€šé‡çš„ç‰©ç†è§£é‡Š** |
| --- | --- | --- | --- | --- |
| è´¨é‡ | $\rho$ | $\partial_t \rho + \nabla \cdot (\rho \vec{v}) = 0$ | $J = \rho \vec{v}$ | ç”±é€Ÿåº¦åœºè¾“è¿çš„è´¨é‡ï¼ˆå¯¹æµï¼‰ã€‚ |
| åŠ¨é‡ | $\rho v_i$ | $\partial_t (\rho v_i) + \partial_k \Pi_{ik} = 0$ | $\Pi_{ik} = P \delta_{ik} + \rho v_i v_k$ | å„å‘åŒæ€§çš„å‹å¼ºåŠ›åŠ ä¸ŠåŠ¨é‡çš„å¯¹æµè¾“è¿ã€‚ |
| èƒ½é‡ | $\frac{1}{2} \rho v^2 + \rho \epsilon$ | $\partial_t e_{\text{total}} + \nabla \cdot J^{(\epsilon)} = 0$ | $J^{(\epsilon)} = \rho \vec{v} \left( \frac{1}{2} v^2 + h \right)$ | ç”±é€Ÿåº¦åœºè¾“è¿çš„æ€»èƒ½é‡ï¼ˆåŠ¨èƒ½+ç„“ï¼‰ã€‚ |

è¿™ä¸ªæ–¹ç¨‹ç»„æ˜¯æˆ‘ä»¬è¿›ä¸€æ­¥ç†è§£æ›´å¤æ‚æµä½“ç°è±¡çš„åŸºçŸ³ã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»ä¸ºæµä½“ä¸–ç•Œæ„å»ºäº†å…¶æœ€åº•å±‚çš„ã€æ— è€—æ•£çš„â€œè¿åŠ¨éª¨æ¶â€ã€‚åœ¨æ¥ä¸‹æ¥çš„è¯¾ç¨‹ä¸­ï¼Œå°†åœ¨æ­¤åŸºç¡€ä¸Šå¼•å…¥**è€—æ•£æ•ˆåº” (dissipative effects)** ï¼ˆå¦‚ç²˜æ€§å’Œçƒ­ä¼ å¯¼ï¼‰ï¼Œä»ç†æƒ³çš„æ¬§æ‹‰æ–¹ç¨‹è¿‡æ¸¡åˆ°æ›´æ™®é€‚çš„**çº³ç»´-æ–¯æ‰˜å…‹æ–¯æ–¹ç¨‹ (Navier-Stokes Equations)** ï¼Œä»è€Œèƒ½å¤Ÿæè¿°æ›´åŠ çœŸå®å’Œå¤æ‚çš„æµä½“ç°è±¡ã€‚


å…³æ³¨æˆ‘ä»¬ï¼Œä¸€èµ·å­¦ä¹ ï¼


å…³æ³¨å…¬ä¼—å·ï¼Œå›å¤ã€**æµä½“åŠ›å­¦**ã€‘ç›´æ¥è·å–åˆ°ç›®å‰ä¸ºæ­¢25èŠ‚è¯¾çš„pythonä»£ç 
ç‰¹åˆ«é¸£è°¢ä»¥ä¸‹å…³æ³¨è€…å¯¹æœ¬ç³»åˆ—ç¬”è®°çš„èµåŠ©æ”¯æŒï¼š
çŸ£èƒ½åˆ¶ã€cuiwã€Så®‹é¹é£ã€å£¬é’æŸ”ã€æ¨é‡‘è£ã€æ—æ—­è¾‰ğŸ…ã€éº¦éº¦