关注我们，一起学习！

最近在学习课程 **非平衡场论与随机动力学** **Nonequilibrium Field Theories and Stochastic Dynamics, Prof. Erwin Frey, LMU Munich, Summer Semester 2025**

其目录如下：

![课程链接：YouTube：https://www.youtube.com/watch?v=MZUqBwZMN_o&ab_channel=PhysicsOfLifeLMU 
哔哩哔哩：https://www.bilibili.com/video/BV18X8wzSEa3/?spm_id_from=333.1387.0.0](https://files.mdnice.com/user/30198/fd8f100d-93f9-420c-8ace-e3a67d524181.png)

Erwin Frey 教授喜欢在黑板上写板书，为记录学习过程，将所学笔记整理为文，并撰写python代码加深理解。

上几节内容请查阅：

**1.简单随机游走**

**2.高斯随机游走与泊松过程**

**3.Gillespie 算法、主方程、生成函数与种群动力学**

**4.种群动力学：线性死亡过程与Lotka-Volterra 系统**

**5.马尔可夫过程的基本方程：查普曼-科尔莫戈罗夫方程**

**6.前向主方程与Q矩阵**

**7. 佩龙-弗罗贝尼乌斯定理、稳态与细致平衡**

**8. 非平衡态：不可逆性与熵产生的推论**

**9. Ehrenfest Model、熵与KL散度**

**10. 连续马尔可夫过程与福克-普朗克方程**

**11. 布朗运动与 O-U 过程**

**12. 作为随机过程的蒙特卡洛采样**

**13. 哈密尔顿蒙特卡洛采样**

**14. 趋化性与集体动力学**

**15. 粗粒化、反常扩散与运动诱导相分离**

**16. 朗之万方程与涨落-耗散定理**

**17. 福克-普朗克方程与玻尔兹曼分布**

**18. 随机过程的路径积分表述**

**19. 随机微分方程**

**20. 伊藤积分与随机过程统一框架**

**21. 含乘性噪声系统的路径积分**

**22. 从粗粒化到连续场论涨落动力学**

**23. 昂萨格理论与涨落、耗散及对称性**

**24. 梯度动力学、相变与弛豫**

**25. 临界慢化、动态响应与守恒律**

**26. 欧拉方程的流体动力学**

**27.纳维-斯托克斯方程**

**28. 扩散模型与不可逆线性热力学**

**29. 悬浮在流体中的布朗粒子 — H模型**

**30. 加性噪声场论**

**31. Janssen-De Dominicis 响应泛函**

**32. 非平衡功与涨落定理**

**33. 有向渗流与谱方法**

**34. 场论的主方程路径积分表示**

**35. 相干态路径积分**

**36. 连续随机场论**

**37. 空间随机动力学**

**笔记撰写耗费大量时间和心血，请尊重原创，一切转发、拷贝整合，均需获得作者同意，侵权必究！**

# 引言：从离散跳跃到连续场论的两种路径

在前面的课程中（特别是**第31讲** 至**第36讲**），多种强大的路径积分形式已被系统性地建立起来，用以描述随机多体系统的集体行为。无论是基于连续朗之万方程的**Janssen-De Dominicis响应泛函**，还是处理离散粒子生灭的**相干态路径积分**，其核心目标都是将描述个体随机事件的微观动力学（主方程或朗之万方程），转化为一个等效的、更便于分析的场论。

**第37讲** 将这一框架推广到了空间维度，通过将多物种的局域反应和扩散过程定义在一个离散的**空间格点（lattice）**上，为描述时空动力学奠定了基础。这自然引出了一个基础且至关重要的问题：如何在这个离散的格点系统上构建路径积分，并从中正确地推导出一个宏观的、连续的场论描述？

这个问题看似只是一个取极限（即让格点间距 $a \to 0$）的数学操作，但其背后隐藏着深刻的物理内涵。这个极限过程并非总是直截了当，不同的数学形式（路径积分的构建方式）在取极限后可能会得到截然不同的物理结果。

这节课将通过对比两种著名的路径积分方法，来揭示这一过程中的微妙之处。其核心议题是，哪种方法能够真正捕捉到底层离散粒子系统随机跳跃所固有的**随机涨落（stochastic fluctuations）**？

这节课将聚焦于两种构建路径积分的主要方法：

1.  **Doi-Peliti (DP) 路径积分**：这是一种“场为先”的方法，其思想源于**第35讲** 的相干态表象。它从一开始就将粒子产生和湮灭算符映射为连续的场变量及其导数，天然地导向一个关于平滑场的描述。

2.  **克莱默-莫亚尔路径积分 (Kramers-Moyal Path Integral, KMPI)**：这是一种“事件为先”的方法，其思想源于**第36讲** 的克莱默-莫亚尔展开。它直接从主方程中的跳跃过程出发，在数学形式上明确保留了粒子从一个格点跳到另一个格点的离散事件特征。

通过对比这两种方法对同一个物理过程——扩散——的描述，将会看到，Doi-Peliti路径积分最终给出了一个确定性的、平均场水平的描述，而克莱默-莫亚尔路径积分则成功地保留了系统的随机性，最终导出了一个包含**内禀噪声（intrinsic noise）**的随机场论。这场“对决”将深刻揭示，数学形式的选择如何决定了最终能够看到的物理图像的深度和广度。

# 1. Doi-Peliti 形式：一个确定性的平均场图像

在**第37讲**中，理论框架已被扩展至空间维度，通过将反应和扩散过程定义在一个离散的格点上。这节课的第一个任务，便是应用在**第35讲**中建立的**Doi-Peliti (DP) 相干态路径积分**方法，为这个格点上的扩散过程构建路径积分，并尝试推导其连续场论。DP形式以其数学上的简洁优美著称，能高效地推导出系统的平均行为。通过这个推导，将清晰地看到该方法的强大之处，以及它为捕捉真实随机性所付出的代价。

Doi-Peliti路径积分由日本物理学家Masaki Doi和意大利物理学家Graham Peliti在20世纪70年代末至80年代初独立提出并系统化，其历史渊源是将量子场论中的相干态与路径积分技术创造性地引入经典随机系统。该方法的物理本质是为描述粒子数可变的随机过程（如化学反应、种群动力学、生态演替）构建一个严格的场论框架：通过引入创生和湮灭算符，它将主方程映射为一种基于相干态的泛函积分形式，其作用量自然包含了粒子间相互作用所导致的多体关联与涨落效应。Doi-Peliti场论的具体应用极为广泛，已成为研究非平衡统计物理的核心数学工具，深刻应用于反应扩散系统的非平衡相变（如定向渗流）、种群生物学的随机演化、基因调控网络的噪声传播、活性物质集体运动以及流行病传播动力学等领域，为理解涨落主导的稀有事件和临界现象提供了强大的解析与数值计算手段。

## 1.1 扩散算符的场表示

理论的起点，是将粒子在格点间的跳跃（扩散）过程，用**第35讲**发展的产生-湮灭算符语言来描述。对于一个单物种系统，其总的刘维尔（Liouvillian）算符中只包含扩散的部分可以写为：
$$
\hat{\mathcal{Q}}_{\text{DIFF}} = \sum_{i} \sum_{j \sim i} D_{ij} \left( a_i^\dagger a_j - a_i^\dagger a_i \right) = \sum_{i} \sum_{j \sim i} D_{ij} a_i^\dagger (a_j - a_i)
$$

* $i, j$ 是格点（lattice site）的索引。

* $j \sim i$ 表示 $j$ 是 $i$ 的最近邻格点。

* $D_{ij}$ 是粒子从格点 $j$ 跳到格点 $i$ 的速率。

* $a_j$ 和 $a_i^\dagger$ 分别是格点 $j$ 上的湮灭算符和格点 $i$ 上的产生算符。

**物理意义**: 这个表达式描述了格点 $i$ 上的粒子数净变化。

* 第一项 $D_{ij} a_i^\dagger a_j$ 描述了粒子从邻居格点 $j$ 以速率 $D_{ij}$ 跳入格点 $i$ 的**增益**过程（在 $j$ 处湮灭，在 $i$ 处产生）。

* 第二项 $-D_{ij} a_i^\dagger a_i$ 描述了粒子从格点 $i$ 跳出到邻居格点 $j$ 的**损失**过程。对所有邻居 $j$ 求和，就得到了从格点 $i$ 流出的总概率流。

Doi-Peliti形式的核心步骤，是将这些抽象的算符映射为连续的场变量和它们的微分算符。根据**第35讲**建立的规则（包含Doi-shift）：
$$
a_i^\dagger \to \phi_i \quad \text{and} \quad a_i \to \partial_i + 1 \quad \text{where} \quad \partial_i \equiv \frac{\partial}{\partial \phi_i}
$$


* 这里的 $\phi_i$ 是一个连续的（复数）场，可理解为在格点 $i$ 上的某种场振幅或生成函数变量。

* Doi-shift "+1" 的引入是为了使算符代数与玻色子代数完美对应。

将此映射代入 $\hat{\mathcal{Q}}_{\text{DIFF}}$，会发生一个重要的简化：
$$
a_j - a_i = (\partial_j + 1) - (\partial_i + 1) = \partial_j - \partial_i
$$
Doi-shift在描述粒子数守恒的扩散过程中恰好相互抵消。因此，算符的场表示为：
$$
\hat{\mathcal{Q}}_{\text{DIFF}} \to \sum_{i} \sum_{j \sim i} D_{ij} \phi_i (\partial_j - \partial_i)
$$
这个表达式经过基于格点对称性的重新排列，可以写成一种在后续推导中更方便的形式：
$$
\hat{\mathcal{Q}}_{\text{DIFF}} \to \sum_{i} \sum_{j \sim i} (D_{ij} \phi_j - D_{ji} \phi_i) \partial_i
$$
**物理意义**:
这个从算符到微分算子的转换，是DP方法的第一步，也是关键一步。它将一个描述离散粒子跳跃的量子化语言，转化为了一个描述连续场演化的经典偏微分方程语言。

## 1.2 Doi-Peliti作用量及其连续极限

有了算符的场表示，就可以遵循**第31讲**中引入的Janssen-De Dominicis形式，构建出描述系统演化的路径积分作用量。对于一个包含扩散和局域反应的系统，其作用量为：
$$
S[\{\phi_i, i\tilde{\phi}_i\}] = \int_{t_0}^{t} d\tau \sum_{i \in L} \left[ i\tilde{\phi}_i \partial_\tau \phi_i - \mathcal{Q}^{(i)}_{\text{DIFF}} - \mathcal{Q}^{(i)}_{\text{REACT}} \right]
$$


* 引入了响应场 $i\tilde{\phi}_i$，它的作用是作为拉格朗日乘子，来强制系统演化遵循由刘维尔算符 $\mathcal{Q}$ 定义的动力学方程。

* $\mathcal{Q}^{(i)}_{\text{DIFF}}$ 是上一小节推导的扩散算符的“符号”形式，通过替换 $\partial_i \to i\tilde{\phi}_i$ 得到，即 $\sum_{j \sim i} (D_{ij} \phi_j - D_{ji} \phi_i) (i\tilde{\phi}_i)$。

现在，专注于扩散部分，并取**连续极限 (continuum limit)** 。为简化，假设一个均匀各向同性的系统，即所有跳跃速率都相同，$D_{ij} = D_{ji} = D$。此时，作用量中的扩散项变为：

$$
- \sum_i (i\tilde{\phi}_i) D \sum_{j \sim i} (\phi_j - \phi_i)
$$

求和项 $\sum_{j \sim i} (\phi_j - \phi_i)$ 正是**格点拉普拉斯算符 (lattice Laplacian)** 。取连续极限的规则如下：

* 格点间距为 $a$。

* 格点求和替换为空间积分：$\sum_{i \in L} a^d \to \int d^d x$。

* 场变量归一化为密度：$\frac{1}{a^d} \phi_i(t) \to \phi(\vec{r}_i, t)$。

* 响应场做类似替换：$\tilde{\phi}_i(t) \to \tilde{\phi}(\vec{r}_i, t)$。

格点拉普拉斯算符在 $a \to 0$ 的极限下，会收敛到连续的拉普拉斯算符 $\nabla^2$：
$$
\sum_{j \sim i} (\phi_j - \phi_i) \xrightarrow{a \to 0} a^2 \nabla^2 \phi
$$
将所有规则代入并整理，最终得到扩散过程的连续作用量：
$$
S_{\text{DIFF}}[\phi, i\tilde{\phi}] = \int dt \int d^d x \left[ i\tilde{\phi}(\vec{r}, t) \left( \partial_t - D \nabla^2 \right) \phi(\vec{r}, t) \right]
$$
**物理意义**:

这个作用量是标准的MSRJD形式，它描述了一个完全确定性的过程。路径积分的物理图像由**鞍点 (saddle-point)** 决定，即令作用量对响应场 $i\tilde{\phi}$ 的变分为零的路径。执行该变分 ($\delta S / \delta(i\tilde{\phi}) = 0$)，直接得到系统的“经典”运动方程：

$$
\partial_t \phi(\vec{r}, t) = D \nabla^2 \phi(\vec{r}, t)
$$

这正是经典的、确定性的**扩散方程 (diffusion equation)** 。

## 1.3 深层解读：Doi-Peliti形式的“过早平均”

这个推导得到了一个完全确定性的结果。这引出了一个关键问题：系统中由粒子离散性带来的随机涨落去哪里了？

答案在于Doi-Peliti形式的构建方式本身。通过从一开始就使用 $a^\dagger \to \phi$，$a \to \partial_\phi + 1$ 这种连续的场表示，该方法实际上在第一步就已经进行了一种“平均化”或“平滑化”处理。

1.  **算符代数的模糊化** ：底层的产生和湮灭算符满足对易关系 $[a_i, a_j^\dagger] = \delta_{ij}$，这其中包含了粒子不可分割的离散性信息。虽然 $[\partial_i, \phi_j] = \delta_{ij}$ 的映射保留了这种代数结构，但它立即将问题投射到了一个由**连续函数**构成的空间中，从而模糊了计数的离散本质。

2.  **作用量的二次型结构** ：最终得到的DP作用量是场变量 $\phi$ 和 $i\tilde{\phi}$ 的**二次型**（即只包含像 $i\tilde{\phi}\phi$ 或 $i\tilde{\phi}\nabla^2\phi$ 这样的项）。在场论中，二次型的作用量总是对应着线性的、非相互作用的或确定性的理论。所有关于涨落和关联的信息都隐藏在更高阶的项中（例如 $(i\tilde{\phi})^2\phi^2$），而这些项在DP形式对扩散的推导中并未出现。

Doi-Peliti形式非常适合推导系统的**平均场行为 (mean-field dynamics)** 。它准确地回答了“粒子的平均浓度如何演化？”这个问题。但是，由于其内在的构造，它“过滤”掉了所有关于浓度如何围绕其平均值进行随机涨落的信息。它给出的，是一个平滑、无噪声的宏观图像。

## 1.4 算符代数的“经典”本质

在整个推导过程中，频繁使用了“产生算符”、“湮灭算符”、“对易关系”等源自量子力学的术语，并且其代数结构 $[a, a^\dagger]=1$ 与玻色子算符完全相同。这是否意味着我们正在处理一个量子系统？

答案是否定的。正如教授在课程中所强调的，这里的理论框架**本质上是经典的**。算符代数在此处并非描述量子态的叠加与纠缠，而是作为一种极其强大的**数学工具**，用以求解描述经典概率演化的偏微分方程。

* **经典概率 vs. 量子概率幅**：我们处理的态矢量 $|\Phi(t)\rangle$，其展开系数是真实的**概率** $P(n,t)$；而在量子力学中，波函数的展开系数是复数的**概率幅**，需要取模平方才能得到概率。

* **数学同构性**：经典随机过程与量子系统之所以能共享同一套算符代数，是因为它们底层的演化方程（主方程 vs. 薛定谔方程）在数学上是同构的。升降算符在此处是求解线性算子谱系的通用技巧，而非量子现象的专利。

刻意避免使用“相干态”等纯粹的量子术语，而采用“泊松表示”、“生成函数”等更贴近经典概率论的语言，正是为了强调这一概念上的区别，避免将经典的随机过程与真正的量子多体问题相混淆。

## 1.5 背景知识：玻色子模型 vs. 排他过程

这节课构建的场论模型，隐含了一个重要的物理假设：每个格点可以容纳**任意数量**的粒子。这在算符代数中体现为，来自不同格点的算符相互对易，且单个格点上的产生算符 $a_i^\dagger$ 可以无限次作用。这种模型在物理学上被称为**玻色子模型（Bosonic Model）**。

与之相对的是另一类重要的物理模型——**排他过程（Exclusion Processes）**，例如“简单对称排他过程”（SSEP）。在这类模型中，每个格点最多只能容纳一个粒子（费米子特性）。这意味着，当一个粒子试图跳入一个已被占据的格点时，这次跳跃会被禁止。

描述排他过程需要一套不同的、更复杂的算符代数（例如自旋算符或费米子算符）。理解我们当前模型的“玻色子”属性，有助于明确其适用范围，并为将来学习更复杂的模型（如包含体积排除效应的系统）奠定概念基础。

# 2. 克莱默-莫亚尔路径积分：捕捉随机跳跃

上一节的推导表明，Doi-Peliti形式在取连续极限后，丢失了所有关于随机涨落的信息，最终只得到了一个确定性的平均场理论。为了构建一个更完整的、能够描述真实随机性的场论，需要一种不走“捷径”、忠实于底层离散跳跃事件的替代方法。

这节课将转向在**第36讲**中介绍的**克莱默-莫亚尔路径积分（Kramers-Moyal Path Integral, KMPI）**。这种方法直接从主方程描述的离散跳跃事件出发，其数学形式能够完整地保留跳跃过程的全部统计信息，从而为正确推导包含内禀噪声的随机场论提供了坚实的基础。

## 2.1 作用量的构建：忠实于跳跃事件

与DP形式不同，KMPI直接从主方程的积分形式出发，其对应的作用量具有一种截然不同的结构。根据**第36讲**的推导，对于格点上的纯扩散过程，其KMPI作用量为：
$$
S[\{n_i, i\tilde{n}_i\}] = \int_{t_0}^{t} d\tau \sum_{i \in L} \left[ i\tilde{n}_i\partial_\tau n_i - \sum_{j \sim i} D_{ji} n_i \left(e^{i (\tilde{n}_j- \tilde{n}_i)}-1\right) \right]
$$


* 这里的变量 $n_i$ 代表格点 $i$ 上的**真实粒子数**（或密度），而非DP形式中的抽象场 $\phi_i$。$\tilde{n}_i$ 是其对应的响应场。

* 作用量的核心是指数项 $\left(e^{i (\tilde{n}_j - \tilde{n}_i)}-1\right)$，它精确地编码了单次粒子跳跃事件。

**物理意义**: 这一项的结构可以被解读为**总跳跃速率 × (跳跃算符)** 。

  * $D_{ji} n_i$ 是粒子从格点 $i$ 跳往其邻居 $j$ 的**总速率**。
    
  * 指数项 $e^{i (\tilde{n}_j - \tilde{n}_i)}$ 在路径积分的框架下，是一个**“移位算符”**的傅里叶表示。它精确地执行了这样一个操作：将格点 $i$ 的粒子数减一（对应因子 $e^{-i\tilde{n}_i}$），同时将格点 $j$ 的粒子数加一（对应因子 $e^{i\tilde{n}_j}$）。
  
  * 减去 1 是为了确保在没有跳跃发生时，该项为零，不贡献任何动力学。

因此，KMPI的作用量没有像DP形式那样预先将跳跃过程线性化，而是完整地保留了其指数形式，从而也保留了跳跃事件的全部统计信息。

## 2.2 连续极限与Kramers-Moyal展开：噪声的浮现

现在，对KMPI作用量执行同样的操作：取连续极限。这正是这节课的核心计算。这个过程将揭示，对指数项进行系统性的展开，等价于一次**克莱默-莫亚尔展开**，并从中自然地浮现出噪声项。

将指数项进行泰勒级数展开：

$$
e^x - 1 = x + \frac{1}{2}x^2 + \mathcal{O}(x^3)
$$

令 $x = i(\tilde{n}_j - \tilde{n}_i)$，并将均匀速率 $D_{ij} = D$ 代入，作用量中的动力学项变为：

$$
\sum_{j \sim i} D n_i \left( e^{i(\tilde{n}_j - \tilde{n}_i)} - 1 \right) = D n_i \sum_{j \sim i} \left[ i(\tilde{n}_j - \tilde{n}_i) + \frac{1}{2}(i(\tilde{n}_j - \tilde{n}_i))^2 + \cdots \right]
$$

现在逐项分析这个展开式在 $a \to 0$ 时的行为。

### 1. 一阶项 (Drift Term)
$$
D n_i \sum_{j \sim i} i(\tilde{n}_j - \tilde{n}_i)
$$
这一项正比于格点拉普拉斯算符作用在 $i\tilde{n}_i$ 上。在连续极限下，它收敛于 $D n(\vec{r}, t) \nabla^2(i\tilde{n}(\vec{r}, t))$。在作用量的积分中，通过一次**分部积分**，可以将拉普拉斯算符从响应场 $\tilde{n}$ 转移到物理场 $n$ 上，得到 $-D \nabla(i\tilde{n}) \cdot \nabla n$ 或 $i\tilde{n} D \nabla^2 n$。

**物理意义**: 这个结果与DP形式得到的结果完全一致，它贡献了系统的**确定性扩散漂移**。

### 2. 二阶项 (Noise Term)
$$
D n_i \sum_{j \sim i} \frac{1}{2}(i(\tilde{n}_j - \tilde{n}_i))^2 = -\frac{D n_i}{2} \sum_{j \sim i} (\tilde{n}_j - \tilde{n}_i)^2
$$
差分 $(\tilde{n}_j - \tilde{n}_i)$ 是对梯度 $\nabla\tilde{n}$ 的离散近似，即 $(\tilde{n}_j - \tilde{n}_i) \approx a \nabla\tilde{n}$。因此，在连续极限下，二阶项收敛于：
$$
- \frac{D n_i}{2} \sum_{j \sim i} (\tilde{n}_j - \tilde{n}_i)^2 \xrightarrow{a \to 0} - D n(\vec{r}, t) (\nabla \tilde{n}(\vec{r}, t))^2 = D n(\vec{r}, t) (\nabla (i\tilde{n}))^2
$$
**物理意义**:
这个二次项在DP形式的推导中完全没有出现。它正是在场论中代表**随机噪声**的项。

将一阶项和二阶项组合起来（更高阶项在 $a \to 0$ 时可以被忽略，这与**第36讲**中Pawula定理的精神一致），得到的连续作用量为：

$$
S[n, i\tilde{n}] = \int dt \int d^d x \left\{ i\tilde{n} \partial_t n - D n \left[ \nabla^2(i\tilde{n}) + (\nabla i\tilde{n})^2 \right] \right\}
$$

这个作用量不仅包含了确定性的漂移项，还包含了一个关键的、正比于 $(i\tilde{n})^2$ 的噪声项。

## 2.3 指数项作为离散性的“记忆”

为什么KMPI成功地导出了这个额外的二次项，而DP却失败了？

根本原因在于，指数项 $e^{i(\tilde{n}_j - \tilde{n}_i)}$ 是跳跃过程矩（moment）的**生成函数**。泰勒展开这个指数函数，实际上就是在系统地计算跳跃过程的所有矩：

* 展开式的一次项，正比于 $i\Delta\tilde{n}$，对应于跳跃的**一阶矩**（平均位移），这产生了确定性的**漂移（drift）**。

* 展开式的二次项，正比于 $(i\Delta\tilde{n})^2$，对应于跳跃的**二阶矩**（位移的方差），这产生了**噪声项（noise）**。

Doi-Peliti形式从一开始就假设了一个线性的动力学结构（$\phi(\partial_j - \partial_i)$），这等价于只保留了泰勒展开的第一项。它只捕捉了跳跃的平均效果，而完全忽略了跳跃过程的随机性（方差）。


KMPI是一种更忠实的表示，因为它没有在开始时就对跳跃过程做任何近似。它将描述离散事件的完整数学结构（指数项）带入了连续极限的计算中。取极限的过程，变成了一次系统的Kramers-Moyal展开。展开的第一项给出了宏观的、确定性的动力学，而第二项则给出了由粒子离散性导致的、不可避免的随机涨落。这个噪声项，是底层离散跳跃事件方差在宏观尺度上的直接体现。

# 3. 乘性噪声的浮现

在上一节的计算中，克莱默-莫亚尔路径积分（KMPI）通过一种更严谨的极限过程，导出了一个与Doi-Peliti（DP）形式不同的作用量。其关键区别在于KMPI作用量中多出了一个正比于 $n (\nabla (i\tilde{n}))^2$ 的项。这个看似纯数学的额外项，实际上蕴含着深刻的物理内容。这节课的目标，就是揭示这一项如何成为连接微观粒子离散性与宏观随机涨落的桥梁，并最终引出**乘性噪声（multiplicative noise）**这一核心物理概念。

## 3.1 从作用量到朗之万方程

为了翻译KMPI作用量的物理意义，可以将其与在**第31讲**和**第36讲**中建立的、描述通用朗之万方程的MSRJD作用量的标准形式进行对比。一个由以下朗之万随机微分方程（SPDE，采用Ito约定）描述的连续随机过程：

$$
\partial_t \phi = F[\phi] + G[\phi] \eta(t)
$$
其对应的MSRJD作用量为：
$$
S[\phi, i\tilde{\phi}] = \int dt \int d^d x \left[ i\tilde{\phi} (\partial_t \phi - F[\phi]) - \frac{1}{2} G^2[\phi] (i\tilde{\phi})^2 \right]
$$


* $F[\phi]$ 是确定性的**漂移项 (Drift Term)** 。

* $G[\phi]$ 是**噪声强度 (Noise Amplitude)** 。

* $\eta(t)$ 是均值为零、方差为 $\langle \eta(t) \eta(t') \rangle = 2\delta(t - t')$ 的高斯白噪声（注意，这里的因子2是一种常见约定，它会影响噪声强度的定义）。

现在，将上一节推导出的KMPI作用量（为便于比较，已通过分部积分整理）与这个标准形式进行逐项对比：

$$
S_{KMPI}[n, i\tilde{n}] = \int dt \int d^d x \left\{ i\tilde{n} (\partial_t n - D \nabla^2 n) - D n (i\tilde{n})^2 \right\}
$$

通过直接比较，可以立刻识别出等效朗之万方程中的各项：

* **漂移项**: $F[n] = D \nabla^2 n$

* **噪声强度平方**: $\frac{1}{2} G^2[n] = D n \implies G[n] = \sqrt{2Dn}$

因此，KMPI作用量所描述的物理过程，由以下的**随机偏微分方程（SPDE）**给出：

$$
\partial_t n(\vec{r}, t) = D \nabla^2 n(\vec{r}, t) + \nabla \cdot \left( \sqrt{2D n(\vec{r}, t)} \, \vec{\eta}(\vec{r}, t) \right)
$$


* $\vec{\eta}$ 是时空高斯白噪声，满足 $\langle \eta_\alpha(\vec{r}, t) \eta_\beta(\vec{r}', t') \rangle = \delta_{\alpha\beta} \delta(\vec{r} - \vec{r}') \delta(t - t')$。

* 噪声项被写成了散度形式 $\nabla \cdot (\dots)$，这体现了粒子数守恒的特性：噪声不会凭空创造或消灭粒子，而是在空间中重新分布它们，形成随机的粒子流。

**注**：讲座板书上的噪声项为 $\nabla \cdot (\sqrt{D n} \, \vec{\lambda})$。这里的 $\sqrt{2}$ 因子差异源于对噪声关联函数定义的不同（单位方差或方差为2），物理本质完全相同。

## 3.2 什么是乘性噪声？

这个SPDE与DP形式导出的确定性扩散方程的关键区别在于第二项，即噪声项。特别地，噪声的强度（振幅）$\sqrt{2Dn}$ 不是一个常数，而是依赖于系统状态（粒子密度 $n$）本身。这种噪声被称为 **乘性噪声（multiplicative noise）**。

它的物理意义非常直观和深刻：

* 在粒子密度很高（$n$ 很大）的区域，单位时间内的随机跳跃事件非常频繁，因此浓度的涨落也很大。

* 在粒子密度很低甚至为零（$n \to 0$）的区域，几乎没有粒子可以跳跃，因此随机涨落也趋于零。

这种源于构成系统的“个体”数量有限且行为随机所产生的噪声，被称为 **人口噪声（demographic noise）**或 **散粒噪声（shot noise）**。它是任何由离散单元（无论是粒子、分子、动物还是细胞）组成的随机系统的内禀属性。


**物理根源的深刻联系**:

这种 $\sqrt{n}$ 的依赖关系并非偶然。根据中心极限定理，对于一个包含大量独立随机个体的系统，其总数 $N$ 的涨落（标准差 $\sigma_N$）正比于平均数 $\bar{N}$ 的平方根，即 $\sigma_N \propto \sqrt{\bar{N}}$。KMPI的推导从第一性原理出发，精确地在宏观场论中重现了这一基本统计规律。

Doi-Peliti形式之所以失败，正是因为它无法描述这种依赖于粒子数本身的涨落。而KMPI通过保留跳跃过程的完整统计信息，成功地导出了描述这一基本物理现象的正确数学形式。

## 3.3 两种理论的对比总结

为了清晰地总结这节课的核心论点，可以将两种形式进行直接对比：

| 特征 | Doi-Peliti 路径积分 | 克莱默-莫亚尔路径积分 |
| :--- | :--- | :--- |
| **格点作用量关键项** | $\tilde{\phi}_i \sum_j (\phi_j - \phi_i)$ | $n_i (e^{i(\tilde{n}_j - \tilde{n}_i)} - 1)$ |
| **物理基础** | 相干态表象（类场） | 主方程跳跃过程（类事件） |
| **连续极限作用量** | $i\tilde{\phi} (\partial_t - D \nabla^2) \phi$ | $i\tilde{n} \partial_t n - D n [\nabla^2 (i\tilde{n}) + (\nabla i\tilde{n})^2]$ |
| **等价的动力学方程** | $\partial_t \phi = D \nabla^2 \phi$ | $\partial_t n = D \nabla^2 n + \nabla \cdot (\sqrt{2D n} \, \vec{\eta})$ |
| **动力学类型** | **确定性**（平均场） | **随机性**（涨落） |
| **描述的物理噪声** | **缺失** | 捕捉到人口/散粒噪声（**乘性噪声**） |

一个看似纯数学上的选择（如何表示跳跃过程），最终导致了两种截然不同的物理理论：一个只描述了平均行为，另一个则完整地描述了平均行为及其周围的随机涨落。



# 4. 将反应纳入场论框架

到目前为止，我们的分析严格聚焦于**扩散**过程。然而，一个完整的空间模型（如**第37讲**所述）必然包含**在位反应（on-site reactions）**。现在，我们将把处理扩散的连续极限方法，推广到反应过程，从而构建一个完整的反应-扩散场论。

## 4.1 “在位反应”的物理图像与标度变换

首先，需要明确在空间模型中“反应”的含义。当我们将空间离散化为一个个边长为 $a$ 的小室（cell）时，“在位反应”被理解为在同一个小室内部发生的事件。教授解释道，这些小室在物理上可以被看作是介观尺度（mesoscopic）的体积，其中可能包含大量粒子，足以让宏观的化学反应定律在其中生效。

在从离散格点过渡到连续空间的极限过程中 ($a \to 0$)，反应速率本身也需要进行相应的**标度变换（scaling）**。一个涉及 $k$ 个反应物的反应（$kA \to \dots$），其速率在连续极限下需要按如下方式重整化：

$$
\lambda_{\text{discrete}} \cdot a^{d(k-1)} \to \lambda_{\text{continuum}}
$$

**物理意义**：这个变换确保了当我们将粒子数 $\phi_i$ 转化为粒子密度 $\phi(\vec{r}) = \phi_i/a^d$ 时，质量作用定律的形式得以保持。例如，对于一个双分子反应 $2A \to \dots$，其速率与 $(\phi/a^d)^2$ 成正比。为了使连续理论中的速率 $\lambda_{\text{continuum}}$ 有正确的单位，离散速率 $\lambda_{\text{discrete}}$ 必须吸收一个因子 $a^d$。


## 4.2 DP框架下的反应作用量

遵循与扩散过程完全相同的逻辑，可以将任何通用反应 $kA \xrightarrow{\lambda} \ell A$ 所对应的刘维尔算符（在**第37讲**中已建立）转化为连续作用量的一部分。根据板书笔记，其在作用量中的贡献为：
$$
S_{\text{REACT}} = - \int dt \int d^d x \, Q_{\text{REACT}}(\phi, i\tilde{\phi}+1)
$$
其中，
$$
Q_{\text{REACT}}(\phi, i \tilde{\phi} + 1) = \lambda_{\text{continuum}} \phi^k \left( (i \tilde{\phi} + 1)^\ell - (i \tilde{\phi} + 1)^k \right)
$$
一个深刻的观点是，这些在连续场论中出现的“介观”反应速率 $\lambda_{\text{continuum}}$ 和扩散系数 $D$，通常被视为**唯象参数（phenomenological parameters）**。如同高能物理中的电子质量无法从第一性原理算出一样，这些参数也极难从更微观的层面精确推导，通常需要通过实验来测量。

## 4.3 KMPI框架下的反应项

同样地，在KMPI的格点作用量中，也存在一个描述反应的项 $\mathcal{L}_{\text{REACT}}^{(i)}$。这个项同样可以进行Kramers-Moyal展开，并贡献于最终SPDE的漂移项和噪声项。

例如，对于增殖反应 $A \to 2A$（速率 $\mu n$），和死亡反应 $A \to \emptyset$（速率 $\lambda n$），遵循**第36讲**的配方，可以得到它们各自对漂移 $V(n)$ 和扩散 $D(n)$ 的贡献：

* **漂移**: $V_{\text{REACT}} = (\mu n)(+1) + (\lambda n)(-1) = (\mu - \lambda)n$

* **扩散**: $D_{\text{REACT}} = \frac{1}{2} (\mu n)(+1)^2 + \frac{1}{2} (\lambda n)(-1)^2 = \frac{1}{2}(\mu + \lambda)n$

将这些项与扩散的贡献相加，就得到了一个完整的反应-扩散SPDE的漂移和噪声项。这为**第5节（原第4节）**模拟中使用的SPDE提供了坚实的理论依据。


# 5. 代码实践：随机性如何“雕刻”反应前沿

前三节的理论推导揭示了克莱默-莫亚尔路径积分（KMPI）能够捕捉到由粒子离散性引起的、Doi-Peliti（DP）方法所忽略的内禀噪声。为了以一种更直观的方式来观察这种噪声的**后果**，这节课的模拟将超越纯扩散，进入一个更动态的**反应-扩散**系统。

这节将模拟一个经典的**Fisher-Kolmogorov反应波**，它描述了一个物种（或一种状态）侵入另一片区域的过程。通过对比确定性理论和随机理论下的波前传播，可以直观地看到，在决定波前“命运”的关键区域——低密度前沿，随机涨落是如何从一个微不足道的“抖动”演变成为塑造宏观形态的主导力量。

## 5.1 模拟设置：两种理论下的物种入侵

模拟将在一个二维长方形网格上进行。初始时，左侧的一小片区域被“活性”粒子占据，其余区域为空。然后，将观察这个活性区域如何向右侧“入侵”。

1.  **确定性反应-扩散 (DP/平均场理论)** ：数值求解经典的Fisher-Kolmogorov方程。这代表了入侵波前的**平均行为** 。

    $$
    \frac{\partial n}{\partial t} = D \nabla^2 n + \mu n \left(1 - \frac{n}{K}\right)
    $$

2.  **随机反应-扩散 (KMPI理论)** ：数值求解包含内禀噪声的随机偏微分方程（SPDE）。这代表了**单次**入侵实验的真实物理过程。其噪声项现在由**扩散**和**反应**共同贡献：

    $$
    \frac{\partial n}{\partial t} = D \nabla^2 n + \mu n \left(1 - \frac{n}{K}\right) + \nabla \cdot \left( \sqrt{2Dn + \frac{\mu n}{K}(K-n)} \, \vec{\eta} \right)
    $$
    
**注**：噪声项的精确形式由KMPI配方系统性地给出，它结合了扩散噪声（$\propto n$）和反应噪声（生灭过程）。这里为了简化和突出物理，使用一个近似但定性正确的形式 $\sqrt{2Dn + \mu n}$，它同样抓住了噪声强度依赖于粒子数 $n$ 的核心特征。

## 5.2 Python 实现：反应前沿模拟器

下面的Python代码实现了上述两种理论的二维数值求解，并生成一个并排对比的动态演化图。

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import convolve2d
import matplotlib.animation as animation

# --- 1. Simulation Parameters ---
GRID_WIDTH = 256
GRID_HEIGHT = 128
D = 0.2              # Diffusion coefficient
MU = 0.1             # Reaction rate (birth rate)
K = 1.0              # Carrying capacity
T_FINAL = 300.0      # Total simulation time
DT = 0.1             # Time step
N_STEPS = int(T_FINAL / DT)
DX = 1.0             # Spatial step

# --- 2. Initial Condition: A front on the left side ---
n0 = np.zeros((GRID_HEIGHT, GRID_WIDTH))
front_width = 10
n0[:, :front_width] = K

# --- 3. Setup for Numerical Simulation ---
laplacian_kernel = np.array([[0, 1, 0], [1, -4, 1], [0, 1, 0]]) / (DX**2)
n_deterministic = n0.copy()
n_stochastic = n0.copy()

# Store history for animation
history_det = [n_deterministic.copy()]
history_sto = [n_stochastic.copy()]
save_interval = 20 # Save one frame every 20 steps

# --- 4. Main Simulation Loop ---
print("Running simulations for reaction fronts...")
for step in range(N_STEPS):
    # --- Deterministic (Mean-Field) Simulation ---
    lap_det = convolve2d(n_deterministic, laplacian_kernel, mode='same', boundary='wrap')
    reaction_det = MU * n_deterministic * (1 - n_deterministic / K)
    n_deterministic += (D * lap_det + reaction_det) * DT

    # --- Stochastic (KMPI) Simulation ---
    n_stochastic[n_stochastic < 0] = 0
    
    # Drift part (same as deterministic)
    lap_sto = convolve2d(n_stochastic, laplacian_kernel, mode='same', boundary='wrap')
    reaction_sto = MU * n_stochastic * (1 - n_stochastic / K)
    drift_term = D * lap_sto + reaction_sto
    
    # Noise part: Combined reaction and diffusion noise
    # The term is approximately sqrt(2*D*n + mu*n)
    noise_strength_sq = 2 * D * n_stochastic + MU * n_stochastic
    noise_amplitude = np.sqrt(np.maximum(0, noise_strength_sq) / (DX**2 * DT))
    
    eta_x = np.random.normal(0, 1, n_stochastic.shape)
    eta_y = np.random.normal(0, 1, n_stochastic.shape)
    
    flux_x = noise_amplitude * eta_x
    flux_y = noise_amplitude * eta_y
    
    grad_flux_y, _ = np.gradient(flux_y, DX, axis=(0, 1))
    _, grad_flux_x = np.gradient(flux_x, DX, axis=(0, 1))
    noise_term = grad_flux_x + grad_flux_y
    
    n_stochastic += (drift_term + noise_term) * DT

    if (step + 1) % save_interval == 0:
        history_det.append(n_deterministic.copy())
        history_sto.append(n_stochastic.copy())

print("Simulation finished. Creating animation...")

# --- 5. Visualization ---
fig, axes = plt.subplots(1, 2, figsize=(16, 8))
fig.patch.set_facecolor('black')
plt.style.use('dark_background')

def update(frame):
    for ax in axes:
        ax.clear()
            
    n_det = history_det[frame]
    n_sto = history_sto[frame]
    
    vmax = K * 1.1
    
    # --- Plot Deterministic Front ---
    axes[0].imshow(n_det, cmap='viridis', vmin=0, vmax=vmax, origin='lower', interpolation='bicubic')
    axes[0].set_title('Deterministic Front (DP/Mean-Field Theory)', color='white')
    axes[0].set_xticks([]); axes[0].set_yticks([])

    # --- Plot Stochastic Front ---
    axes[1].imshow(n_sto, cmap='viridis', vmin=0, vmax=vmax, origin='lower', interpolation='bicubic')
    axes[1].set_title('Stochastic Front (KMPI Theory)', color='white')
    axes[1].set_xticks([]); axes[1].set_yticks([])
    
    fig.suptitle(f'Reaction-Diffusion Front Propagation (Time: {frame*DT*save_interval:.1f})', color='white', fontsize=16)
    fig.tight_layout(rect=[0, 0, 1, 0.95])
    
    return axes[0], axes[1]

ani = animation.FuncAnimation(fig, update, frames=len(history_det), interval=50, blit=False)
try:
    ani.save('reaction_front_comparison.gif', writer='pillow', fps=20)
    print("Animation saved as 'reaction_front_comparison.gif'.")
except Exception as e:
    print(f"Could not save animation: {e}")

plt.show()

```
![运行代码输出](https://files.mdnice.com/user/129153/ae9dced3-f4d5-4f67-a3cb-d48697dc2e08.png)

**左侧（确定性/DP理论）** ：入侵波前是一条笔直、光滑的线。它以一个恒定的、可预测的速度向右传播。这代表了一个理想化的、无限多粒子极限下的平均行为。

**右侧（随机/KMPI理论）** ：宏观上，波前同样在向右传播，但其形态发生了质的改变。波前不再是笔直的，而是变得**粗糙、犬牙交错** ，并且在传播过程中**不断动态地改变形状** 。

**噪声的“雕刻”作用**：这种粗糙性正是**人口噪声**的直接作用。在波前的最前端，粒子密度 $n$ 非常低。根据 KMPI 理论，噪声的相对强度在这里达到最大。随机的繁殖事件（或扩散跳跃）会导致前沿的某些部分“幸运地”向前跳跃一小步，而另一些部分则会暂时停滞或后退。日积月累，这些微观的随机事件“雕刻”出了一个宏观上**嶙峋不平的、不断演化的**真实前沿。

这个反应-扩散波的例子表明，KMPI 捕捉到的内禀噪声，并不仅仅是在平均场解上添加的一层无关紧要的“毛刺”。相反，在诸如反应前沿这样的物理情境中，**噪声是决定系统宏观形态和动力学行为的关键因素**。它将一个在确定性世界中平淡无奇的直线，变成了一个在随机世界中充满动态和结构的、粗糙的界面。这正是构建一个能够描述真实物理世界的随机场论的必要性所在。


# 结论

这节课从一个基本物理过程——粒子在格点上的随机跳跃——出发，通过两种不同的路径积分形式主义探索了其连续极限。这次探索揭示了一个至关重要的结论：**数学形式的选择深刻地影响了最终的物理图像**。

* **Doi-Peliti (DP) 路径积分**，源于**第35讲**的相干态表象，通过其优雅的代数结构，高效地导出了系统的**平均场动力学**，即经典的确定性扩散方程。然而，这种方法的代价是完全丢失了关于系统随机涨落的信息。

* **克莱默-莫亚尔路径积分 (KMPI)**，继承自**第36讲**的展开思想，通过忠实地保留描述离散跳跃事件的指数项，在连续极限下进行系统的Kramers-Moyal展开。这个更严谨的过程不仅重现了确定性的漂移项，还揭示了一个至关重要的二阶项。该项对应于一个**乘性噪声**，其物理根源是粒子离散性所带来的人口噪声（demographic noise）。

最终，KMPI导出了一个随机偏微分方程（SPDE），它完整地描述了系统的宏观行为（漂移）和内禀的随机涨落（噪声）。这证明了，要从微观的、离散的随机过程正确地推导出宏观的、连续的随机场论，必须小心处理极限过程，确保描述事件随机性的核心数学结构没有在早期就被“平均掉”。

至此，KMPI在处理**扩散**问题上的优越性已经得到证实。它提供了一条从任何主方程的跳跃过程出发，系统性地推导其对应的随机朗之万方程的普适路径。然而，在**第37讲**中引入的空间模型，不仅包含扩散，还包含更复杂的**在位反应（on-site reactions）**。

因此，一个自然且关键的问题是：这个已被证明对扩散有效的KMPI框架，是否也能被用来正确地描述反应过程，并最终构建一个完整的随机反应-扩散场论？

这正是**下一讲“克莱默-莫亚尔路径积分方法：反应的场论”**将要解决的核心问题。课程将把这节课建立的强大工具应用到更广阔的领域：

* **将KMPI推广到反应系统**：将探讨如何运用KMPI的指数算符形式，来描述诸如粒子产生 ($A \to 2A$)、湮灭 ($2A \to A$) 和衰变 ($A \to \emptyset$) 等任意化学计量比的反应过程。

* **构建完整的反应-扩散场论**：通过将这节课推导的扩散作用量与下一讲将要推导的反应作用量相结合，最终将能够从第一性原理出发，为像**有向渗流**（在**第33讲**中引入）这样的复杂非平衡模型，构建出其完整的随机偏微分方程（SPDE）。

* **理论的统一与应用**：最终将建成一个统一的理论框架，能够系统性地从任何微观主方程（包含反应和扩散）出发，推导其宏观随机场论描述。这将为使用重整化群等现代场论工具，来分析远离平衡态的复杂随机系统的临界行为和相变，铺平最后的道路。

通过这节课的学习，理解随机场论起源的关键一步已经完成。下一讲将在此基础上，继续构建一个更完整、更强大的理论框架。

最后，值得一提的是，KMPI框架在处理更复杂的物理情境时，展现出比DP形式更强的稳健性。教授在课程中提到，如果扩散系数本身依赖于粒子密度或空间构型 $D(n)$，DP形式的推导会因其固有的场变量替换而变得“卡壳”（stuck），难以处理。相比之下，KMPI从真实的粒子数 $n$ 出发，可以更自然地将这种依赖性纳入理论框架。这一优势凸显了KMPI作为一种更接近物理本源的建模工具，在面对复杂非平衡系统时所具有的潜力。


关注我们，一起学习！

关注公众号，回复【**反应前沿**】直接获取到目前为止38节课的python代码

特别鸣谢以下关注者对本系列笔记的赞助支持：

矣能制、cuiw、S宋鹏飞、壬青柔、杨金荣、林旭辉🏅、麦麦、我是猫、海流、quanta、藕片