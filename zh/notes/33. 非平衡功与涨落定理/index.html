
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Course Notes and Code (Erwin Frey, LMU Munich, 2025)">
      
      
        <meta name="author" content="Zhihang Liu">
      
      
        <link rel="canonical" href="https://liu-zhihang.github.io/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/zh/notes/33.%20%E9%9D%9E%E5%B9%B3%E8%A1%A1%E5%8A%9F%E4%B8%8E%E6%B6%A8%E8%90%BD%E5%AE%9A%E7%90%86/">
      
      
        <link rel="prev" href="../32.%20Janssen-De%20Dominicis%20%E5%93%8D%E5%BA%94%E6%B3%9B%E5%87%BD%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%85%B3%E7%B3%BB/">
      
      
        <link rel="next" href="../34.%20%E6%9C%89%E5%90%91%E6%B8%97%E6%B5%81%E3%80%81%E5%90%B8%E6%94%B6%E6%80%81%E4%B8%8E%E8%B0%B1%E6%96%B9%E6%B3%95/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>33. 非平衡功与涨落定理 - Nonequilibrium Field Theories and Stochastic Dynamics</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Nonequilibrium Field Theories and Stochastic Dynamics" class="md-header__button md-logo" aria-label="Nonequilibrium Field Theories and Stochastic Dynamics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nonequilibrium Field Theories and Stochastic Dynamics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              33. 非平衡功与涨落定理
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/zh/" hreflang="zh" class="md-select__link">
              简体中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Liu-Zhihang/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Nonequilibrium Field Theories and Stochastic Dynamics" class="md-nav__button md-logo" aria-label="Nonequilibrium Field Theories and Stochastic Dynamics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Nonequilibrium Field Theories and Stochastic Dynamics
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Liu-Zhihang/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Course Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Course Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/1.%20Course%20Introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Course Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/2.%20Simple%20Random%20Walk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Simple Random Walk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/3.%20Gaussian%20Random%20Walk%20and%20Poisson%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. Gaussian Random Walk and Poisson Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/4.%20Gillespie%20Algorithm%2C%20Master%20Equation%2C%20Generating%20Functions%20and%20Population%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Gillespie Algorithm, Master Equation, Generating Functions and Population Dynamics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/5.%20Population%20Dynamics%20-%20Linear%20Death%20Process%20and%20Lotka-Volterra%20System/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. Population Dynamics - Linear Death Process and Lotka-Volterra System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/6.%20Fundamental%20Equations%20of%20Markov%20Processes%20%E2%80%94%20Chapman%E2%80%93Kolmogorov%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6. Fundamental Equations of Markov Processes — Chapman–Kolmogorov Equation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/7.%20Forward%20Master%20Equation%20and%20the%20Q%20Matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7. Forward Master Equation and the Q Matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/8.%20Perron%E2%80%93Frobenius%20Theorem%2C%20Steady%20States%2C%20and%20Detailed%20Balance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8. Perron–Frobenius Theorem, Steady States, and Detailed Balance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/9.%20Nonequilibrium%20States%20%E2%80%94%20Irreversibility%20and%20Entropy%20Production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    9. Nonequilibrium States — Irreversibility and Entropy Production
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/10.%20Ehrenfest%20Model%2C%20Entropy%2C%20and%20KL%20Divergence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10. Ehrenfest Model, Entropy, and KL Divergence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/11.%20Continuous%20Markov%20Processes%20and%20the%20Fokker%E2%80%93Planck%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11. Continuous Markov Processes and the Fokker–Planck Equation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/12.%20Brownian%20Motion%20and%20the%20Ornstein%E2%80%93Uhlenbeck%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    12. Brownian Motion and the Ornstein–Uhlenbeck Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/13.%20Monte%20Carlo%20Sampling%20as%20a%20Stochastic%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    13. Monte Carlo Sampling as a Stochastic Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/14.%20Hamiltonian%20Monte%20Carlo%20Sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    14. Hamiltonian Monte Carlo Sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/15.%20Chemotaxis%2C%20Run-and-Tumble%20Motion%2C%20and%20the%20Keller%E2%80%93Segel%20Model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15. Chemotaxis, Run-and-Tumble Motion, and the Keller–Segel Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/16.%20The%20Schnitzer%20Model%2C%20Anomalous%20Diffusion%2C%20and%20Motility%E2%80%91Induced%20Phase%20Separation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    16. The Schnitzer Model, Anomalous Diffusion, and Motility‑Induced Phase Separation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/17.%20Langevin%20Equation%2C%20Brownian%20Particle%2C%20and%20the%20Fluctuation%E2%80%93Dissipation%20Theorem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    17. Langevin Equation, Brownian Particle, and the Fluctuation–Dissipation Theorem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/18.%20Fokker%E2%80%93Planck%20Equation%20and%20the%20Smoluchowski%20Equation%20%E2%80%94%20From%20Random%20Trajectories%20to%20Probability%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    18. Fokker–Planck Equation and the Smoluchowski Equation — From Random Trajectories to Probability Dynamics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/19.%20Path%20Integral%20Formulation%20of%20Stochastic%20Processes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    19. Path Integral Formulation of Stochastic Processes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/20.%20Stochastic%20Differential%20Equations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20. Stochastic Differential Equations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    中文笔记
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            中文笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    首页
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20%E8%AF%BE%E7%A8%8B%E5%AF%BC%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. 课程导论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.%20%E7%AE%80%E5%8D%95%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. 简单随机游走
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.%20%E9%AB%98%E6%96%AF%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E4%B8%8E%E6%B3%8A%E6%9D%BE%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. 高斯随机游走与泊松过程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.%20Gillespie%20%E7%AE%97%E6%B3%95%E3%80%81%E4%B8%BB%E6%96%B9%E7%A8%8B%E3%80%81%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E4%B8%8E%E7%A7%8D%E7%BE%A4%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Gillespie 算法、主方程、生成函数与种群动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.%20%E7%A7%8D%E7%BE%A4%E5%8A%A8%E6%80%81%E5%AD%A6%EF%BC%9A%E7%BA%BF%E6%80%A7%E6%AD%BB%E4%BA%A1%E8%BF%87%E7%A8%8B%E4%B8%8ELotka-Volterra%20%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. 种群动态学：线性死亡过程与Lotka-Volterra 系统
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.%20%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%96%B9%E7%A8%8B%EF%BC%9A%E6%9F%A5%E6%99%AE%E6%9B%BC-%E7%A7%91%E5%B0%94%E8%8E%AB%E6%88%88%E7%BD%97%E5%A4%AB%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6. 马尔可夫过程的基本方程：查普曼-科尔莫戈罗夫方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.%20%E5%89%8D%E5%90%91%E4%B8%BB%E6%96%B9%E7%A8%8B%E4%B8%8EQ%E7%9F%A9%E9%98%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7. 前向主方程与Q矩阵
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8.%20%E4%BD%A9%E9%BE%99-%E5%BC%97%E7%BD%97%E8%B4%9D%E5%B0%BC%E4%B9%8C%E6%96%AF%E5%AE%9A%E7%90%86%E3%80%81%E7%A8%B3%E6%80%81%E4%B8%8E%E7%BB%86%E8%87%B4%E5%B9%B3%E8%A1%A1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8. 佩龙-弗罗贝尼乌斯定理、稳态与细致平衡
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9.%20%E9%9D%9E%E5%B9%B3%E8%A1%A1%E6%80%81%EF%BC%9A%E4%B8%8D%E5%8F%AF%E9%80%86%E6%80%A7%E4%B8%8E%E7%86%B5%E4%BA%A7%E7%94%9F%E7%9A%84%E6%8E%A8%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    9. 非平衡态：不可逆性与熵产生的推论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10.%20%E5%9F%83%E4%BC%A6%E8%B4%B9%E6%96%AF%E7%89%B9%E6%A8%A1%E5%9E%8B%E3%80%81%E7%86%B5%E4%B8%8EKL%E6%95%A3%E5%BA%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10. 埃伦费斯特模型、熵与KL散度
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11.%20%E8%BF%9E%E7%BB%AD%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E4%B8%8E%E7%A6%8F%E5%85%8B-%E6%99%AE%E6%9C%97%E5%85%8B%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11. 连续马尔可夫过程与福克-普朗克方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12.%20%E5%B8%83%E6%9C%97%E8%BF%90%E5%8A%A8%E4%B8%8E%E5%A5%A5%E6%81%A9%E6%96%AF%E5%9D%A6-%E4%B9%8C%E4%BC%A6%E8%B4%9D%E5%85%8B%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    12. 布朗运动与奥恩斯坦-乌伦贝克过程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13.%20%E4%BD%9C%E4%B8%BA%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E9%87%87%E6%A0%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    13. 作为随机过程的蒙特卡洛采样
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14.%20%E5%93%88%E5%AF%86%E5%B0%94%E9%A1%BF%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E9%87%87%E6%A0%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    14. 哈密尔顿蒙特卡洛采样
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15.%20%E8%B6%8B%E5%8C%96%E6%80%A7%E3%80%81%E8%B7%91%E5%8A%A8-%E7%BF%BB%E6%BB%9A%E8%BF%90%E5%8A%A8%E4%B8%8EKeller-Segel%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15. 趋化性、跑动-翻滚运动与Keller-Segel模型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../16.%20Schnitzer%E6%A8%A1%E5%9E%8B%E3%80%81%E5%8F%8D%E5%B8%B8%E6%89%A9%E6%95%A3%E4%B8%8E%E8%BF%90%E5%8A%A8%E8%AF%B1%E5%AF%BC%E7%9B%B8%E5%88%86%E7%A6%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    16. Schnitzer模型、反常扩散与运动诱导相分离
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../17.%20%E6%9C%97%E4%B9%8B%E4%B8%87%E6%96%B9%E7%A8%8B%E3%80%81%E5%B8%83%E6%9C%97%E7%B2%92%E5%AD%90%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    17. 朗之万方程、布朗粒子与涨落-耗散定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18.%20%E7%A6%8F%E5%85%8B-%E6%99%AE%E6%9C%97%E5%85%8B%E6%96%B9%E7%A8%8B%E4%B8%8E%E6%96%AF%E6%91%A9%E6%A3%B1%E9%9C%8D%E5%A4%AB%E6%96%AF%E5%9F%BA%E6%96%B9%E7%A8%8B%EF%BC%9A%E4%BB%8E%E9%9A%8F%E6%9C%BA%E8%BD%A8%E8%BF%B9%E5%88%B0%E6%A6%82%E7%8E%87%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    18. 福克-普朗克方程与斯摩棱霍夫斯基方程：从随机轨迹到概率动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19.%20%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E8%A1%A8%E8%BF%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    19. 随机过程的路径积分表述
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.%20%E9%9A%8F%E6%9C%BA%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20. 随机微分方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.%20%E4%BC%8A%E8%97%A4%E7%A7%AF%E5%88%86%E4%B8%8E%E7%BB%9F%E4%B8%80%E7%9A%84%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    21. 伊藤积分与统一的随机过程框架
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.%20%E5%90%AB%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    22. 含乘性噪声系统的路径积分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.%20%E4%BB%8E%E7%B2%97%E7%B2%92%E5%8C%96%E5%88%B0%E8%BF%9E%E7%BB%AD%E5%9C%BA%E8%AE%BA%E6%B6%A8%E8%90%BD%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    23. 从粗粒化到连续场论涨落动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.%20%E6%98%82%E8%90%A8%E6%A0%BC%E7%B3%BB%E6%95%B0%E3%80%81%E5%80%92%E6%98%93%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%8A%A8%E6%80%81%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    24. 昂萨格系数、倒易关系与动态涨落-耗散定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../25.%20%E6%A2%AF%E5%BA%A6%E5%8A%A8%E5%8A%9B%E5%AD%A6%E3%80%81%E7%9B%B8%E5%8F%98%E4%B8%8E%E5%BC%9B%E8%B1%AB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    25. 梯度动力学、相变与弛豫
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../26.%20%E4%B8%B4%E7%95%8C%E6%85%A2%E5%8C%96%E3%80%81%E5%8A%A8%E6%80%81%E5%93%8D%E5%BA%94%E4%B8%8E%E5%AE%88%E6%81%92%E5%BE%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    26. 临界慢化、动态响应与守恒律
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../27.%20%E7%AE%80%E5%8D%95%E6%B5%81%E4%BD%93%E3%80%81%E6%97%A0%E6%91%A9%E6%93%A6%E6%B5%81%E4%BD%93%E4%B8%8E%E6%AC%A7%E6%8B%89%E6%96%B9%E7%A8%8B%E7%9A%84%E6%B5%81%E4%BD%93%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    27. 简单流体、无摩擦流体与欧拉方程的流体动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../28.%20%E7%B2%98%E6%80%A7%E6%B5%81%E4%BD%93%E3%80%81%E7%BA%B3%E7%BB%B4-%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E6%96%B9%E7%A8%8B%E3%80%81%E7%86%B5%E5%B9%B3%E8%A1%A1%E4%B8%8E%E7%83%AD%E4%BC%A0%E5%AF%BC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    28. 粘性流体、纳维-斯托克斯方程、熵平衡与热传导
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../29.%20%E4%B8%8D%E5%8F%AF%E9%80%86%E7%BA%BF%E6%80%A7%E7%83%AD%E5%8A%9B%E5%AD%A6%E4%B8%8E%E5%B9%B2%E6%80%A7%E6%89%A9%E6%95%A3%E7%B2%92%E5%AD%90%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    29. 不可逆线性热力学与干性扩散粒子系统
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../30.%20%E6%82%AC%E6%B5%AE%E5%9C%A8%E6%B5%81%E4%BD%93%E4%B8%AD%E7%9A%84%E5%B8%83%E6%9C%97%E7%B2%92%E5%AD%90%20%E2%80%94%20H%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    30. 悬浮在流体中的布朗粒子 — H模型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../31.%20%E5%8A%A8%E6%80%81%E6%B3%9B%E5%87%BD%E3%80%81%E5%8A%A0%E6%80%A7%E5%99%AA%E5%A3%B0%E5%9C%BA%E8%AE%BA%E4%B8%8EOnsager-Machlup%E6%B3%9B%E5%87%BD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    31. 动态泛函、加性噪声场论与Onsager-Machlup泛函
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../32.%20Janssen-De%20Dominicis%20%E5%93%8D%E5%BA%94%E6%B3%9B%E5%87%BD%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%85%B3%E7%B3%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    32. Janssen-De Dominicis 响应泛函与涨落-耗散关系
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    33. 非平衡功与涨落定理
    
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../34.%20%E6%9C%89%E5%90%91%E6%B8%97%E6%B5%81%E3%80%81%E5%90%B8%E6%94%B6%E6%80%81%E4%B8%8E%E8%B0%B1%E6%96%B9%E6%B3%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    34. 有向渗流、吸收态与谱方法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../35.%20%E4%B8%BB%E6%96%B9%E7%A8%8B%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E8%A1%A8%E7%A4%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    35. 主方程的路径积分表示
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../36.%20%E7%9B%B8%E5%B9%B2%E6%80%81%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E3%80%81%E7%AE%97%E7%AC%A6%E4%BB%A3%E6%95%B0%E4%B8%8E%E8%99%9A%E5%99%AA%E5%A3%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    36. 相干态路径积分、算符代数与虚噪声
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../37.%20Kramers-Moyal%20%E5%B1%95%E5%BC%80%E4%B8%8E%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E7%9A%84%E4%BD%8E%E5%99%AA%E5%A3%B0%E6%9E%81%E9%99%90/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    37. Kramers-Moyal 展开与路径积分的低噪声极限
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../38.%20%E5%A4%9A%E7%89%A9%E7%A7%8D%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E4%B8%8E%E5%BE%AA%E7%8E%AF%E7%AB%9E%E4%BA%89%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    38. 多物种路径积分与循环竞争动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../39.%20%E4%BB%8E%E7%B2%92%E5%AD%90%E8%B7%B3%E8%B7%83%E5%88%B0%E8%BF%9E%E7%BB%AD%E5%9C%BA%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    39. 从粒子跳跃到连续场论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../40.%20%E7%BB%9F%E4%B8%80%E7%9A%84%E5%9C%BA%E8%AE%BA%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    40. 统一的场论框架
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="_1">引言：从被动响应到主动驱动——开启非平衡世界的大门<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>前面讲座探讨的核心是<strong>近热平衡的系统</strong>。特别是<strong>第32讲</strong>，课程构建了强大的 <strong>Janssen-De Dominicis (JDD) 路径积分形式体系</strong>，并从中推导出了近平衡统计物理学的基石——<strong>涨落-耗散关系 (Fluctuation-Dissipation Theorem, FDT)</strong>。FDT 提供了一个深刻的见解：系统对微小外部扰动的<strong>被动线性响应</strong>，完全由其在平衡态下的<strong>自发涨落</strong>行为所决定。这一关系深刻地依赖于系统在平衡态下的<strong>时间反演对称性</strong>。</p>
<p>然而，JDD 形式体系和 FDT 的辉煌也限定了其疆域。当目光从实验室的理想条件投向更广阔的真实世界——从细胞内分子马达的持续运转，到实验中被激光快速拖拽的胶体颗粒，再到任何在<strong>有限时间内</strong>经历显著外部参数变化的系统——所面对的将是远离平衡的、具有内在<strong>不可逆性</strong>的复杂过程。对于这些过程，经典热力-学只能给出不完整的描述，通常以不等式的形式出现，例如，非平衡功的平均值总是大于或等于系统平衡自由能的变化量（<span class="arithmatex">\(\langle W \rangle \geq \Delta F\)</span>）。</p>
<p>这节课标志着课程又一个至关重要的<strong>视角转变</strong>：研究将从系统对微小扰动的<strong>被动响应</strong> ，转向分析系统在外部<strong>协议 (protocol)主动、任意</strong>驱动下的非平衡动力学。核心问题是：对于这些远离平衡的、本质上是随机的过程，是否存在能够超越经典不等式的、普适的、<strong>精确的等式关系</strong>，从而为这些过程提供根本性的约束？</p>
<p>答案是肯定的，而关键的突破在于<strong>改变观察尺度</strong>。关注点不再仅仅是功或熵产生等热力学量的<strong>平均值</strong>，而是转向研究由系统无数条<strong>随机轨迹 (stochastic trajectories)</strong> 所产生的这些量的<strong>完整概率分布</strong>。通过分析涨落的全部统计信息，可以从看似混乱的非平衡过程中，精确地“蒸馏”出隐藏的平衡态信息。</p>
<p>这节课将聚焦于推导和理解两个核心的<strong>涨落定理 (Fluctuation Theorems, FTs)</strong>：<strong>Jarzynski 等式 (Jarzynski’s Work Relation)</strong> 和 <strong>Crooks 涨落定理 (Crooks' Fluctuation Theorem)</strong> 。这些定理不仅是近年来非平衡统计物理最重大的突破之一，更是构成了<strong>随机热力学 (Stochastic Thermodynamics)</strong> 这门新兴学科的理论基石。</p>
<h1 id="1-fdt">1. 回顾：涨落-耗散关系 (FDT)<a class="headerlink" href="#1-fdt" title="Permanent link">&para;</a></h1>
<p>为了更好地理解即将到来的非平衡涨落定理，有必要首先回顾描述<strong>近平衡系统</strong>动力学的核心场论工具——<strong>Janssen-De Dominicis (J-D) 作用量</strong>，以及它如何系统性地导出了涨落-耗散关系。</p>
<p>在统计场论的框架下，一个随机过程的所有可能轨迹的统计权重，可以通过一个作用量泛函来描述。J-D 作用量正是为具有加性高斯噪声的随机动力学系统构建的这样一个作用量：</p>
<div class="arithmatex">\[S[\phi, \tilde{\phi}] = \int_{x,t} \left[ \tilde{\phi}_\alpha (\dot{\phi}_\alpha - A_\alpha[\phi]) - \frac{1}{2} \tilde{\phi}_\alpha N_{\alpha\beta} \tilde{\phi}_\beta \right]\]</div>
<p>这里的 <span class="arithmatex">\(\phi(\vec{x},t)\)</span> 是描述系统状态的物理场（例如，粒子浓度场），而 <span class="arithmatex">\(\tilde{\phi}(\vec{x},t)\)</span> 是一个辅助的<strong>响应场 (response field)</strong> 。这个作用量优雅地将系统的全部动力学信息编码于一身：</p>
<p><strong>动力学约束项 <span class="arithmatex">\(\tilde{\phi}_\alpha (\dot{\phi}_\alpha - A_\alpha[\phi])\)</span></strong> ：这一项源于对朗之万方程的严格执行。在路径积分中，响应场 <span class="arithmatex">\(\tilde{\phi}\)</span> 扮演了拉格朗日乘子的角色，它通过在所有路径上求和，强制要求只有满足确定性运动方程（<span class="arithmatex">\(\dot{\phi}_\alpha = A_\alpha[\phi]\)</span>）的轨迹才会有显著的贡献。</p>
<p><strong>噪声贡献项 <span class="arithmatex">\(-\frac{1}{2} \tilde{\phi}_\alpha N_{\alpha\beta} \tilde{\phi}_\beta\)</span></strong> ：这一项则来源于对高斯白噪声的平均。<span class="arithmatex">\(N_{\alpha\beta}\)</span> 是噪声关联矩阵 <span class="arithmatex">\(\langle \xi_\alpha(x,t)\xi_\beta(x',t') \rangle = N_{\alpha\beta}\delta(x-x')\delta(t-t')\)</span> 的核心，该项的二次型形式将噪声的统计特性永久地“烙印”在了有效作用量中。</p>
<p>通过对这个作用量泛函进行路径积分，可以计算出任意可观测量。其中，两个核心的物理量是响应函数和关联函数。</p>
<ol>
<li>
<p><strong>响应函数 (Response Function) <span class="arithmatex">\(\chi_{\alpha\beta}(x,t;x',t')\)</span></strong> ：它描述了系统在 <span class="arithmatex">\((x,t)\)</span> 处的场分量 <span class="arithmatex">\(\langle \phi_\alpha \rangle\)</span> 如何响应在另一时空点 <span class="arithmatex">\((x',t')\)</span> 施加的一个微小外部扰动场 <span class="arithmatex">\(h_\beta\)</span>。在J-D形式体系下，它被精确地表达为物理场与响应场的关联函数：</p>
<div class="arithmatex">\[\chi_{\alpha\beta}(x,t;x',t') = \left.\frac{\delta \langle \phi_\alpha(x,t) \rangle}{\delta h_\beta(x',t')} \right|_{h \to 0} = L \langle \phi_\alpha(x,t) \tilde{\phi}_\beta(x',t') \rangle\]</div>
</li>
<li>
<p><strong>关联函数 (Correlation Function) <span class="arithmatex">\(C_{\alpha\beta}(x,t;x',t')\)</span></strong>：它描述了系统在没有任何外部扰动的情况下，其<strong>自发涨落</strong>在不同时空点之间的统计关联程度 ：</p>
<div class="arithmatex">\[C_{\alpha\beta}(x,t;x',t') = \langle \phi_\alpha(x,t) \phi_\beta(x',t') \rangle\]</div>
</li>
</ol>
<p>推导 FDT 的关键，在于利用系统在<strong>热平衡态</strong>下所满足的<strong>时间反演对称性</strong>。正如在第31讲和第32讲中展示的，这一基本对称性对J-D作用量施加了强有力的约束，最终要求噪声强度 <span class="arithmatex">\(N\)</span> 和耗散系数 <span class="arithmatex">\(L\)</span> 必须满足<strong>爱因斯坦-昂萨格关系</strong>（<span class="arithmatex">\(N=2LT\)</span>）。这个内置的对称性最终导致响应函数和关联函数之间存在一个精确的关系：</p>
<div class="arithmatex">\[\chi(\tau) = -\frac{1}{k_B T} \Theta(\tau) \frac{dC}{d\tau}(\tau)\]</div>
<p>其中 <span class="arithmatex">\(\tau = t-t'\)</span>，<span class="arithmatex">\(\Theta(\tau)\)</span> 是亥维赛阶跃函数，体现了<strong>因果性</strong>（响应不能发生在扰动之前）。这个关系式就是<strong>涨落-耗散定理</strong>。它深刻地揭示了：一个系统抵抗外部扰动而<strong>耗散</strong>能量的能力（由 <span class="arithmatex">\(\chi\)</span> 体现），与其内部自发的、热驱动的<strong>涨落</strong>（由 <span class="arithmatex">\(C\)</span> 体现）是同一个微观物理本质的两个侧面。</p>
<p>这个推导过程不仅为 FDT 提供了一个严格的场论证明，更重要的是，它展示了<strong>时间反演对称性</strong>在连接系统“响应”和“涨落”中的核心作用。正是这一思想，将被推广到远离平衡的系统中，成为推导非平衡涨落定理的基石。</p>
<h1 id="2">2. 非平衡驱动系统与外部协议<a class="headerlink" href="#2" title="Permanent link">&para;</a></h1>
<p>上一节回顾的涨落-耗散关系 (FDT) 描述了系统对微小扰动的<strong>被动响应</strong>。现在，将注意力从这种近平衡的线性行为，转向一个被<strong>主动、任意地驱动远离平衡</strong>的系统。这里的核心转变在于，外部参数不再是微小的探针，而是一个随时间显著变化的、预先设定的控制程序。</p>
<h2 id="21">2.1 系统的描述：自由能泛函<a class="headerlink" href="#21" title="Permanent link">&para;</a></h2>
<p>考虑一个由场变量 <span class="arithmatex">\(\vec{\phi}\)</span> 描述的系统，其在给定外部场 <span class="arithmatex">\(\vec{h}\)</span> 下的平衡态性质由一个<strong>自由能泛函 <span class="arithmatex">\(F[\vec{\phi}]\)</span></strong> 给出。其形式与在第25讲中探讨的金兹堡-朗道理论一致：</p>
<div class="arithmatex">\[F[\vec{\phi}] = \int d^dx \left( f(\vec{\phi}) + \frac{c}{2} (\vec{\nabla} \vec{\phi})^2 - \vec{h} \cdot \vec{\phi} \right)\]</div>
<p>这个泛函的每一项都有清晰的物理意义：</p>
<p><strong>局域自由能密度 <span class="arithmatex">\(f(\vec{\phi})\)</span></strong> ：包含了局域的熵贡献和粒子间的平均场相互作用，决定了系统的基本相行为。</p>
<p><strong>梯度能量项 <span class="arithmatex">\(\frac{c}{2} (\vec{\nabla} \vec{\phi})^2\)</span></strong> ：它对空间非均匀性施加能量惩罚，是界面张力的微观来源。</p>
<p><strong>耦合项 <span class="arithmatex">\(-\vec{h} \cdot \vec{\phi}\)</span></strong> ：这是外部世界与系统相互作用的“把手”。正是通过改变外部场 <span class="arithmatex">\(\vec{h}\)</span>，才能够对系统施加影响并做功。</p>
<h2 id="22">2.2 驱动过程的设定<a class="headerlink" href="#22" title="Permanent link">&para;</a></h2>
<p>一个典型的非平衡驱动实验或模拟，其设定如下：</p>
<ol>
<li>
<p><strong>初始状态</strong> ：在 <span class="arithmatex">\(t=0\)</span> 时刻，系统与一个初始外部场 <span class="arithmatex">\(\vec{h}(0)\)</span> 完全达到热平衡。这意味着，系统初始构型 <span class="arithmatex">\(\vec{\phi}_0\)</span> 的概率分布由玻尔兹曼因子给出：</p>
<div class="arithmatex">\[P_0[\vec{\phi}_0] = \frac{1}{Z_0(T)} \exp \left[ -\beta F_0[\vec{\phi}_0] \right]\]</div>
<p>其中 <span class="arithmatex">\(\beta = 1/T\)</span> (设玻尔兹曼常数 <span class="arithmatex">\(k_B=1\)</span>)，<span class="arithmatex">\(F_0\)</span> 是对应于初始外场 <span class="arithmatex">\(\vec{h}(0)\)</span> 的自由能泛函，而 <span class="arithmatex">\(Z_0(T)\)</span> 是相应的配分函数。从一个精确定义的平衡态出发，是所有涨落定理的逻辑起点。</p>
</li>
<li>
<p><strong>驱动过程</strong> ：在 <span class="arithmatex">\(t=0\)</span> 到 <span class="arithmatex">\(t=t_f\)</span> 的时间段内，外部场 <span class="arithmatex">\(\vec{h}(t)\)</span> 按照一个预先设定的、确定性的时间函数进行演化。这个函数 <span class="arithmatex">\(\vec{h}(t)\)</span> 被称为<strong>外部协议 (external protocol)</strong> 。如下图所示，协议将系统从一个初始平衡态，经过一系列非平衡态，最终驱动到一个通常也是非平衡的末态。</p>
</li>
</ol>
<p><img alt="协议示意图，课堂板书截图" src="../../../assets/images/remote/d7894a2b-a42e-478b-8c51-2a1a648efeb5-9d8504a6cd.png" />
图示：一个外部协议的例子。外部场<span class="arithmatex">\(h(t)\)</span>在<span class="arithmatex">\(t=0\)</span>之前为常数，在<span class="arithmatex">\(0\)</span>到<span class="arithmatex">\(t_f\)</span>之间按某一函数变化，在<span class="arithmatex">\(t_f\)</span>之后再次变为常数。</p>
<ul>
<li><strong>初始平衡态</strong>：在 <span class="arithmatex">\(t&lt;0\)</span> 的时间里，外部场 <span class="arithmatex">\(h=0\)</span> 且保持不变，系统处于初始的平衡状态中。</li>
<li><strong>驱动过程</strong>：在 <span class="arithmatex">\(t=0\)</span> 到 <span class="arithmatex">\(t=t_f\)</span> 这个有限的时间区间内，外部场 <span class="arithmatex">\(h(t)\)</span> 按照一个预先设定的（通常是任意的）函数进行演化，将系统主动地带离平衡。</li>
<li><strong>末态</strong>：在 <span class="arithmatex">\(t&gt;t_f\)</span> 后，外部场达到最终值 <span class="arithmatex">\(h_f\)</span> 并再次保持不变，系统会开始向对应于 <span class="arithmatex">\(h_f\)</span> 的新平衡态弛豫。</li>
</ul>
<h2 id="23">2.3 不可逆性的根源：有限时间与弛豫<a class="headerlink" href="#23" title="Permanent link">&para;</a></h2>
<p>这个过程的不可逆性，其根源在于协议是在<strong>有限时间</strong> <span class="arithmatex">\(t_f\)</span> 内完成的。这里存在两种截然不同的极限：</p>
<ul>
<li>
<p><strong>准静态极限 (<span class="arithmatex">\(t_f \to \infty\)</span>)</strong> ：如果协议变化得无限缓慢，系统在每个瞬间都有足够的时间通过内部弛豫来适应外部场的微小改变。因此，系统始终保持在与瞬时外场 <span class="arithmatex">\(\vec{h}(t)\)</span> 相对应的平衡态。这样的过程是<strong>可逆的 (reversible)</strong> ，外界所做的功恰好等于系统始末平衡态之间的自由能差 <span class="arithmatex">\(\Delta F\)</span>。这是经典热力学的理想疆域。</p>
</li>
<li>
<p><strong>有限时间过程 (<span class="arithmatex">\(t_f &lt; \infty\)</span>)</strong> ：对于任何有限的驱动时间，系统内部的弛豫（由动力学系数 <span class="arithmatex">\(L\)</span> 等决定）需要时间。因此，系统状态的演化总是会<strong>滞后 (lag)</strong> 于外部场的改变。系统的概率分布 <span class="arithmatex">\(P(\vec{\phi},t)\)</span> 将不再是对应于瞬时外场 <span class="arithmatex">\(\vec{h}(t)\)</span> 的平衡分布。正是这种滞后，导致了能量的<strong>耗散 (dissipation)</strong> ，通常以热的形式散发到环境中。</p>
</li>
</ul>
<p>因此，外部施加的功的平均值将严格大于自由能的变化，即 <span class="arithmatex">\(\langle W \rangle &gt; \Delta F\)</span>。这个差值，<span class="arithmatex">\(\langle W_{diss} \rangle = \langle W \rangle - \Delta F\)</span>，就是平均<strong>耗散功 (dissipated work)</strong> ，它量化了过程的不可逆程度。</p>
<p>涨落定理的精髓在于，它不仅关注这个平均行为，而是精确地刻画了由无数条随机轨迹所产生的<strong>功的完整概率分布 <span class="arithmatex">\(P(W)\)</span></strong> 。接下来的任务，就是为这个在单条轨迹上所做的、随机的非平衡功给出一个精确的定义。</p>
<h1 id="3">3. 非平衡功：定义与路径积分计算<a class="headerlink" href="#3" title="Permanent link">&para;</a></h1>
<p>为了建立涨落定理，首先必须为“功”在随机、非平衡过程中给出一个精确的物理定义。与宏观热力学中功是一个确定值不同，在随机热力学中，功是在<strong>单条随机轨迹</strong>上定义的、一个依赖于路径的<strong>随机变量</strong> 。</p>
<h2 id="31-jarzynski">3.1 Jarzynski 功的定义<a class="headerlink" href="#31-jarzynski" title="Permanent link">&para;</a></h2>
<p>这个定义源于经典力学和热力学的基本思想：对系统做的功，等于系统能量因外部控制参数变化而产生的改变。对于一个由外部场 <span class="arithmatex">\(\vec{h}(t)\)</span> 驱动的系统，其自由能泛函 <span class="arithmatex">\(F[\vec{\phi}]\)</span> 会随时间显式地变化。在微小时间间隔 <span class="arithmatex">\(dt\)</span> 内，外部施动者对系统做的微功 <span class="arithmatex">\(dW_J\)</span> 就是 <span class="arithmatex">\(F[\vec{\phi}]\)</span> 由于外部参数 <span class="arithmatex">\(\vec{h}\)</span> 的变化而产生的改变。这类似于经典热力学中的 <span class="arithmatex">\(dW = (\partial E / \partial \lambda) d\lambda\)</span>。在场论的语言中，这表现为：</p>
<div class="arithmatex">\[dW_J = \left( \frac{\partial F[\vec{\phi}(t)]}{\partial t} \right)_{\vec{\phi} \text{ fixed}} dt\]</div>
<p>这里的偏导数 <span class="arithmatex">\(\partial/\partial t\)</span> 仅作用于自由能泛函中<strong>显式依赖时间</strong>的外部场 <span class="arithmatex">\(\vec{h}(t)\)</span>，而保持瞬时场构型 <span class="arithmatex">\(\vec{\phi}(t)\)</span> 不变。利用在第2节中给出的自由能泛函形式 <span class="arithmatex">\(F \propto -\int d^dx (\vec{h} \cdot \vec{\phi})\)</span>，可以得到 <span class="arithmatex">\(\delta F / \delta \vec{h} = -\vec{\phi}\)</span>。因此，在整个协议期间（从 <span class="arithmatex">\(t=0\)</span> 到 <span class="arithmatex">\(t=t_f\)</span>）对系统所做的总功，即 <strong>Jarzynski 功</strong> <span class="arithmatex">\(W_J[\vec{\phi}]\)</span>，便是沿着一条具体的轨迹 <span class="arithmatex">\(\vec{\phi}(t)\)</span> 对微功进行积分的结果：</p>
<div class="arithmatex">\[W_J[\vec{\phi}] := \int_0^{t_f} dt \, \frac{\partial F[\vec{\phi}]}{\partial t} = -\int_0^{t_f} dt \int d^dx \, \vec{\phi}(\vec{x},t) \cdot \frac{\partial \vec{h}(\vec{x},t)}{\partial t}\]</div>
<p>这个定义深刻地揭示了非平衡功的物理本质：</p>
<ul>
<li>
<p><strong>功是随机的</strong>：<span class="arithmatex">\(W_J\)</span> 是一个<strong>泛函</strong> ，它的值取决于系统所经历的具体微观路径 <span class="arithmatex">\(\vec{\phi}(\vec{x},t)\)</span>。由于系统的演化受到热噪声的影响是随机的，不同的轨迹会产生不同的功值。因此，功本身是一个随机变量，具有一个概率分布 <span class="arithmatex">\(P(W_J)\)</span>。</p>
</li>
<li>
<p><strong>功的来源</strong> ：功是系统状态场 <span class="arithmatex">\(\vec{\phi}(t)\)</span> 与<strong>外部协议变化率</strong> <span class="arithmatex">\(\partial \vec{h} / \partial t\)</span> 耦合的直接结果。如果协议不随时间变化（<span class="arithmatex">\(\partial \vec{h}/\partial t = 0\)</span>），则外界对系统不做功。</p>
</li>
</ul>
<h2 id="32">3.2 路径积分下的系综平均<a class="headerlink" href="#32" title="Permanent link">&para;</a></h2>
<p>为了计算任意可观测量 <span class="arithmatex">\(O[\vec{\phi}]\)</span>（例如功本身 <span class="arithmatex">\(W_J\)</span>，或其指数函数 <span class="arithmatex">\(e^{-\beta W_J}\)</span>）的系综平均值，需要在第2节定义的非平衡驱动实验的整个路径系综上进行平均。这个平均过程在路径积分形式下，可以被系统性地分解为三个层次的积分：</p>
<div class="arithmatex">\[\langle O[\vec{\phi}] \rangle = \int \mathcal{D}[\vec{\phi}_0] \underbrace{P_0[\vec{\phi}_0]}_{\text{初始态权重}} \int \mathcal{D}[\vec{\phi}_f] \int_{\vec{\phi}(0)=\vec{\phi}_0}^{\vec{\phi}(t_f)=\vec{\phi}_f} \underbrace{\mathcal{D}[\vec{\phi}, \tilde{\phi}] \exp(-S[\tilde{\phi}, \vec{\phi}])}_{\text{路径权重}} O[\vec{\phi}]\]</div>
<p>注意：为与课程板书保持一致，这里的响应场积分测度为 <span class="arithmatex">\(\mathcal{D}[\tilde{\phi}]\)</span>，对应于 Wick 旋转后的实数作用量。</p>
<p>这个看似复杂的表达式，实际上是对非平衡过程的一个精确的、分步式的数学模拟：</p>
<ol>
<li>
<p><strong>初始态平均 (Initial State Averaging)</strong> ：积分 <span class="arithmatex">\(\int \mathcal{D}[\vec{\phi}_0] P_0[\vec{\phi}_0] \dots\)</span> 对应于实验的第一步：从初始的平衡系综中，按照玻尔兹曼概率 <span class="arithmatex">\(P_0[\vec{\phi}_0] = \frac{1}{Z_0} e^{-\beta F_0[\vec{\phi}_0]}\)</span> 随机“抽取”一个初始构型 <span class="arithmatex">\(\vec{\phi}_0\)</span>。</p>
</li>
<li>
<p><strong>路径平均 (Path Averaging)</strong> ：对于每一个给定的初始构型 <span class="arithmatex">\(\vec{\phi}_0\)</span> 和最终构型 <span class="arithmatex">\(\vec{\phi}_f\)</span>，内层的积分 <span class="arithmatex">\(\int \mathcal{D}[\vec{\phi}, \tilde{\phi}] \exp(-S) \dots\)</span> 则是对所有可能连接这两点的、遵循随机动力学的历史路径进行求和。每条路径的统计权重由 <strong>J-D 作用量</strong> <span class="arithmatex">\(e^{-S[\tilde{\phi}, \vec{\phi}]}\)</span> 给出，该作用量已经将朗之万方程的动力学约束和噪声统计特性完全编码在内。</p>
</li>
<li>
<p><strong>末态求和 (Summing over Final States)</strong> ：最外层的积分 <span class="arithmatex">\(\int \mathcal{D}[\vec{\phi}_f] \dots\)</span> 则是对所有可能的最终构型进行求和，因为在非平衡过程中，即使从同一个初始态出发，不同的随机轨迹也会到达不同的末态。</p>
</li>
</ol>
<p>这个表达式是推导所有涨落定理的坚实数学基础。它将一个非平衡过程的宏观统计平均，精确地分解为了对初始平衡态的抽样和对随机动力学路径的求和。接下来的任务，就是通过对这个路径积分表达式进行一系列巧妙的对称性变换，来揭示隐藏在其中的普适规律。</p>
<h1 id="4">4. 涨落定理的路径积分推导<a class="headerlink" href="#4" title="Permanent link">&para;</a></h1>
<p>本节是讲座的数学核心，将详细展示如何通过对 J-D 路径积分作用量进行一系列精妙的变换，从而推导出连接非平衡功和平衡自由能的核心关系。整个推导过程的基石是作用量在<strong>时间反演</strong>下的内在对称性，这正是微观可逆性在路径层面的深刻体现。</p>
<p>为清晰地展示推导，考虑一个由梯度下降主导的系统（如模型A），其漂移项为 <span class="arithmatex">\(A_\alpha = -L (\delta F / \delta \phi_\alpha)\)</span>。根据第32讲，其 J-D 作用量为：</p>
<div class="arithmatex">\[S[\tilde{\vec{\phi}}, \vec{\phi}] = \int_{\vec{x}, t} \left[ \tilde{\phi}_{\alpha} \left(\partial_t \phi_{\alpha} + L\frac{\delta F}{\delta \phi_{\alpha}} \right) - \frac{1}{2} \tilde{\phi}_{\alpha} N_{\alpha\beta} \tilde{\phi}_{\beta} \right]\]</div>
<p>根据涨落-耗散定理的要求，在平衡态下噪声强度与耗散系数满足<strong>爱因斯坦-昂萨格关系</strong> <span class="arithmatex">\(N_{\alpha\beta} = 2LT \delta_{\alpha\beta}\)</span>。</p>
<h2 id="1">步骤 1：响应场变量代换——分离热力学项<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<p><strong>物理动机</strong> ：第一步是一个纯粹的数学技巧，但其物理动机非常明确：<strong>重新组织作用量，将与热力学直接相关的量（自由能、功）从复杂的动力学项中显式地分离出来</strong> 。这个变换的设计，正是为了让最终结果能以一种清晰的热力学形式呈现。</p>
<p>定义新的响应场变量 <span class="arithmatex">\(\bar{\phi}_\alpha\)</span>：</p>
<div class="arithmatex">\[\bar{\phi}_\alpha(t) \equiv -\tilde{\phi}_\alpha(t) + \frac{1}{T} \frac{\delta F}{\delta \phi_\alpha(t)}\]</div>
<p>这个变换的雅可比行列式为1，因此路径积分的测度不变。将 <span class="arithmatex">\(\tilde{\phi}_\alpha(t) = -\bar{\phi}_\alpha(t) + \frac{1}{T} \frac{\delta F}{\delta \phi_\alpha(t)}\)</span> 代入作用量 <span class="arithmatex">\(S\)</span> 中，并利用 <span class="arithmatex">\(N=2LT\)</span>，经过一番代数运算，作用量可以被精确地分解为：</p>
<div class="arithmatex">\[S[\tilde{\vec{\phi}}, \vec{\phi}] = \int_{\vec{x}, t} \left[ \bar{\phi}_{\alpha} \left( -\partial_t \phi_{\alpha} + L\frac{\delta F}{\delta \phi_{\alpha}} - LT\bar{\phi}_{\alpha} \right) + \frac{1}{T}\frac{\delta F}{\delta \phi_{\alpha}} \partial_t \phi_{\alpha} \right]\]</div>
<p>这个形式中的最后一项 <span class="arithmatex">\(\frac{1}{T}\frac{\delta F}{\delta \phi_{\alpha}} \partial_t \phi_{\alpha}\)</span> 是分离热力学量的关键。利用泛函的链式法则，自由能 <span class="arithmatex">\(F[\vec{\phi}(t)]\)</span> 沿一条轨迹对时间的全导数为：</p>
<div class="arithmatex">\[\frac{dF[\vec{\phi}(t)]}{dt} = \int d^dx \frac{\delta F}{\delta \phi_\alpha}\frac{\partial \phi_\alpha}{\partial t} + \frac{\partial F}{\partial t}\]</div>
<p>这里：</p>
<ul>
<li>
<p><span class="arithmatex">\(\frac{dF}{dt}\)</span> 是沿着具体轨迹 <span class="arithmatex">\(\vec{\phi}(t)\)</span>，自由能的总变化率。</p>
</li>
<li>
<p>第一项 <span class="arithmatex">\(\int d^dx \dots\)</span> 是由于系统<strong>内部构型</strong> <span class="arithmatex">\(\vec{\phi}\)</span> 自身演化所导致的自由能变化。</p>
</li>
<li>
<p>第二项 <span class="arithmatex">\(\frac{\partial F}{\partial t}\)</span> 则是由于<strong>外部协议</strong> <span class="arithmatex">\(\vec{h}(t)\)</span> 改变了能量景观本身，所导致的自由能的显式时间依赖性。根据第3节的定义，这一项的积分正是 <strong>Jarzynski 功</strong> <span class="arithmatex">\(W_J[\vec{\phi}]\)</span>。</p>
</li>
</ul>
<p>因此，最后一项的积分可以精确地写为：</p>
<div class="arithmatex">\[
\frac{1}{T} \int_0^{t_f} dt \int d^dx \frac{\delta F}{\delta \phi_\alpha} \partial_t \phi_\alpha =\beta \int_0^{t_f} dt \left( \frac{dF[\vec{\phi}]}{dt} - \frac{\partial F[\vec{\phi}]}{\partial t} \right) = \beta \left( (F_f[\vec{\phi}_f] - F_0[\vec{\phi}_0]) - W_J[\vec{\phi}] \right)
\]</div>
<p><strong>物理意义</strong> ：这一步代数变换的深刻结果是，它将原来的路径权重因子 <span class="arithmatex">\(e^{-S}\)</span> 转换为了一个新的形式，其中包含了 <span class="arithmatex">\(e^{-\beta (F_f - F_0 - W_J)}\)</span> 这一核心的热力学部分。我们成功地在作用量层面“预提取”了最终结果中需要的物理量。</p>
<h2 id="2_1">步骤 2：时间反演变换——运用核心对称性<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h2>
<p><strong>物理动机</strong> ：第二步是整个推导的物理核心。通过对路径积分变量执行时间反演操作，来运用系统的<strong>微观可逆性</strong>这一基本对称性。其思想是比较“正向播放的电影”和“倒带播放的电影”的概率。</p>
<p>定义时间反演后的路径变量为：</p>
<div class="arithmatex">\[(\vec{\phi}^R(t), \bar{\vec{\phi}}^R(t)) \equiv (\vec{\phi}(t_f - t), \bar{\vec{\phi}}(t_f - t))\]</div>
<p>同时，外部协议也进行相应的时间反演，即<strong>反向协议 (reversed protocol)</strong> ：<span class="arithmatex">\(\vec{h}^R(t) = \vec{h}(t_f - t)\)</span>。现在考察作用量中的关键项在这个变换下的行为：</p>
<ul>
<li>
<p><strong>时间导数项</strong> ：如课程板书所示，<span class="arithmatex">\(\int dt \, \bar{\phi}_{\alpha} \partial_t \phi_{\alpha}\)</span> 这一项在时间反演下会反号。它代表了作用量中与时间演化方向直接相关的部分。</p>
</li>
<li>
<p><strong>功项</strong> ：需要在<strong>反向协议</strong> <span class="arithmatex">\(\vec{h}^R(t)\)</span> 下，计算沿着<strong>反向路径</strong> <span class="arithmatex">\(\vec{\phi}^R(t)\)</span> 所做的功，记为 <span class="arithmatex">\(W_J^R\)</span>。通过变量代换 <span class="arithmatex">\(\tau = t_f - t\)</span> 可以严格证明：</p>
<div class="arithmatex">\[W_J^R[\vec{\phi}^R] = -\int_0^{t_f} dt \int d^dx \, \vec{\phi}^R(\vec{x},t) \cdot \frac{\partial \vec{h}^R(\vec{x},t)}{\partial t} = - W_J[\vec{\phi}]\]</div>
<p><strong>物理意义</strong> ：这个结果的物理内涵是：在反向协议下沿反向路径所做的功，恰好是正向协议下沿正向路径所做功的相反数。</p>
</li>
</ul>
<p>经过这些变换，原来的作用量 <span class="arithmatex">\(S\)</span> 变成了一个新的作用量 <span class="arithmatex">\(S^R\)</span>，其形式与原作用量相似，但描述的是在反向协议下的动力学。</p>
<h2 id="3_1">步骤 3：整合结果——导出普适关系<a class="headerlink" href="#3_1" title="Permanent link">&para;</a></h2>
<p><strong>逻辑整合</strong> ：现在，将前两步的变换结果整合到可观测量 <span class="arithmatex">\(\langle O[\vec{\phi}] \rangle\)</span> 的路径积分表达式中。通过变量代换和利用路径积分测度的不变性（雅可比行列式为1），可以证明一个深刻的对偶关系：</p>
<div class="arithmatex">\[\langle O[\vec{\phi}] \rangle = \frac{Z_f(T)}{Z_0(T)} \langle \hat{O}[\vec{\phi}] e^{-\beta W_J^R[\vec{\phi}]} \rangle_R\]</div>
<ul>
<li>
<p><span class="arithmatex">\(\langle \dots \rangle_R\)</span> 表示在<strong>反向协议</strong>下，从末态 <span class="arithmatex">\(F_f\)</span> 对应的平衡系综开始的系综平均。</p>
</li>
<li>
<p><span class="arithmatex">\(\hat{O}[\vec{\phi}]\)</span> 是在时间反演路径上计算的可观测量。</p>
</li>
<li>
<p><span class="arithmatex">\(Z_f\)</span> 和 <span class="arithmatex">\(Z_0\)</span> 分别是与末态外场 <span class="arithmatex">\(\vec{h}(t_f)\)</span> 和初态外场 <span class="arithmatex">\(\vec{h}(0)\)</span> 对应的平衡配分函数。</p>
</li>
</ul>
<p>最后，利用自由能的定义 <span class="arithmatex">\(\Delta F = F_f - F_0 = -T \ln(Z_f / Z_0)\)</span>，以及步骤2中导出的关系 <span class="arithmatex">\(W_J^R = -W_J[\vec{\phi}]\)</span>，便得到了一个普适的涨落关系式：</p>
<div class="arithmatex">\[\langle O[\vec{\phi}] \rangle = e^{-\beta \Delta F} \langle \hat{O}[\vec{\phi}] e^{\beta W_J[\vec{\phi}]} \rangle_R\]</div>
<p><strong>物理意义</strong>：
这个结果是惊人的。它表明，一个在<strong>正向协议</strong>下测量的物理量的平均值（LHS），可以被精确地转化为一个在<strong>反向协议</strong>下、由一个指数功因子 <span class="arithmatex">\(e^{\beta W_J}\)</span> 加权的、对时间反演后的可观测量进行的平均（RHS）。</p>
<p>这个对偶关系是微观可逆性在非平衡过程中的直接体现。宏观上观察到的不可逆性（如 <span class="arithmatex">\(\langle W \rangle &gt; \Delta F\)</span>），并非源于物理定律本身不满足时间对称性，而是源于过程的<strong>边界条件不对称</strong>：从一个特定的平衡态开始，然后让时间向前演化。涨落定理正是对这种边界条件不对-称性所产生的统计后果的精确量化。</p>
<h1 id="5-jarzynski">5. Jarzynski 功关系<a class="headerlink" href="#5-jarzynski" title="Permanent link">&para;</a></h1>
<p>上一节推导出的普适涨落关系式，是连接正向与反向非平衡过程的一座普适桥梁。现在，将通过一个极为简洁而巧妙的选择，从这座桥梁中提取出第一个里程碑式的成果——<strong>Jarzynski 等式 (Jarzynski's Work Relation)</strong> 。</p>
<p><strong>Jarzynski 等式</strong>由物理学家 Christopher Jarzynski 在 <strong>1997 年</strong>提出。其深刻的<strong>物理本质</strong>在于，它在非平衡统计物理学和平衡态热力学之间建立了一座精确的桥梁。该等式指出，在一个将系统从一个平衡态驱动到另一个状态的任意非平衡过程中，对所做功 <span class="arithmatex">\(W\)</span> 的指数项进行的系综平均，精确地等于系统始末平衡态之间的自由能差 <span class="arithmatex">\(\Delta F\)</span> 所对应的玻尔兹曼因子，即 <span class="arithmatex">\(\langle e^{-\beta W} \rangle = e^{-\beta \Delta F}\)</span>。这一定理是对传统热力学第二定律不等式 (<span class="arithmatex">\(\langle W \rangle \ge \Delta F\)</span>) 的惊人强化，因为它将一个依赖于具体动力学路径的非平衡平均值，与一个只取决于平衡态的纯热力学量精确地联系起来。</p>
<p>在<strong>具体应用</strong>上，该等式具有革命性意义，它允许科学家通过快速、不可逆的计算机模拟或单分子实验（如用光镊拉伸RNA发夹或蛋白质）来精确计算平衡态的自由能差，这在传统准静态方法难以实现的生物物理和材料科学领域尤为重要。</p>
<h2 id="51">5.1 从普适关系到精确等式<a class="headerlink" href="#51" title="Permanent link">&para;</a></h2>
<p>回顾上一节的最终成果，即普适的对偶关系式：
<span class="arithmatex">\(<span class="arithmatex">\(\langle O[\vec{\phi}] \rangle = e^{-\beta \Delta F} \langle \hat{O}[\vec{\phi}] e^{\beta W_J[\vec{\phi}]} \rangle_R\)</span>\)</span>
这个关系对于任意的可观测量 <span class="arithmatex">\(O[\vec{\phi}]\)</span> 都成立。为了得到最简洁的关系，可以选择最简单的可观测量，即<strong>恒等算符 <span class="arithmatex">\(O[\vec{\phi}] = 1\)</span></strong> 。</p>
<p>将这个选择代入普适关系中：</p>
<ul>
<li>
<p>在等式左边，由于概率归一化，任何量的平均值 <span class="arithmatex">\(\langle 1 \rangle\)</span> 都等于 1。</p>
</li>
<li>
<p>在等式右边，时间反演操作不改变常数，因此 <span class="arithmatex">\(\hat{1} = 1\)</span>。</p>
</li>
</ul>
<p>这样，普适关系立刻简化为：</p>
<div class="arithmatex">\[1 = e^{-\beta \Delta F} \langle e^{\beta W_J[\vec{\phi}]} \rangle_R\]</div>
<p>这个表达式的左边是<strong>正向过程</strong>的平均（隐含的），右边是在<strong>反向协议</strong>下的系综平均 <span class="arithmatex">\(\langle \dots \rangle_R\)</span>。然而，Jarzynski 等式的标准形式是关于正向过程的。为了得到它，我们运用一个等价的推导：在普适关系中，我们选择一个不同的可观测量 <span class="arithmatex">\(O'[\phi] = O[\phi] e^{-\beta W_J[\phi]}\)</span>。经过代数运算可以得到另一个等价的普适关系：<span class="arithmatex">\(\langle O[\phi] e^{-\beta W_J[\phi]} \rangle = e^{-\beta \Delta F} \langle \hat{O}[\phi] \rangle_R\)</span>。</p>
<p>现在，再次选择 <span class="arithmatex">\(O[\vec{\phi}] = 1\)</span> 代入这个新关系：</p>
<div class="arithmatex">\[\langle 1 \cdot e^{-\beta W_J[\vec{\phi}]} \rangle = e^{-\beta \Delta F} \langle \hat{1} \rangle_R\]</div>
<p>[cite_start]由于 <span class="arithmatex">\(\langle \hat{1} \rangle_R = 1\)</span>，我们便直接得到了最终的 <strong>Jarzynski 等式</strong> ：</p>
<div class="arithmatex">\[\langle e^{-\beta W_J[\vec{\phi}]} \rangle = e^{-\beta \Delta F}\]</div>
<p><strong>物理意义</strong>：
这个等式是随机热力学中最著名的结果之一，它的物理意义极为深刻：</p>
<p><strong>连接非平衡与平衡</strong> ：等式左边是一个在<strong>非平衡</strong>过程中定义的量——对功的指数进行的系综平均。这个平均值依赖于整个过程的动力学细节（如拖拽速度、耗散系数等）。而等式右边则是一个纯粹的<strong>平衡态</strong>热力学量——仅由始末态的平衡自由能差 <span class="arithmatex">\(\Delta F\)</span> 决定 。Jarzynski 等式在这两者之间建立了一座精确的、出人意料的桥梁。</p>
<p><strong>计算自由能的新途径</strong> ：它提供了一种从非平衡实验或模拟中计算平衡自由能差的强大方法 。传统方法（如热力学积分）要求过程必须是准静态的，这对于复杂的生物分子或缓慢的玻璃态系统，在实践中往往难以实现。而 Jarzynski 等式表明，即使过程是快速和高度不可逆的，只要能对足够多的轨迹进行功的测量，并计算其<strong>指数平均</strong>（这是一个非线性的平均，会极大地加权那些稀有的、功值小的轨迹），就能精确地得到平衡自由能差 。</p>
<h2 id="52">5.2 对热力学第二定律的精化<a class="headerlink" href="#52" title="Permanent link">&para;</a></h2>
<p>Jarzynski 等式不仅与热力学第二定律完美兼容，更是后者的一个深刻<strong>精化 (refinement)</strong> 。利用数学中的<strong>琴生不等式 (Jensen's inequality)</strong> ，即对于任意凸函数 <span class="arithmatex">\(f(x)\)</span>（如 <span class="arithmatex">\(f(x)=e^x\)</span>），有 <span class="arithmatex">\(\langle f(x) \rangle \geq f(\langle x \rangle)\)</span>。将此应用于 Jarzynski 等式：</p>
<div class="arithmatex">\[\langle e^{-\beta W_J} \rangle \geq e^{\langle -\beta W_J \rangle} = e^{-\beta \langle W_J \rangle}\]</div>
<p>将此不等式与 Jarzynski 等式本身相结合：</p>
<div class="arithmatex">\[e^{-\beta \Delta F} = \langle e^{-\beta W_J} \rangle \geq e^{-\beta \langle W_J \rangle}\]</div>
<p>对两边取对数并乘以 <span class="arithmatex">\(-T\)</span>（这会反转不等号），便恢复了我们熟悉的热力学第二定律的表述：</p>
<div class="arithmatex">\[\langle W_J \rangle \geq \Delta F\]</div>
<p><strong>物理意义</strong>：
这个推导清晰地表明，Jarzynski 等式是一个比第二定律<strong>更强</strong>的声明。</p>
<p><strong>第二定律</strong>只约束了功的<strong>平均值</strong> ，它承认在单次实验中功 <span class="arithmatex">\(W_J\)</span> 可能小于 <span class="arithmatex">\(\Delta F\)</span>（即所谓的瞬时“违背”第二定律），但对这种情况发生的概率保持沉默。</p>
<p><strong>Jarzynski 等式</strong>则对功的<strong>整个概率分布</strong> <span class="arithmatex">\(P(W_J)\)</span> 施加了一个精确的积分约束。它表明，那些 <span class="arithmatex">\(W_J &lt; \Delta F\)</span> 的轨迹确实会发生，但它们的统计权重被指数级地抑制，而那些 <span class="arithmatex">\(W_J &gt; \Delta F\)</span> 的耗散性轨迹则贡献更大。最终，通过 <span class="arithmatex">\(e^{-\beta W_J}\)</span> 这一非线性加权平均，所有涨落的贡献被精妙地组合在一起，不多不少，正好等于平衡自由能差所对应的热力学因子。</p>
<h1 id="6-i-jarzynski">6. 代码实践 I ：验证 Jarzynski 等式<a class="headerlink" href="#6-i-jarzynski" title="Permanent link">&para;</a></h1>
<p>下面将通过 Python 代码模拟一个经典的非平衡物理过程——拖拽一个在谐振子势阱中的过阻尼布朗粒子——来数值验证 Jarzynski 等式。</p>
<h2 id="_2">物理模型<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>考虑一个一维的过阻尼布朗粒子，其动力学由以下<strong>朗之万方程 (Langevin equation)</strong> 描述：</p>
<div class="arithmatex">\[\gamma \frac{dx}{dt} = -\frac{\partial V(x,t)}{\partial x} + \eta(t)\]</div>
<p>其中：</p>
<ul>
<li>
<p><span class="arithmatex">\(x(t)\)</span> 是粒子的位置。</p>
</li>
<li>
<p><span class="arithmatex">\(\gamma\)</span> 是摩擦系数。</p>
</li>
<li>
<p><span class="arithmatex">\(V(x,t) = \frac{1}{2} k (x - \lambda(t))^2\)</span> 是一个谐振子势阱，其中心位置 <span class="arithmatex">\(\lambda(t)\)</span> 由外部协议控制。<span class="arithmatex">\(k\)</span> 是势阱的劲度系数。</p>
</li>
<li>
<p><span class="arithmatex">\(\eta(t)\)</span> 是高斯白噪声，代表来自热浴的随机碰撞，其统计性质为 <span class="arithmatex">\(\langle \eta(t) \rangle = 0\)</span> 和 <span class="arithmatex">\(\langle \eta(t) \eta(t') \rangle = 2 \gamma T \delta(t - t')\)</span>，其中 <span class="arithmatex">\(T\)</span> 是温度。</p>
</li>
</ul>
<p><strong>非平衡协议：</strong> 势阱中心 <span class="arithmatex">\(\lambda(t)\)</span> 在时间 <span class="arithmatex">\(t=0\)</span> 到 <span class="arithmatex">\(t=t_f\)</span> 内从初始位置 <span class="arithmatex">\(\lambda_0\)</span> 线性地移动到最终位置 <span class="arithmatex">\(\lambda_f\)</span>：</p>
<div class="arithmatex">\[\lambda(t) = \lambda_0 + (\lambda_f - \lambda_0) \frac{t}{t_f}\]</div>
<p><strong>非平衡功：</strong>根据前面的定义，沿着一条轨迹 <span class="arithmatex">\(x(t)\)</span> 所做的功为：</p>
<div class="arithmatex">\[W_J = \int_0^{t_f} \frac{\partial V(x(t),t)}{\partial \lambda} \frac{d\lambda}{dt} dt = \int_0^{t_f} k (x(t) - \lambda(t)) \frac{d\lambda}{dt} dt\]</div>
<p><strong>自由能变化</strong>：由于势阱的形状（由 <span class="arithmatex">\(k\)</span> 决定）没有改变，始末态的平衡自由能差为 <span class="arithmatex">\(\Delta F = 0\)</span>。因此，Jarzynski 等式预测 <span class="arithmatex">\(\langle e^{-\beta W_J} \rangle = e^0 = 1\)</span>。</p>
<h2 id="python">Python 实现<a class="headerlink" href="#python" title="Permanent link">&para;</a></h2>
<p>下面的代码使用简单的欧拉-丸山方法 (Euler-Maruyama method) 对朗之万方程进行数值积分，并计算多条轨迹的功，最后验证 Jarzynski 等式。</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">animation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.gridspec</span><span class="w"> </span><span class="kn">import</span> <span class="n">GridSpec</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span> <span class="c1"># Import tqdm to show progress bar</span>

<span class="c1"># --- 1. Physical Parameters ---</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">T</span>

<span class="c1"># --- 2. Simulation Parameters ---</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">t_f</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">num_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_f</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">num_trajectories</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="c1"># --- Optimization: Animation Parameters ---</span>
<span class="n">FRAMES</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># We only generate 100 animation frames</span>
<span class="n">TRAJ_PER_FRAME</span> <span class="o">=</span> <span class="n">num_trajectories</span> <span class="o">//</span> <span class="n">FRAMES</span> <span class="c1"># How many trajectories per frame</span>

<span class="c1"># --- 3. Protocol Definition ---</span>
<span class="n">lambda_0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">lambda_f</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">v_lambda</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambda_f</span> <span class="o">-</span> <span class="n">lambda_0</span><span class="p">)</span> <span class="o">/</span> <span class="n">t_f</span>

<span class="c1"># --- 4. Initialize Data Storage ---</span>
<span class="n">work_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_trajectories</span><span class="p">)</span>
<span class="n">trajectories</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_trajectories</span><span class="p">,</span> <span class="n">num_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">time_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">,</span> <span class="n">num_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># --- 5. Main Simulation Loop (Generate All Data) ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generating all trajectory data...&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_trajectories</span><span class="p">)):</span> <span class="c1"># Use tqdm to show progress</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">lambda_0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span> <span class="o">/</span> <span class="n">k</span><span class="p">))</span>
    <span class="n">trajectories</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">total_work</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_steps</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">lambda_t</span> <span class="o">=</span> <span class="n">lambda_0</span> <span class="o">+</span> <span class="n">v_lambda</span> <span class="o">*</span> <span class="n">t</span>

        <span class="n">force_on_trap</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">lambda_t</span><span class="p">)</span>
        <span class="n">dW</span> <span class="o">=</span> <span class="o">-</span><span class="n">force_on_trap</span> <span class="o">*</span> <span class="n">v_lambda</span> <span class="o">*</span> <span class="n">dt</span> <span class="c1"># Corrected work calculation</span>
        <span class="n">total_work</span> <span class="o">+=</span> <span class="n">dW</span>

        <span class="n">force_on_particle</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">lambda_t</span><span class="p">)</span>
        <span class="n">noise_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="p">(</span><span class="n">force_on_particle</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">+</span> <span class="n">noise_term</span> <span class="o">/</span> <span class="n">gamma</span>
        <span class="n">trajectories</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">step</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>

    <span class="n">work_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_work</span>

<span class="c1"># Pre-calculate convergence process of Jarzynski average</span>
<span class="n">jarzynski_averages</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">work_values</span><span class="p">[:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">TRAJ_PER_FRAME</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">FRAMES</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data generation completed, creating animation...&quot;</span><span class="p">)</span>

<span class="c1"># --- 6. Create Visualization ---</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;dark_background&#39;</span><span class="p">)</span>  <span class="c1"># Set black background</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
<span class="n">ax_physics</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax_hist</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax_conv</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Jarzynski Equality Dynamic Verification (Optimized Version)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>

<span class="c1"># Initialize plot elements for efficient updates</span>
<span class="n">line_traj</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax_physics</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">point_traj</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax_physics</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Particle Trajectory&#39;</span><span class="p">)</span>
<span class="n">line_conv</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax_conv</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># --- 7. Animation Update Function (Optimized Version) ---</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">frame</span><span class="p">):</span>
    <span class="c1"># Calculate total number of trajectories for current frame</span>
    <span class="n">num_traj_so_far</span> <span class="o">=</span> <span class="p">(</span><span class="n">frame</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">TRAJ_PER_FRAME</span>

    <span class="c1"># --- Update Panel 1: Physical Process (Show only the last trajectory of current batch) ---</span>
    <span class="n">ax_physics</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span> <span class="c1"># Physics panel structure is complex, easier to clear</span>
    <span class="n">current_traj_index</span> <span class="o">=</span> <span class="n">num_traj_so_far</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">current_traj</span> <span class="o">=</span> <span class="n">trajectories</span><span class="p">[</span><span class="n">current_traj_index</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">ax_physics</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">current_traj</span><span class="p">,</span> <span class="n">time_array</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">ax_physics</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">current_traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">time_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Particle Trajectory&#39;</span><span class="p">)</span>

    <span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">ax_physics</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_range</span> <span class="o">-</span> <span class="n">lambda_0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Initial Potential Well&#39;</span><span class="p">)</span>
    <span class="n">ax_physics</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_range</span> <span class="o">-</span> <span class="n">lambda_f</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Final Potential Well&#39;</span><span class="p">)</span>
    <span class="n">lambda_t_array</span> <span class="o">=</span> <span class="n">lambda_0</span> <span class="o">+</span> <span class="n">v_lambda</span> <span class="o">*</span> <span class="n">time_array</span>
    <span class="n">ax_physics</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lambda_t_array</span><span class="p">,</span> <span class="n">time_array</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Trap Center Trajectory&#39;</span><span class="p">)</span>

    <span class="n">ax_physics</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Position x&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax_physics</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Time t&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax_physics</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Physical Process: Trajectory #</span><span class="si">{</span><span class="n">num_traj_so_far</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax_physics</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">ax_physics</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_f</span><span class="p">)</span>
    <span class="n">ax_physics</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
    <span class="n">ax_physics</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

    <span class="c1"># --- Update Panel 2: Work Distribution Histogram ---</span>
    <span class="n">ax_hist</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">current_works</span> <span class="o">=</span> <span class="n">work_values</span><span class="p">[:</span><span class="n">num_traj_so_far</span><span class="p">]</span>
    <span class="n">ax_hist</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">current_works</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">work_values</span><span class="p">)</span><span class="o">*</span><span class="mf">1.1</span><span class="p">))</span>
    <span class="n">mean_work</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">current_works</span><span class="p">)</span>
    <span class="n">ax_hist</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">mean_work</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;&lt;W&gt; = </span><span class="si">{</span><span class="n">mean_work</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax_hist</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ΔF = 0&#39;</span><span class="p">)</span>
    <span class="n">ax_hist</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Work W&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax_hist</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density P(W)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax_hist</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Non-equilibrium Work Distribution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax_hist</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax_hist</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

    <span class="c1"># --- Update Panel 3: Convergence of Jarzynski Average ---</span>
    <span class="n">ax_conv</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">traj_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">frame</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">TRAJ_PER_FRAME</span>
    <span class="n">ax_conv</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">traj_counts</span><span class="p">,</span> <span class="n">jarzynski_averages</span><span class="p">[:</span><span class="n">frame</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax_conv</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Theoretical Value exp(-βΔF) = 1&#39;</span><span class="p">)</span>
    <span class="n">ax_conv</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Trajectories&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax_conv</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\langle e^{-\beta W} \rangle$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax_conv</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Convergence of Jarzynski Average&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax_conv</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">ax_conv</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
    <span class="n">ax_conv</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="n">current_avg_val</span> <span class="o">=</span> <span class="n">jarzynski_averages</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span>
    <span class="n">ax_conv</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Current Value: </span><span class="si">{</span><span class="n">current_avg_val</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> 
                 <span class="n">transform</span><span class="o">=</span><span class="n">ax_conv</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                 <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round,pad=0.5&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;wheat&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">])</span>

<span class="c1"># --- 8. Create and Save Animation ---</span>
<span class="c1"># Create a progress bar to show animation saving progress</span>
<span class="n">ani_pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">FRAMES</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Rendering animation&quot;</span><span class="p">)</span>
<span class="n">ani</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="n">FRAMES</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ani</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;jarzynski_verification_optimized.gif&#39;</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="s1">&#39;pillow&#39;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> 
         <span class="n">progress_callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">ani_pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ani_pbar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Animation &#39;jarzynski_verification_optimized.gif&#39; saved successfully!&quot;</span><span class="p">)</span>
</code></pre></div>
<img alt="运行代码输出" src="../../../assets/images/remote/jarzynski_verification_optimized.gif" /></p>
<p><strong>物理过程</strong>：左侧的物理过程图显示，粒子轨迹（红色实线）总是<strong>滞后</strong>于势阱中心（蓝色虚线代表的初始/最终位置和未显示的移动轨迹）。这正是产生耗散功的物理来源。</p>
<p><strong>热力学第二定律成立</strong> ：右上方的功分布图显示，平均功<span class="arithmatex">\(&lt;W&gt;\)</span>远大于自由能差 <span class="arithmatex">\(ΔF = 0\)</span>。这验证了热力学第二定律 <span class="arithmatex">\(⟨W⟩ ≥ ΔF\)</span>。</p>
<p><strong>Jarzynski 平均值的收敛 ：</strong> 
Jarzynski 等式最重要的一个特征：它的收敛速度非常缓慢，并且受到稀有事件的剧烈影响。Jarzynski 平均值是 <span class="arithmatex">\(⟨e^{-βW}⟩\)</span>，一个非线性的指数平均。这个平均对<strong>功 <span class="arithmatex">\(W\)</span> 值很小甚至为负</strong>的轨迹（即右上图中直方图最左侧的那些事件）极其敏感。这些是“幸运”的轨迹，热涨落恰好帮助粒子跟上了势阱的移动，减少了耗散。然而，这些轨迹非常稀少。在有限的模拟次数（如1480次）中，很可能没有充分地采样到足够多的这类稀有事件。因此，计算出的平均值会存在统计偏差，通常会小于1。图中紫色曲线的剧烈波动正反映了这种对稀有事件的敏感性。如果将模拟的轨迹数量增加到10000甚至更多，会看到这个值会更稳定地接近。</p>
<h1 id="7-crooks">7. Crooks 涨落定理：一个更精细的对称性<a class="headerlink" href="#7-crooks" title="Permanent link">&para;</a></h1>
<p>Jarzynski 等式是对非平衡功的一个积分约束，它作用于功的指数的<strong>平均值</strong>。然而，它源于一个更普适、更精细的关系，即 <strong>Crooks 涨落定理</strong>。该定理不对平均值进行约束，而是直接关联了<strong>正向</strong>和<strong>反向</strong>过程的<strong>整个功分布函数</strong>。</p>
<p><strong>Crooks 涨落定理</strong>由 Gavin E. Crooks 在1999 年作为 Jarzynski 等式的推广和精化而提出。它的<strong>物理本质</strong>是一种更为精细和强力的对称性关系，它不再局限于对功的某个平均值进行约束，而是直接关联了<strong>正向过程</strong>和<strong>反向过程</strong>的<strong>整个功的概率分布函数</strong>。该定理指出，在正向过程中做出功 <span class="arithmatex">\(W\)</span> 的概率 <span class="arithmatex">\(P(W)\)</span>，与在反向协议下做出功 <span class="arithmatex">\(-W\)</span> 的概率 <span class="arithmatex">\(\tilde{p}(-W)\)</span> 之比，由一个简单的指数关系决定：<span class="arithmatex">\(P(W)/\tilde{p}(-W) = e^{\beta (W - \Delta F)}\)</span>。这个关系定量地解释了瞬时“违背”第二定律（即 <span class="arithmatex">\(W &lt; \Delta F\)</span>）的事件是何等稀少，并揭示了非平衡涨落中深刻的时间反演对称性。</p>
<p>在<strong>具体应用</strong>中，Crooks 定理提供了一种比 Jarzynski 等式在数值上更稳健、更可靠的自由能计算方法，因为它允许通过寻找正向和反向功分布曲线的交点来直接确定 <span class="arithmatex">\(\Delta F\)</span>。这一“交点法”已成为分析单分子力谱实验（如RNA折叠/解折叠）和计算模拟数据的标准工具。</p>
<h2 id="71">7.1 定理的推导与形式<a class="headerlink" href="#71" title="Permanent link">&para;</a></h2>
<p>Crooks 定理可以从第4节的普适关系式中推导出来。通过选择一个特殊的可观测量 <span class="arithmatex">\(O[\vec{\phi}] = \delta(W - W_J[\vec{\phi}])\)</span>，这个选择相当于在路径积分中只筛选出所有功值恰好为 <span class="arithmatex">\(W\)</span> 的轨迹。经过推导，可以得到正向过程的功分布 <span class="arithmatex">\(P(W_J)\)</span> 与反向过程的功分布 <span class="arithmatex">\(P_R(-W_J)\)</span> 之间的关系：</p>
<div class="arithmatex">\[\frac{P(W_J)}{P_R(-W_J)} = e^{\beta (W_J - \Delta F)}\]</div>
<ul>
<li>
<p><span class="arithmatex">\(P(W_J)\)</span> 是在<strong>正向协议</strong>下，测得做功为 <span class="arithmatex">\(W_J\)</span> 的概率密度。</p>
</li>
<li>
<p><span class="arithmatex">\(P_R(-W_J)\)</span> 是在<strong>反向协议</strong>下，测得做功为 <span class="arithmatex">\(-W_J\)</span> 的概率密度。</p>
</li>
</ul>
<p>这个定理的物理内涵比 Jarzynski 等式更为丰富和深刻：</p>
<ul>
<li>
<p><strong>精细的对称性 (Detailed Symmetry)</strong> ：它揭示了非平衡涨落中一种深刻的对称性，可以看作是“功空间”中的一种“细致平衡”。它精确地量化了在正向过程中观察到一个特定功值 <span class="arithmatex">\(W_J\)</span> 的概率，与在反向过程中观察到“相反”功值 <span class="arithmatex">\(-W_J\)</span> 的概率之比。</p>
</li>
<li>
<p><strong>量化第二定律的“违背”</strong> ：当一条轨迹的功 <span class="arithmatex">\(W_J &lt; \Delta F\)</span> 时，这看起来像是对第二定律的瞬时“违背”。Crooks 定理精确地告诉我们这种事件的稀有程度。将公式重写为 <span class="arithmatex">\(P(W_J) / P_R(-W_J) = e^{\beta (W_J - \Delta F)}\)</span>，当 <span class="arithmatex">\(W_J &lt; \Delta F\)</span> 时，指数项为负，这意味着 <span class="arithmatex">\(P(W_J)\)</span> 相对于在反向过程中发生相应耗散事件（功为 <span class="arithmatex">\(-W_J &gt; -\Delta F\)</span>）的概率 <span class="arithmatex">\(P_R(-W_J)\)</span> 而言，是<strong>指数级稀少的</strong> 。</p>
</li>
</ul>
<p><strong>自由能的几何解释</strong> ：将定理方程两边取对数，得到：
    <span class="arithmatex">\(<span class="arithmatex">\(\ln \frac{P(W_J)}{P_R(-W_J)} = \beta (W_J - \Delta F)\)</span>\)</span></p>
<p>这个形式揭示了一个惊人的线性关系。它表明，如果将两个功分布的对数比率 <span class="arithmatex">\(\ln(P/P_R)\)</span> 作为 y 轴，功 <span class="arithmatex">\(W_J\)</span> 作为 x 轴作图，得到的数据点应该落在一条<strong>斜率为 <span class="arithmatex">\(\beta=1/T\)</span>，且与 x 轴交点恰好为 <span class="arithmatex">\(\Delta F\)</span></strong> 的直线上。这为通过实验或模拟数据精确确定自由能差，提供了一种极其强大和直观的几何方法。</p>
<h2 id="72-crooks-jarzynski">7.2 Crooks 定理蕴含 Jarzynski 等式<a class="headerlink" href="#72-crooks-jarzynski" title="Permanent link">&para;</a></h2>
<p>Crooks 定理是一个比 Jarzynski 等式更强的结论。我们可以通过对 Crooks 定理进行积分来重新推导出 Jarzynski 等式，证明这一点：</p>
<ol>
<li>
<p>从 Crooks 定理出发：<span class="arithmatex">\(P(W_J) = P_R(-W_J) e^{\beta (W_J - \Delta F)}\)</span></p>
</li>
<li>
<p>计算 Jarzynski 平均值：
    <span class="arithmatex">\(<span class="arithmatex">\(\langle e^{-\beta W_J} \rangle \equiv \int dW_J \, P(W_J) e^{-\beta W_J}\)</span>\)</span></p>
</li>
<li>
<p>代入 <span class="arithmatex">\(P(W_J)\)</span> 的表达式：
    <span class="arithmatex">\(<span class="arithmatex">\(\langle e^{-\beta W_J} \rangle = \int dW_J \, P_R(-W_J) e^{\beta (W_J - \Delta F)} e^{-\beta W_J}\)</span>\)</span></p>
</li>
<li>
<p>化简指数项：
    <span class="arithmatex">\(<span class="arithmatex">\(\langle e^{-\beta W_J} \rangle = \int dW_J \, P_R(-W_J) e^{-\beta \Delta F} = e^{-\beta \Delta F} \int dW_J \, P_R(-W_J)\)</span>\)</span></p>
</li>
<li>
<p>由于 <span class="arithmatex">\(P_R\)</span> 是一个归一化的概率分布，其积分为1：
    <span class="arithmatex">\(<span class="arithmatex">\(\int dW_J \, P_R(-W_J) = 1\)</span>\)</span></p>
</li>
<li>
<p>最终得到 Jarzynski 等式：
    <span class="arithmatex">\(<span class="arithmatex">\(\langle e^{-\beta W_J} \rangle = e^{-\beta \Delta F}\)</span>\)</span></p>
</li>
</ol>
<p>这个推导清晰地表明，Jarzynski 等式是 Crooks 定理在积分层面上的一个直接推论。</p>
<h1 id="8-crooks">8.代码实践 || ：可视化 Crooks 定理<a class="headerlink" href="#8-crooks" title="Permanent link">&para;</a></h1>
<p>为了直观地理解和验证 Crooks 定理，可以扩展之前的 Python 模拟，加入对<strong>反向协议</strong>的模拟，并以两种方式比较正反向过程的功分布。</p>
<p>在之前的代码基础上，增加一个模拟反向过程的循环，并绘制两个验证图。</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- 1. Parameter settings (same as before) ---</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">T</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span> <span class="n">t_f</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">;</span> <span class="n">num_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t_f</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">num_trajectories</span> <span class="o">=</span> <span class="mi">20000</span> <span class="c1"># Increase trajectory count for smoother distribution</span>

<span class="c1"># --- 2. Forward protocol simulation ---</span>
<span class="n">lambda_0_fwd</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">lambda_f_fwd</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">v_lambda_fwd</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambda_f_fwd</span> <span class="o">-</span> <span class="n">lambda_0_fwd</span><span class="p">)</span> <span class="o">/</span> <span class="n">t_f</span>
<span class="n">work_forward</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_trajectories</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulating forward protocol...&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_trajectories</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">lambda_0_fwd</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span> <span class="o">/</span> <span class="n">k</span><span class="p">))</span>
    <span class="n">total_work</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_steps</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">lambda_t</span> <span class="o">=</span> <span class="n">lambda_0_fwd</span> <span class="o">+</span> <span class="n">v_lambda_fwd</span> <span class="o">*</span> <span class="n">t</span>
        <span class="n">force_lambda</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">lambda_t</span><span class="p">)</span>
        <span class="c1"># Key correction: definition of work</span>
        <span class="n">dW</span> <span class="o">=</span> <span class="o">-</span><span class="n">force_lambda</span> <span class="o">*</span> <span class="p">(</span><span class="n">v_lambda_fwd</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>
        <span class="n">total_work</span> <span class="o">+=</span> <span class="n">dW</span>
        <span class="n">force_x</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">lambda_t</span><span class="p">)</span>
        <span class="n">noise_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="p">(</span><span class="n">force_x</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">+</span> <span class="n">noise_term</span> <span class="o">/</span> <span class="n">gamma</span>
    <span class="n">work_forward</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_work</span>

<span class="c1"># --- 3. Reverse protocol simulation ---</span>
<span class="n">lambda_0_rev</span> <span class="o">=</span> <span class="n">lambda_f_fwd</span><span class="p">;</span> <span class="n">lambda_f_rev</span> <span class="o">=</span> <span class="n">lambda_0_fwd</span>
<span class="n">v_lambda_rev</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambda_f_rev</span> <span class="o">-</span> <span class="n">lambda_0_rev</span><span class="p">)</span> <span class="o">/</span> <span class="n">t_f</span> <span class="c1"># Velocity is negative</span>
<span class="n">work_reverse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_trajectories</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulating reverse protocol...&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_trajectories</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">lambda_0_rev</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span> <span class="o">/</span> <span class="n">k</span><span class="p">))</span>
    <span class="n">total_work</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_steps</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="n">lambda_t</span> <span class="o">=</span> <span class="n">lambda_0_rev</span> <span class="o">+</span> <span class="n">v_lambda_rev</span> <span class="o">*</span> <span class="n">t</span>
        <span class="n">force_lambda</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">lambda_t</span><span class="p">)</span>
        <span class="c1"># Key correction: definition of work</span>
        <span class="n">dW</span> <span class="o">=</span> <span class="o">-</span><span class="n">force_lambda</span> <span class="o">*</span> <span class="p">(</span><span class="n">v_lambda_rev</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>
        <span class="n">total_work</span> <span class="o">+=</span> <span class="n">dW</span>
        <span class="n">force_x</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">lambda_t</span><span class="p">)</span>
        <span class="n">noise_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="p">(</span><span class="n">force_x</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">+</span> <span class="n">noise_term</span> <span class="o">/</span> <span class="n">gamma</span>
    <span class="n">work_reverse</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_work</span>

<span class="c1"># --- 4. Visualizing Crooks Theorem ---</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;dark_background&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Numerical Verification of Crooks Fluctuation Theorem&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="c1"># --- Figure 1: Intersection point of work distributions ---</span>
<span class="n">delta_F</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">work_forward</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Forward work distribution $P(W)$&#39;</span><span class="p">)</span>
<span class="c1"># Plot distribution of negative reverse work P_R(-W)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="o">-</span><span class="n">work_reverse</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Reverse work distribution $P_R(-W)$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">delta_F</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ΔF = </span><span class="si">{</span><span class="n">delta_F</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Work W&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Verification Method 1: Work Distributions Intersect at ΔF&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># --- Figure 2: Linear relationship of logarithmic probability ratio ---</span>
<span class="c1"># Calculate histogram data</span>
<span class="n">hist_fwd</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">work_forward</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hist_rev</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="o">-</span><span class="n">work_reverse</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">bin_centers</span> <span class="o">=</span> <span class="p">(</span><span class="n">bin_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">bin_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span>

<span class="c1"># Avoid division by zero, only select regions where both distributions are non-zero</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">hist_fwd</span> <span class="o">&gt;</span> <span class="mf">1e-4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hist_rev</span> <span class="o">&gt;</span> <span class="mf">1e-4</span><span class="p">)</span>
<span class="n">log_ratio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">hist_fwd</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">/</span> <span class="n">hist_rev</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
<span class="n">work_vals</span> <span class="o">=</span> <span class="n">bin_centers</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="c1"># Plot scatter diagram</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">work_vals</span><span class="p">,</span> <span class="n">log_ratio</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation data (ln[P(W)/P_R(-W)])&#39;</span><span class="p">)</span>

<span class="c1"># Plot theoretical prediction line</span>
<span class="n">w_theory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">work_vals</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">work_vals</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">log_ratio_theory</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="n">w_theory</span> <span class="o">-</span> <span class="n">delta_F</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_theory</span><span class="p">,</span> <span class="n">log_ratio_theory</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Theoretical prediction: Slope β=</span><span class="si">{</span><span class="n">beta</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Work W&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\ln[P(W) / P_R(-W)]$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Verification Method 2: Linear Relationship of Log Probability Ratio&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="运行代码输出" src="../../../assets/images/remote/22bf615e-1cb8-4373-8e99-7345db9a2ab7-21558a2f47.png" /></p>
<p>左图展示了正向功分布 <span class="arithmatex">\(P(W)\)</span>（蓝色）和反向功的相反数分布 <span class="arithmatex">\(P_R(-W)\)</span>（橙色）。正向过程平均是耗散的，所以 <span class="arithmatex">\(P(W)\)</span> 的峰值在正功区域。反向过程平均也是耗散的（<span class="arithmatex">\(W_R &gt; \Delta F_{rev} = -\Delta F = 0\)</span>），所以 <span class="arithmatex">\(-W_R\)</span> predominantly 是负的，其分布 <span class="arithmatex">\(P_R(-W)\)</span> 的峰值在负功区域。<strong>最关键的特征是两个分布的交点</strong>。根据 Crooks 定理，这个交点应该精确地位于 <span class="arithmatex">\(W = \Delta F\)</span> 处。在模拟中，由于 <span class="arithmatex">\(\Delta F = 0\)</span>，两个直方图的曲线在 <span class="arithmatex">\(W = 0\)</span> 的红色虚线处相交。</p>
<p>右图提供了更严格、更定量的验证。它直接测试了<br />
$$
  \ln\left[\frac{P(W)}{P_R(-W)}\right] = \beta (W - \Delta F)
$$
这个线性关系。模拟数据点（蓝色散点）清晰地落在一条直线上，与理论预测的红线高度吻合。这条直线的斜率正是 <span class="arithmatex">\(\beta = 1/T = 1.0\)</span>，x轴截距也精确地位于 <span class="arithmatex">\(\Delta F = 0\)</span> 处。</p>
<h1 id="_3">结论<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h1>
<p>在这节课的结尾，Erwin Frey 教授推荐了一篇该领域的权威综述文章：</p>
<p><strong>Seifert U. Stochastic thermodynamics, fluctuation theorems and molecular machines[J]. Reports on progress in physics, 2012, 75(12): 126001.</strong></p>
<p>这篇综述系统性地构建了<strong>随机热力学 (Stochastic Thermodynamics)</strong> 的理论框架。其核心思想是将经典热力学的宏观概念，如功、热和熵产生，<strong>成功地扩展到了单个微观随机轨迹的层面</strong>。对于一个与恒温热库耦合的非平衡系统（无论是用朗之万方程描述的连续系统，还是用主方程描述的离散系统），如何在单条涨落轨迹上建立第一定律般的能量平衡关系。文章展示了如何从一个“主定理” (master theorem) 出发，以一种统一的方式推导出这节课学习的 Jarzynski 等式、Crooks 定理以及其他多种积分和精细涨落定理 (IFT &amp; DFT)。论文涵盖了大量的 paradigmatic systems（典范系统），包括我们模拟过的胶体颗粒、生物聚合物、分子马达以及小型生化网络等。正如Frey教授所言，这是一篇“...beautiful review of all the different aspects of stochastic thermodynamics...”。</p>
<p><strong>这节课标志着这系列课程从近平衡向非平衡领域的关键转折。</strong>从回顾近平衡系统的涨落-耗散关系出发，将统计物理学的视野拓展到了由任意外部协议驱动的、远离平衡的随机过程。通过运用强大的 JDD 路径积分工具，最终证明了即使在系统经历高度不可逆的过程时，依然能够找到超越经典热力学不等式的、普适且精确的等式关系。</p>
<p>核心内容可以总结为以下四点：</p>
<ol>
<li>
<p><strong>非平衡功是随机变量</strong>：在微观尺度，由于热涨落的存在，对系统所做的功不再是一个确定值，而是一个依赖于系统具体演化轨迹的随机变量，因此必须用其完整的概率分布来描述。</p>
</li>
<li>
<p><strong>Jarzynski 等式</strong>：功的指数平均值，这个在非平衡过程中测量的量，被证明精确地等于系统始末平衡态之间的自由能差所对应的热力学因子，即 <span class="arithmatex">\(\langle e^{-\beta W_J} \rangle = e^{-\beta \Delta F}\)</span>。这一定理为从不可逆过程中提取平衡态信息提供了坚实的理论基础。</p>
</li>
<li>
<p><strong>Crooks 涨落定理</strong>：这是一个更为精细和强大的“细致”对称关系。它通过公式 <span class="arithmatex">\(\frac{P(W_J)}{P_R(-W_J)} = e^{\beta (W_J - \Delta F)}\)</span>，精确地关联了正向和反向过程的整个功分布，从而定量地解释了瞬时“违背”第二定律事件的稀有性。</p>
</li>
<li>
<p><strong>时间反演对称性的核心作用</strong>：所有这些非平衡定理的根本来源，是底层微观动力学的<strong>时间可逆性</strong>。宏观上观察到的不可逆性源于不对称的边界条件（即从一个确定的平衡态开始并让时间向前流逝），而涨落定理正是对这种边界条件不对称性所产生的统计后果的精确描述。</p>
</li>
</ol>
<p>这节课关注的是一个系统在<strong>有限时间</strong>内从一个平衡态被驱动到另一个状态的<strong>瞬态 (transient)</strong> 非平衡过程。然而，非平衡世界还包含另一类极为重要的系统：那些在持续的能量或物质流驱动下，能够达到<strong>非平衡稳态 (Non-Equilibrium Steady State, NESS)</strong> 的系统。</p>
<p>接下来的课程将转向对 NESS 的研究，特别是将以<strong>有向渗流 (Directed Percolation)</strong> 作为研究非平衡相变的典范模型。与平衡相变（如伊辛模型）不同，有向渗流模型中内含了一个“时间”或优先方向，使其本质上是动态和不可逆的。<strong>它描述了诸如流行病传播、催化剂表面反应等多种系统中从活跃态到“死亡”（吸收）态的临界行为。</strong></p>
<p>研究这类系统，也预示着分析工具的转变。对于 NESS 的长时间行为、弛豫速率以及涨落的谱特性，<strong>光谱方法 (Spectral Method)</strong> 将成为核心工具。该方法通过分析系统演化算符（如福克-普朗克算符）的本征值和本征函数来揭示系统的动力学特性。因此，后续课程的视角将从本讲的<strong>路径积分方法</strong>，转向使用<strong>算符理论</strong>来剖析非平衡系统的动力学。</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.sections", "navigation.expand", "navigation.top", "toc.integrate", "search.highlight"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../assets/javascripts/mathjax.js"></script>
      
        <script src="../../../assets/javascripts/language-nav.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>