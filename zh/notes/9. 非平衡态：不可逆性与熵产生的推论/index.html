
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Course Notes and Code (Erwin Frey, LMU Munich, 2025)">
      
      
        <meta name="author" content="Zhihang Liu">
      
      
        <link rel="canonical" href="https://liu-zhihang.github.io/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/zh/notes/9.%20%E9%9D%9E%E5%B9%B3%E8%A1%A1%E6%80%81%EF%BC%9A%E4%B8%8D%E5%8F%AF%E9%80%86%E6%80%A7%E4%B8%8E%E7%86%B5%E4%BA%A7%E7%94%9F%E7%9A%84%E6%8E%A8%E8%AE%BA/">
      
      
        <link rel="prev" href="../8.%20%E4%BD%A9%E9%BE%99-%E5%BC%97%E7%BD%97%E8%B4%9D%E5%B0%BC%E4%B9%8C%E6%96%AF%E5%AE%9A%E7%90%86%E3%80%81%E7%A8%B3%E6%80%81%E4%B8%8E%E7%BB%86%E8%87%B4%E5%B9%B3%E8%A1%A1/">
      
      
        <link rel="next" href="../10.%20%E5%9F%83%E4%BC%A6%E8%B4%B9%E6%96%AF%E7%89%B9%E6%A8%A1%E5%9E%8B%E3%80%81%E7%86%B5%E4%B8%8EKL%E6%95%A3%E5%BA%A6/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>9. 非平衡态：不可逆性与熵产生的推论 - Nonequilibrium Field Theories and Stochastic Dynamics</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Nonequilibrium Field Theories and Stochastic Dynamics" class="md-header__button md-logo" aria-label="Nonequilibrium Field Theories and Stochastic Dynamics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nonequilibrium Field Theories and Stochastic Dynamics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              9. 非平衡态：不可逆性与熵产生的推论
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/zh/" hreflang="zh" class="md-select__link">
              简体中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Liu-Zhihang/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Nonequilibrium Field Theories and Stochastic Dynamics" class="md-nav__button md-logo" aria-label="Nonequilibrium Field Theories and Stochastic Dynamics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Nonequilibrium Field Theories and Stochastic Dynamics
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Liu-Zhihang/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Course Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Course Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/1.%20Course%20Introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Course Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/2.%20Simple%20Random%20Walk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Simple Random Walk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/3.%20Gaussian%20Random%20Walk%20and%20Poisson%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. Gaussian Random Walk and Poisson Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/4.%20Gillespie%20Algorithm%2C%20Master%20Equation%2C%20Generating%20Functions%20and%20Population%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Gillespie Algorithm, Master Equation, Generating Functions and Population Dynamics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/5.%20Population%20Dynamics%20-%20Linear%20Death%20Process%20and%20Lotka-Volterra%20System/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. Population Dynamics - Linear Death Process and Lotka-Volterra System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/6.%20Fundamental%20Equations%20of%20Markov%20Processes%20%E2%80%94%20Chapman%E2%80%93Kolmogorov%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6. Fundamental Equations of Markov Processes — Chapman–Kolmogorov Equation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/7.%20Forward%20Master%20Equation%20and%20the%20Q%20Matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7. Forward Master Equation and the Q Matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/8.%20Perron%E2%80%93Frobenius%20Theorem%2C%20Steady%20States%2C%20and%20Detailed%20Balance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8. Perron–Frobenius Theorem, Steady States, and Detailed Balance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/9.%20Nonequilibrium%20States%20%E2%80%94%20Irreversibility%20and%20Entropy%20Production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    9. Nonequilibrium States — Irreversibility and Entropy Production
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/10.%20Ehrenfest%20Model%2C%20Entropy%2C%20and%20KL%20Divergence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10. Ehrenfest Model, Entropy, and KL Divergence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/11.%20Continuous%20Markov%20Processes%20and%20the%20Fokker%E2%80%93Planck%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11. Continuous Markov Processes and the Fokker–Planck Equation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/12.%20Brownian%20Motion%20and%20the%20Ornstein%E2%80%93Uhlenbeck%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    12. Brownian Motion and the Ornstein–Uhlenbeck Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/13.%20Monte%20Carlo%20Sampling%20as%20a%20Stochastic%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    13. Monte Carlo Sampling as a Stochastic Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/14.%20Hamiltonian%20Monte%20Carlo%20Sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    14. Hamiltonian Monte Carlo Sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/15.%20Chemotaxis%2C%20Run-and-Tumble%20Motion%2C%20and%20the%20Keller%E2%80%93Segel%20Model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15. Chemotaxis, Run-and-Tumble Motion, and the Keller–Segel Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/16.%20The%20Schnitzer%20Model%2C%20Anomalous%20Diffusion%2C%20and%20Motility%E2%80%91Induced%20Phase%20Separation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    16. The Schnitzer Model, Anomalous Diffusion, and Motility‑Induced Phase Separation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/17.%20Langevin%20Equation%2C%20Brownian%20Particle%2C%20and%20the%20Fluctuation%E2%80%93Dissipation%20Theorem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    17. Langevin Equation, Brownian Particle, and the Fluctuation–Dissipation Theorem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/18.%20Fokker%E2%80%93Planck%20Equation%20and%20the%20Smoluchowski%20Equation%20%E2%80%94%20From%20Random%20Trajectories%20to%20Probability%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    18. Fokker–Planck Equation and the Smoluchowski Equation — From Random Trajectories to Probability Dynamics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/19.%20Path%20Integral%20Formulation%20of%20Stochastic%20Processes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    19. Path Integral Formulation of Stochastic Processes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/20.%20Stochastic%20Differential%20Equations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20. Stochastic Differential Equations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    中文笔记
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            中文笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    首页
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20%E8%AF%BE%E7%A8%8B%E5%AF%BC%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. 课程导论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.%20%E7%AE%80%E5%8D%95%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. 简单随机游走
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.%20%E9%AB%98%E6%96%AF%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E4%B8%8E%E6%B3%8A%E6%9D%BE%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. 高斯随机游走与泊松过程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.%20Gillespie%20%E7%AE%97%E6%B3%95%E3%80%81%E4%B8%BB%E6%96%B9%E7%A8%8B%E3%80%81%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E4%B8%8E%E7%A7%8D%E7%BE%A4%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Gillespie 算法、主方程、生成函数与种群动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5.%20%E7%A7%8D%E7%BE%A4%E5%8A%A8%E6%80%81%E5%AD%A6%EF%BC%9A%E7%BA%BF%E6%80%A7%E6%AD%BB%E4%BA%A1%E8%BF%87%E7%A8%8B%E4%B8%8ELotka-Volterra%20%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. 种群动态学：线性死亡过程与Lotka-Volterra 系统
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.%20%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%96%B9%E7%A8%8B%EF%BC%9A%E6%9F%A5%E6%99%AE%E6%9B%BC-%E7%A7%91%E5%B0%94%E8%8E%AB%E6%88%88%E7%BD%97%E5%A4%AB%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6. 马尔可夫过程的基本方程：查普曼-科尔莫戈罗夫方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.%20%E5%89%8D%E5%90%91%E4%B8%BB%E6%96%B9%E7%A8%8B%E4%B8%8EQ%E7%9F%A9%E9%98%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7. 前向主方程与Q矩阵
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8.%20%E4%BD%A9%E9%BE%99-%E5%BC%97%E7%BD%97%E8%B4%9D%E5%B0%BC%E4%B9%8C%E6%96%AF%E5%AE%9A%E7%90%86%E3%80%81%E7%A8%B3%E6%80%81%E4%B8%8E%E7%BB%86%E8%87%B4%E5%B9%B3%E8%A1%A1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8. 佩龙-弗罗贝尼乌斯定理、稳态与细致平衡
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    9. 非平衡态：不可逆性与熵产生的推论
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    9. 非平衡态：不可逆性与熵产生的推论
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reversible-process" class="md-nav__link">
    <span class="md-ellipsis">
      可逆过程 (Reversible Process)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#irreversible-process" class="md-nav__link">
    <span class="md-ellipsis">
      不可逆过程 (Irreversible Process)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10.%20%E5%9F%83%E4%BC%A6%E8%B4%B9%E6%96%AF%E7%89%B9%E6%A8%A1%E5%9E%8B%E3%80%81%E7%86%B5%E4%B8%8EKL%E6%95%A3%E5%BA%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10. 埃伦费斯特模型、熵与KL散度
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11.%20%E8%BF%9E%E7%BB%AD%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E4%B8%8E%E7%A6%8F%E5%85%8B-%E6%99%AE%E6%9C%97%E5%85%8B%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11. 连续马尔可夫过程与福克-普朗克方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12.%20%E5%B8%83%E6%9C%97%E8%BF%90%E5%8A%A8%E4%B8%8E%E5%A5%A5%E6%81%A9%E6%96%AF%E5%9D%A6-%E4%B9%8C%E4%BC%A6%E8%B4%9D%E5%85%8B%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    12. 布朗运动与奥恩斯坦-乌伦贝克过程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13.%20%E4%BD%9C%E4%B8%BA%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E9%87%87%E6%A0%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    13. 作为随机过程的蒙特卡洛采样
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14.%20%E5%93%88%E5%AF%86%E5%B0%94%E9%A1%BF%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E9%87%87%E6%A0%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    14. 哈密尔顿蒙特卡洛采样
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15.%20%E8%B6%8B%E5%8C%96%E6%80%A7%E3%80%81%E8%B7%91%E5%8A%A8-%E7%BF%BB%E6%BB%9A%E8%BF%90%E5%8A%A8%E4%B8%8EKeller-Segel%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15. 趋化性、跑动-翻滚运动与Keller-Segel模型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../16.%20Schnitzer%E6%A8%A1%E5%9E%8B%E3%80%81%E5%8F%8D%E5%B8%B8%E6%89%A9%E6%95%A3%E4%B8%8E%E8%BF%90%E5%8A%A8%E8%AF%B1%E5%AF%BC%E7%9B%B8%E5%88%86%E7%A6%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    16. Schnitzer模型、反常扩散与运动诱导相分离
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../17.%20%E6%9C%97%E4%B9%8B%E4%B8%87%E6%96%B9%E7%A8%8B%E3%80%81%E5%B8%83%E6%9C%97%E7%B2%92%E5%AD%90%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    17. 朗之万方程、布朗粒子与涨落-耗散定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18.%20%E7%A6%8F%E5%85%8B-%E6%99%AE%E6%9C%97%E5%85%8B%E6%96%B9%E7%A8%8B%E4%B8%8E%E6%96%AF%E6%91%A9%E6%A3%B1%E9%9C%8D%E5%A4%AB%E6%96%AF%E5%9F%BA%E6%96%B9%E7%A8%8B%EF%BC%9A%E4%BB%8E%E9%9A%8F%E6%9C%BA%E8%BD%A8%E8%BF%B9%E5%88%B0%E6%A6%82%E7%8E%87%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    18. 福克-普朗克方程与斯摩棱霍夫斯基方程：从随机轨迹到概率动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19.%20%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E8%A1%A8%E8%BF%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    19. 随机过程的路径积分表述
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.%20%E9%9A%8F%E6%9C%BA%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20. 随机微分方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.%20%E4%BC%8A%E8%97%A4%E7%A7%AF%E5%88%86%E4%B8%8E%E7%BB%9F%E4%B8%80%E7%9A%84%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    21. 伊藤积分与统一的随机过程框架
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.%20%E5%90%AB%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    22. 含乘性噪声系统的路径积分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.%20%E4%BB%8E%E7%B2%97%E7%B2%92%E5%8C%96%E5%88%B0%E8%BF%9E%E7%BB%AD%E5%9C%BA%E8%AE%BA%E6%B6%A8%E8%90%BD%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    23. 从粗粒化到连续场论涨落动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.%20%E6%98%82%E8%90%A8%E6%A0%BC%E7%B3%BB%E6%95%B0%E3%80%81%E5%80%92%E6%98%93%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%8A%A8%E6%80%81%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    24. 昂萨格系数、倒易关系与动态涨落-耗散定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../25.%20%E6%A2%AF%E5%BA%A6%E5%8A%A8%E5%8A%9B%E5%AD%A6%E3%80%81%E7%9B%B8%E5%8F%98%E4%B8%8E%E5%BC%9B%E8%B1%AB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    25. 梯度动力学、相变与弛豫
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../26.%20%E4%B8%B4%E7%95%8C%E6%85%A2%E5%8C%96%E3%80%81%E5%8A%A8%E6%80%81%E5%93%8D%E5%BA%94%E4%B8%8E%E5%AE%88%E6%81%92%E5%BE%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    26. 临界慢化、动态响应与守恒律
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../27.%20%E7%AE%80%E5%8D%95%E6%B5%81%E4%BD%93%E3%80%81%E6%97%A0%E6%91%A9%E6%93%A6%E6%B5%81%E4%BD%93%E4%B8%8E%E6%AC%A7%E6%8B%89%E6%96%B9%E7%A8%8B%E7%9A%84%E6%B5%81%E4%BD%93%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    27. 简单流体、无摩擦流体与欧拉方程的流体动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../28.%20%E7%B2%98%E6%80%A7%E6%B5%81%E4%BD%93%E3%80%81%E7%BA%B3%E7%BB%B4-%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E6%96%B9%E7%A8%8B%E3%80%81%E7%86%B5%E5%B9%B3%E8%A1%A1%E4%B8%8E%E7%83%AD%E4%BC%A0%E5%AF%BC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    28. 粘性流体、纳维-斯托克斯方程、熵平衡与热传导
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../29.%20%E4%B8%8D%E5%8F%AF%E9%80%86%E7%BA%BF%E6%80%A7%E7%83%AD%E5%8A%9B%E5%AD%A6%E4%B8%8E%E5%B9%B2%E6%80%A7%E6%89%A9%E6%95%A3%E7%B2%92%E5%AD%90%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    29. 不可逆线性热力学与干性扩散粒子系统
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../30.%20%E6%82%AC%E6%B5%AE%E5%9C%A8%E6%B5%81%E4%BD%93%E4%B8%AD%E7%9A%84%E5%B8%83%E6%9C%97%E7%B2%92%E5%AD%90%20%E2%80%94%20H%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    30. 悬浮在流体中的布朗粒子 — H模型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../31.%20%E5%8A%A8%E6%80%81%E6%B3%9B%E5%87%BD%E3%80%81%E5%8A%A0%E6%80%A7%E5%99%AA%E5%A3%B0%E5%9C%BA%E8%AE%BA%E4%B8%8EOnsager-Machlup%E6%B3%9B%E5%87%BD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    31. 动态泛函、加性噪声场论与Onsager-Machlup泛函
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../32.%20Janssen-De%20Dominicis%20%E5%93%8D%E5%BA%94%E6%B3%9B%E5%87%BD%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%85%B3%E7%B3%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    32. Janssen-De Dominicis 响应泛函与涨落-耗散关系
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../33.%20%E9%9D%9E%E5%B9%B3%E8%A1%A1%E5%8A%9F%E4%B8%8E%E6%B6%A8%E8%90%BD%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    33. 非平衡功与涨落定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../34.%20%E6%9C%89%E5%90%91%E6%B8%97%E6%B5%81%E3%80%81%E5%90%B8%E6%94%B6%E6%80%81%E4%B8%8E%E8%B0%B1%E6%96%B9%E6%B3%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    34. 有向渗流、吸收态与谱方法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../35.%20%E4%B8%BB%E6%96%B9%E7%A8%8B%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E8%A1%A8%E7%A4%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    35. 主方程的路径积分表示
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../36.%20%E7%9B%B8%E5%B9%B2%E6%80%81%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E3%80%81%E7%AE%97%E7%AC%A6%E4%BB%A3%E6%95%B0%E4%B8%8E%E8%99%9A%E5%99%AA%E5%A3%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    36. 相干态路径积分、算符代数与虚噪声
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../37.%20Kramers-Moyal%20%E5%B1%95%E5%BC%80%E4%B8%8E%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E7%9A%84%E4%BD%8E%E5%99%AA%E5%A3%B0%E6%9E%81%E9%99%90/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    37. Kramers-Moyal 展开与路径积分的低噪声极限
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../38.%20%E5%A4%9A%E7%89%A9%E7%A7%8D%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E4%B8%8E%E5%BE%AA%E7%8E%AF%E7%AB%9E%E4%BA%89%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    38. 多物种路径积分与循环竞争动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../39.%20%E4%BB%8E%E7%B2%92%E5%AD%90%E8%B7%B3%E8%B7%83%E5%88%B0%E8%BF%9E%E7%BB%AD%E5%9C%BA%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    39. 从粒子跳跃到连续场论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../40.%20%E7%BB%9F%E4%B8%80%E7%9A%84%E5%9C%BA%E8%AE%BA%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    40. 统一的场论框架
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="_1">引言<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>这节课是随机过程理论学习中的一个关键节点。在前几讲中，我们已经建立了主方程 (Master Equation) 这一核心框架，它描述了系统在不同状态间跳转的概率如何随时间演化。现在，我们将从单纯描述"如何"演化，深入到探讨其背后更深层次的物理"为什么"，即这些演化过程的热力学意义。</p>
<p><strong>我们将踏出平衡态的理想世界，进入一个更广阔、更真实的领域：非平衡态物理 (Non-equilibrium Physics)。</strong>当细致平衡被打破时，系统会出现持续的概率流，就像河流中稳定的水流一样。这种单向的、不可逆的流动正是生命活动、化学反应和所有由外部能量驱动的系统的标志。我们将学习如何从单条随机轨迹出发，精确地量化这种不可逆性 (Irreversibility)，并最终定义出熵产生 (Entropy Production)。这个量，正是热力学第二定律在微观随机世界中的直接体现。</p>
<p>可以说，这一讲是连接微观随机事件与宏观热力学“时间之箭”的关键桥梁。</p>
<p>本节课的核心主题是区分两类截然不同的随机过程：</p>
<h2 id="reversible-process">可逆过程 (Reversible Process)<a class="headerlink" href="#reversible-process" title="Permanent link">&para;</a></h2>
<p>这类过程是随机系统达到<strong>热力学平衡 (Thermodynamic Equilibrium)</strong> 的微观体现，其核心标志是满足<strong>细致平衡 (Detailed Balance)</strong> 条件。在这样的系统中，时间的“箭头”消失了，过去与未来在统计上无法区分。</p>
<p>我们可以从以下几个层面来理解其深刻内涵：</p>
<ol>
<li>
<p><strong>时间的对称性</strong>：想象一下我们用摄像机记录下一个可逆过程的演化轨迹，然后将录像带<strong>倒着播放</strong>。从统计学的角度来看，倒放的影片和一个正常播放的影片是无法区分的。例如，观察一个处于平衡态的气体中的单个花粉粒（布朗运动），它在水中随机地、毫无目的地飘动。无论正放还是倒放，我们看到的都是同样杂乱无章的随机运动。这种时间上的对称性，是可逆过程最直观的特征。</p>
</li>
<li>
<p><strong>微观的完美平衡</strong>：这种宏观上的时间对称性，源于微观层面每一个独立过程都与其逆过程达到了完美的平衡。这正是<strong>细致平衡条件</strong>的数学表达：
    <span class="arithmatex">\(<span class="arithmatex">\(\pi_j w_{j \to k} = \pi_k w_{k \to j}\)</span>\)</span>
    这个公式告诉我们，在稳态下，从任意状态 <span class="arithmatex">\(j\)</span> 跳转到状态 <span class="arithmatex">\(k\)</span> 的总概率流（左侧），都<strong>精确地</strong>被从 <span class="arithmatex">\(k\)</span> 反向跳转回 <span class="arithmatex">\(j\)</span> 的总概率流（右侧）所抵消。这种平衡发生在<strong>每一对</strong>直接相连的状态之间，而非仅仅是整个系统的宏观平衡。</p>
</li>
<li>
<p><strong>无净环流的“静态”平衡</strong>：由于每一条“微观路径”都与其逆过程完全平衡，系统内部不可能存在任何持续的、净的概率环流。我们可以用一个<strong>湖泊</strong>来比喻：湖水处于平衡状态，宏观水位不变。在微观层面，水分子在不停运动，但从任意点A到点B的水分子流，都会被从点B到点A的分子流精确抵消。整个湖泊虽然内部高度动态，但宏观上没有任何净水流。这正是热力学平衡的本质——一个看似“寂静”，实则在微观层面“喧闹”不休的动态平衡。</p>
</li>
<li>
<p><strong>简单的动力学行为</strong>：正如讲座中所推导的，满足细致平衡的系统，其动力学演化也异常“纯粹”。系统从任意初始状态趋向平衡的过程，是一种平滑的、<strong>无振荡的指数弛豫</strong>。这表明系统会以最直接、最单调的方式“滑向”其最稳定的平衡态，不会出现复杂的周期性行为。</p>
</li>
</ol>
<h2 id="irreversible-process">不可逆过程 (Irreversible Process)<a class="headerlink" href="#irreversible-process" title="Permanent link">&para;</a></h2>
<p>这类过程打破了细致平衡的严格约束，是所有活跃的、消耗能量的<strong>非平衡系统 (Non-equilibrium Systems)</strong> 的共同特征。正是这种不平衡，赋予了时间一个明确的方向，是我们体验到的“时间之箭”在微观世界的起源。</p>
<ol>
<li>
<p><strong>时间的非对称性</strong>：对于一个不可逆过程，正放和倒放的录像在统计上是<strong>截然不同</strong>的。想象一个细胞内的分子马达沿着微管“行走”，它消耗ATP提供的能量，稳定地朝一个方向运动。如果我们倒放这个录像，会看到一个分子马达“反向”行走，并在这个过程中“合成”ATP——这在物理上是不可能自发发生的。这种统计上的非对称性，为时间赋予了明确的方向。</p>
</li>
<li>
<p><strong>持续的微观流动</strong>：不可逆性的根源在于细致平衡被打破，即 <span class="arithmatex">\(\pi_j w_{j \to k} \neq \pi_k w_{k \to j}\)</span>。这意味着在状态 <span class="arithmatex">\(j\)</span> 和 <span class="arithmatex">\(k\)</span> 之间，存在一个<strong>净的概率流</strong>。当这些净流在系统中形成一个或多个闭合循环时（即不满足柯尔莫哥洛夫循环准则），系统就处在一个<strong>非平衡稳态 (Non-Equilibrium Steady State, NESS)</strong>。</p>
</li>
<li>
<p><strong>由能量驱动的“动态”平衡</strong>：我们可以用一条<strong>河流</strong>来比喻这种状态。河流的水位可以是稳定的（稳态），但这需要有源源不断的水从上游流入（能量输入）。在河流的任何一个截面，流入和流出的水量相等，维持了水位的稳定（这对应于比细致平衡更弱的“全局平衡”条件）。然而，河水整体有一个明确的下游方向，存在着<strong>净的水流</strong>。生命系统，如一个活细胞，就是这样一个由持续的新陈代谢（能量流）维持的、高度有序的非平衡稳态。</p>
</li>
<li>
<p><strong>熵的持续产生</strong>：这种单向的、不可逆的流动是有代价的，这个代价就是<strong>熵的持续产生</strong>。正如讲座中所定义的，我们可以通过比较一条正向轨迹 <span class="arithmatex">\(\gamma\)</span> 与其逆向轨迹 <span class="arithmatex">\(\bar{\gamma}\)</span> 的发生概率，来精确量化这种不可逆性。其对数比值，即<strong>熵产生</strong> <span class="arithmatex">\(\Delta s[\gamma] = \ln(P[\gamma]/P[\bar{\gamma}])\)</span>，总是非负的。对于一个非平衡稳态系统，其<strong>平均熵产生速率</strong> <span class="arithmatex">\(\sigma\)</span> 是一个大于零的常数，它衡量了系统维持其动态活动所需要付出的、向环境中“耗散”能量的速率。这个量，正是热力学第二定律在随机过程层面最精确的数学表达。</p>
</li>
</ol>
<h1 id="1">1. 细致平衡<a class="headerlink" href="#1" title="Permanent link">&para;</a></h1>
<p>热平衡这一物理条件会给系统的数学描述带来强大的约束，使得其动态行为变得异常简洁和可预测。</p>
<h2 id="11">1.1 再探主方程：随机过程的游戏规则<a class="headerlink" href="#11" title="Permanent link">&para;</a></h2>
<p><img alt="课堂板书截图" src="../../../assets/images/remote/0a3803ab-54cd-47f8-b070-26b379ba1408-96a6c2ee27.jpg" /></p>
<p>讲座从回顾主方程开始，这是我们整个理论体系的基石。</p>
<div class="arithmatex">\[
\frac{d\mathbf{p}(t)}{dt} = Q \cdot \mathbf{p}(t)
\]</div>
<p>这个方程描述了在一个连续时间的马尔可夫过程中，概率如何随时间演化。我们可以将其写成分量的形式，以便更清晰地理解其物理意义：</p>
<div class="arithmatex">\[
\frac{dp_n(t)}{dt} = \sum_{m \neq n} (p_m(t) w_{m \to n} - p_n(t) w_{n \to m})
\]</div>
<p><strong>物理意义</strong>：这个形式清楚地展示了状态 <span class="arithmatex">\(n\)</span> 的概率 <span class="arithmatex">\(p_n(t)\)</span> 随时间的变化，是由一个"流入项"和一个"流出项"共同决定的。</p>
<p><strong>流入项 (Gain Term)</strong>: <span class="arithmatex">\(\sum_{m \neq n} p_m(t) w_{m \to n}\)</span> 表示从所有其他状态 <span class="arithmatex">\(m\)</span> 跳转到状态 <span class="arithmatex">\(n\)</span> 的总速率。</p>
<p><strong>流出项 (Loss Term)</strong>: <span class="arithmatex">\(\sum_{m \neq n} p_n(t) w_{n \to m} = p_n(t) \sum_{m \neq n} w_{n \to m}\)</span> 表示从状态 <span class="arithmatex">\(n\)</span> 跳转到任何其他状态的总速率。</p>
<p>Q-矩阵的另一个重要性质是其<strong>列和为零</strong>：</p>
<div class="arithmatex">\[
\sum_n Q_{nm} = 0
\]</div>
<p><strong>物理意义</strong>：这个性质是<strong>概率守恒</strong>的数学体现。<span class="arithmatex">\(Q_{mm} = -\sum_{n \neq m} w_{m \to n}\)</span> 是从状态 <span class="arithmatex">\(m\)</span> 流出的总速率，而 <span class="arithmatex">\(\sum_{n \neq m} Q_{nm} = \sum_{n \neq m} w_{m \to n}\)</span> 是流入到其他所有状态的总速率。两者相加为零，意味着粒子离开状态 <span class="arithmatex">\(m\)</span> 后，必然会进入某个其他状态 <span class="arithmatex">\(n\)</span>，总概率始终保持为1。</p>
<h2 id="12">1.2 细致平衡原理：平衡态的标志<a class="headerlink" href="#12" title="Permanent link">&para;</a></h2>
<p>对于一类特殊的过程，即<strong>可逆过程 (Reversible Processes)</strong>，系统会达到一个非常特殊的稳态，这个稳态由<strong>细致平衡 (Detailed Balance, DB)</strong> 条件定义。</p>
<div class="arithmatex">\[
\pi_i w_{i \to j} = \pi_j w_{j \to i}
\]</div>
<p><span class="arithmatex">\(\pi_i\)</span> 和 <span class="arithmatex">\(\pi_j\)</span> 是系统处于状态 <span class="arithmatex">\(i\)</span> 和 <span class="arithmatex">\(j\)</span> 的稳态概率。
<span class="arithmatex">\(w_{i \to j}\)</span> 是从 <span class="arithmatex">\(i\)</span> 到 <span class="arithmatex">\(j\)</span> 的转移速率。
<span class="arithmatex">\(\pi_i w_{i \to j}\)</span> 是在稳态下，单位时间内从状态 <span class="arithmatex">\(i\)</span> 跳转到状态 <span class="arithmatex">\(j\)</span> 的<strong>概率流 (Probability Flux)</strong>。</p>
<p><strong>物理意义</strong>：细致平衡不仅仅是一个数学公式，它是一个深刻的物理陈述，即<strong>微观可逆性原理</strong>。在热平衡状态下，任何两个状态之间的概率流都是双向且完全相等的。从 <span class="arithmatex">\(i\)</span> 到 <span class="arithmatex">\(j\)</span> 的流量被从 <span class="arithmatex">\(j\)</span> 到 <span class="arithmatex">\(i\)</span> 的流量精确抵消。这意味着净概率流 <span class="arithmatex">\(J_{ij} = \pi_i w_{i \to j} - \pi_j w_{j \to i}\)</span> 对所有状态对 <span class="arithmatex">\((i,j)\)</span> 都精确为零。我们可以将其比作一条繁忙的双向街道，向北行驶的车辆数量恰好等于向南行驶的车辆数量，因此没有净交通流。</p>
<p><strong>重要辨析：细致平衡是稳态的充分非必要条件</strong></p>
<p><strong>稳态 (Steady State)</strong> 的定义是概率分布不随时间变化，即 <span class="arithmatex">\(\frac{d\mathbf{p}(t)}{dt} = 0\)</span>，也就是 <span class="arithmatex">\(Q \cdot \boldsymbol{\pi} = 0\)</span>。</p>
<p><strong>细致平衡 (Detailed Balance)</strong> 是一个更强的条件。如果细致平衡成立，我们可以证明稳态条件也必然成立。然而，反过来不一定。系统可以处于一个概率分布恒定，但内部存在持续的、非零的净概率流的稳态。这种状态被称为<strong>非平衡稳态 (Non-Equilibrium Steady State, NESS)</strong>，我们将在第二部分详细探讨。</p>
<p>因此，细致平衡定义了所有稳态中的一个特殊子集——<strong>平衡态</strong>。</p>
<h2 id="13">1.3 对称性的力量：简化系统动力学<a class="headerlink" href="#13" title="Permanent link">&para;</a></h2>
<p>细致平衡条件的一个强大推论是，它允许我们通过一个相似变换，将通常不对称的 Q-矩阵<strong>对称化</strong> 。定义一个新的矩阵 <span class="arithmatex">\(\tilde{Q}\)</span>：</p>
<div class="arithmatex">\[
\tilde{Q}_{mn} := \pi_m^{-1/2} Q_{mn} \pi_n^{1/2}
\]</div>
<p>如果系统满足细致平衡，那么这个新的 <span class="arithmatex">\(\tilde{Q}\)</span> 矩阵是<strong>对称</strong>的，即 <span class="arithmatex">\(\tilde{Q}_{mn} = \tilde{Q}_{nm}\)</span>。</p>
<p><strong>推导过程</strong>：</p>
<p>对于非对角元素 (<span class="arithmatex">\(m \neq n\)</span>)，我们有 <span class="arithmatex">\(Q_{mn} = w_{n \to m}\)</span>。</p>
<div class="arithmatex">\[
\tilde{Q}_{mn} = \pi_m^{-1/2} w_{n \to m} \pi_n^{1/2}
\]</div>
<p>利用细致平衡条件 <span class="arithmatex">\(w_{n \to m} = w_{m \to n} \frac{\pi_n}{\pi_m}\)</span>，代入上式：</p>
<div class="arithmatex">\[
\tilde{Q}_{mn} = \pi_m^{-1/2} (w_{m \to n} \frac{\pi_n}{\pi_m}) \pi_n^{1/2} = \pi_m^{1/2} w_{m \to n} \pi_n^{-1/2}
\]</div>
<p>另一方面，我们计算 <span class="arithmatex">\(\tilde{Q}_{nm}\)</span>：</p>
<div class="arithmatex">\[
\tilde{Q}_{nm} = \pi_n^{-1/2} Q_{nm} \pi_m^{1/2} = \pi_n^{-1/2} w_{m \to n} \pi_m^{1/2}
\]</div>
<p>比较两式，我们发现 <span class="arithmatex">\(\tilde{Q}_{mn} = \tilde{Q}_{nm}\)</span>，证明了其对称性。</p>
<p>这个数学上的"技巧"为何如此重要？因为它揭示了平衡系统动力学的深刻物理特性：</p>
<p>1.<strong>实数特征值</strong>：对称矩阵（或更广义的厄米矩阵）保证其所有特征值都是实数。在我们的问题中，Q-矩阵的特征值为 <span class="arithmatex">\(-\lambda\)</span>。这意味着弛豫速率 <span class="arithmatex">\(\lambda\)</span> 都是实数。</p>
<p>2.<strong>非振荡弛豫</strong>：特征值为实数，意味着系统向平衡态的演化过程是纯粹的指数衰减，而不会出现振荡。主方程的通解可以写成特征模式的叠加：
$$
p(t) = \sum_{\lambda} c_{\lambda} \Phi(\lambda) e^{-\lambda t}
$$</p>
<p>其中 <span class="arithmatex">\(\lambda &gt; 0\)</span>（对于非稳态模式），这代表了系统从任意初始状态向唯一稳态 <span class="arithmatex">\(\boldsymbol{\pi}\)</span>（对应于 <span class="arithmatex">\(\lambda = 0\)</span> 的模式）的弛豫过程是平滑的、非振荡的。</p>
<p>3.<strong>正交基底</strong>：对称矩阵的特征向量构成一个完备的正交基底。这意味着任何初始概率分布都可以唯一地分解为这些基本"弛豫模式"的线性组合。</p>
<p>总之，Q-矩阵的可对称化是平衡系统不存在内在循环动力学的数学体现，它将抽象的马尔可夫过程与保守系统的物理学联系起来。</p>
<h2 id="14">1.4 柯尔莫哥洛夫循环准则：一个直观的平衡态判据<a class="headerlink" href="#14" title="Permanent link">&para;</a></h2>
<p><img alt="课堂板书截图" src="../../../assets/images/remote/29fdf51d-a3ad-4734-80ca-dfd0939d69b3-9f69c97201.jpg" /></p>
<p><img alt="课堂板书截图" src="../../../assets/images/remote/8a8bb30d-0c3f-49d7-8a36-d1b0d0dc085a-11da98d628.png" /></p>
<p>除了代数形式的细致平衡条件，还有一个等价的、更直观的几何判据——<strong>柯尔莫哥洛夫循环准则 (Kolmogorov's Loop Criterion)</strong> 。该准则指出，一个不可约的马尔可夫过程是可逆的（即满足细致平衡），当且仅当对于状态空间中的<strong>任何闭合循环</strong>，顺时针方向的转移速率之积等于逆时针方向的转移速率之积。</p>
<div class="arithmatex">\[w_{1 \to 2} w_{2 \to 3} \cdots w_{N \to 1} = w_{1 \to N} w_{N \to N-1} \cdots w_{2 \to 1}\]</div>
<p><strong>直观理解</strong>：以一个简单的三状态系统 <span class="arithmatex">\(\{1, 2, 3\}\)</span> 为例，此准则要求：</p>
<div class="arithmatex">\[
w_{1 \to 2} w_{2 \to 3} w_{3 \to 1} = w_{2 \to 1} w_{3 \to 2} w_{1 \to 3}
\]</div>
<p>如果这个等式不成立，例如顺时针的乘积大于逆时针，就意味着系统内部存在一个持续的、顺时针方向的<strong>净概率环流 (Net Probability Circulation)</strong>。这种净环流是不可逆性的根本标志。只要系统中存在哪怕一个循环不满足此准令，系统就必然处于非平衡状态，其稳态必须由外部能量输入来维持。</p>
<p>这个准则为我们提供了一个强大的视觉工具，它将不可逆性与状态空间中的"循环"直接联系起来，为我们接下来量化熵产生和通量奠定了概念基础。</p>
<h1 id="2">2. 超越平衡态 —— 不可逆性与时间之箭<a class="headerlink" href="#2" title="Permanent link">&para;</a></h1>
<p>在这一部分，我们将告别简洁的平衡世界，进入更为普遍的非平衡领域。这些系统是活跃的、动态的，并且具有明确的时间方向。我们的目标是量化这种"<strong>方向性</strong>"。</p>
<h2 id="21-ness">2.1 当平衡被打破：非平衡稳态 (NESS)<a class="headerlink" href="#21-ness" title="Permanent link">&para;</a></h2>
<p>当细致平衡条件不被满足时，系统仍然可以达到一个稳态，即概率分布不随时间改变 <span class="arithmatex">\(\frac{d\mathbf{p}(t)}{dt} = 0\)</span>。然而，此时系统内部存在持续的、非零的净概率流 <span class="arithmatex">\(J_{ij} = \pi_i w_{i \to j} - \pi_j w_{j \to i} \neq 0\)</span>。这就是<strong>非平衡稳态 (Non-Equilibrium Steady State, NESS)</strong> 。</p>
<p>一个绝佳的类比是喷泉：水池中的水位（对应概率）保持恒定，但这并不是因为水是静止的，而是因为水泵在持续地将水抽上高处，水又不断地流回水池。这个过程维持了一个动态的平衡，需要持续的能量输入（水泵做功）来抵抗重力（耗散）。同样，生命系统、电路、以及所有执行功能的分子机器都工作在 NESS 状态。</p>
<h2 id="22">2.2 正向与反向轨迹<a class="headerlink" href="#22" title="Permanent link">&para;</a></h2>
<p>为了量化不可逆性，我们需要比较系统演化的一条<strong>正向轨迹 (Forward Trajectory)</strong> 与其<strong>时间反演后的反向轨迹 (Backward Trajectory)</strong> 发生的概率。</p>
<p><img alt="课堂板书截图" src="../../../assets/images/remote/753f43e4-2aca-4959-8ec4-2fcaeb4bd3e5-803145793f.png" /></p>
<p>首先定义一条正向轨迹 <span class="arithmatex">\(\gamma\)</span> 为一个状态序列和在每个状态的停留时间：</p>
<div class="arithmatex">\[\gamma: 0 \xrightarrow{\tau_1} 1 \xrightarrow{\tau_2} \cdots \xrightarrow{\tau_n} n\]</div>
<p>这条轨迹的概率（严格来说是概率密度）<span class="arithmatex">\(P[\gamma]\)</span> 是如何构建的呢？它由一系列事件概率的乘积构成：</p>
<ol>
<li>
<p><strong>初始概率</strong>: 首先，系统在时刻 <span class="arithmatex">\(t=0\)</span> 处于状态 <span class="arithmatex">\(0\)</span> 的概率是 <span class="arithmatex">\(\pi_0\)</span>。</p>
</li>
<li>
<p><strong>等待概率</strong>: 在状态 <span class="arithmatex">\(k\)</span> 停留时间 <span class="arithmatex">\(\tau_k\)</span> 而不发生跳转的概率。这是一个泊松过程，其概率为 <span class="arithmatex">\(e^{-\alpha_k \tau_k}\)</span>，其中 <span class="arithmatex">\(\alpha_k = \sum_{\ell \neq k} w_{k \to \ell}\)</span> 是离开状态 <span class="arithmatex">\(k\)</span> 的总速率，也叫<strong>出射速率 (exit rate)</strong> 。</p>
</li>
<li>
<p><strong>跳转概率</strong>: 发生一次从 <span class="arithmatex">\(k\)</span> 到 <span class="arithmatex">\(k+1\)</span> 跳转的概率正比于转移速率 <span class="arithmatex">\(w_{k \to k+1}\)</span>。</p>
</li>
</ol>
<p>将这些部分组合起来，我们得到正向轨迹的概率：</p>
<div class="arithmatex">\[P[\gamma] = \pi_0 \cdot e^{-\alpha_0 \tau_0} \cdot w_{0 \to 1} \cdot e^{-\alpha_1 \tau_1} \cdot w_{1 \to 2} \cdots w_{n-1 \to n} \cdot e^{-\alpha_n \tau_n}\]</div>
<p>类似地，我们可以定义时间反演的轨迹 <span class="arithmatex">\(\bar{\gamma}\)</span>，它从状态 <span class="arithmatex">\(n\)</span> 开始，逆序经过相同的状态，最终回到状态 <span class="arithmatex">\(0\)</span>。其概率为：</p>
<div class="arithmatex">\[P[\bar{\gamma}] = \pi_n \cdot e^{-\alpha_n \tau_n} \cdot w_{n \to n-1} \cdots w_{1 \to 0} \cdot e^{-\alpha_0 \tau_0}\]</div>
<h2 id="23">2.3 量化不可逆性：沿路径的熵产生<a class="headerlink" href="#23" title="Permanent link">&para;</a></h2>
<p>不可逆性的核心在于正向和反向轨迹的概率不再相等。我们可以通过计算它们的比值来量化这种不对称性：</p>
<div class="arithmatex">\[\frac{P[\bar{\gamma}]}{P[\gamma]} = \frac{\pi_n e^{-\alpha_n \tau_n} w_{n \to n-1} \cdots w_{1 \to 0} e^{-\alpha_0 \tau_0}}{\pi_0 e^{-\alpha_0 \tau_0} w_{0 \to 1} \cdots w_{n-1 \to n} e^{-\alpha_n \tau_n}}\]</div>
<p>一个非常深刻的结果是，所有与停留时间相关的指数项 <span class="arithmatex">\(e^{-\alpha_k \tau_k}\)</span> 都被精确地消掉了！这告诉我们，不可逆性（以及后续定义的熵产生）的根源在于<strong>状态之间的跳转</strong>，而不是在某个状态上的等待。</p>
<p>简化后，我们得到：</p>
<div class="arithmatex">\[\frac{P[\bar{\gamma}]}{P[\gamma]} = \frac{\pi_n}{\pi_0} \cdot \frac{w_{n \to n-1} w_{n-1 \to n-2} \cdots w_{1 \to 0}}{w_{0 \to 1} w_{1 \to 2} \cdots w_{n-1 \to n}}\]</div>
<p>基于这个比值，我们可以定义沿轨迹 <span class="arithmatex">\(\gamma\)</span> 的<strong>总熵产生 (Total Entropy Production)</strong> <span class="arithmatex">\(\Delta s[\gamma]\)</span>：</p>
<div class="arithmatex">\[\Delta s[\gamma] = \ln \frac{P[\bar{\gamma}]}{P[\gamma]}\]</div>
<p>这个对数比值的形式并非偶然，它与信息论中的<strong>相对熵 (Kullback-Leibler Divergence)</strong> 有着深刻的联系。</p>
<p><strong>物理意义</strong>：<span class="arithmatex">\(\Delta s[\gamma]\)</span> 量化了我们区分正向轨迹和反向轨迹的能力。</p>
<p>如果 <span class="arithmatex">\(\Delta s[\gamma] \gg 0\)</span>，意味着 <span class="arithmatex">\(P[\gamma] \gg P[\bar{\gamma}]\)</span>，正向过程比反向过程更容易发生，时间之箭的方向非常明确。</p>
<p>如果系统满足细致平衡，那么平均而言，这个比值会是1，<span class="arithmatex">\(\Delta s[\gamma]\)</span> 会在0附近波动，表明过程是时间对称的。</p>
<p><strong>信息论视角</strong>：熵产生可以被看作是我们通过观察轨迹来判断时间流向所获得的信息量。一个不可逆的过程会不断产生信息，从而区分过去和未来。</p>
<h2 id="24">2.4 解构熵：系统与环境<a class="headerlink" href="#24" title="Permanent link">&para;</a></h2>
<p><img alt="课堂板书截图" src="../../../assets/images/remote/d723de81-a899-417c-b628-84c13c7759d1-161752927f.jpg" /></p>
<p>总熵产生可以被分解为两个有明确物理意义的部分：</p>
<div class="arithmatex">\[\Delta s[\gamma] = \ln\left(\frac{\pi_n}{\pi_0}\right) + \sum_{k=1}^{n} \ln\left(\frac{w_{k \to k-1}}{w_{k-1 \to k}}\right)\]</div>
<p>我们将这两项分别定义为：</p>
<ol>
<li><strong>系统熵变 (System Entropy Change)</strong>: </li>
</ol>
<div class="arithmatex">\[
(\Delta s)_{\text{system}} = \ln\left(\frac{\pi_n}{\pi_0}\right) = -\ln \pi_n - (-\ln \pi_0)
\]</div>
<p>这一项只依赖于轨迹的初末状态，而与中间经过的路径无关。这是<strong>状态函数 (State Function)</strong> 的典型特征。它代表了系统自身信息熵的变化（以玻尔兹曼熵 <span class="arithmatex">\(S = -k_B \ln p\)</span> 的形式）。</p>
<ol>
<li><strong>环境熵变 (Environment Entropy Change)</strong>: </li>
</ol>
<div class="arithmatex">\[
(\Delta s)_{\text{env}} = \sum_{k=1}^{n} \ln\left(\frac{w_{k \to k-1}}{w_{k-1 \to k}}\right)
\]</div>
<p>这一项是轨迹中每一步跳转贡献的总和。如果从状态0到状态n换一条不同的路径，这个值就会改变。这是<strong>路径函数 (Path Function)</strong> 的特征，类似于经典热力学中的热和功。它代表了为了驱动这条轨迹发生，系统与环境之间交换的熵（通常以热量的形式）。</p>
<p>这个分解是随机热力学的基石，它将宏观热力学第二定律在单条微观轨迹的层面上进行了精确的重述：</p>
<div class="arithmatex">\[
\Delta s_{\text{total}} = \Delta s_{\text{sys}} + \Delta s_{\text{env}}
\]</div>
<h2 id="25-sigma">2.5 平均熵产生速率 <span class="arithmatex">\(\sigma\)</span><a class="headerlink" href="#25-sigma" title="Permanent link">&para;</a></h2>
<p>对于一个处于非平衡稳态 (NESS) 的系统，我们更关心的是其长期、持续的熵产生能力。这通过<strong>平均熵产生速率 (Average Entropy Production Rate)</strong> <span class="arithmatex">\(\sigma\)</span> 来衡量。</p>
<div class="arithmatex">\[\sigma = \lim_{T \to \infty} \frac{1}{T} \langle \Delta s[\gamma] \rangle\]</div>
<p>这里的 <span class="arithmatex">\(\langle \cdot \rangle\)</span> 表示对所有在时间 <span class="arithmatex">\(T\)</span> 内可能发生的轨迹进行平均。在长时间极限下，系统熵变 <span class="arithmatex">\((\Delta s)_{\text{system}}\)</span> 的贡献会因其仅依赖于初末状态而被平均掉，起主导作用的是环境熵变。</p>
<p>经过推导，可以得到一个极其优美的最终表达式：</p>
<div class="arithmatex">\[
\sigma = \frac{1}{2} \sum_{i,j} (\pi_i w_{i \to j} - \pi_j w_{j \to i}) \ln\left(\frac{\pi_j w_{j \to i}}{\pi_i w_{i \to j}}\right)
\]</div>
<p>这个公式也可以写作：</p>
<div class="arithmatex">\[
\sigma = \sum_{i &lt; j} J_{ij} \ln \left( \frac{w_{i \to j}}{w_{j \to i}} \right)
\]</div>
<p><strong>深刻的物理结构</strong>：这个表达式具有<strong>（通量）x（热力学力）</strong>的普适结构，这是所有不可逆过程耗散理论的核心。</p>
<p><strong>通量 (Flux)</strong>: <span class="arithmatex">\(J_{ij} = \pi_i w_{i \to j} - \pi_j w_{j \to i}\)</span> 是状态间的净概率流。</p>
<p><strong>热力学力 (Thermodynamic Force)</strong>: <span class="arithmatex">\(A_{ij} = \ln\left(\frac{w_{j \to i}}{w_{i \to j}}\right)\)</span> 是驱动该通量产生的"<strong>力</strong>"。</p>
<p><strong>非负性</strong>：利用不等式 <span class="arithmatex">\((x-y)\ln(x/y) \geq 0\)</span>，可以证明 <span class="arithmatex">\(\sigma \geq 0\)</span>。等号成立的唯一条件是，对所有的状态对 <span class="arithmatex">\((i,j)\)</span>，净通量 <span class="arithmatex">\(J_{ij} = 0\)</span>。这恰恰就是细致平衡的条件。</p>
<p>因此，任何偏离热平衡的系统（任何 NESS）都必然是一个持续产生熵的"机器"。<span class="arithmatex">\(\sigma\)</span> 就是维持其非平衡结构和功能所必须付出的、不可避免的热力学代价。</p>
<h1 id="3-python">3. Python 模拟<a class="headerlink" href="#3-python" title="Permanent link">&para;</a></h1>
<h2 id="31">3.1 模拟一个可逆系统：粒子在三势阱中的热运动<a class="headerlink" href="#31" title="Permanent link">&para;</a></h2>
<p>想象一个微观粒子（例如胶体颗粒）浸润在恒温的热浴中，并被限制在一个具有三个稳定深度的“势阱”（Potential Well）中运动。由于来自周围液体分子的随机碰撞（热涨落），这个粒子有足够的能量跳越势阱之间的“能垒”，从而在三个状态（<strong>阱A</strong>、<strong>阱B</strong>、<strong>阱C</strong>）之间随机跃迁。由于整个系统与一个单一温度的热浴达到平衡，它必然满足细致平衡条件，是一个完美的可逆过程。</p>
<p><strong>实现思路</strong>:</p>
<ol>
<li><strong>构建能量景观</strong>: 我们设定三个势阱的能量深度 (<span class="arithmatex">\(E_A, E_B, E_C\)</span>) 和它们之间的能垒高度。</li>
<li><strong>计算速率</strong>: 跃迁速率由<strong>阿伦尼乌斯定律</strong>给出，即从一个深阱跳到一个浅阱要比反向过程容易得多。从状态 <span class="arithmatex">\(i\)</span> 到 <span class="arithmatex">\(j\)</span> 的速率 <span class="arithmatex">\(w_{i \to j} \propto \exp(-\frac{\Delta E_{\text{barrier}}}{k_B T})\)</span>。</li>
<li><strong>理论稳态</strong>: 在热平衡下，粒子在每个势阱中被发现的概率遵循<strong>玻尔兹曼分布</strong>，即 <span class="arithmatex">\(\pi_i \propto \exp(-\frac{E_i}{k_B T})\)</span>。能量越低的势阱，粒子待在里面的概率越高。</li>
<li><strong>分析与验证</strong>: 我们将运行 Gillespie 模拟，并验证其轨迹在统计上没有净的环流，且最终的占据概率精确地收敛到理论上的玻尔兹曼分布。</li>
</ol>
<p><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gillespie_simulation</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">initial_state</span><span class="p">,</span> <span class="n">T_max</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a continuous-time Markov process using the Gillespie algorithm.</span>

<span class="sd">    Args:</span>
<span class="sd">        Q (np.array): The transition rate matrix (Q_ij = w_j-&gt;i).</span>
<span class="sd">        initial_state (int): The starting state.</span>
<span class="sd">        T_max (float): The maximum simulation time.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple containing lists of times, states, and transitions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_states</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_states</span><span class="p">)</span>

    <span class="n">current_state</span> <span class="o">=</span> <span class="n">initial_state</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="n">time_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">]</span>
    <span class="n">state_trajectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_state</span><span class="p">]</span>
    <span class="n">transitions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T_max</span><span class="p">:</span>
        <span class="n">rates_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Q</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">current_state</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">states</span> <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">current_state</span><span class="p">])</span>
        <span class="n">total_rate_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rates_out</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">total_rate_out</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">total_rate_out</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
        <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;=</span> <span class="n">T_max</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="n">possible_next_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">states</span> <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">current_state</span><span class="p">]</span>
        <span class="n">probabilities</span> <span class="o">=</span> <span class="n">rates_out</span> <span class="o">/</span> <span class="n">total_rate_out</span>
        <span class="n">next_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">possible_next_states</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">probabilities</span><span class="p">)</span>

        <span class="n">transitions</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">current_state</span><span class="p">,</span> <span class="n">next_state</span><span class="p">))</span>
        <span class="n">current_state</span> <span class="o">=</span> <span class="n">next_state</span>

        <span class="n">time_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">state_trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_state</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">time_points</span><span class="p">,</span> <span class="n">state_trajectory</span><span class="p">,</span> <span class="n">transitions</span>

<span class="c1"># --- 1. Reversible System: Particle in a Triple-Well Potential ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Simulating Reversible System (Thermal Equilibrium) ---&quot;</span><span class="p">)</span>

<span class="c1"># Physical Parameters (in units of k_B*T, so k_B*T=1)</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span> <span class="c1"># Energy of wells A, B, C</span>
<span class="n">E_barrier_base</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># Energy barrier height relative to the higher well</span>
<span class="n">prefactor</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># Arrhenius prefactor</span>

<span class="c1"># Calculate theoretical steady-state (Boltzmann distribution)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">E</span><span class="p">))</span>
<span class="n">pi_theory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">E</span><span class="p">)</span> <span class="o">/</span> <span class="n">Z</span>

<span class="c1"># Calculate transition rates from energy landscape (Arrhenius law)</span>
<span class="c1"># w_ij = A * exp(-(E_barrier_ij - E_i))</span>
<span class="n">rates</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">rates</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">prefactor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">E_barrier_base</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="c1"># A -&gt; B</span>
<span class="n">rates</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">prefactor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">E_barrier_base</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="c1"># B -&gt; A</span>
<span class="n">rates</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">prefactor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">E_barrier_base</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="c1"># B -&gt; C</span>
<span class="n">rates</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">prefactor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">E_barrier_base</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="c1"># C -&gt; B</span>
<span class="n">rates</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">prefactor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">E_barrier_base</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span> <span class="c1"># C -&gt; A</span>
<span class="n">rates</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">prefactor</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">E_barrier_base</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="c1"># A -&gt; C</span>

<span class="c1"># Construct the Q-matrix</span>
<span class="n">Q_rev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">rate</span> <span class="ow">in</span> <span class="n">rates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">Q_rev</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rate</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">Q_rev</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Q_rev</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>

<span class="c1"># Verify Kolmogorov&#39;s loop criterion</span>
<span class="n">prod_clockwise</span> <span class="o">=</span> <span class="n">rates</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span> <span class="o">*</span> <span class="n">rates</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span> <span class="o">*</span> <span class="n">rates</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
<span class="n">prod_counter_clockwise</span> <span class="o">=</span> <span class="n">rates</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span> <span class="o">*</span> <span class="n">rates</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span> <span class="o">*</span> <span class="n">rates</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kolmogorov&#39;s Loop Criterion Check:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Clockwise rate product = </span><span class="si">{</span><span class="n">prod_clockwise</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Counter-clockwise rate product = </span><span class="si">{</span><span class="n">prod_counter_clockwise</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Ratio (should be 1.0): </span><span class="si">{</span><span class="n">prod_clockwise</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">prod_counter_clockwise</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Run a long simulation</span>
<span class="n">T_max_rev</span> <span class="o">=</span> <span class="mi">200000</span>
<span class="n">times</span><span class="p">,</span> <span class="n">states</span><span class="p">,</span> <span class="n">transitions</span> <span class="o">=</span> <span class="n">gillespie_simulation</span><span class="p">(</span><span class="n">Q_rev</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">T_max_rev</span><span class="p">)</span>

<span class="c1"># Analyze net flux</span>
<span class="n">transition_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">transitions</span><span class="p">)</span>
<span class="n">clockwise_jumps</span> <span class="o">=</span> <span class="n">transition_counts</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">transition_counts</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">transition_counts</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">counter_clockwise_jumps</span> <span class="o">=</span> <span class="n">transition_counts</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">transition_counts</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">transition_counts</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;In a simulation of T=</span><span class="si">{</span><span class="n">T_max_rev</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total clockwise jumps: </span><span class="si">{</span><span class="n">clockwise_jumps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total counter-clockwise jumps: </span><span class="si">{</span><span class="n">counter_clockwise_jumps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The counts are very close, indicating no net probability flux.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Calculate simulated steady-state distribution</span>
<span class="n">occupancy_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">occupancy_times</span><span class="p">[</span><span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">occupancy_times</span><span class="p">[</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">T_max_rev</span> <span class="o">-</span> <span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">pi_simulated</span> <span class="o">=</span> <span class="n">occupancy_times</span> <span class="o">/</span> <span class="n">T_max_rev</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Steady-State Distribution (Boltzmann) Comparison:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Theoretical pi = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pi_theory</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Simulated pi   = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">pi_simulated</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- Visualization ---</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8-whitegrid&#39;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Plot 1: Potential Energy Landscape</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">x_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="c1"># A simple polynomial to represent a triple-well potential visually</span>
<span class="n">U</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_coords</span><span class="o">**</span><span class="mi">6</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">x_coords</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">47</span><span class="o">*</span><span class="n">x_coords</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">60</span><span class="o">*</span><span class="n">x_coords</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">x_coords</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x_coords</span><span class="p">)</span>
<span class="c1"># Adjust wells to roughly match energy levels E</span>
<span class="n">U</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="n">U</span><span class="p">[</span><span class="n">x_coords</span> <span class="o">&lt;</span> <span class="mf">1.5</span><span class="p">]</span> <span class="o">+=</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">x_coords</span> <span class="o">&lt;</span> <span class="mf">1.5</span><span class="p">])</span> <span class="o">+</span> <span class="mf">2.5</span>
<span class="n">U</span><span class="p">[(</span><span class="n">x_coords</span> <span class="o">&gt;=</span> <span class="mf">1.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x_coords</span> <span class="o">&lt;=</span> <span class="mf">3.5</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">U</span><span class="p">[(</span><span class="n">x_coords</span> <span class="o">&gt;=</span> <span class="mf">1.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x_coords</span> <span class="o">&lt;=</span> <span class="mf">3.5</span><span class="p">)])</span> <span class="o">+</span> <span class="mf">2.5</span>
<span class="n">U</span><span class="p">[</span><span class="n">x_coords</span> <span class="o">&gt;</span> <span class="mf">3.5</span><span class="p">]</span> <span class="o">+=</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="n">x_coords</span> <span class="o">&gt;</span> <span class="mf">3.5</span><span class="p">])</span> <span class="o">+</span> <span class="mf">2.5</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_coords</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Physical Model: Particle in a Triple-Well Potential&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Position (arbitrary units)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Potential Energy $U(x)$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">2.8</span><span class="p">,</span> <span class="s1">&#39;Well A (State 0)&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">2.8</span><span class="p">,</span> <span class="s1">&#39;Well B (State 1)&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mf">2.8</span><span class="p">,</span> <span class="s1">&#39;Well C (State 2)&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span> <span class="c1"># Hide y-axis ticks for a cleaner look</span>

<span class="c1"># Plot 2: Trajectory</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">state_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Well A (0)&#39;</span><span class="p">,</span> <span class="s1">&#39;Well B (1)&#39;</span><span class="p">,</span> <span class="s1">&#39;Well C (2)&#39;</span><span class="p">]</span>
<span class="n">t_display_limit</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="n">T_max_rev</span><span class="p">)</span>
<span class="n">display_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">times</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">t_display_limit</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">times</span><span class="p">)[</span><span class="n">display_indices</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">states</span><span class="p">)[</span><span class="n">display_indices</span><span class="p">],</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sample Trajectory (First </span><span class="si">{</span><span class="n">t_display_limit</span><span class="si">}</span><span class="s1"> time units)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;State&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">state_labels</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>

<span class="c1"># Plot 3: Steady-State Distribution</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">state_labels</span><span class="p">,</span> <span class="n">pi_simulated</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cornflowerblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation Result&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">state_labels</span><span class="p">,</span> <span class="n">pi_theory</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Theory (Boltzmann $\pi$)&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Steady-State Probability Distribution&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pi_theory</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pi_simulated</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pi_simulated</span><span class="p">):</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
运行代码输出：
<div class="highlight"><pre><span></span><code>--- Simulating Reversible System (Thermal Equilibrium) ---
Kolmogorov&#39;s Loop Criterion Check:
  Clockwise rate product = 0.0498
  Counter-clockwise rate product = 0.0498
  Ratio (should be 1.0): 1.0000

In a simulation of T=200000:
  Total clockwise jumps: 69792
  Total counter-clockwise jumps: 69734
The counts are very close, indicating no net probability flux.

Steady-State Distribution (Boltzmann) Comparison:
  Theoretical pi = [0.3315 0.5465 0.122 ]
  Simulated pi   = [0.3318 0.5461 0.122 ]
</code></pre></div>
<img alt="运行代码输出" src="../../../assets/images/remote/213a78ef-278d-4eea-8b03-8dd127f0a9b2-15341ba412.png" /></p>
<p><strong>上图 (Physical Model)</strong> 显示了系统的物理规则：一个粒子在具有三个不同深度势阱的能量景观中运动。势阱B最深（最稳定），而势阱C最浅（最不稳定）。</p>
<p><strong>左下图 (Sample Trajectory)</strong> 展示了系统的微观动态：在热能的驱动下，粒子在三个势阱之间进行着永不停歇的随机跳跃。</p>
<p><strong>右下图 (Steady-State Probability)</strong> 揭示了系统的宏观统计结果：经过长时间的演化，粒子在每个势阱中停留的时间比例（蓝色条形图）与基于其能量深度预测的理论玻尔兹曼分布（红色圆点）完全吻合。粒子在最深的势阱B中停留的时间最长，在最浅的势阱C中停留的时间最短。</p>
<p>总而言之，该图直观地证明了物理规则（能量景观）如何决定微观的随机行为，并最终涌现出一个可预测的、稳定的宏观平衡态。</p>
<h2 id="32">3.2 模拟一个不可逆系统：受驱动力作用的环状系统<a class="headerlink" href="#32" title="Permanent link">&para;</a></h2>
<p><strong>物理模型</strong>: 想象一个带电粒子被束缚在三个离散的站点（<strong>站点A</strong>、<strong>站点B</strong>、<strong>站点C</strong>）构成的环上。现在，我们施加一个恒定的环形电场（非保守力）。这个电场会驱动带电粒子倾向于沿一个方向（例如，顺时针）运动。虽然热涨落仍然允许粒子偶尔“逆流而上”，但整体上会形成一个持续的、净的粒子流。这个系统为了维持这个稳态“电流”，必须持续从外部电场获取能量，并以热量的形式耗散掉，因此它是一个典型的非平衡稳态 (NESS)。</p>
<p><strong>实现思路</strong>:</p>
<ol>
<li><strong>构建模型</strong>: 我们直接设定顺时针的跳转速率（<span class="arithmatex">\(w_{cw}\)</span>）远大于逆时针的速率（<span class="arithmatex">\(w_{ccw}\)</span>），以模拟外部驱动力。</li>
<li><strong>验证与模拟</strong>: 该速率设置明显违反柯尔莫哥洛夫准则。我们运行 Gillespie 模拟。</li>
<li><strong>分析</strong>:<ul>
<li>统计顺逆时针的跳转次数，预期会观察到巨大的差异，这便是<strong>净概率电流</strong>的证据。</li>
<li>计算并绘制<strong>累积熵产生</strong>随时间变化的图像。对于这个被驱动的的系统，该曲线应呈线性增长，其斜率即为平均熵产生速率 <span class="arithmatex">\(\sigma\)</span>。</li>
</ul>
</li>
</ol>
<p><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">patches</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gillespie_simulation</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">initial_state</span><span class="p">,</span> <span class="n">T_max</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a continuous-time Markov process using the Gillespie algorithm.</span>

<span class="sd">    Args:</span>
<span class="sd">        Q (np.array): The transition rate matrix (Q_ij = w_j-&gt;i).</span>
<span class="sd">        initial_state (int): The starting state.</span>
<span class="sd">        T_max (float): The maximum simulation time.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: A tuple containing lists of times, states, and transitions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_states</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_states</span><span class="p">)</span>

    <span class="n">current_state</span> <span class="o">=</span> <span class="n">initial_state</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="n">time_points</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">]</span>
    <span class="n">state_trajectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">current_state</span><span class="p">]</span>
    <span class="n">transitions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T_max</span><span class="p">:</span>
        <span class="n">rates_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Q</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">current_state</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">states</span> <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">current_state</span><span class="p">])</span>
        <span class="n">total_rate_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rates_out</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">total_rate_out</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">total_rate_out</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
        <span class="k">if</span> <span class="n">t</span> <span class="o">&gt;=</span> <span class="n">T_max</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="n">possible_next_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">states</span> <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">current_state</span><span class="p">]</span>
        <span class="n">probabilities</span> <span class="o">=</span> <span class="n">rates_out</span> <span class="o">/</span> <span class="n">total_rate_out</span>
        <span class="n">next_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">possible_next_states</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">probabilities</span><span class="p">)</span>

        <span class="n">transitions</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">current_state</span><span class="p">,</span> <span class="n">next_state</span><span class="p">))</span>
        <span class="n">current_state</span> <span class="o">=</span> <span class="n">next_state</span>

        <span class="n">time_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">state_trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_state</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">time_points</span><span class="p">,</span> <span class="n">state_trajectory</span><span class="p">,</span> <span class="n">transitions</span>

<span class="c1"># --- 2. Irreversible System: Driven Particle on a Ring ---</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Simulating Irreversible System (Non-Equilibrium Steady State) ---&quot;</span><span class="p">)</span>
<span class="n">Q_irrev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># Define rates that model a strong clockwise driving force</span>
<span class="n">w_cw</span> <span class="o">=</span> <span class="mf">10.0</span>  <span class="c1"># High rate for clockwise jumps</span>
<span class="n">w_ccw</span> <span class="o">=</span> <span class="mf">0.5</span>   <span class="c1"># Low rate for counter-clockwise jumps</span>

<span class="n">w01_i</span><span class="p">,</span> <span class="n">w12_i</span><span class="p">,</span> <span class="n">w20_i</span> <span class="o">=</span> <span class="n">w_cw</span><span class="p">,</span> <span class="n">w_cw</span><span class="p">,</span> <span class="n">w_cw</span>
<span class="n">w10_i</span><span class="p">,</span> <span class="n">w21_i</span><span class="p">,</span> <span class="n">w02_i</span> <span class="o">=</span> <span class="n">w_ccw</span><span class="p">,</span> <span class="n">w_ccw</span><span class="p">,</span> <span class="n">w_ccw</span>

<span class="c1"># Populate Q-matrix</span>
<span class="n">Q_irrev</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">w01_i</span><span class="p">;</span> <span class="n">Q_irrev</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">w10_i</span>
<span class="n">Q_irrev</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">w12_i</span><span class="p">;</span> <span class="n">Q_irrev</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">w21_i</span>
<span class="n">Q_irrev</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">w20_i</span><span class="p">;</span> <span class="n">Q_irrev</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">w02_i</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">Q_irrev</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Q_irrev</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>

<span class="c1"># Verify violation of Kolmogorov&#39;s criterion</span>
<span class="n">prod_clockwise_i</span> <span class="o">=</span> <span class="n">w01_i</span> <span class="o">*</span> <span class="n">w12_i</span> <span class="o">*</span> <span class="n">w20_i</span>
<span class="n">prod_counter_clockwise_i</span> <span class="o">=</span> <span class="n">w02_i</span> <span class="o">*</span> <span class="n">w21_i</span> <span class="o">*</span> <span class="n">w10_i</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kolmogorov&#39;s Loop Criterion Check:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Clockwise rate product = </span><span class="si">{</span><span class="n">prod_clockwise_i</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Counter-clockwise rate product = </span><span class="si">{</span><span class="n">prod_counter_clockwise_i</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The products are unequal, confirming the system is irreversible.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Run simulation</span>
<span class="n">T_max_irrev</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">times_irrev</span><span class="p">,</span> <span class="n">states_irrev</span><span class="p">,</span> <span class="n">transitions_irrev</span> <span class="o">=</span> <span class="n">gillespie_simulation</span><span class="p">(</span><span class="n">Q_irrev</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">T_max_irrev</span><span class="p">)</span>

<span class="c1"># Count jumps to show net flux</span>
<span class="n">transition_counts_i</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">transitions_irrev</span><span class="p">)</span>
<span class="n">clockwise_jumps_i</span> <span class="o">=</span> <span class="n">transition_counts_i</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">transition_counts_i</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">transition_counts_i</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">counter_clockwise_jumps_i</span> <span class="o">=</span> <span class="n">transition_counts_i</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">transition_counts_i</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">transition_counts_i</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;In a simulation of T=</span><span class="si">{</span><span class="n">T_max_irrev</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total clockwise jumps: </span><span class="si">{</span><span class="n">clockwise_jumps_i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total counter-clockwise jumps: </span><span class="si">{</span><span class="n">counter_clockwise_jumps_i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A strong net clockwise probability current is observed.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Calculate and plot cumulative entropy production</span>
<span class="n">rates_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span> <span class="n">w01_i</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span> <span class="n">w10_i</span><span class="p">,</span> 
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span> <span class="n">w12_i</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span> <span class="n">w21_i</span><span class="p">,</span> 
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span> <span class="n">w20_i</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span> <span class="n">w02_i</span>
<span class="p">}</span>
<span class="n">entropy_production</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">cumulative_entropy</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span>
<span class="n">entropy_times</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">transitions_irrev</span><span class="p">)):</span>
    <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">transitions_irrev</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">ds_env</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">rates_map</span><span class="p">[(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)]</span> <span class="o">/</span> <span class="n">rates_map</span><span class="p">[(</span><span class="n">end</span><span class="p">,</span> <span class="n">start</span><span class="p">)])</span>
    <span class="n">entropy_production</span> <span class="o">+=</span> <span class="n">ds_env</span>
    <span class="n">cumulative_entropy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entropy_production</span><span class="p">)</span>
    <span class="n">entropy_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">times_irrev</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Calculate average entropy production rate, sigma</span>
<span class="n">avg_sigma</span> <span class="o">=</span> <span class="n">cumulative_entropy</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">entropy_times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Simulated average entropy production rate (sigma) ~ </span><span class="si">{</span><span class="n">avg_sigma</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- Visualization ---</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8-whitegrid&#39;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="c1"># Plot 1: System Diagram</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">pos</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.866</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">),</span> <span class="mi">2</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.866</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)}</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span> <span class="n">s</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#FF6B6B&#39;</span><span class="p">,</span> <span class="s1">&#39;#4ECDC4&#39;</span><span class="p">,</span> <span class="s1">&#39;#45B7D1&#39;</span><span class="p">])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Site A (0)&#39;</span><span class="p">,</span> <span class="s1">&#39;Site B (1)&#39;</span><span class="p">,</span> <span class="s1">&#39;Site C (2)&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Arrows for rates</span>
<span class="c1"># Clockwise (strong)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=.3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;,head_length=10,head_width=8&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=.3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;,head_length=10,head_width=8&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=.3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;,head_length=10,head_width=8&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">))</span>
<span class="c1"># Counter-clockwise (weak)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=.3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;,head_length=5,head_width=4&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=.3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;,head_length=5,head_width=4&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">FancyArrowPatch</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=.3&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;,head_length=5,head_width=4&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">))</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;Driving Force&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Physical Model: Driven Particle on a Ring&#39;</span><span class="p">)</span>


<span class="c1"># Plot 2: Cumulative Entropy Production</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropy_times</span><span class="p">,</span> <span class="n">cumulative_entropy</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Cumulative Entropy Production $\Delta s(t)$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropy_times</span><span class="p">,</span> <span class="n">avg_sigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">entropy_times</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">fr</span><span class="s1">&#39;Average Rate $\sigma \approx </span><span class="si">{</span><span class="n">avg_sigma</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Entropy Production in the Driven System&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Total Entropy Production, $\Delta s(t)$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
运行代码输出</p>
<div class="highlight"><pre><span></span><code>--- Simulating Irreversible System (Non-Equilibrium Steady State) ---
Kolmogorov&#39;s Loop Criterion Check:
  Clockwise rate product = 1000.0000
  Counter-clockwise rate product = 0.1250
The products are unequal, confirming the system is irreversible.

In a simulation of T=5000:
  Total clockwise jumps: 50008
  Total counter-clockwise jumps: 2508
A strong net clockwise probability current is observed.

Simulated average entropy production rate (sigma) ~ 28.4600
</code></pre></div>
<p><img alt="运行代码输出" src="../../../assets/images/remote/5a440c99-1910-4a67-bce4-ad6c16e0a896-a2c17b4778.png" /></p>
<p>这个例子展示了一个由外部驱动力维持的<strong>非平衡稳态 (Non-Equilibrium Steady State)</strong> 的核心特征。</p>
<p><strong>左图 (Physical Model):</strong> 展示了我们的物理模型：一个粒子在环状的三个站点间运动，并受到一个恒定的“驱动力”作用。这个力使得粒子顺时针跳转的速率（粗黑箭头）远大于逆时针跳转的速率（细虚线箭头）。这在物理上代表了一个持续消耗能量来维持定向运动的系统，它从根本上<strong>打破了细致平衡</strong>。</p>
<p><strong>右图 (Entropy Production): 不可逆性的代价</strong> 它显示了系统<strong>累积熵产生</strong>随时间的变化。我们可以清晰地看到：总熵产生（蓝色实线）随着时间的推移，在涨落中<strong>持续地、线性地增加</strong>。这与可逆系统（熵产生平均为零）形成了鲜明对比。熵产生的增加不是随机的，而是遵循一个非常稳定的平均速率，即图中虚线所示的斜率 <span class="arithmatex">\(\\sigma\)</span>（这里约为 28.46）。</p>
<h1 id="_2">结论<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h1>
<p>这节课教授正式带领我们从平衡到非平衡物理的转变。本节的核心要点如下：</p>
<p><strong>平衡态</strong>由<strong>细致平衡</strong>定义，其标志是没有净概率流 (<span class="arithmatex">\(J_{ij} = 0\)</span>)，平均熵产生速率为零 (<span class="arithmatex">\(\sigma = 0\)</span>)，其动力学在时间上是可逆的。其数学上的简洁性（Q-矩阵可对称化）反映了其物理上的"寂静"。</p>
<p><strong>非平衡态</strong>则打破了细致平衡，其特征是存在持续的净概率流 (<span class="arithmatex">\(J_{ij} \neq 0\)</span>)，熵产生速率恒为正 (<span class="arithmatex">\(\sigma &gt; 0\)</span>)，因而具有明确的时间方向性。</p>
<p>通过引入轨迹熵的概念，我们得以在单分子、单轨迹的微观层面精确地定义和量化热力学量，如系统熵、环境熵和总熵产生。最终得到的平均熵产生速率公式 <span class="arithmatex">\(\sigma = \sum J \cdot A\)</span> 揭示了所有耗散过程的普遍结构。</p>
<p>这些概念远非理论上的抽象，它们是理解我们所处动态世界的基本语法。熵的持续产生，是所有具备功能和方向性的过程所必须付出的、不可避免的物理代价。我们看到它在微观尺度上驱动着生命本身：它是细胞内的分子马达拖着货物沿轨道行走的能量消耗，是离子泵逆浓度梯度工作、维持神经电位的根本机制，也是整个新陈代谢网络将食物转化为有序生物结构的基础。在宏观尺度上，它同样无处不在：它是计算机处理信息时必须散发热量的原因，是化学反应（如燃烧）不可逆地释放能量的体现，是电流在电路中稳定流动的标志，甚至是地球上太阳能驱动天气系统形成壮丽风暴的引擎。</p>
<p>最终，这揭示了一个深刻的物理学真理：任何一个想要在远离“热寂”（即完美平衡态）的条件下维持其复杂结构和功能的系统，都必须持续地从环境中汲取能量并以熵的形式耗散掉。在非平衡的世界里，熵的产生并非仅仅是混乱和衰败的标志，更是复杂性、功能性乃至生命本身得以存在的必要条件。</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.sections", "navigation.expand", "navigation.top", "toc.integrate", "search.highlight"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../assets/javascripts/mathjax.js"></script>
      
        <script src="../../../assets/javascripts/language-nav.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>