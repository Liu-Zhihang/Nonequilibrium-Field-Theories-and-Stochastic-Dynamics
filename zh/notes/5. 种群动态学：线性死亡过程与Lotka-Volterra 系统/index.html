
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Course Notes and Code (Erwin Frey, LMU Munich, 2025)">
      
      
        <meta name="author" content="Zhihang Liu">
      
      
        <link rel="canonical" href="https://liu-zhihang.github.io/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/zh/notes/5.%20%E7%A7%8D%E7%BE%A4%E5%8A%A8%E6%80%81%E5%AD%A6%EF%BC%9A%E7%BA%BF%E6%80%A7%E6%AD%BB%E4%BA%A1%E8%BF%87%E7%A8%8B%E4%B8%8ELotka-Volterra%20%E7%B3%BB%E7%BB%9F/">
      
      
        <link rel="prev" href="../4.%20Gillespie%20%E7%AE%97%E6%B3%95%E3%80%81%E4%B8%BB%E6%96%B9%E7%A8%8B%E3%80%81%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E4%B8%8E%E7%A7%8D%E7%BE%A4%E5%8A%A8%E5%8A%9B%E5%AD%A6/">
      
      
        <link rel="next" href="../6.%20%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%96%B9%E7%A8%8B%EF%BC%9A%E6%9F%A5%E6%99%AE%E6%9B%BC-%E7%A7%91%E5%B0%94%E8%8E%AB%E6%88%88%E7%BD%97%E5%A4%AB%E6%96%B9%E7%A8%8B/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>5. 种群动态学：线性死亡过程与Lotka-Volterra 系统 - Nonequilibrium Field Theories and Stochastic Dynamics</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Nonequilibrium Field Theories and Stochastic Dynamics" class="md-header__button md-logo" aria-label="Nonequilibrium Field Theories and Stochastic Dynamics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nonequilibrium Field Theories and Stochastic Dynamics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5. 种群动态学：线性死亡过程与Lotka-Volterra 系统
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics/zh/" hreflang="zh" class="md-select__link">
              简体中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Liu-Zhihang/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Nonequilibrium Field Theories and Stochastic Dynamics" class="md-nav__button md-logo" aria-label="Nonequilibrium Field Theories and Stochastic Dynamics" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Nonequilibrium Field Theories and Stochastic Dynamics
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Liu-Zhihang/Nonequilibrium-Field-Theories-and-Stochastic-Dynamics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Course Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Course Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/1.%20Course%20Introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. Course Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/2.%20Simple%20Random%20Walk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. Simple Random Walk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/3.%20Gaussian%20Random%20Walk%20and%20Poisson%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. Gaussian Random Walk and Poisson Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/4.%20Gillespie%20Algorithm%2C%20Master%20Equation%2C%20Generating%20Functions%20and%20Population%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Gillespie Algorithm, Master Equation, Generating Functions and Population Dynamics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/5.%20Population%20Dynamics%20-%20Linear%20Death%20Process%20and%20Lotka-Volterra%20System/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5. Population Dynamics - Linear Death Process and Lotka-Volterra System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/6.%20Fundamental%20Equations%20of%20Markov%20Processes%20%E2%80%94%20Chapman%E2%80%93Kolmogorov%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6. Fundamental Equations of Markov Processes — Chapman–Kolmogorov Equation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/7.%20Forward%20Master%20Equation%20and%20the%20Q%20Matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7. Forward Master Equation and the Q Matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/8.%20Perron%E2%80%93Frobenius%20Theorem%2C%20Steady%20States%2C%20and%20Detailed%20Balance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8. Perron–Frobenius Theorem, Steady States, and Detailed Balance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/9.%20Nonequilibrium%20States%20%E2%80%94%20Irreversibility%20and%20Entropy%20Production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    9. Nonequilibrium States — Irreversibility and Entropy Production
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/10.%20Ehrenfest%20Model%2C%20Entropy%2C%20and%20KL%20Divergence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10. Ehrenfest Model, Entropy, and KL Divergence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/11.%20Continuous%20Markov%20Processes%20and%20the%20Fokker%E2%80%93Planck%20Equation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11. Continuous Markov Processes and the Fokker–Planck Equation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/12.%20Brownian%20Motion%20and%20the%20Ornstein%E2%80%93Uhlenbeck%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    12. Brownian Motion and the Ornstein–Uhlenbeck Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/13.%20Monte%20Carlo%20Sampling%20as%20a%20Stochastic%20Process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    13. Monte Carlo Sampling as a Stochastic Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/14.%20Hamiltonian%20Monte%20Carlo%20Sampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    14. Hamiltonian Monte Carlo Sampling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/15.%20Chemotaxis%2C%20Run-and-Tumble%20Motion%2C%20and%20the%20Keller%E2%80%93Segel%20Model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15. Chemotaxis, Run-and-Tumble Motion, and the Keller–Segel Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/16.%20The%20Schnitzer%20Model%2C%20Anomalous%20Diffusion%2C%20and%20Motility%E2%80%91Induced%20Phase%20Separation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    16. The Schnitzer Model, Anomalous Diffusion, and Motility‑Induced Phase Separation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/17.%20Langevin%20Equation%2C%20Brownian%20Particle%2C%20and%20the%20Fluctuation%E2%80%93Dissipation%20Theorem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    17. Langevin Equation, Brownian Particle, and the Fluctuation–Dissipation Theorem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/18.%20Fokker%E2%80%93Planck%20Equation%20and%20the%20Smoluchowski%20Equation%20%E2%80%94%20From%20Random%20Trajectories%20to%20Probability%20Dynamics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    18. Fokker–Planck Equation and the Smoluchowski Equation — From Random Trajectories to Probability Dynamics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/19.%20Path%20Integral%20Formulation%20of%20Stochastic%20Processes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    19. Path Integral Formulation of Stochastic Processes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../notes/20.%20Stochastic%20Differential%20Equations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20. Stochastic Differential Equations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    中文笔记
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            中文笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    首页
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20%E8%AF%BE%E7%A8%8B%E5%AF%BC%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1. 课程导论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2.%20%E7%AE%80%E5%8D%95%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2. 简单随机游走
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3.%20%E9%AB%98%E6%96%AF%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0%E4%B8%8E%E6%B3%8A%E6%9D%BE%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3. 高斯随机游走与泊松过程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4.%20Gillespie%20%E7%AE%97%E6%B3%95%E3%80%81%E4%B8%BB%E6%96%B9%E7%A8%8B%E3%80%81%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0%E4%B8%8E%E7%A7%8D%E7%BE%A4%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4. Gillespie 算法、主方程、生成函数与种群动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    5. 种群动态学：线性死亡过程与Lotka-Volterra 系统
    
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6.%20%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%96%B9%E7%A8%8B%EF%BC%9A%E6%9F%A5%E6%99%AE%E6%9B%BC-%E7%A7%91%E5%B0%94%E8%8E%AB%E6%88%88%E7%BD%97%E5%A4%AB%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6. 马尔可夫过程的基本方程：查普曼-科尔莫戈罗夫方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7.%20%E5%89%8D%E5%90%91%E4%B8%BB%E6%96%B9%E7%A8%8B%E4%B8%8EQ%E7%9F%A9%E9%98%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7. 前向主方程与Q矩阵
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8.%20%E4%BD%A9%E9%BE%99-%E5%BC%97%E7%BD%97%E8%B4%9D%E5%B0%BC%E4%B9%8C%E6%96%AF%E5%AE%9A%E7%90%86%E3%80%81%E7%A8%B3%E6%80%81%E4%B8%8E%E7%BB%86%E8%87%B4%E5%B9%B3%E8%A1%A1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8. 佩龙-弗罗贝尼乌斯定理、稳态与细致平衡
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9.%20%E9%9D%9E%E5%B9%B3%E8%A1%A1%E6%80%81%EF%BC%9A%E4%B8%8D%E5%8F%AF%E9%80%86%E6%80%A7%E4%B8%8E%E7%86%B5%E4%BA%A7%E7%94%9F%E7%9A%84%E6%8E%A8%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    9. 非平衡态：不可逆性与熵产生的推论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10.%20%E5%9F%83%E4%BC%A6%E8%B4%B9%E6%96%AF%E7%89%B9%E6%A8%A1%E5%9E%8B%E3%80%81%E7%86%B5%E4%B8%8EKL%E6%95%A3%E5%BA%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10. 埃伦费斯特模型、熵与KL散度
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11.%20%E8%BF%9E%E7%BB%AD%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E8%BF%87%E7%A8%8B%E4%B8%8E%E7%A6%8F%E5%85%8B-%E6%99%AE%E6%9C%97%E5%85%8B%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11. 连续马尔可夫过程与福克-普朗克方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12.%20%E5%B8%83%E6%9C%97%E8%BF%90%E5%8A%A8%E4%B8%8E%E5%A5%A5%E6%81%A9%E6%96%AF%E5%9D%A6-%E4%B9%8C%E4%BC%A6%E8%B4%9D%E5%85%8B%E8%BF%87%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    12. 布朗运动与奥恩斯坦-乌伦贝克过程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13.%20%E4%BD%9C%E4%B8%BA%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E9%87%87%E6%A0%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    13. 作为随机过程的蒙特卡洛采样
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14.%20%E5%93%88%E5%AF%86%E5%B0%94%E9%A1%BF%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E9%87%87%E6%A0%B7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    14. 哈密尔顿蒙特卡洛采样
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15.%20%E8%B6%8B%E5%8C%96%E6%80%A7%E3%80%81%E8%B7%91%E5%8A%A8-%E7%BF%BB%E6%BB%9A%E8%BF%90%E5%8A%A8%E4%B8%8EKeller-Segel%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15. 趋化性、跑动-翻滚运动与Keller-Segel模型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../16.%20Schnitzer%E6%A8%A1%E5%9E%8B%E3%80%81%E5%8F%8D%E5%B8%B8%E6%89%A9%E6%95%A3%E4%B8%8E%E8%BF%90%E5%8A%A8%E8%AF%B1%E5%AF%BC%E7%9B%B8%E5%88%86%E7%A6%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    16. Schnitzer模型、反常扩散与运动诱导相分离
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../17.%20%E6%9C%97%E4%B9%8B%E4%B8%87%E6%96%B9%E7%A8%8B%E3%80%81%E5%B8%83%E6%9C%97%E7%B2%92%E5%AD%90%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    17. 朗之万方程、布朗粒子与涨落-耗散定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18.%20%E7%A6%8F%E5%85%8B-%E6%99%AE%E6%9C%97%E5%85%8B%E6%96%B9%E7%A8%8B%E4%B8%8E%E6%96%AF%E6%91%A9%E6%A3%B1%E9%9C%8D%E5%A4%AB%E6%96%AF%E5%9F%BA%E6%96%B9%E7%A8%8B%EF%BC%9A%E4%BB%8E%E9%9A%8F%E6%9C%BA%E8%BD%A8%E8%BF%B9%E5%88%B0%E6%A6%82%E7%8E%87%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    18. 福克-普朗克方程与斯摩棱霍夫斯基方程：从随机轨迹到概率动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19.%20%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E8%A1%A8%E8%BF%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    19. 随机过程的路径积分表述
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.%20%E9%9A%8F%E6%9C%BA%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20. 随机微分方程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.%20%E4%BC%8A%E8%97%A4%E7%A7%AF%E5%88%86%E4%B8%8E%E7%BB%9F%E4%B8%80%E7%9A%84%E9%9A%8F%E6%9C%BA%E8%BF%87%E7%A8%8B%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    21. 伊藤积分与统一的随机过程框架
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.%20%E5%90%AB%E4%B9%98%E6%80%A7%E5%99%AA%E5%A3%B0%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    22. 含乘性噪声系统的路径积分
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.%20%E4%BB%8E%E7%B2%97%E7%B2%92%E5%8C%96%E5%88%B0%E8%BF%9E%E7%BB%AD%E5%9C%BA%E8%AE%BA%E6%B6%A8%E8%90%BD%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    23. 从粗粒化到连续场论涨落动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.%20%E6%98%82%E8%90%A8%E6%A0%BC%E7%B3%BB%E6%95%B0%E3%80%81%E5%80%92%E6%98%93%E5%85%B3%E7%B3%BB%E4%B8%8E%E5%8A%A8%E6%80%81%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    24. 昂萨格系数、倒易关系与动态涨落-耗散定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../25.%20%E6%A2%AF%E5%BA%A6%E5%8A%A8%E5%8A%9B%E5%AD%A6%E3%80%81%E7%9B%B8%E5%8F%98%E4%B8%8E%E5%BC%9B%E8%B1%AB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    25. 梯度动力学、相变与弛豫
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../26.%20%E4%B8%B4%E7%95%8C%E6%85%A2%E5%8C%96%E3%80%81%E5%8A%A8%E6%80%81%E5%93%8D%E5%BA%94%E4%B8%8E%E5%AE%88%E6%81%92%E5%BE%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    26. 临界慢化、动态响应与守恒律
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../27.%20%E7%AE%80%E5%8D%95%E6%B5%81%E4%BD%93%E3%80%81%E6%97%A0%E6%91%A9%E6%93%A6%E6%B5%81%E4%BD%93%E4%B8%8E%E6%AC%A7%E6%8B%89%E6%96%B9%E7%A8%8B%E7%9A%84%E6%B5%81%E4%BD%93%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    27. 简单流体、无摩擦流体与欧拉方程的流体动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../28.%20%E7%B2%98%E6%80%A7%E6%B5%81%E4%BD%93%E3%80%81%E7%BA%B3%E7%BB%B4-%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E6%96%B9%E7%A8%8B%E3%80%81%E7%86%B5%E5%B9%B3%E8%A1%A1%E4%B8%8E%E7%83%AD%E4%BC%A0%E5%AF%BC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    28. 粘性流体、纳维-斯托克斯方程、熵平衡与热传导
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../29.%20%E4%B8%8D%E5%8F%AF%E9%80%86%E7%BA%BF%E6%80%A7%E7%83%AD%E5%8A%9B%E5%AD%A6%E4%B8%8E%E5%B9%B2%E6%80%A7%E6%89%A9%E6%95%A3%E7%B2%92%E5%AD%90%E7%B3%BB%E7%BB%9F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    29. 不可逆线性热力学与干性扩散粒子系统
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../30.%20%E6%82%AC%E6%B5%AE%E5%9C%A8%E6%B5%81%E4%BD%93%E4%B8%AD%E7%9A%84%E5%B8%83%E6%9C%97%E7%B2%92%E5%AD%90%20%E2%80%94%20H%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    30. 悬浮在流体中的布朗粒子 — H模型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../31.%20%E5%8A%A8%E6%80%81%E6%B3%9B%E5%87%BD%E3%80%81%E5%8A%A0%E6%80%A7%E5%99%AA%E5%A3%B0%E5%9C%BA%E8%AE%BA%E4%B8%8EOnsager-Machlup%E6%B3%9B%E5%87%BD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    31. 动态泛函、加性噪声场论与Onsager-Machlup泛函
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../32.%20Janssen-De%20Dominicis%20%E5%93%8D%E5%BA%94%E6%B3%9B%E5%87%BD%E4%B8%8E%E6%B6%A8%E8%90%BD-%E8%80%97%E6%95%A3%E5%85%B3%E7%B3%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    32. Janssen-De Dominicis 响应泛函与涨落-耗散关系
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../33.%20%E9%9D%9E%E5%B9%B3%E8%A1%A1%E5%8A%9F%E4%B8%8E%E6%B6%A8%E8%90%BD%E5%AE%9A%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    33. 非平衡功与涨落定理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../34.%20%E6%9C%89%E5%90%91%E6%B8%97%E6%B5%81%E3%80%81%E5%90%B8%E6%94%B6%E6%80%81%E4%B8%8E%E8%B0%B1%E6%96%B9%E6%B3%95/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    34. 有向渗流、吸收态与谱方法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../35.%20%E4%B8%BB%E6%96%B9%E7%A8%8B%E7%9A%84%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E8%A1%A8%E7%A4%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    35. 主方程的路径积分表示
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../36.%20%E7%9B%B8%E5%B9%B2%E6%80%81%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E3%80%81%E7%AE%97%E7%AC%A6%E4%BB%A3%E6%95%B0%E4%B8%8E%E8%99%9A%E5%99%AA%E5%A3%B0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    36. 相干态路径积分、算符代数与虚噪声
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../37.%20Kramers-Moyal%20%E5%B1%95%E5%BC%80%E4%B8%8E%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E7%9A%84%E4%BD%8E%E5%99%AA%E5%A3%B0%E6%9E%81%E9%99%90/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    37. Kramers-Moyal 展开与路径积分的低噪声极限
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../38.%20%E5%A4%9A%E7%89%A9%E7%A7%8D%E8%B7%AF%E5%BE%84%E7%A7%AF%E5%88%86%E4%B8%8E%E5%BE%AA%E7%8E%AF%E7%AB%9E%E4%BA%89%E5%8A%A8%E5%8A%9B%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    38. 多物种路径积分与循环竞争动力学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../39.%20%E4%BB%8E%E7%B2%92%E5%AD%90%E8%B7%B3%E8%B7%83%E5%88%B0%E8%BF%9E%E7%BB%AD%E5%9C%BA%E8%AE%BA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    39. 从粒子跳跃到连续场论
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../40.%20%E7%BB%9F%E4%B8%80%E7%9A%84%E5%9C%BA%E8%AE%BA%E6%A1%86%E6%9E%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    40. 统一的场论框架
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="_1">引言：将随机工具包应用于生命动态学<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>在前几节课中，教授已经帮我们建立了一个强大的理论框架来描述随机过程。本节课将这些抽象的工具应用于一个具体且重要的领域：种群动力学。这节课的目标是利用我们学到的知识来模拟由离散个体组成的种群的生、死和相互作用。</p>
<h1 id="1">1. 核心概念回顾<a class="headerlink" href="#1" title="Permanent link">&para;</a></h1>
<p>在深入研究新的模型之前，教授带我们简要回顾了一下工具箱中的几个关键概念：</p>
<p><strong>主方程 (Master Equation)：</strong>这是描述随机系统概率分布随时间演化的核心方程。它的本质思想非常直观，即系统处于某个特定状态 <span class="arithmatex">\(n\)</span> 的概率 <span class="arithmatex">\(p(n,t)\)</span> 的变化率，等于从其他状态转移到状态 <span class="arithmatex">\(n\)</span> 的速率（"增益"项）减去从状态 <span class="arithmatex">\(n\)</span> 转移到其他状态的速率（"损失"项）。其通用形式为：</p>
<div class="arithmatex">\[\frac{d}{dt}p(n,t) = \text{"gain"} - \text{"loss"}\]</div>
<p>这个方程为我们提供了一个完整的、概率性的系统描述。</p>
<p><strong>Gillespie 算法：</strong>主方程虽然精确，但通常是一组难以解析求解的耦合微分方程。Gillespie 算法是一种精妙的数值方法，它并非对主方程的近似，而是其<strong>精确的随机实现</strong>。该算法能够生成一系列随机轨迹（stochastic trajectories），这些轨迹的统计特性与主方程所描述的完全一致。</p>
<p><strong>理论与模拟的联系：</strong>理论（主方程）和模拟（Gillespie 算法）之间存在着深刻的联系。如果我们运行大量的 Gillespie 模拟，并在某个特定时间点 <span class="arithmatex">\(t\)</span> 收集所有轨迹的系统状态（例如，种群数量 <span class="arithmatex">\(n\)</span>），然后绘制这些状态的直方图，那么当模拟次数足够多时，这个直方图将收敛于主方程所预测的真实概率分布 <span class="arithmatex">\(p(n,t)\)</span> 。</p>
<h2 id="_2">为何需要随机模型？<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>你可能会问，我们已经有了描述种群增长的确定性模型（如逻辑斯谛方程），为什么还需要引入如此复杂的随机框架？</p>
<p>答案在于物理现实的根本性质。种群是由<strong>离散的</strong>个体组成的，而个体的行为——出生、死亡、捕食、交配——本质上是<strong>概率性</strong>的事件。确定性模型将种群数量视为连续变量，忽略了个体性和随机性，这在种群数量巨大时是一个合理的近似。然而，当种群规模较小时，随机波动（即"人口噪音"，demographic noise）可能主导系统的行为。一个随机的死亡事件序列可能导致一个小种群意外灭绝，而这是确定性模型无法预测的。</p>
<p>因此，随机模型不仅仅是确定性模型的一个更复杂的替代品，它们是对生命系统更<strong>基本、更真实</strong>的描述。它们使我们能够理解和量化由随机性本身驱动的现象，如灭绝风险、疾病爆发的概率以及生物多样性的维持。在本节中，教授将首先从最简单的"线性死亡过程"入手，然后逐步构建一个复杂的、包含捕食者和猎物的生态系统，并在这个过程中揭示随机性如何从根本上改变我们对系统行为的理解。</p>
<h1 id="2">2. 线性死亡过程：随机种群模型的基础<a class="headerlink" href="#2" title="Permanent link">&para;</a></h1>
<p>为了建立对随机种群动态的直观理解，我们从最简单的非平凡模型开始：一个种群中的个体只能死亡，不能出生。我们将从三个不同的角度来剖析这个过程：确定性的平均场视角、随机的主方程视角，以及精确的解析解。</p>
<h2 id="21">2.1 确定性视角（平均场理论）<a class="headerlink" href="#21" title="Permanent link">&para;</a></h2>
<p>首先，我们考虑一个最简单的描述。假设我们有一个物种 <span class="arithmatex">\(A\)</span>，其个体以恒定的速率 <span class="arithmatex">\(\lambda\)</span> 死亡。我们可以用一个类似化学反应的式子来表示这个过程：</p>
<div class="arithmatex">\[A \xrightarrow{\lambda} \varnothing\]</div>
<p>这里的 <span class="arithmatex">\(\lambda\)</span> 代表每个个体在单位时间内死亡的概率，即人均死亡率。</p>
<p>在<strong>平均场</strong>（mean-field）近似下，我们假设种群数量非常大，并且混合得非常均匀，因此我们可以忽略个体的离散性和随机波动，将种群数量 <span class="arithmatex">\(n(t)\)</span> 视为一个连续的、确定性的变量。</p>
<p>在这种情况下，整个种群数量的减少速率，就等于人均死亡率 <span class="arithmatex">\(\lambda\)</span> 乘以当前的种群数量 <span class="arithmatex">\(n(t)\)</span>。这给了我们一个简单的一阶常微分方程（ODE）：</p>
<div class="arithmatex">\[\frac{d}{dt}n(t) = -\lambda n(t)\]</div>
<p>这是一个我们非常熟悉的一阶线性微分方程。给定初始条件 <span class="arithmatex">\(n(t=0)=n_0\)</span>，它的解是经典的指数衰减：</p>
<div class="arithmatex">\[n(t) = n_0 e^{-\lambda t}\]</div>
<p>这个确定性解告诉我们种群的平均行为趋势。它将作为我们评估更完整的随机模型的一个基准。</p>
<h2 id="22">2.2 更深层次的探索：通过主方程进行随机描述<a class="headerlink" href="#22" title="Permanent link">&para;</a></h2>
<p>现在，我们放弃平均场近似，将种群数量 <span class="arithmatex">\(N(t)\)</span> 视为一个离散的随机变量。我们的目标不再是求解一个确定的轨迹 <span class="arithmatex">\(n(t)\)</span>，而是找到在任意时刻 <span class="arithmatex">\(t\)</span>，种群数量恰好为 <span class="arithmatex">\(n\)</span> 的概率分布，即 <span class="arithmatex">\(p(n,t) = \text{Prob}(N(t)=n)\)</span>。为此，我们需要构建该过程的主方程。</p>
<p>我们再次运用"增益-损失"原理来构建方程：</p>
<div class="arithmatex">\[\frac{d}{dt}p(n,t) = \text{gain} - \text{loss}\]</div>
<ul>
<li>
<p><strong>损失项 (Loss Term)：</strong>系统如何离开状态 <span class="arithmatex">\(n\)</span>？唯一的途径是发生一次死亡事件。当种群数量为 <span class="arithmatex">\(n\)</span> 时，每个个体都可能以速率 <span class="arithmatex">\(\lambda\)</span> 死亡。由于所有个体的死亡事件是相互独立的（这是"线性"过程的核心假设），整个种群发生死亡事件的总速率是 <span class="arithmatex">\(n \times \lambda\)</span>。因此，系统以速率 <span class="arithmatex">\(\lambda n\)</span> 离开状态 <span class="arithmatex">\(n\)</span>。这一项对 <span class="arithmatex">\(p(n,t)\)</span> 的贡献是负的，即 <span class="arithmatex">\(-\lambda n p(n,t)\)</span>。</p>
</li>
<li>
<p><strong>增益项 (Gain Term)：</strong>系统如何进入状态 <span class="arithmatex">\(n\)</span>？唯一的途径是，系统原本处于状态 <span class="arithmatex">\(n+1\)</span>，然后发生了一次死亡事件。当种群数量为 <span class="arithmatex">\(n+1\)</span> 时，整个种群发生死亡的总速率是 <span class="arithmatex">\((n+1) \times \lambda\)</span>。因此，从状态 <span class="arithmatex">\(n+1\)</span> 转移到状态 <span class="arithmatex">\(n\)</span> 的速率是 <span class="arithmatex">\(\lambda(n+1)p(n+1,t)\)</span>。这一项对 <span class="arithmatex">\(p(n,t)\)</span> 的贡献是正的。</p>
</li>
</ul>
<p>将增益项和损失项组合起来，我们就得到了线性死亡过程的完整主方程：</p>
<div class="arithmatex">\[\frac{d}{dt}p(n,t) = \lambda(n+1)p(n+1,t) - \lambda n p(n,t)\]</div>
<p>这是一个无限维的耦合常微分方程组（对于 <span class="arithmatex">\(n=0,1,2,...,n_0\)</span>），直接求解它相当困难。幸运的是，Frey 教授展示了一种更优雅、更具物理直觉的方法来获得其精确解。</p>
<h2 id="23">2.3 精确解：揭示存活的二项分布本质<a class="headerlink" href="#23" title="Permanent link">&para;</a></h2>
<p>与其直接求解主方程，不如让我们从一个更简单的问题入手，然后逐步推广。</p>
<h3 id="231">2.3.1 单个个体的存活<a class="headerlink" href="#231" title="Permanent link">&para;</a></h3>
<p>首先，考虑初始时只有一个个体（<span class="arithmatex">\(n_0=1\)</span>）的情况。这个个体在时间 <span class="arithmatex">\(t\)</span> 仍然存活的概率是多少？这是一个经典的指数等待问题。在任何一个微小的时间间隔 <span class="arithmatex">\(dt\)</span> 内，它死亡的概率是 <span class="arithmatex">\(\lambda dt\)</span>。因此，它在时间 <span class="arithmatex">\(t\)</span> 仍然存活的概率 <span class="arithmatex">\(p(t)\)</span> 遵循：</p>
<div class="arithmatex">\[\frac{d}{dt}p(t) = -\lambda p(t)\]</div>
<p>解得 <span class="arithmatex">\(p(t) = e^{-\lambda t}\)</span>。相应地，它在时间 <span class="arithmatex">\(t\)</span> 已经死亡的概率为 <span class="arithmatex">\(q(t) = 1 - p(t) = 1 - e^{-\lambda t}\)</span> 。</p>
<h3 id="232-n_0">2.3.2 推广至 <span class="arithmatex">\(n_0\)</span> 个个体<a class="headerlink" href="#232-n_0" title="Permanent link">&para;</a></h3>
<p>现在，我们回到初始种群为 <span class="arithmatex">\(n_0\)</span> 的情况。线性死亡过程的一个核心假设是，<strong>每个个体的死亡事件是相互独立的</strong>。一个人的死亡不会影响另一个人的死亡概率。这意味着，在时间 <span class="arithmatex">\(t\)</span>，整个种群的存活情况可以看作是进行了 <span class="arithmatex">\(n_0\)</span> 次独立的"伯努利试验"。</p>
<p>每一次试验对应一个初始个体，试验的结果只有两种：</p>
<p>1."成功"：该个体在时间 <span class="arithmatex">\(t\)</span> 仍然存活，其概率为 <span class="arithmatex">\(p(t) = e^{-\lambda t}\)</span>。</p>
<p>2."失败"：该个体在时间 <span class="arithmatex">\(t\)</span> 已经死亡，其概率为 <span class="arithmatex">\(q(t) = 1 - e^{-\lambda t}\)</span>。</p>
<p>我们关心的是，在 <span class="arithmatex">\(n_0\)</span> 次试验中，恰好有 <span class="arithmatex">\(n\)</span> 次"成功"（即有 <span class="arithmatex">\(n\)</span> 个个体存活）的概率是多少。这正是<strong>二项分布</strong>的定义！因此，我们可以直接写出其概率分布：</p>
<div class="arithmatex">\[p(n,t) = \binom{n_0}{n} [p(t)]^n [q(t)]^{n_0-n} = \binom{n_0}{n} (e^{-\lambda t})^n (1 - e^{-\lambda t})^{n_0-n}\]</div>
<p>这个结果非常深刻。它揭示了模型数学形式与其物理假设之间的直接联系：</p>
<p>线性速率（总速率 <span class="arithmatex">\(\propto n\)</span>） <span class="arithmatex">\(\implies\)</span> 个体独立性（无相互作用） <span class="arithmatex">\(\implies\)</span> 伯努利试验（每个个体独立存活或死亡） <span class="arithmatex">\(\implies\)</span> 二项分布解。</p>
<p>这个逻辑链条是理解随机过程物理意义的关键。</p>
<h2 id="24">2.4 分布的矩：平均值与方差<a class="headerlink" href="#24" title="Permanent link">&para;</a></h2>
<p>一旦我们知道了概率分布是二项分布，我们就可以利用其已知的性质来计算平均值和方差。对于一个参数为 <span class="arithmatex">\((N,p)\)</span> 的二项分布，其均值为 <span class="arithmatex">\(Np\)</span>，方差为 <span class="arithmatex">\(Np(1-p)\)</span>。</p>
<p>在我们的模型中，<span class="arithmatex">\(N\)</span> 对应于初始种群 <span class="arithmatex">\(n_0\)</span>，<span class="arithmatex">\(p\)</span> 对应于单个个体的存活概率 <span class="arithmatex">\(p(t) = e^{-\lambda t}\)</span>。因此，我们可以立即得到：</p>
<p><strong>平均种群数量 (Mean)：</strong></p>
<div class="arithmatex">\[\langle n(t) \rangle = n_0 p(t) = n_0 e^{-\lambda t}\]</div>
<p><strong>种群数量的方差 (Variance)：</strong></p>
<div class="arithmatex">\[\sigma^2(t) = n_0 p(t) (1 - p(t)) = n_0 e^{-\lambda t} (1 - e^{-\lambda t})\]</div>
<p>这里我们发现了一个至关重要的结论：随机过程的<strong>平均值</strong> <span class="arithmatex">\(\langle n(t) \rangle\)</span> 与我们之前推导的<strong>确定性平均场解</strong> <span class="arithmatex">\(n(t)\)</span> 完全相同！这对于所有线性过程都是一个普遍成立的优美结果。它告诉我们，确定性方程确实正确地捕捉了系统的平均行为。</p>
<p>然而，方差 <span class="arithmatex">\(\sigma^2(t)\)</span> 是一个全新的、纯粹由随机性带来的量。它量化了"人口噪音"的大小——即由于个体死亡事件发生的随机性，实际种群轨迹围绕着平均值的波动程度。这是平均场方法完全无法捕捉到的信息。</p>
<h2 id="25">2.5 计算验证：模拟线性死亡过程<a class="headerlink" href="#25" title="Permanent link">&para;</a></h2>
<p>我们将使用 Gillespie 算法来模拟线性死亡过程，并生成讲座 PPT 中的第一张图。</p>
<p><img alt="课堂PPT截图" src="../../../assets/images/remote/7adc6d62-ed6a-4426-8075-ead0063928ec-8f34530876.png" />
Gillespie 算法的逻辑如下：</p>
<p>1.<strong>初始化</strong>：在时间 <span class="arithmatex">\(t=0\)</span> 时，设置种群数量 <span class="arithmatex">\(N(0)=n_0\)</span>。</p>
<p>2.<strong>计算总速率</strong>：在任意时刻，当种群数量为 <span class="arithmatex">\(N\)</span> 时，发生下一次事件（任何一次死亡）的总速率为 <span class="arithmatex">\(\alpha = \lambda N\)</span>。</p>
<p>3.<strong>确定等待时间</strong>：下一次事件发生的等待时间 <span class="arithmatex">\(\tau\)</span> 服从速率为 <span class="arithmatex">\(\alpha\)</span> 的指数分布。我们可以通过逆变换采样法生成这个时间：<span class="arithmatex">\(\tau = -\frac{1}{\alpha} \ln(\xi)\)</span>，其中 <span class="arithmatex">\(\xi\)</span> 是一个在 <span class="arithmatex">\((0, 1]\)</span> 区间内均匀分布的随机数。</p>
<p>4.<strong>执行事件</strong>：由于系统中只有一种事件（死亡），我们直接更新种群数量：<span class="arithmatex">\(N \to N-1\)</span>。</p>
<p>5.<strong>更新时间</strong>：将当前时间向前推进：<span class="arithmatex">\(t \to t+\tau\)</span>。</p>
<p>6.<strong>重复</strong>：回到第 2 步，继续模拟，直到种群数量 <span class="arithmatex">\(N=0\)</span> 或达到预设的模拟总时长。</p>
<p>下面是实现这一过程并复现讲座中两张图的 Python 代码。</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">comb</span>

<span class="c1"># --- Simulation parameters ---</span>
<span class="n">n0</span> <span class="o">=</span> <span class="mi">20</span>      <span class="c1"># Initial population size</span>
<span class="n">lambda_rate</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Per capita death rate</span>
<span class="n">t_max</span> <span class="o">=</span> <span class="mf">4.0</span>    <span class="c1"># Maximum simulation time</span>
<span class="n">num_simulations</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># Total number of simulated trajectories</span>

<span class="c1"># --- Gillespie algorithm implementation for linear death process ---</span>
<span class="k">def</span><span class="w"> </span><span class="nf">linear_death_gillespie</span><span class="p">(</span><span class="n">n_start</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">t_end</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate linear death process using Gillespie algorithm</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">n_start</span>

    <span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">]</span>
    <span class="n">populations</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="p">]</span>

    <span class="k">while</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">t_end</span><span class="p">:</span>
        <span class="c1"># Total reaction rate</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">rate</span> <span class="o">*</span> <span class="n">n</span>

        <span class="c1"># Generate waiting time tau</span>
        <span class="n">xi1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tau</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">xi1</span><span class="p">)</span> <span class="o">/</span> <span class="n">alpha</span>

        <span class="c1"># Update time and population</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="n">tau</span>
        <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span> <span class="c1"># Only death events</span>

        <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">populations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">populations</span><span class="p">)</span>

<span class="c1"># --- Run multiple simulations ---</span>
<span class="n">all_trajectories</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_simulations</span><span class="p">):</span>
    <span class="n">times</span><span class="p">,</span> <span class="n">populations</span> <span class="o">=</span> <span class="n">linear_death_gillespie</span><span class="p">(</span><span class="n">n0</span><span class="p">,</span> <span class="n">lambda_rate</span><span class="p">,</span> <span class="n">t_max</span><span class="p">)</span>
    <span class="n">all_trajectories</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">times</span><span class="p">,</span> <span class="n">populations</span><span class="p">))</span>

<span class="c1"># --- Plotting ---</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># --- Figure 1: Stochastic trajectories and deterministic solution ---</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Plot some example trajectories</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">times</span><span class="p">,</span> <span class="n">populations</span> <span class="o">=</span> <span class="n">all_trajectories</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">populations</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">)</span>

<span class="c1"># Plot deterministic solution</span>
<span class="n">t_deterministic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">n_deterministic</span> <span class="o">=</span> <span class="n">n0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">lambda_rate</span> <span class="o">*</span> <span class="n">t_deterministic</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_deterministic</span><span class="p">,</span> <span class="n">n_deterministic</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$n(t) = n_0 e^{-\lambda t}$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;population size&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;stochastic trajectories&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n0</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_max</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># --- Figure 2: Histogram and theoretical solution at different times ---</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">time_points</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">,</span> <span class="s1">&#39;saddlebrown&#39;</span><span class="p">,</span> <span class="s1">&#39;darkred&#39;</span><span class="p">]</span>
<span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.8</span>

<span class="c1"># Helper function: get population size at a specific time from a trajectory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_population_at_time</span><span class="p">(</span><span class="n">trajectory</span><span class="p">,</span> <span class="n">t_point</span><span class="p">):</span>
    <span class="n">times</span><span class="p">,</span> <span class="n">populations</span> <span class="o">=</span> <span class="n">trajectory</span>
    <span class="c1"># Find the index of the last time point &lt;= t_point</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">t_point</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">populations</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

<span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">time_points</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="c1"># Collect population sizes at this time point from all simulations</span>
    <span class="n">populations_at_t</span> <span class="o">=</span> <span class="p">[</span><span class="n">get_population_at_time</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">traj</span> <span class="ow">in</span> <span class="n">all_trajectories</span><span class="p">]</span>

    <span class="c1"># Calculate histogram</span>
    <span class="n">n_values</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">populations_at_t</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">probabilities</span> <span class="o">=</span> <span class="n">counts</span> <span class="o">/</span> <span class="n">num_simulations</span>

    <span class="c1"># Plot histogram</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">n_values</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">bar_width</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t = </span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Plot theoretical binomial distribution</span>
    <span class="n">p_survival</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">lambda_rate</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">n_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">p_n_t</span> <span class="o">=</span> <span class="n">comb</span><span class="p">(</span><span class="n">n0</span><span class="p">,</span> <span class="n">n_range</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p_survival</span><span class="o">**</span><span class="n">n_range</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_survival</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">n0</span> <span class="o">-</span> <span class="n">n_range</span><span class="p">))</span>
    <span class="c1"># For visualization, only plot points with significant probabilities</span>
    <span class="c1"># ax.plot(n_range, p_n_t, &#39;o&#39;, color=color, markersize=4)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;p(n, t)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;histogram&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Add theoretical formula text</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$p(n,t) = \binom</span><span class="si">{n_0}{n}</span><span class="s1"> p^n q^{n_0-n}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;saddlebrown&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">,</span> <span class="s1">&#39;t = 4&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkred&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;t = 1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;saddlebrown&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="s1">&#39;t = 0.1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Linear Death Process&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<img alt="运行代码输出" src="../../../assets/images/remote/ed74d315-594f-4662-8da6-fcacae5a7fd8-7fe47412d4.png" />
<strong>右图 (histogram)：</strong>这张图展示了在三个不同时间点（<span class="arithmatex">\(t=0.1, 1, 4\)</span>）种群数量的概率分布。条形图是我们通过运行上万次 Gillespie 模拟得到的经验分布。可以看到，随着时间的推移，分布的峰值向左移动（平均种群数量减少），并且分布变得更宽（相对不确定性增加），最终在时间很长时，大部分模拟都以种群灭绝（<span class="arithmatex">\(n=0\)</span>）告终。这与我们推导的二项分布的动态行为完全一致。</p>
<p><strong>左图 (stochastic trajectories)：</strong>这张图展示了三次独立的模拟轨迹（彩色阶梯线）。每一条轨迹都代表了一种可能的历史。黑色的平滑曲线是我们推导出的确定性解 <span class="arithmatex">\(n(t)=n_0e^{-\lambda t}\)</span>，也就是随机过程的平均值。这张图直观地展示了随机过程的核心特征：<strong>单次实现（轨迹）是随机的、离散的，但大量实现的平均行为则收敛于确定性的均场解</strong>。</p>
<h1 id="3-lotka-volterra-process-">3. 洛特卡-沃尔泰拉过程(Lotka-Volterra Process)：模拟捕食者-猎物互动<a class="headerlink" href="#3-lotka-volterra-process-" title="Permanent link">&para;</a></h1>
<p>在掌握了最简单的单一种群模型后，我们现在将挑战一个更复杂、也更有趣的系统：一个包含两种相互作用物种的生态系统——<strong>捕食者（predator）和猎物（prey）</strong>。这就是著名的洛特卡-沃尔泰拉（<strong>Lotka-Volterra</strong>）模型。我们将看到，物种间的非线性相互作用会产生远比线性过程丰富和令人惊讶的动态行为。</p>
<p>洛特卡-沃尔泰拉方程是一组描述捕食者-猎物生态系统动态的耦合非线性微分方程。这个模型源于20世纪初生态学研究的需求，由阿尔弗雷德·洛特卡和维托·沃尔泰拉分别独立提出，用于解释自然界中捕食者和猎物种群数量的周期性波动现象。</p>
<p>该方程组的建立基于以下生物学假设：</p>
<p>1.捕食者种群因自然死亡而减少，速率为 <span class="arithmatex">\(-\lambda a\)</span></p>
<p>2.捕食者通过捕食猎物而繁殖，增殖速率为 <span class="arithmatex">\(+\gamma_p ab\)</span></p>
<p>3.猎物种群因自身繁殖而增长，速率为 <span class="arithmatex">\(+\mu b\)</span></p>
<p>4.猎物因被捕食而减少，速率为 <span class="arithmatex">\(-\gamma_p ab\)</span></p>
<p>5.猎物之间因资源竞争而死亡，速率为 <span class="arithmatex">\(-\gamma_c b^2\)</span></p>
<p>这些假设最终形成了如下的耦合方程组：
$$
\frac{d}{dt}a(t) = (-\lambda + \gamma_p b) \cdot a
$$</p>
<div class="arithmatex">\[
\frac{d}{dt}b(t) = (\mu - \gamma_p a - \gamma_c b) \cdot b
\]</div>
<p>其中 <span class="arithmatex">\(a(t)\)</span> 和 <span class="arithmatex">\(b(t)\)</span> 分别代表捕食者和猎物的种群密度。</p>
<p>在实际应用中，洛特卡-沃尔泰拉方程广泛用于：</p>
<p>1.<strong>生态系统建模</strong>：分析捕食者-猎物关系，如狼与鹿、猫与鼠等生态系统的行为</p>
<p>2.<strong>渔业资源管理</strong>：指导可持续捕捞策略的制定</p>
<p>3.<strong>害虫生物防治</strong>：设计利用天敌控制农业害虫的方案</p>
<p>4.<strong>流行病学研究</strong>：模拟疾病传播中病毒与宿主的相互作用</p>
<p>5.<strong>经济学建模</strong>：描述商业竞争中不同企业间的动态关系</p>
<p>该模型虽然简化了现实生态系统的复杂性，但其揭示的非线性相互作用原理对理解复杂系统行为具有重要意义。特别是当引入随机性后，该模型能更好地反映真实生态系统中种群数量的波动特性，为生态风险评估和生物多样性保护提供理论基础。</p>
<h2 id="31">3.1 构建生态系统：基本随机过程<a class="headerlink" href="#31" title="Permanent link">&para;</a></h2>
<p>我们定义系统中的两个物种：</p>
<ul>
<li><strong>A</strong>: 捕食者 (Predator)</li>
<li><strong>B</strong>: 猎物 (Prey)</li>
</ul>
<p>这个生态系统的动态由四个基本（或称元）随机过程共同决定：</p>
<ol>
<li>
<p><strong>捕食者死亡 (Predator Death)：</strong>捕食者会因自然原因死亡。这是一个线性的死亡过程，与我们之前分析的类似。
   <span class="arithmatex">\(<span class="arithmatex">\(\varnothing \xleftarrow{\lambda} A\)</span>\)</span></p>
</li>
<li>
<p><strong>猎物出生 (Prey Birth)：</strong>猎物会自我繁殖。假设资源充足，这也是一个线性的出生过程。
   <span class="arithmatex">\(<span class="arithmatex">\(B \xrightarrow{\mu} B + B\)</span>\)</span></p>
</li>
<li>
<p><strong>捕食 (Predation)：</strong>这是模型的核心互动。当一个捕食者 A 遇到一个猎物 B 时，它会吃掉猎物，并在此过程中繁殖出一个新的捕食者。</p>
</li>
</ol>
<p>$$
   A + B \xrightarrow{\gamma_p} A + A
   $$</p>
<ol>
<li><strong>猎物竞争 (Prey Competition)：</strong>当猎物数量过多时，它们会因为争夺有限的资源（如食物、空间）而发生竞争，导致其中一个个体死亡。
   $$
   B + B \xrightarrow{\gamma_c} B
   $$</li>
</ol>
<h2 id="32">3.2 量化变化：反应倾向性<a class="headerlink" href="#32" title="Permanent link">&para;</a></h2>
<p>为了用 Gillespie 算法模拟这个系统或推导其平均场方程，我们需要将上述的符号化反应转化为数学上的速率表达式，即<strong>倾向性函数 (propensity function)</strong> <span class="arithmatex">\(\alpha_\mu\)</span>。倾向性 <span class="arithmatex">\(\alpha_\mu\)</span> 表示反应 <span class="arithmatex">\(\mu\)</span> 在单位时间内发生的概率。</p>
<p>假设系统当前的状态是 <span class="arithmatex">\((N_A, N_B)\)</span>，其中 <span class="arithmatex">\(N_A\)</span> 是捕食者数量，<span class="arithmatex">\(N_B\)</span> 是猎物数量。</p>
<p><span class="arithmatex">\(\alpha_1 = \lambda N_A\)</span>：捕食者死亡的总速率。与线性死亡过程一样，它正比于捕食者的数量 <span class="arithmatex">\(N_A\)</span>。</p>
<p><span class="arithmatex">\(\alpha_2 = \mu N_B\)</span>：猎物出生的总速率，正比于猎物数量 <span class="arithmatex">\(N_B\)</span>。</p>
<p><span class="arithmatex">\(\alpha_3 = \gamma_p N_A N_B\)</span>：捕食事件的总速率。这个二次项是模型的关键。它源于"质量作用定律"的假设：在一个充分混合的系统中，两种不同类型的个体相遇的频率正比于它们各自数量的乘积。</p>
<p><span class="arithmatex">\(\alpha_4 = \gamma_c N_B(N_B - 1)\)</span>：猎物竞争的总速率。竞争需要两个猎物个体参与。在 <span class="arithmatex">\(N_B\)</span> 个猎物中，可以组成的不同个体对的数量是 <span class="arithmatex">\(\binom{N_B}{2} = \frac{1}{2}N_B(N_B - 1)\)</span>。因此，总速率正比于此。Frey 教授的讲义中将速率常数定义为 <span class="arithmatex">\(\gamma_c\)</span>，吸收了因子 <span class="arithmatex">\(1/2\)</span>，因此倾向性写为 <span class="arithmatex">\(\gamma_c N_B(N_B - 1)\)</span>。当 <span class="arithmatex">\(N_B\)</span> 很大时，这近似于 <span class="arithmatex">\(\gamma_c N_B^2\)</span>。</p>
<p>为了清晰地组织这些信息，我们可以创建一个表格，它将成为我们理解和编程的蓝图：</p>
<table>
<thead>
<tr>
<th>过程名称</th>
<th>化学反应式</th>
<th>速率常数</th>
<th>倾向性函数 <span class="arithmatex">\(\alpha_\mu(N_A, N_B)\)</span></th>
<th>状态变化 <span class="arithmatex">\((\Delta N_A, \Delta N_B)\)</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>捕食者死亡</td>
<td><span class="arithmatex">\(A \xrightarrow{\lambda} \emptyset\)</span></td>
<td><span class="arithmatex">\(\lambda\)</span></td>
<td><span class="arithmatex">\(\lambda N_A\)</span></td>
<td><span class="arithmatex">\((-1, 0)\)</span></td>
</tr>
<tr>
<td>猎物出生</td>
<td><span class="arithmatex">\(B \xrightarrow{\mu} B + B\)</span></td>
<td><span class="arithmatex">\(\mu\)</span></td>
<td><span class="arithmatex">\(\mu N_B\)</span></td>
<td><span class="arithmatex">\((0, +1)\)</span></td>
</tr>
<tr>
<td>捕食</td>
<td><span class="arithmatex">\(A + B \xrightarrow{\gamma_p} A + A\)</span></td>
<td><span class="arithmatex">\(\gamma_p\)</span></td>
<td><span class="arithmatex">\(\gamma_p N_A N_B\)</span></td>
<td><span class="arithmatex">\((+1, -1)\)</span></td>
</tr>
<tr>
<td>猎物竞争</td>
<td><span class="arithmatex">\(B + B \xrightarrow{\gamma_c} B\)</span></td>
<td><span class="arithmatex">\(\gamma_c\)</span></td>
<td><span class="arithmatex">\(\gamma_c N_B (N_B - 1)\)</span></td>
<td><span class="arithmatex">\((0, -1)\)</span></td>
</tr>
</tbody>
</table>
<p>这个表格完整地定义了我们的随机模型。每一行都告诉我们一个事件的"发生速率"（倾向性）以及"发生后会怎样"（状态变化）。</p>
<h2 id="33">3.3 平均场近似：耦合速率方程<a class="headerlink" href="#33" title="Permanent link">&para;</a></h2>
<p><img alt="课堂PPT截图" src="../../../assets/images/remote/d81e28ad-d89e-4759-9624-57eca4a46274-6eed958c80.png" /></p>
<p>与线性死亡过程类似，我们可以通过忽略随机波动来推导描述系统平均行为的确定性方程。我们用连续变量 <span class="arithmatex">\(a(t)\)</span> 和 <span class="arithmatex">\(b(t)\)</span> 分别代表捕食者和猎物的种群密度。</p>
<p><strong>捕食者密度 <span class="arithmatex">\(a(t)\)</span> 的变化</strong>：</p>
<ul>
<li>
<p>因自然死亡而减少，速率为 <span class="arithmatex">\(-\lambda a\)</span>。</p>
</li>
<li>
<p>因捕食猎物而增加，速率为 <span class="arithmatex">\(+\gamma_p ab\)</span>。</p>
</li>
<li>
<p>合并得到：<span class="arithmatex">\(\frac{d}{dt}a(t) = (-\lambda + \gamma_p b) \cdot a\)</span></p>
</li>
</ul>
<p><strong>猎物密度 <span class="arithmatex">\(b(t)\)</span> 的变化</strong>：</p>
<ul>
<li>
<p>因自身繁殖而增加，速率为 <span class="arithmatex">\(+\mu b\)</span>。</p>
</li>
<li>
<p>因被捕食而减少，速率为 <span class="arithmatex">\(-\gamma_p ab\)</span>。</p>
</li>
<li>
<p>因内部竞争而减少，速率为 <span class="arithmatex">\(-\gamma_c b^2\)</span>（这里我们用 <span class="arithmatex">\(b^2\)</span> 作为 <span class="arithmatex">\(b(b-1)\)</span> 的连续近似）。</p>
</li>
<li>
<p>合并得到：<span class="arithmatex">\(\frac{d}{dt}b(t) = (\mu - \gamma_p a - \gamma_c b) \cdot b\)</span></p>
</li>
</ul>
<p>这两个耦合的非线性常微分方程就是确定性的洛特卡-沃尔泰拉方程。</p>
<h2 id="34">3.4 相空间中的动态：不动点与相图<a class="headerlink" href="#34" title="Permanent link">&para;</a></h2>
<p>确定性方程的长期行为可以通过分析其在 <span class="arithmatex">\((a,b)\)</span> 相空间中的流场来理解。我们关心的是不动点（fixed points），即种群密度不再变化的点（<span class="arithmatex">\(\partial_t a=0\)</span> 和 <span class="arithmatex">\(\partial_t b=0\)</span>）。</p>
<p><img alt="课堂PPT截图" src="../../../assets/images/remote/87d348ef-9175-4639-9cb7-898aeec11f99-1ca44bd51d.jpg" /></p>
<p><strong>特殊情况 (<span class="arithmatex">\(\gamma_c=0\)</span>)：</strong>这是最经典的洛特卡-沃尔泰拉模型，没有猎物竞争。</p>
<p>不动点有两个：一个是灭绝点 <span class="arithmatex">\((0,0)\)</span>，另一个是共存不动点 <span class="arithmatex">\((a^*,b^*)=(\mu/\gamma_p,\lambda/\gamma_p)\)</span>。</p>
<p>分析表明，这个共存不动点是一个<strong>中性稳定中心</strong> (neutrally stable center)。系统的轨迹是围绕这个中心的一系列封闭的轨道（周期性振荡）。系统所在的具体轨道由初始条件决定。</p>
<p>这个系统是保守的，存在一个守恒量 <span class="arithmatex">\(E = \mu \ln a + \lambda \ln b - \gamma_p(a+b)\)</span>。每条轨道对应一个恒定的 <span class="arithmatex">\(E\)</span> 值。</p>
<p><strong>一般情况 (<span class="arithmatex">\(\gamma_c&gt;0\)</span>)：</strong>引入猎物竞争后，情况发生了质变。</p>
<p>共存不动点的位置变为 <span class="arithmatex">\((a^*,b^*)\)</span>，其中 <span class="arithmatex">\(b^* = (\mu-\gamma_p a^*)/\gamma_c\)</span>。</p>
<p>竞争项 <span class="arithmatex">\(\gamma_c b^2\)</span> 起到了"阻尼"的作用。不动点不再是中性中心，而是一个<strong>稳定螺线点</strong> (stable spiral)。无论从哪个初始条件出发（只要种群不灭绝），系统的轨迹都会以振荡的方式螺旋式地收敛到这个唯一的共存不动点。</p>
<p>我们可以通过绘制相图（Phase Portraits）来将这些动态行为可视化。
<div class="highlight"><pre><span></span><code><span class="c1"># --- Import necessary libraries ---</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">odeint</span>

<span class="c1"># --- Define Lotka-Volterra ODE system ---</span>
<span class="k">def</span><span class="w"> </span><span class="nf">lotka_volterra_ode</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">lambda_rate</span><span class="p">,</span> <span class="n">mu_rate</span><span class="p">,</span> <span class="n">gamma_p</span><span class="p">,</span> <span class="n">gamma_c</span><span class="p">):</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">y</span>
    <span class="n">da_dt</span> <span class="o">=</span> <span class="n">mu_rate</span> <span class="o">*</span> <span class="n">a</span> <span class="o">-</span> <span class="n">gamma_p</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
    <span class="n">db_dt</span> <span class="o">=</span> <span class="o">-</span><span class="n">lambda_rate</span> <span class="o">*</span> <span class="n">b</span> <span class="o">+</span> <span class="n">gamma_p</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="o">-</span> <span class="n">gamma_c</span> <span class="o">*</span> <span class="n">b</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">da_dt</span><span class="p">,</span> <span class="n">db_dt</span><span class="p">]</span>

<span class="c1"># --- Set parameters ---</span>
<span class="n">lambda_rate</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">mu_rate</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">gamma_p</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">gamma_c</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="c1"># --- Plot phase diagrams ---</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># --- Case 1: gamma_c = 0 (neutral center) ---</span>
<span class="n">gamma_c</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">a_max</span><span class="p">,</span> <span class="n">b_max</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span>
<span class="n">a_grid</span><span class="p">,</span> <span class="n">b_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">b_max</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>

<span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">a_grid</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">b_grid</span><span class="p">)</span>
<span class="n">NI</span><span class="p">,</span> <span class="n">NJ</span> <span class="o">=</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">shape</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NI</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NJ</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_grid</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">b_grid</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]]</span>
        <span class="n">dydt</span> <span class="o">=</span> <span class="n">lotka_volterra_ode</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lambda_rate</span><span class="p">,</span> <span class="n">mu_rate</span><span class="p">,</span> <span class="n">gamma_p</span><span class="p">,</span> <span class="n">gamma_c</span><span class="p">)</span>
        <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dydt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dydt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Plot flow field</span>
<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">a_grid</span><span class="p">,</span> <span class="n">b_grid</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkslategrey&#39;</span><span class="p">)</span>

<span class="c1"># Plot fixed point</span>
<span class="n">a_star</span> <span class="o">=</span> <span class="n">mu_rate</span> <span class="o">/</span> <span class="n">gamma_p</span>
<span class="n">b_star</span> <span class="o">=</span> <span class="n">lambda_rate</span> <span class="o">/</span> <span class="n">gamma_p</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a_star</span><span class="p">,</span> <span class="n">b_star</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="c1"># Plot sample trajectories</span>
<span class="n">initial_conditions</span> <span class="o">=</span> <span class="p">[[</span><span class="n">a_star</span><span class="o">*</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">b_star</span><span class="o">*</span><span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="n">a_star</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">b_star</span><span class="o">*</span><span class="mf">0.5</span><span class="p">]]</span>
<span class="n">t_span</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">y0</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">initial_conditions</span><span class="p">):</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">lotka_volterra_ode</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">lambda_rate</span><span class="p">,</span> <span class="n">mu_rate</span><span class="p">,</span> <span class="n">gamma_p</span><span class="p">,</span> <span class="n">gamma_c</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a_max</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">b_max</span><span class="p">)</span>

<span class="c1"># --- Case 2: gamma_c &gt; 0 (stable spiral point) ---</span>
<span class="n">gamma_c</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">a_max</span><span class="p">,</span> <span class="n">b_max</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span>
<span class="n">a_grid</span><span class="p">,</span> <span class="n">b_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a_max</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">b_max</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>

<span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">a_grid</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">b_grid</span><span class="p">)</span>
<span class="n">NI</span><span class="p">,</span> <span class="n">NJ</span> <span class="o">=</span> <span class="n">a_grid</span><span class="o">.</span><span class="n">shape</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NI</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NJ</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">a_grid</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">b_grid</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]]</span>
        <span class="n">dydt</span> <span class="o">=</span> <span class="n">lotka_volterra_ode</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lambda_rate</span><span class="p">,</span> <span class="n">mu_rate</span><span class="p">,</span> <span class="n">gamma_p</span><span class="p">,</span> <span class="n">gamma_c</span><span class="p">)</span>
        <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">dydt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dydt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">a_grid</span><span class="p">,</span> <span class="n">b_grid</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkslategrey&#39;</span><span class="p">)</span>

<span class="c1"># Plot fixed point</span>
<span class="n">b_star_damped</span> <span class="o">=</span> <span class="n">lambda_rate</span> <span class="o">/</span> <span class="n">gamma_p</span>
<span class="n">a_star_damped</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu_rate</span> <span class="o">-</span> <span class="n">gamma_c</span> <span class="o">*</span> <span class="n">b_star_damped</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma_p</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a_star_damped</span><span class="p">,</span> <span class="n">b_star_damped</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="c1"># Plot sample trajectories</span>
<span class="n">initial_conditions</span> <span class="o">=</span> <span class="p">[[</span><span class="n">a_star_damped</span><span class="o">*</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">b_star_damped</span><span class="o">*</span><span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="n">a_star_damped</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">b_star_damped</span><span class="o">*</span><span class="mf">0.5</span><span class="p">]]</span>
<span class="n">t_span</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">y0</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">initial_conditions</span><span class="p">):</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">lotka_volterra_ode</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">lambda_rate</span><span class="p">,</span> <span class="n">mu_rate</span><span class="p">,</span> <span class="n">gamma_p</span><span class="p">,</span> <span class="n">gamma_c</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a_max</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">b_max</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Phase Portraits&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<img alt="运行代码输出" src="../../../assets/images/remote/0f2238f9-154a-4031-b425-99586f550155-c48f8168f5.png" /></p>
<p><strong>左图 (<span class="arithmatex">\(\gamma_c=0\)</span>)</strong>: 该图清晰地展示了一个中性稳定中心。流线（streamplot）形成了围绕中心不动点（白色圆圈）的闭合环路。我们绘制的两条轨迹（橙色和橘红色）也沿着这些闭合轨道运行，永不靠近也不远离中心。这代表了捕食者和猎物数量的持续周期性振荡。</p>
<p><strong>右图 (<span class="arithmatex">\(\gamma_c&gt;0\)</span>)</strong>: 该图展示了一个稳定螺线点。流线现在都指向内部的中心不动点（红色圆圈）。我们绘制的一条轨迹（红色）也显示了种群数量一边振荡一边衰减，最终趋向于稳定的共存状态。</p>
<h1 id="4-gillespie">4. 完整的随机模拟：Gillespie 算法<a class="headerlink" href="#4-gillespie" title="Permanent link">&para;</a></h1>
<p>确定性模型为我们提供了系统平均行为的蓝图，但真实的故事隐藏在随机性之中。现在，我们将使用 Gillespie 算法来模拟完整的随机洛特卡-沃尔泰拉过程。</p>
<p><img alt="课堂PPT截图" src="../../../assets/images/remote/35228029-308c-4ceb-943f-9a2b3fe6b1d0-6cd5872ffd.png" /></p>
<p><img alt="课堂PPT截图" src="../../../assets/images/remote/15ccbc5f-3f31-4f2d-ae17-c82b6230304d-d48ac47777.png" /></p>
<p>适用于多个反应通道的 Gillespie 算法步骤如下：</p>
<p>1.<strong>初始化</strong>：在 <span class="arithmatex">\(t=0\)</span> 时，设置状态 <span class="arithmatex">\((N_A,N_B)\)</span>。</p>
<p>2.<strong>计算所有倾向性</strong>：根据当前状态 <span class="arithmatex">\((N_A,N_B)\)</span>，计算出所有四个反应的倾向性 <span class="arithmatex">\(\alpha_1,\alpha_2,\alpha_3,\alpha_4\)</span>。</p>
<p>3.<strong>计算总速率</strong>：将所有倾向性相加，得到总速率 <span class="arithmatex">\(\alpha_{\text{tot}} = \sum_{\mu=1}^{4} \alpha_\mu\)</span>。</p>
<p>4.<strong>确定等待时间</strong>：生成下一次事件的等待时间 <span class="arithmatex">\(\tau = -\frac{1}{\alpha_{\text{tot}}} \ln(\xi_1)\)</span>，其中 <span class="arithmatex">\(\xi_1\)</span> 是 <span class="arithmatex">\((0, 1]\)</span> 上的均匀随机数。</p>
<p>5.<strong>选择发生的事件</strong>：这是关键一步。我们需要根据每个反应的相对概率 <span class="arithmatex">\(\alpha_\mu/\alpha_{\text{tot}}\)</span> 来决定具体发生哪个事件。这可以通过"轮盘赌"选择法实现：生成第二个均匀随机数 <span class="arithmatex">\(\xi_2 \in [0,1]\)</span>，然后选择满足 <span class="arithmatex">\(\sum_{\nu=1}^{\mu-1} \alpha_\nu &lt; \xi_2 \alpha_{\text{tot}} \leq \sum_{\nu=1}^{\mu} \alpha_\nu\)</span> 的反应 <span class="arithmatex">\(\mu\)</span>。</p>
<p>6.<strong>执行事件</strong>：根据选中的反应类型，按照状态变化表更新系统状态。</p>
<p>7.<strong>更新时间</strong>：将当前时间向前推进：<span class="arithmatex">\(t \to t+\tau\)</span>。</p>
<p>8.<strong>重复</strong>：回到第 2 步，继续模拟，直到达到预设的模拟总时长。</p>
<p>下面是实现这一算法的 Python 代码：</p>
<p><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">odeint</span>

<span class="c1"># --- Parameter Setup ---</span>
<span class="n">lambda_rate</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Predator death rate</span>
<span class="n">mu_rate</span> <span class="o">=</span> <span class="mf">1.0</span>      <span class="c1"># Prey birth rate</span>
<span class="n">gamma_p</span> <span class="o">=</span> <span class="mf">0.01</span>     <span class="c1"># Predation rate</span>

<span class="c1"># --- Deterministic ODE Definition ---</span>
<span class="k">def</span><span class="w"> </span><span class="nf">lotka_volterra_ode</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">lambda_r</span><span class="p">,</span> <span class="n">mu_r</span><span class="p">,</span> <span class="n">gamma_p_r</span><span class="p">,</span> <span class="n">gamma_c_r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines the system of ordinary differential equations for the Lotka-Volterra model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">y</span>
    <span class="n">dadt</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">lambda_r</span> <span class="o">+</span> <span class="n">gamma_p_r</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span>
    <span class="n">dbdt</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu_r</span> <span class="o">-</span> <span class="n">gamma_p_r</span> <span class="o">*</span> <span class="n">a</span> <span class="o">-</span> <span class="n">gamma_c_r</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dadt</span><span class="p">,</span> <span class="n">dbdt</span><span class="p">]</span>

<span class="c1"># --- Gillespie Algorithm for Lotka-Volterra Process ---</span>
<span class="k">def</span><span class="w"> </span><span class="nf">lotka_volterra_gillespie</span><span class="p">(</span><span class="n">n_a</span><span class="p">,</span> <span class="n">n_b</span><span class="p">,</span> <span class="n">rates</span><span class="p">,</span> <span class="n">t_end</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates the Lotka-Volterra process using the Gillespie algorithm.</span>

<span class="sd">    Args:</span>
<span class="sd">        n_a (int): Initial number of predators.</span>
<span class="sd">        n_b (int): Initial number of prey.</span>
<span class="sd">        rates (tuple): A tuple of rate constants (lambda_r, mu_r, gamma_p_r, gamma_c_r).</span>
<span class="sd">        t_end (float): The end time for the simulation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple containing arrays for times, predator populations, and prey populations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lambda_r</span><span class="p">,</span> <span class="n">mu_r</span><span class="p">,</span> <span class="n">gamma_p_r</span><span class="p">,</span> <span class="n">gamma_c_r</span> <span class="o">=</span> <span class="n">rates</span>

    <span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="c1"># Ensure populations are floats to avoid potential integer division issues</span>
    <span class="n">n_a</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n_a</span><span class="p">)</span>
    <span class="n">n_b</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n_b</span><span class="p">)</span>

    <span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">]</span>
    <span class="n">populations_a</span> <span class="o">=</span> <span class="p">[</span><span class="n">n_a</span><span class="p">]</span>
    <span class="n">populations_b</span> <span class="o">=</span> <span class="p">[</span><span class="n">n_b</span><span class="p">]</span>

    <span class="c1"># Stoichiometry matrix: rows are reactions, columns are species (A, B)</span>
    <span class="n">nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>  <span class="c1"># Reaction 1: A -&gt; 0 (Predator death)</span>
        <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="o">+</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># Reaction 2: B -&gt; 2B (Prey birth)</span>
        <span class="p">[</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># Reaction 3: A+B -&gt; 2A (Predation)</span>
        <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="c1"># Reaction 4: 2B -&gt; B (Prey competition)</span>
    <span class="p">])</span>

    <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">t_end</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n_a</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n_b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>  <span class="c1"># Stop if one species goes extinct</span>

        <span class="c1"># Calculate propensities for each reaction</span>
        <span class="n">propensities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="n">lambda_r</span> <span class="o">*</span> <span class="n">n_a</span><span class="p">,</span>
            <span class="n">mu_r</span> <span class="o">*</span> <span class="n">n_b</span><span class="p">,</span>
            <span class="n">gamma_p_r</span> <span class="o">*</span> <span class="n">n_a</span> <span class="o">*</span> <span class="n">n_b</span><span class="p">,</span>
            <span class="n">gamma_c_r</span> <span class="o">*</span> <span class="n">n_b</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_b</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">])</span>

        <span class="n">a_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">propensities</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">a_total</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span> <span class="c1"># No more reactions can occur</span>

        <span class="c1"># Generate waiting time (tau) until the next reaction</span>
        <span class="n">xi1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">tau</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">xi1</span><span class="p">)</span> <span class="o">/</span> <span class="n">a_total</span>

        <span class="c1"># Choose which reaction occurs</span>
        <span class="n">xi2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">p_normalized</span> <span class="o">=</span> <span class="n">propensities</span> <span class="o">/</span> <span class="n">a_total</span>
        <span class="n">reaction_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">propensities</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">p_normalized</span><span class="p">)</span>

        <span class="c1"># Update time and populations</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="n">tau</span>
        <span class="n">n_a</span> <span class="o">+=</span> <span class="n">nu</span><span class="p">[</span><span class="n">reaction_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">n_b</span> <span class="o">+=</span> <span class="n">nu</span><span class="p">[</span><span class="n">reaction_idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">populations_a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n_a</span><span class="p">)</span>
        <span class="n">populations_b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n_b</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">times</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">populations_a</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">populations_b</span><span class="p">)</span>

<span class="c1"># --- Initial Conditions ---</span>
<span class="c1"># The deterministic fixed point is (100, 100) for gamma_c=0.</span>
<span class="c1"># We start away from the fixed point to observe oscillations.</span>
<span class="n">n_a0</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">n_b0</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># --- Plot 1: Stochastic Oscillations Time Series (Reproducing PPT_1.jpg) ---</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8-whitegrid&#39;</span><span class="p">)</span>
<span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">gamma_c_1</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">rates_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambda_rate</span><span class="p">,</span> <span class="n">mu_rate</span><span class="p">,</span> <span class="n">gamma_p</span><span class="p">,</span> <span class="n">gamma_c_1</span><span class="p">)</span>
<span class="c1"># For a better single trajectory view, let&#39;s start this one away from the fixed point too</span>
<span class="n">t_sim_1</span><span class="p">,</span> <span class="n">n_a_sim_1</span><span class="p">,</span> <span class="n">n_b_sim_1</span> <span class="o">=</span> <span class="n">lotka_volterra_gillespie</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">rates_1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_sim_1</span><span class="p">,</span> <span class="n">n_a_sim_1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predator&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_sim_1</span><span class="p">,</span> <span class="n">n_b_sim_1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prey&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Stochastic Simulation of Predator-Prey Dynamics</span><span class="se">\n</span><span class="s1">&#39;</span>
              <span class="sa">f</span><span class="s1">&#39;$\lambda=</span><span class="si">{</span><span class="n">lambda_rate</span><span class="si">}</span><span class="s1">, \mu=</span><span class="si">{</span><span class="n">mu_rate</span><span class="si">}</span><span class="s1">, \gamma_p=</span><span class="si">{</span><span class="n">gamma_p</span><span class="si">}</span><span class="s1">, \gamma_c=</span><span class="si">{</span><span class="n">gamma_c_1</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> 
              <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">n_a_sim_1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">n_b_sim_1</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1.1</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">n_a_sim_1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># --- Plot 2: Stochastic vs. Deterministic (Reproducing PPT2.jpg) ---</span>
<span class="n">fig2</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># --- Left Subplot: gamma_c = 0 ---</span>
<span class="n">ax2_left</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">gamma_c_left</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">rates_left</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambda_rate</span><span class="p">,</span> <span class="n">mu_rate</span><span class="p">,</span> <span class="n">gamma_p</span><span class="p">,</span> <span class="n">gamma_c_left</span><span class="p">)</span>
<span class="n">num_simulations</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Number of stochastic trajectories to plot</span>

<span class="c1"># Run and plot multiple stochastic simulations</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_simulations</span><span class="p">):</span>
    <span class="n">t_sim</span><span class="p">,</span> <span class="n">n_a_sim</span><span class="p">,</span> <span class="n">n_b_sim</span> <span class="o">=</span> <span class="n">lotka_volterra_gillespie</span><span class="p">(</span><span class="n">n_a0</span><span class="p">,</span> <span class="n">n_b0</span><span class="p">,</span> <span class="n">rates_left</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
    <span class="c1"># Use a low alpha to create a &quot;cloud&quot; effect</span>
    <span class="n">ax2_left</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_sim</span><span class="p">,</span> <span class="n">n_a_sim</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> 
                  <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Stochastic Simulation&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ax2_left</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_sim</span><span class="p">,</span> <span class="n">n_b_sim</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>


<span class="c1"># Deterministic solution</span>
<span class="n">t_ode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="n">n_a0</span><span class="p">,</span> <span class="n">n_b0</span><span class="p">]</span>
<span class="n">sol_left</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">lotka_volterra_ode</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t_ode</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">rates_left</span><span class="p">)</span>
<span class="c1"># Plot deterministic solution with a thick black line for contrast</span>
<span class="n">ax2_left</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ode</span><span class="p">,</span> <span class="n">sol_left</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Deterministic Solution&#39;</span><span class="p">)</span>
<span class="n">ax2_left</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ode</span><span class="p">,</span> <span class="n">sol_left</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>


<span class="n">ax2_left</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2_left</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2_left</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$\gamma_p = </span><span class="si">{</span><span class="n">gamma_p</span><span class="si">}</span><span class="s1">, \gamma_c = </span><span class="si">{</span><span class="n">gamma_c_left</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2_left</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax2_left</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
<span class="n">ax2_left</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">850</span><span class="p">)</span>


<span class="c1"># --- Right Subplot: gamma_c &gt; 0 ---</span>
<span class="n">ax2_right</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">gamma_c_right</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">rates_right</span> <span class="o">=</span> <span class="p">(</span><span class="n">lambda_rate</span><span class="p">,</span> <span class="n">mu_rate</span><span class="p">,</span> <span class="n">gamma_p</span><span class="p">,</span> <span class="n">gamma_c_right</span><span class="p">)</span>

<span class="c1"># Run and plot multiple stochastic simulations</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_simulations</span><span class="p">):</span>
    <span class="n">t_sim</span><span class="p">,</span> <span class="n">n_a_sim</span><span class="p">,</span> <span class="n">n_b_sim</span> <span class="o">=</span> <span class="n">lotka_volterra_gillespie</span><span class="p">(</span><span class="n">n_a0</span><span class="p">,</span> <span class="n">n_b0</span><span class="p">,</span> <span class="n">rates_right</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
    <span class="n">ax2_right</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_sim</span><span class="p">,</span> <span class="n">n_a_sim</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                   <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Stochastic Simulation&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">ax2_right</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_sim</span><span class="p">,</span> <span class="n">n_b_sim</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>


<span class="c1"># Deterministic solution</span>
<span class="n">sol_right</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">lotka_volterra_ode</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t_ode</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">rates_right</span><span class="p">)</span>
<span class="n">ax2_right</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ode</span><span class="p">,</span> <span class="n">sol_right</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Deterministic Solution&#39;</span><span class="p">)</span>
<span class="n">ax2_right</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_ode</span><span class="p">,</span> <span class="n">sol_right</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

<span class="n">ax2_right</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2_right</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax2_right</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;$\gamma_p = </span><span class="si">{</span><span class="n">gamma_p</span><span class="si">}</span><span class="s1">, \gamma_c = </span><span class="si">{</span><span class="n">gamma_c_right</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax2_right</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax2_right</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
<span class="n">ax2_right</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">650</span><span class="p">)</span>


<span class="n">fig2</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Comparison of Stochastic Trajectories and Deterministic Solutions&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<img alt="运行代码输出" src="../../../assets/images/remote/a7249f6d-3693-4c80-b256-49f91f882052-06432353d7.png" />
<strong>第一张图 (随机振荡时间序列)：</strong>这张图展示了在没有猎物竞争（<span class="arithmatex">\(\gamma_c=0\)</span>）的情况下，一次典型的随机模拟结果。我们可以看到清晰的捕食者-猎物振荡：猎物（橙色线）数量先增加，随后捕食者（蓝色线）数量因食物充足而增加；捕食者增多导致猎物数量下降，接着捕食者因食物短缺而数量下降，完成一个循环。然而，与确定性模型的完美周期不同，这里的振荡<strong>幅度和周期都是随机变化的</strong>。</p>
<p><img alt="运行代码输出" src="../../../assets/images/remote/7dc4f5d9-bb4b-4509-8fe9-176a41eeb8cc-94c9ea384f.png" /></p>
<p><strong>第二张图 (随机 vs 确定性对比)：</strong>这张图是本讲座最核心、最发人深省的结果。</p>
<p><img alt="课堂PPT截图" src="../../../assets/images/remote/6d7d454d-aae9-4ef5-81f8-ff738df73995-420a240e98.png" /></p>
<p><strong>左子图 (<span class="arithmatex">\(\gamma_c=0\)</span>)</strong>: 确定性解（粗黑线）是一条完美的、稳定的周期轨道。然而，随机模拟（细灰线）的行为截然不同。随机轨迹的振荡幅度<strong>倾向于不断增大</strong>，出现越来越高的波峰和越来越低的波谷。这是为什么呢？确定性系统是保守的，被"囚禁"在由初始条件决定的一条轨道上。而随机事件（出生、死亡）就像是对系统的随机"踢动"，使得系统可以在不同的轨道之间进行随机游走。由于没有一个力把它拉回到某个特定的轨道，这种游走会使振荡幅度扩散，极大地增加了某个物种数量触及零（即灭绝）的风险。在这里，<strong>内在噪音起到了破坏稳定性的作用</strong>。</p>
<p><strong>右子图 (<span class="arithmatex">\(\gamma_c &gt; 0\)</span>)</strong>: 引入猎物竞争后，确定性解（粗黑线）表现为阻尼振荡，最终稳定在一个不动点上。生态系统达到了一个静态的平衡。然而，随机模拟（细灰线）再次讲述了一个不同的故事。轨迹确实被吸引到了不动点附近，但它<strong>并没有停下来</strong>。相反，它在不动点周围持续地进行着随机波动。这里，确定性动力像一个"恢复力"，总是试图将系统拉回到平衡点；而随机事件则像一个持续的"驱动力"，不断地将系统踢离平衡点。这两者之间达成的动态平衡，使得系统能够<strong>维持持续的、有噪声的振荡</strong>。在这种情况下，<strong>内在噪音起到了维持动态、防止系统"死亡"的作用</strong>。</p>
<h1 id="_3">总结<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h1>
<p>通过本次课的学习，我们完成了一次从简单到复杂的旅程，从一个物种的指数衰减，到一个完整生态系统的复杂互动。更重要的是，我们深入探讨了描述这些系统的两种不同哲学：确定性平均场理论和完整的随机理论。</p>
<p>我们总结出以下关键教训：</p>
<p>1.<strong>确定性模型捕捉平均行为</strong>：对于线性过程，或者对于种群规模极大的非线性过程，确定性（平均场）方程能够很好地描述系统的平均动态。例如，线性死亡过程的平均值与确定性解完全一致。</p>
<p>2.<strong>随机性揭示了波动的本质</strong>：随机模型不仅给出了平均行为，还精确地量化了围绕平均值的波动（方差或整个概率分布）。这些"人口噪音"在确定性世界中是不可见的，但在真实的生物系统中，它们是不可避免的、核心的组成部分。</p>
<p>3.<strong>噪音的角色是微妙且依赖于系统的</strong>：通过对比有无竞争的洛特卡-沃尔泰拉模型，我们看到了一个最深刻的结论：噪音并非总是"讨厌的"随机扰动。它的作用与系统本身的确定性动力学结构密切相关。</p>
<div class="highlight"><pre><span></span><code>* 在保守的、具有中性稳定轨道的系统中（如 $\gamma_c=0$），噪音是**破坏性的**，它会放大振荡，驱动系统走向灭绝。
* 在耗散的、具有稳定吸引子的系统中（如 $\gamma_c&gt;0$），噪音是**创造性的**，它能与确定性的吸引力相抗衡，维持系统持续的动态波动，防止其陷入死寂的平衡。
</code></pre></div>
<p>最终，这节课告诉我们，要真正理解生态系统、细胞网络或流行病传播等现象，我们必须拥抱随机性。随机波动不是需要被平均掉的细节，而是驱动系统产生丰富、复杂甚至反直觉行为的关键因素。我们建立的"主方程-Gillespie算法"框架，为探索这个随机世界提供了强大而精确的工具。</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.sections", "navigation.expand", "navigation.top", "toc.integrate", "search.highlight"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../assets/javascripts/mathjax.js"></script>
      
        <script src="../../../assets/javascripts/language-nav.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>